<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liu Chih Yuan">
<meta name="dcterms.date" content="2025-05-28">

<title>VAST Challenge 2025 - Mini-Challenge 3 – ISSS608 Visual Analytics Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-ddd961a2510921635943dfbbd19534c4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>

<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>

<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608 Visual Analytics Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-menu" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Menu</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-menu">    
        <li>
    <a class="dropdown-item" href="../../project_proposal/proposal_DC.html">
 <span class="dropdown-text">Project Proposal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/TestQuarto_David.html">
 <span class="dropdown-text">Test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../TH3/Take-Home_Ex02_MC3.html">
 <span class="dropdown-text">Test2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/adrian_test_q4/testing_q4.html">
 <span class="dropdown-text">Adrian Task 4a &amp; 4b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/Rico_q3/Take Home Exercise 3.html">
 <span class="dropdown-text">Rico Task 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/David_Q2/Take-Home_Ex02_MC3 - Q2.html">
 <span class="dropdown-text">David Task 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#load-package" id="toc-load-package" class="nav-link" data-scroll-target="#load-package">1. Load Package</a></li>
  <li><a href="#clean-and-transform-data" id="toc-clean-and-transform-data" class="nav-link" data-scroll-target="#clean-and-transform-data">2. Clean and Transform Data</a>
  <ul class="collapse">
  <li><a href="#initial-eda" id="toc-initial-eda" class="nav-link" data-scroll-target="#initial-eda">2.1 Initial EDA</a></li>
  </ul></li>
  <li><a href="#data-cleaning-and-wrangling" id="toc-data-cleaning-and-wrangling" class="nav-link" data-scroll-target="#data-cleaning-and-wrangling">3. Data Cleaning and Wrangling</a></li>
  <li><a href="#building-tidygraph-object" id="toc-building-tidygraph-object" class="nav-link" data-scroll-target="#building-tidygraph-object">4. Building <code>tidygraph</code> object</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">5. EDA</a>
  <ul class="collapse">
  <li><a href="#relationship-between-entities-and-events" id="toc-relationship-between-entities-and-events" class="nav-link" data-scroll-target="#relationship-between-entities-and-events">5.1 Relationship between entities and events</a></li>
  <li><a href="#entity-distribution" id="toc-entity-distribution" class="nav-link" data-scroll-target="#entity-distribution">5.2 Entity distribution</a></li>
  <li><a href="#event-type-distribution" id="toc-event-type-distribution" class="nav-link" data-scroll-target="#event-type-distribution">5.3 Event type distribution</a></li>
  <li><a href="#list-of-communication-participants" id="toc-list-of-communication-participants" class="nav-link" data-scroll-target="#list-of-communication-participants">5.4 List of communication participants</a></li>
  <li><a href="#visualization-of-communication-participants-network" id="toc-visualization-of-communication-participants-network" class="nav-link" data-scroll-target="#visualization-of-communication-participants-network">5.4.1 Visualization of communication participants network</a></li>
  </ul></li>
  <li><a href="#task-1a-1b-daily-temporal-patterns-in-communications-over-the-two-weeks" id="toc-task-1a-1b-daily-temporal-patterns-in-communications-over-the-two-weeks" class="nav-link" data-scroll-target="#task-1a-1b-daily-temporal-patterns-in-communications-over-the-two-weeks">4 - Task 1a &amp; 1b: Daily Temporal Patterns in Communications over the Two Weeks 🎯</a>
  <ul class="collapse">
  <li><a href="#vast-challenge-task-question-1a-and-1b" id="toc-vast-challenge-task-question-1a-and-1b" class="nav-link" data-scroll-target="#vast-challenge-task-question-1a-and-1b">VAST Challenge Task &amp; Question 1a and 1b</a>
  <ul class="collapse">
  <li><a href="#step-1-extract-parse-communication-event-timestamps" id="toc-step-1-extract-parse-communication-event-timestamps" class="nav-link" data-scroll-target="#step-1-extract-parse-communication-event-timestamps">Step 1: Extract &amp; Parse Communication Event Timestamps</a></li>
  <li><a href="#step-2-visualize-the-communication-volume-for-analysis" id="toc-step-2-visualize-the-communication-volume-for-analysis" class="nav-link" data-scroll-target="#step-2-visualize-the-communication-volume-for-analysis">Step 2: Visualize the Communication Volume for Analysis</a></li>
  <li><a href="#step-3-plot-combined-hourly-and-half-hourly-communication-volume" id="toc-step-3-plot-combined-hourly-and-half-hourly-communication-volume" class="nav-link" data-scroll-target="#step-3-plot-combined-hourly-and-half-hourly-communication-volume">Step 3: Plot Combined Hourly and Half-hourly Communication Volume</a></li>
  </ul></li>
  <li><a href="#task-1c-focus-on-a-particular-entity---nadia-conti" id="toc-task-1c-focus-on-a-particular-entity---nadia-conti" class="nav-link" data-scroll-target="#task-1c-focus-on-a-particular-entity---nadia-conti">5 - Task 1c: Focus on a Particular Entity - “Nadia Conti”</a></li>
  <li><a href="#vast-challenge-task-question-1c" id="toc-vast-challenge-task-question-1c" class="nav-link" data-scroll-target="#vast-challenge-task-question-1c">VAST Challenge Task &amp; Question 1c</a>
  <ul class="collapse">
  <li><a href="#data-preparation-for-nadia-conti-influence-analysis" id="toc-data-preparation-for-nadia-conti-influence-analysis" class="nav-link" data-scroll-target="#data-preparation-for-nadia-conti-influence-analysis">5.1 <strong>-</strong> Data Preparation for “Nadia Conti” Influence Analysis</a></li>
  <li><a href="#build-the-global-network-and-compute-centrality" id="toc-build-the-global-network-and-compute-centrality" class="nav-link" data-scroll-target="#build-the-global-network-and-compute-centrality">5.2 <strong>-</strong> Build the Global Network and Compute Centrality</a></li>
  <li><a href="#extract-nadia-conti-ego-network-2-hop-neighbourhood" id="toc-extract-nadia-conti-ego-network-2-hop-neighbourhood" class="nav-link" data-scroll-target="#extract-nadia-conti-ego-network-2-hop-neighbourhood">5.3 <strong>-</strong> Extract “Nadia Conti” Ego Network (2-hop Neighbourhood)</a></li>
  <li><a href="#visualize-nadia-contis-ego-network-interactive" id="toc-visualize-nadia-contis-ego-network-interactive" class="nav-link" data-scroll-target="#visualize-nadia-contis-ego-network-interactive">5.4 <strong>-</strong> Visualize Nadia Conti’s Ego Network (Interactive)</a></li>
  </ul></li>
  <li><a href="#global-and-ego-network-structure" id="toc-global-and-ego-network-structure" class="nav-link" data-scroll-target="#global-and-ego-network-structure">Global and Ego-Network Structure</a>
  <ul class="collapse">
  <li><a href="#centrality-tables-for-nadias-ego-network" id="toc-centrality-tables-for-nadias-ego-network" class="nav-link" data-scroll-target="#centrality-tables-for-nadias-ego-network">5.5 <strong>-</strong> Centrality Tables for Nadia’s Ego Network</a></li>
  </ul></li>
  <li><a href="#centrality-metrics-and-direct-indirect-influences" id="toc-centrality-metrics-and-direct-indirect-influences" class="nav-link" data-scroll-target="#centrality-metrics-and-direct-indirect-influences">Centrality Metrics and Direct &amp; Indirect Influences</a></li>
  </ul></li>
  <li><a href="#task-4a-4b" id="toc-task-4a-4b" class="nav-link" data-scroll-target="#task-4a-4b">5. Task 4a &amp; 4b</a>
  <ul class="collapse">
  <li><a href="#extracting-nadias-data" id="toc-extracting-nadias-data" class="nav-link" data-scroll-target="#extracting-nadias-data">5.1 Extracting Nadia’s data</a></li>
  <li><a href="#message-count-of-nadia" id="toc-message-count-of-nadia" class="nav-link" data-scroll-target="#message-count-of-nadia">5.2 Message count of Nadia</a></li>
  <li><a href="#message-frequency-of-nadia" id="toc-message-frequency-of-nadia" class="nav-link" data-scroll-target="#message-frequency-of-nadia">5.3 Message frequency of Nadia</a>
  <ul class="collapse">
  <li><a href="#daily" id="toc-daily" class="nav-link" data-scroll-target="#daily">5.3.1 Daily</a></li>
  <li><a href="#hourly" id="toc-hourly" class="nav-link" data-scroll-target="#hourly">5.3.2 Hourly</a></li>
  </ul></li>
  <li><a href="#nadias-relationship-pattern" id="toc-nadias-relationship-pattern" class="nav-link" data-scroll-target="#nadias-relationship-pattern">5.4 Nadia’s relationship pattern</a></li>
  <li><a href="#nadias-most-frequent-commuter" id="toc-nadias-most-frequent-commuter" class="nav-link" data-scroll-target="#nadias-most-frequent-commuter">5.5 Nadia’s most frequent commuter</a></li>
  <li><a href="#temporal-suspicious-event-alignment" id="toc-temporal-suspicious-event-alignment" class="nav-link" data-scroll-target="#temporal-suspicious-event-alignment">5.6 Temporal + suspicious event alignment</a>
  <ul class="collapse">
  <li><a href="#showing-nadias-unusually-active-days" id="toc-showing-nadias-unusually-active-days" class="nav-link" data-scroll-target="#showing-nadias-unusually-active-days">5.6.1 Showing Nadia’s unusually active days</a></li>
  <li><a href="#suspicious-dates" id="toc-suspicious-dates" class="nav-link" data-scroll-target="#suspicious-dates">5.6.2 Suspicious dates</a></li>
  </ul></li>
  <li><a href="#drilling-down-on-spike-flagged-date" id="toc-drilling-down-on-spike-flagged-date" class="nav-link" data-scroll-target="#drilling-down-on-spike-flagged-date">5.7 Drilling down on spike + flagged date</a>
  <ul class="collapse">
  <li><a href="#extract-nadias-message-from-oct-8" id="toc-extract-nadias-message-from-oct-8" class="nav-link" data-scroll-target="#extract-nadias-message-from-oct-8">5.7.1 Extract Nadia’s message from Oct 8</a></li>
  <li><a href="#keywords-of-oct-8" id="toc-keywords-of-oct-8" class="nav-link" data-scroll-target="#keywords-of-oct-8">5.7.2 Keywords of Oct 8</a></li>
  <li><a href="#network-of-oct-8-communication" id="toc-network-of-oct-8-communication" class="nav-link" data-scroll-target="#network-of-oct-8-communication">5.7.3 Network of Oct 8 communication</a></li>
  </ul></li>
  <li><a href="#linking-oct-8-comms-to-permits-approvals-or-vessel-activity" id="toc-linking-oct-8-comms-to-permits-approvals-or-vessel-activity" class="nav-link" data-scroll-target="#linking-oct-8-comms-to-permits-approvals-or-vessel-activity">5.8 Linking Oct 8 comms to permits, approvals, or vessel activity</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">VAST Challenge 2025 - Mini-Challenge 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liu Chih Yuan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 28, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 15, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="background" class="level1">
<h1>Background</h1>
<p>This take home exercise is based on the <a href="https://vast-challenge.github.io/2025/MC3.html">VAST Challenge Mini Case 3</a></p>
<p>Over the past decade, the community of Oceanus has faced numerous transformations and challenges evolving from its fishing-centric origins. Following major crackdowns on illegal fishing activities, suspects have shifted investments into more regulated sectors such as the ocean tourism industry, resulting in growing tensions. This increased tourism has recently attracted the likes of international pop star Sailor Shift, who announced plans to film a music video on the island.</p>
<p>Clepper Jessen, a former analyst at FishEye and now a seasoned journalist for the Hacklee Herald, has been keenly observing these rising tensions. Recently, he turned his attention towards the temporary closure of Nemo Reef. By listening to radio communications and utilizing his investigative tools, Clepper uncovered a complex web of expedited approvals and secretive logistics. These efforts revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and local conservationist group The Green Guardians, pointing towards a story of corruption and manipulation.</p>
<p>Your task is to develop new and novel visualizations and visual analytics approaches to help Clepper get to the bottom of this story</p>
</section>
<section id="load-package" class="level1">
<h1>1. Load Package</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load Libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite, tidygraph, ggraph, lubridate, SmartEDA, igraph, dplyr, viridis, ggrepel, scales)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Load Graph and Schema</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_release/MC3_graph.json"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_release/MC3_schema.json"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 5
 $ directed  : logi TRUE
 $ multigraph: logi FALSE
 $ graph     :List of 4
  ..$ mode        : chr "static"
  ..$ edge_default: Named list()
  ..$ node_default: Named list()
  ..$ name        : chr "VAST_MC3_Knowledge_Graph"
 $ nodes     :'data.frame': 1159 obs. of  31 variables:
  ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  ..$ findings         : chr [1:1159] NA NA NA NA ...
  ..$ content          : chr [1:1159] NA NA NA NA ...
  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  ..$ results          : chr [1:1159] NA NA NA NA ...
  ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  ..$ destination      : chr [1:1159] NA NA NA NA ...
  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  ..$ outcome          : chr [1:1159] NA NA NA NA ...
  ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  ..$ thing_collected  :'data.frame':   1159 obs. of  2 variables:
  .. ..$ type: chr [1:1159] NA NA NA NA ...
  .. ..$ name: chr [1:1159] NA NA NA NA ...
  ..$ reference        : chr [1:1159] NA NA NA NA ...
  ..$ date             : chr [1:1159] NA NA NA NA ...
  ..$ time             : chr [1:1159] NA NA NA NA ...
  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  ..$ start_date       : chr [1:1159] NA NA NA NA ...
  ..$ end_date         : chr [1:1159] NA NA NA NA ...
  ..$ report_type      : chr [1:1159] NA NA NA NA ...
  ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  ..$ operational_role : chr [1:1159] NA NA NA NA ...
 $ edges     :'data.frame': 3226 obs. of  5 variables:
  ..$ id         : chr [1:3226] "2" "3" "5" "3013" ...
  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  ..$ source     : chr [1:3226] "Sam" "Sam" "Sam" "Sam" ...
  ..$ target     : chr [1:3226] "Relationship_Suspicious_217" "Event_Communication_370" "Event_Assessment_600" "Relationship_Colleagues_430" ...
  ..$ type       : chr [1:3226] NA "sent" NA NA ...</code></pre>
</div>
</div>
</section>
<section id="clean-and-transform-data" class="level1">
<h1>2. Clean and Transform Data</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>nodes)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="initial-eda" class="level2">
<h2 class="anchored" data-anchor-id="initial-eda">2.1 Initial EDA</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExpCatViz</span>(<span class="at">data=</span>mc3_nodes,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">"pink"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-7.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-8.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[9]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-9.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[10]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-10.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[11]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-11.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[12]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-12.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[13]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-13.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[14]]</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-3-14.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="data-cleaning-and-wrangling" class="level1">
<h1>3. Data Cleaning and Wrangling</h1>
<p>Code chunk below performs the following data cleaning tasks:</p>
<ul>
<li><p>convert values in id field into character data type,</p></li>
<li><p>exclude records with&nbsp;<code>id</code>&nbsp;value are na,</p></li>
<li><p>exclude records with similar id values,</p></li>
<li><p>exclude&nbsp;<code>thing_collected</code>&nbsp;field, and</p></li>
<li><p>save the cleaned tibble dataframe into a new tibble datatable called&nbsp;<code>mc3_nodes_cleaned</code>.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below will be used to:</p>
<ul>
<li><p>rename source and target fields to from_id and to_id respectively,</p></li>
<li><p>convert values in from_id and to_id fields to character data type,</p></li>
<li><p>exclude values in from_id and to_id which not found in the id field of mc3_nodes_cleaned,</p></li>
<li><p>exclude records whereby from_id and/or to_id values are missing, and</p></li>
<li><p>save the cleaned tibble dataframe and called it mc3_edges_cleaned.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id, </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, code chunk below will be used to create mapping of character id in&nbsp;<code>mc3_nodes_cleaned</code>&nbsp;to row index</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below will be used to join and convert&nbsp;<code>from_id</code>&nbsp;and&nbsp;<code>to_id</code>&nbsp;to integer indices. At the same time we also drop rows with unmatched nodes.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next the code chunk below is used to subset nodes to only those referenced by edges.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>           mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will then use the code chunk below to rebuild lookup from old index to new index.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    used_node_indices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below will be used to update edge indices to match new node table.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>         is_inferred, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-tidygraph-object" class="level1">
<h1>4. Building <code>tidygraph</code> object</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> mc3_nodes_final,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> mc3_edges_final,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mc3_graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'tbl_graph', 'igraph'  hidden list of 10
 $ : num 1159
 $ : logi TRUE
 $ : num [1:3226] 0 0 0 0 0 0 0 1 1 1 ...
 $ : num [1:3226] 1137 356 746 894 875 ...
 $ : NULL
 $ : NULL
 $ : NULL
 $ : NULL
 $ :List of 4
  ..$ : num [1:3] 1 0 1
  ..$ : Named list()
  ..$ :List of 31
  .. ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  .. ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  .. ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  .. ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ findings         : chr [1:1159] NA NA NA NA ...
  .. ..$ content          : chr [1:1159] NA NA NA NA ...
  .. ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ results          : chr [1:1159] NA NA NA NA ...
  .. ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ destination      : chr [1:1159] NA NA NA NA ...
  .. ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  .. ..$ outcome          : chr [1:1159] NA NA NA NA ...
  .. ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ reference        : chr [1:1159] NA NA NA NA ...
  .. ..$ date             : chr [1:1159] NA NA NA NA ...
  .. ..$ time             : chr [1:1159] NA NA NA NA ...
  .. ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ start_date       : chr [1:1159] NA NA NA NA ...
  .. ..$ end_date         : chr [1:1159] NA NA NA NA ...
  .. ..$ report_type      : chr [1:1159] NA NA NA NA ...
  .. ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  .. ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  .. ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  .. ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  .. ..$ operational_role : chr [1:1159] NA NA NA NA ...
  .. ..$ new_index        : int [1:1159] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ :List of 2
  .. ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  .. ..$ type       : chr [1:3226] NA "sent" NA NA ...
 $ :&lt;environment: 0x10f8d8d90&gt; 
 - attr(*, "active")= chr "nodes"</code></pre>
</div>
</div>
</section>
<section id="eda" class="level1">
<h1>5. EDA</h1>
<p>Setting seed for reproducibility</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="relationship-between-entities-and-events" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-entities-and-events">5.1 Relationship between entities and events</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc3_graph, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">type</span><span class="st">`</span>), </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> type), </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="entity-distribution" class="level2">
<h2 class="anchored" data-anchor-id="entity-distribution">5.2 Entity distribution</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define color mapping</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>subtype_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span> <span class="ot">=</span> <span class="st">"#25e158"</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"#ec4bff"</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(sub_type, n), <span class="at">y =</span> n, <span class="at">fill =</span> sub_type)) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Entity Sub-type Distribution"</span>, <span class="at">x =</span> <span class="st">"Sub-type"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="event-type-distribution" class="level2">
<h2 class="anchored" data-anchor-id="event-type-distribution">5.3 Event type distribution</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(sub_type, n), <span class="at">y =</span> n, <span class="at">fill =</span> sub_type)) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Event Sub-type Distribution"</span>, <span class="at">x =</span> <span class="st">"Sub-type"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="list-of-communication-participants" class="level2">
<h2 class="anchored" data-anchor-id="list-of-communication-participants">5.4 List of communication participants</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get all Communication Event IDs</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>comm_event_ids <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Extract 'sent' edges for communication events</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>comm_sent_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>, to_id <span class="sc">%in%</span> comm_event_ids) <span class="sc">%&gt;%</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">comm_id =</span> to_id, <span class="at">sender_id =</span> from_id)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Extract 'received' edges for same communication events</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>comm_received_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>, from_id <span class="sc">%in%</span> comm_event_ids) <span class="sc">%&gt;%</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">comm_id =</span> from_id, <span class="at">receiver_id =</span> to_id)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Join sent and received edges by communication ID</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>comm_pairs <span class="ot">&lt;-</span> comm_sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(comm_received_edges, <span class="at">by =</span> <span class="st">"comm_id"</span>)</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Add sender and receiver labels</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>participants_named <span class="ot">&lt;-</span> comm_pairs <span class="sc">%&gt;%</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">sender_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">receiver_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver_id"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step7: Interactive summary of top sender–receiver pairs</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>participants_named <span class="sc">%&gt;%</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_label, receiver_label, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Top Communication Pairs (Sender → Receiver)"</span>,</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">"Sender"</span>, <span class="st">"Receiver"</span>, <span class="st">"Message Count"</span>),</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-54575bd3d30a622838bc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-54575bd3d30a622838bc">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top Communication Pairs (Sender → Receiver)<\/caption>","data":[["Clepper Jensen","Miranda Jordan","The Intern","Green Guardians","Green Guardians","The Lookout","Neptune","Remora","Neptune","Oceanus City Council","The Intern","The Lookout","Himark Harbor","Neptune","Davis","Green Guardians","Liam Thorne","Mrs. Money","Oceanus City Council","Oceanus City Council","Osprey","Remora","Davis","Davis","EcoVigil","Himark Harbor","Mako","Mrs. Money","Oceanus City Council","Sentinel","Sentinel","The Lookout","Boss","Davis","Green Guardians","Horizon","Mako","Mako","Mako","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Rodriguez","Small Fry","The Lookout","The Middleman","V. Miesel Shipping","Boss","Defender","Elise","Green Guardians","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Horizon","Mako","Mrs. Money","Neptune","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Rodriguez","Rodriguez","Samantha Blake","Samantha Blake","Samantha Blake","The Lookout","The Middleman","The Middleman","Davis","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Green Guardians","Green Guardians","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Kelly","Knowles","Liam Thorne","Mako","Mako","Mako","Mako","Marlin","Marlin","Mrs. Money","Nadia Conti","Nadia Conti","Neptune","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Sentinel","Sentinel","Serenity","Serenity","Serenity","Serenity","Small Fry","The Accountant","The Middleman","V. Miesel Shipping","V. Miesel Shipping","Boss","Boss","Davis","Davis","Davis","Defender","Defender","EcoVigil","Elise","Elise","Glitters Team","Glitters Team","Glitters Team","Glitters Team","Green Guardians","Green Guardians","Green Guardians","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Horizon","Knowles","Knowles","Liam Thorne","Liam Thorne","Liam Thorne","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Marlin","Marlin","Marlin","Mrs. Money","Mrs. Money","Mrs. Money","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Neptune","Neptune","Neptune","Neptune","Northern Light","Northern Light","Northern Light","Northern Light","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Reef Guardian","Reef Guardian","Remora","Remora","Remora","Remora","Remora","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Sailor Shifts Team","Sailor Shifts Team","Sam","Seawatch","Seawatch","Seawatch","Sentinel","Sentinel","Sentinel","Sentinel","Small Fry","The Accountant","The Intern","The Lookout","The Middleman","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping"],["Miranda Jordan","Clepper Jensen","Mrs. Money","Green Guardians","Oceanus City Council","The Intern","Remora","Mako","V. Miesel Shipping","Liam Thorne","The Lookout","Sam","Oceanus City Council","Mako","Davis","Reef Guardian","Oceanus City Council","Boss","Green Guardians","Paackland Harbor","Mako","Neptune","Mako","Nadia Conti","Horizon","Neptune","Remora","The Intern","Himark Harbor","Horizon","Mako","Horizon","Mrs. Money","Remora","Horizon","Sentinel","Himark Harbor","Samantha Blake","Sentinel","Remora","Sentinel","EcoVigil","Oceanus City Council","Rodriguez","Remora","Sentinel","Boss","Neptune","The Middleman","Reef Guardian","Nadia Conti","EcoVigil","Mako","Remora","Seawatch","Serenity","EcoVigil","Neptune","The Middleman","Elise","Mako","Horizon","Marlin","Reef Guardian","Seawatch","Sentinel","Serenity","Paackland Harbor","Boss","Davis","Mako","Oceanus City Council","Sailor Shifts Team","Green Guardians","Mrs. Money","The Accountant","V. Miesel Shipping","EcoVigil","Liam Thorne","Reef Guardian","Sentinel","Mako","Seawatch","Oceanus City Council","Marlin","Green Guardians","Seawatch","Sam","Davis","Nadia Conti","Boss","Osprey","Paackland Harbor","Reef Guardian","Himark Harbor","Remora","Neptune","Liam Thorne","Neptune","Davis","Mako","Reef Guardian","Samantha Blake","Oceanus City Council","Reef Guardian","Defender","Mako","Paackland Harbor","Sailor Shifts Team","Green Guardians","Oceanus City Council","Himark Harbor","Mako","Neptune","Reef Guardian","Davis","Boss","Liam Thorne","Remora","V. Miesel Shipping","Mako","V. Miesel Shipping","Boss","Himark Harbor","Neptune","Mako","Seawatch","Oceanus City Council","Liam Thorne","V. Miesel Shipping","Boss","Northern Light","Remora","Samantha Blake","Northern Light","Paackland Harbor","Sentinel","EcoVigil","Knowles","Mako","Nadia Conti","Osprey","Northern Light","Mako","Oceanus City Council","Reef Guardian","Haacklee Harbor","Mako","Boss","EcoVigil","Elise","Davis","Elise","Marlin","Oceanus City Council","Sailor Shifts Team","Serenity","V. Miesel Shipping","Mako","Oceanus City Council","Reef Guardian","Mako","Remora","V. Miesel Shipping","Haacklee Harbor","Marlin","Oceanus City Council","V. Miesel Shipping","City Officials","Himark Harbor","Nadia Conti","Reef Guardian","Serenity","Green Guardians","Himark Harbor","Oceanus City Council","Sailor Shifts Team","EcoVigil","Marlin","Nadia Conti","Northern Light","Oceanus City Council","Sentinel","Liam Thorne","Neptune","Port Security","Davis","Himark Harbor","Nadia Conti","Rodriguez","V. Miesel Shipping","Mrs. Money","Nadia Conti","Remora","Sailor Shifts Team","Nadia Conti","Remora","Kelly","Green Guardians","Himark Harbor","Reef Guardian","Nadia Conti","Paackland Harbor","Reef Guardian","Seawatch","Mako","The Middleman","The Intern","Reef Guardian","Paackland Harbor","Boss","Davis","Elise","Mako","Mrs. Money","Nadia Conti","Rodriguez"],[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Sender<\/th>\n      <th>Receiver<\/th>\n      <th>Message Count<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":2},{"name":"sender_label","targets":0},{"name":"receiver_label","targets":1},{"name":"n","targets":2}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="visualization-of-communication-participants-network" class="level2">
<h2 class="anchored" data-anchor-id="visualization-of-communication-participants-network">5.4.1 Visualization of communication participants network</h2>
<p>This code creates an&nbsp;<strong>interactive communication network graph</strong>&nbsp;using&nbsp;<code>visNetwork</code>, where:</p>
<ul>
<li><p>Each&nbsp;<strong>node</strong>&nbsp;represents a person or entity,&nbsp;<strong>node size</strong>&nbsp;is based on total messages&nbsp;<strong>sent</strong>&nbsp;by that participant.</p></li>
<li><p>Each&nbsp;<strong>edge (arrow)</strong>&nbsp;represents a communication sent from one participant to another, the thicker the edge, the more message sent to that particular receiver.</p></li>
</ul>
<p><strong>Ver 1: Layout_in_circle</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Summarize communication edges</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>comm_edges_vis <span class="ot">&lt;-</span> participants_named <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_id, receiver_id, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> sender_id, <span class="at">to =</span> receiver_id, <span class="at">value =</span> n)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute messages sent per node</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>message_counts <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sent_count =</span> <span class="fu">sum</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Prepare nodes, merge with message count and add color/shape</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">unique</span>(<span class="fu">c</span>(comm_edges_vis<span class="sc">$</span>from, comm_edges_vis<span class="sc">$</span>to))) <span class="sc">%&gt;%</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(message_counts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"from"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sent_count =</span> <span class="fu">replace_na</span>(sent_count, <span class="dv">0</span>),</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">rescale</span>(sent_count, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)),</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(label, <span class="st">"&lt;br&gt;Sub-type: "</span>, sub_type,</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(sent_count), <span class="fu">paste0</span>(<span class="st">"&lt;br&gt;Sent: "</span>, sent_count, <span class="st">" messages"</span>), <span class="st">""</span>)),</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"#25e158"</span>,</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#ec4bff"</span>,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">case_when</span>(</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"dot"</span>,</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"square"</span>,</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"triangle"</span>,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"star"</span>,</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"diamond"</span>,</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"dot"</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(size))</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Format visNetwork edges</span></span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fu">rescale</span>(value, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Messages:"</span>, value)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Define legend items</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>legend_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Organization"</span>, <span class="st">"Vessel"</span>, <span class="st">"Group"</span>, <span class="st">"Location"</span>),</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#2ca5ff"</span>, <span class="st">"#f5ee15"</span>, <span class="st">"#FB7E81"</span>, <span class="st">"#25e158"</span>, <span class="st">"#ec4bff"</span>),</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">c</span>(<span class="st">"dot"</span>, <span class="st">"square"</span>, <span class="st">"triangle"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>),</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Render network with legend</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"1000px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> nodes_vis<span class="sc">$</span>size</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># color and shape are picked up from nodes_vis columns automatically</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(legend_nodes), <span class="cf">function</span>(i) {</span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> legend_nodes<span class="sc">$</span>label[i],</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">shape =</span> legend_nodes<span class="sc">$</span>shape[i],</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> legend_nodes<span class="sc">$</span>color[i]</span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.15</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_in_circle"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">enabled =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-a09acc36575f53e3d2b2" style="width:100%;height:1000px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a09acc36575f53e3d2b2">{"x":{"nodes":{"id":["Green Guardians","Oceanus City Council","Mako","Neptune","Reef Guardian","The Lookout","Himark Harbor","Davis","Remora","The Intern","Clepper Jensen","Mrs. Money","Miranda Jordan","Sentinel","Paackland Harbor","V. Miesel Shipping","Rodriguez","Horizon","EcoVigil","The Middleman","Liam Thorne","Samantha Blake","Boss","Nadia Conti","Serenity","Small Fry","Marlin","Haacklee Harbor","Osprey","Elise","Defender","Glitters Team","Northern Light","Knowles","The Accountant","Seawatch","Kelly","Sailor Shifts Team","Sam","City Officials","Port Security"],"label":["Green Guardians","Oceanus City Council","Mako","Neptune","Reef Guardian","The Lookout","Himark Harbor","Davis","Remora","The Intern","Clepper Jensen","Mrs. Money","Miranda Jordan","Sentinel","Paackland Harbor","V. Miesel Shipping","Rodriguez","Horizon","EcoVigil","The Middleman","Liam Thorne","Samantha Blake","Boss","Nadia Conti","Serenity","Small Fry","Marlin","Haacklee Harbor","Osprey","Elise","Defender","Glitters Team","Northern Light","Knowles","The Accountant","Seawatch","Kelly","Sailor Shifts Team","Sam","City Officials","Port Security"],"sub_type":["Organization","Organization","Vessel","Vessel","Vessel","Person","Location","Person","Vessel","Person","Person","Person","Person","Vessel","Location","Organization","Person","Vessel","Vessel","Person","Person","Person","Person","Person","Vessel","Person","Vessel","Location","Vessel","Person","Vessel","Organization","Vessel","Vessel","Person","Vessel","Person","Organization","Person","Group","Location"],"sent_count":[44,37,35,34,34,33,27,25,25,24,20,19,18,18,16,15,14,14,14,13,11,9,9,8,8,7,7,7,6,5,5,4,4,4,3,3,2,2,1,0,0],"size":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],"title":["Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages","Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages","Mako<br>Sub-type: Vessel<br>Sent: 35 messages","Neptune<br>Sub-type: Vessel<br>Sent: 34 messages","Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages","The Lookout<br>Sub-type: Person<br>Sent: 33 messages","Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages","Davis<br>Sub-type: Person<br>Sent: 25 messages","Remora<br>Sub-type: Vessel<br>Sent: 25 messages","The Intern<br>Sub-type: Person<br>Sent: 24 messages","Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages","Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages","Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages","Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages","Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages","V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages","Rodriguez<br>Sub-type: Person<br>Sent: 14 messages","Horizon<br>Sub-type: Vessel<br>Sent: 14 messages","EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages","The Middleman<br>Sub-type: Person<br>Sent: 13 messages","Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages","Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages","Boss<br>Sub-type: Person<br>Sent: 9 messages","Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages","Serenity<br>Sub-type: Vessel<br>Sent: 8 messages","Small Fry<br>Sub-type: Person<br>Sent: 7 messages","Marlin<br>Sub-type: Vessel<br>Sent: 7 messages","Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages","Osprey<br>Sub-type: Vessel<br>Sent: 6 messages","Elise<br>Sub-type: Person<br>Sent: 5 messages","Defender<br>Sub-type: Vessel<br>Sent: 5 messages","Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages","Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages","Knowles<br>Sub-type: Vessel<br>Sent: 4 messages","The Accountant<br>Sub-type: Person<br>Sent: 3 messages","Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages","Kelly<br>Sub-type: Person<br>Sent: 2 messages","Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages","Sam<br>Sub-type: Person<br>Sent: 1 messages","City Officials<br>Sub-type: Group<br>Sent: 0 messages","Port Security<br>Sub-type: Location<br>Sent: 0 messages"],"color":["#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#2ca5ff","#ec4bff","#2ca5ff","#FB7E81","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#FB7E81","#ec4bff","#f5ee15","#2ca5ff","#FB7E81","#FB7E81","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#FB7E81","#2ca5ff","#FB7E81","#ec4bff","#FB7E81","#2ca5ff","#FB7E81","#f5ee15","#FB7E81","#FB7E81","#2ca5ff","#FB7E81","#2ca5ff","#f5ee15","#2ca5ff","#25e158","#ec4bff"],"shape":["square","square","triangle","triangle","triangle","dot","diamond","dot","triangle","dot","dot","dot","dot","triangle","diamond","square","dot","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","triangle","diamond","triangle","dot","triangle","square","triangle","triangle","dot","triangle","dot","square","dot","star","diamond"],"x":[1,0.988263204734962,0.9533279194732136,0.8960129976915159,0.8176618525785562,0.7201109685684319,0.6056468557020445,0.4769524557696989,0.3370442564294944,0.189201587293274,0.03688975521995497,-0.1163211795401867,-0.2668400825319395,-0.4111389182430832,-0.5458354442665709,-0.6677724881958929,-0.7740919490703919,-0.8623017888393665,-0.9303344436218247,-0.9765952856514705,-1,-1,-0.9765952856514704,-0.9303344436218246,-0.8623017888393664,-0.7740919490703918,-0.6677724881958926,-0.5458354442665705,-0.4111389182430827,-0.2668400825319392,-0.1163211795401862,0.03688975521995497,0.1892015872932742,0.3370442564294949,0.4769524557696991,0.6056468557020447,0.7201109685684317,0.8176618525785562,0.8960129976915159,0.9533279194732136,0.988263204734962],"y":[0,0.1527613834167303,0.3019421694807169,0.4440456870063911,0.5757411499843077,0.6939417283821623,0.7958769008244742,0.8791573932654411,0.9418311815475191,0.9824292451932162,1,0.9941316023674809,0.964961602562342,0.9131737206566701,0.8399818207089611,0.7471014588194116,0.6367096719489687,0.5113939500181348,0.3740915873362889,0.2280208349126063,0.07660546738007068,-0.07660546738007079,-0.2280208349126069,-0.374091587336289,-0.511393950018135,-0.6367096719489687,-0.7471014588194118,-0.8399818207089615,-0.9131737206566706,-0.964961602562342,-0.994131602367481,-1,-0.9824292451932162,-0.941831181547519,-0.879157393265441,-0.7958769008244738,-0.6939417283821623,-0.5757411499843074,-0.4440456870063906,-0.3019421694807168,-0.1527613834167298]},"edges":{"from":["Clepper Jensen","Miranda Jordan","The Intern","Green Guardians","Green Guardians","The Lookout","Neptune","Remora","Neptune","Oceanus City Council","The Intern","The Lookout","Himark Harbor","Neptune","Davis","Green Guardians","Liam Thorne","Mrs. Money","Oceanus City Council","Oceanus City Council","Osprey","Remora","Davis","Davis","EcoVigil","Himark Harbor","Mako","Mrs. Money","Oceanus City Council","Sentinel","Sentinel","The Lookout","Boss","Davis","Green Guardians","Horizon","Mako","Mako","Mako","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Rodriguez","Small Fry","The Lookout","The Middleman","V. Miesel Shipping","Boss","Defender","Elise","Green Guardians","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Horizon","Mako","Mrs. Money","Neptune","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Rodriguez","Rodriguez","Samantha Blake","Samantha Blake","Samantha Blake","The Lookout","The Middleman","The Middleman","Davis","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Green Guardians","Green Guardians","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Kelly","Knowles","Liam Thorne","Mako","Mako","Mako","Mako","Marlin","Marlin","Mrs. Money","Nadia Conti","Nadia Conti","Neptune","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Sentinel","Sentinel","Serenity","Serenity","Serenity","Serenity","Small Fry","The Accountant","The Middleman","V. Miesel Shipping","V. Miesel Shipping","Boss","Boss","Davis","Davis","Davis","Defender","Defender","EcoVigil","Elise","Elise","Glitters Team","Glitters Team","Glitters Team","Glitters Team","Green Guardians","Green Guardians","Green Guardians","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Horizon","Knowles","Knowles","Liam Thorne","Liam Thorne","Liam Thorne","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Marlin","Marlin","Marlin","Mrs. Money","Mrs. Money","Mrs. Money","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Neptune","Neptune","Neptune","Neptune","Northern Light","Northern Light","Northern Light","Northern Light","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Reef Guardian","Reef Guardian","Remora","Remora","Remora","Remora","Remora","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Sailor Shifts Team","Sailor Shifts Team","Sam","Seawatch","Seawatch","Seawatch","Sentinel","Sentinel","Sentinel","Sentinel","Small Fry","The Accountant","The Intern","The Lookout","The Middleman","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping"],"to":["Miranda Jordan","Clepper Jensen","Mrs. Money","Green Guardians","Oceanus City Council","The Intern","Remora","Mako","V. Miesel Shipping","Liam Thorne","The Lookout","Sam","Oceanus City Council","Mako","Davis","Reef Guardian","Oceanus City Council","Boss","Green Guardians","Paackland Harbor","Mako","Neptune","Mako","Nadia Conti","Horizon","Neptune","Remora","The Intern","Himark Harbor","Horizon","Mako","Horizon","Mrs. Money","Remora","Horizon","Sentinel","Himark Harbor","Samantha Blake","Sentinel","Remora","Sentinel","EcoVigil","Oceanus City Council","Rodriguez","Remora","Sentinel","Boss","Neptune","The Middleman","Reef Guardian","Nadia Conti","EcoVigil","Mako","Remora","Seawatch","Serenity","EcoVigil","Neptune","The Middleman","Elise","Mako","Horizon","Marlin","Reef Guardian","Seawatch","Sentinel","Serenity","Paackland Harbor","Boss","Davis","Mako","Oceanus City Council","Sailor Shifts Team","Green Guardians","Mrs. Money","The Accountant","V. Miesel Shipping","EcoVigil","Liam Thorne","Reef Guardian","Sentinel","Mako","Seawatch","Oceanus City Council","Marlin","Green Guardians","Seawatch","Sam","Davis","Nadia Conti","Boss","Osprey","Paackland Harbor","Reef Guardian","Himark Harbor","Remora","Neptune","Liam Thorne","Neptune","Davis","Mako","Reef Guardian","Samantha Blake","Oceanus City Council","Reef Guardian","Defender","Mako","Paackland Harbor","Sailor Shifts Team","Green Guardians","Oceanus City Council","Himark Harbor","Mako","Neptune","Reef Guardian","Davis","Boss","Liam Thorne","Remora","V. Miesel Shipping","Mako","V. Miesel Shipping","Boss","Himark Harbor","Neptune","Mako","Seawatch","Oceanus City Council","Liam Thorne","V. Miesel Shipping","Boss","Northern Light","Remora","Samantha Blake","Northern Light","Paackland Harbor","Sentinel","EcoVigil","Knowles","Mako","Nadia Conti","Osprey","Northern Light","Mako","Oceanus City Council","Reef Guardian","Haacklee Harbor","Mako","Boss","EcoVigil","Elise","Davis","Elise","Marlin","Oceanus City Council","Sailor Shifts Team","Serenity","V. Miesel Shipping","Mako","Oceanus City Council","Reef Guardian","Mako","Remora","V. Miesel Shipping","Haacklee Harbor","Marlin","Oceanus City Council","V. Miesel Shipping","City Officials","Himark Harbor","Nadia Conti","Reef Guardian","Serenity","Green Guardians","Himark Harbor","Oceanus City Council","Sailor Shifts Team","EcoVigil","Marlin","Nadia Conti","Northern Light","Oceanus City Council","Sentinel","Liam Thorne","Neptune","Port Security","Davis","Himark Harbor","Nadia Conti","Rodriguez","V. Miesel Shipping","Mrs. Money","Nadia Conti","Remora","Sailor Shifts Team","Nadia Conti","Remora","Kelly","Green Guardians","Himark Harbor","Reef Guardian","Nadia Conti","Paackland Harbor","Reef Guardian","Seawatch","Mako","The Middleman","The Intern","Reef Guardian","Paackland Harbor","Boss","Davis","Elise","Mako","Mrs. Money","Nadia Conti","Rodriguez"],"value":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"width":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"title":["Messages: 20","Messages: 18","Messages: 15","Messages: 12","Messages: 12","Messages: 12","Messages: 9","Messages: 9","Messages: 8","Messages: 8","Messages: 8","Messages: 8","Messages: 7","Messages: 7","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],"physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"enabled":false},"layout":{"randomSeed":1818}},"groups":null,"width":"100%","height":"1000px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.15,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":[{"label":"Person","shape":"dot","color":"#2ca5ff"},{"label":"Organization","shape":"square","color":"#f5ee15"},{"label":"Vessel","shape":"triangle","color":"#FB7E81"},{"label":"Group","shape":"star","color":"#25e158"},{"label":"Location","shape":"diamond","color":"#ec4bff"}],"nodesToDataframe":false},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Ver 2: Layout_on_sphere</strong></p>
<p>From this plot, it reveals that some pairs (e.g., Miranda Jordan and Clepper Jensen) mainly communicate with each other, suggesting isolated or private channels outside the broader network.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Summarize communication edges</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>comm_edges_vis <span class="ot">&lt;-</span> participants_named <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_id, receiver_id, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> sender_id, <span class="at">to =</span> receiver_id, <span class="at">value =</span> n)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute messages sent per person (by sender)</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>message_counts <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from) <span class="sc">%&gt;%</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sent_count =</span> <span class="fu">sum</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Prepare nodes with label, subtype, color, shape, and scaled size</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">unique</span>(<span class="fu">c</span>(comm_edges_vis<span class="sc">$</span>from, comm_edges_vis<span class="sc">$</span>to))) <span class="sc">%&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(message_counts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"from"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">if_else</span>(</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rescale</span>(sent_count, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>      <span class="dv">15</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(label, <span class="st">"&lt;br&gt;Sub-type: "</span>, sub_type,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(sent_count), <span class="fu">paste0</span>(<span class="st">"&lt;br&gt;Sent: "</span>, sent_count, <span class="st">" messages"</span>), <span class="st">""</span>)),</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"#25e158"</span>,</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#ec4bff"</span>,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">case_when</span>(</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"dot"</span>,</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"square"</span>,</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"triangle"</span>,</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"star"</span>,</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"diamond"</span>,</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"dot"</span></span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Format edges</span></span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fu">rescale</span>(value, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)),</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Messages:"</span>, value)</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Legend mapping</span></span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>legend_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Organization"</span>, <span class="st">"Vessel"</span>, <span class="st">"Group"</span>, <span class="st">"Location"</span>),</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#2ca5ff"</span>, <span class="st">"#f5ee15"</span>, <span class="st">"#FB7E81"</span>, <span class="st">"#25e158"</span>, <span class="st">"#ec4bff"</span>),</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">c</span>(<span class="st">"dot"</span>, <span class="st">"square"</span>, <span class="st">"triangle"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>),</span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Render the network with layout_on_sphere and legend</span></span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"900px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> nodes_vis<span class="sc">$</span>size</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># color and shape columns are automatically used</span></span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(legend_nodes), <span class="cf">function</span>(i) {</span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> legend_nodes<span class="sc">$</span>label[i],</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">shape =</span> legend_nodes<span class="sc">$</span>shape[i],</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> legend_nodes<span class="sc">$</span>color[i]</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span>,</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.15</span></span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_on_sphere"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">enabled =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-175c971dccb8e6d83228" style="width:100%;height:900px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-175c971dccb8e6d83228">{"x":{"nodes":{"id":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Glitters Team","Oceanus City Council","Green Guardians","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","City Officials","Paackland Harbor","Haacklee Harbor","Himark Harbor","Port Security"],"label":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Glitters Team","Oceanus City Council","Green Guardians","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","City Officials","Paackland Harbor","Haacklee Harbor","Himark Harbor","Port Security"],"sub_type":["Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Organization","Organization","Organization","Organization","Organization","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Group","Location","Location","Location","Location"],"sent_count":[1,2,8,5,11,9,25,14,20,18,24,33,3,19,13,9,7,4,37,44,15,2,34,7,8,35,34,14,3,14,18,6,5,4,25,4,null,16,7,27,null],"size":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],"title":["Sam<br>Sub-type: Person<br>Sent: 1 messages","Kelly<br>Sub-type: Person<br>Sent: 2 messages","Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages","Elise<br>Sub-type: Person<br>Sent: 5 messages","Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages","Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages","Davis<br>Sub-type: Person<br>Sent: 25 messages","Rodriguez<br>Sub-type: Person<br>Sent: 14 messages","Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages","Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages","The Intern<br>Sub-type: Person<br>Sent: 24 messages","The Lookout<br>Sub-type: Person<br>Sent: 33 messages","The Accountant<br>Sub-type: Person<br>Sent: 3 messages","Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages","The Middleman<br>Sub-type: Person<br>Sent: 13 messages","Boss<br>Sub-type: Person<br>Sent: 9 messages","Small Fry<br>Sub-type: Person<br>Sent: 7 messages","Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages","Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages","Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages","V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages","Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages","Neptune<br>Sub-type: Vessel<br>Sent: 34 messages","Marlin<br>Sub-type: Vessel<br>Sent: 7 messages","Serenity<br>Sub-type: Vessel<br>Sent: 8 messages","Mako<br>Sub-type: Vessel<br>Sent: 35 messages","Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages","Horizon<br>Sub-type: Vessel<br>Sent: 14 messages","Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages","EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages","Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages","Osprey<br>Sub-type: Vessel<br>Sent: 6 messages","Defender<br>Sub-type: Vessel<br>Sent: 5 messages","Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages","Remora<br>Sub-type: Vessel<br>Sent: 25 messages","Knowles<br>Sub-type: Vessel<br>Sent: 4 messages","City Officials<br>Sub-type: Group","Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages","Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages","Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages","Port Security<br>Sub-type: Location"],"color":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#25e158","#ec4bff","#ec4bff","#ec4bff","#ec4bff"],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","star","diamond","diamond","diamond","diamond"],"x":[0.006440927175621391,-0.06664830184967618,-0.4409630997074512,-0.2787167727474305,0.2365064772775034,0.6476746072078645,0.667719144831592,0.2976986554858154,-0.2526935027451958,-0.7129586264042105,-0.8813060495281457,-0.6944798975090127,-0.2316698995019175,0.3317086862019816,0.794708147038439,1,0.8814846985123932,0.4796721568472757,-0.0759052165537506,-0.6094787616592352,-0.9536054047189444,-1,-0.732695736478211,-0.2342851279815245,0.3371692344569699,0.7953258761289943,0.9847209772943193,0.83512595572909,0.393361353839724,-0.1815498231890834,-0.6654615755328198,-0.851148143779292,-0.642764389284291,-0.1259267219792909,0.4310925572677355,0.6825812698064202,0.4211383409771228,-0.1688497446265791,-0.4410178911458582,0.09467015775055376,0.006440927175621391],"y":[-0.01598891125852964,0.2954839704434384,0.006862204298155872,-0.4747234670075287,-0.5862691145784071,-0.2409750687836689,0.3014469779380633,0.7063569373476082,0.7617907495947651,0.4507146812594094,-0.08001565513005549,-0.6066112860066712,-0.924405409326406,-0.9192001757418308,-0.5970787360481746,-0.07163254829246113,0.4807357855851913,0.8803103056319443,1,0.8025079340453891,0.3497092889073024,-0.2171529858949235,-0.7203891044614957,-1,-0.9640461487628595,-0.620602608247057,-0.08055603018195756,0.4725053352879633,0.8400550256881181,0.8794642891354818,0.5658741880942779,0.02003717536535121,-0.5188955272797955,-0.7832295634598994,-0.6126999832464018,-0.08620961161376928,0.4389235777464779,0.4945974391681667,-0.03774803939227411,-0.3235418088732364,-0.01598891125852964]},"edges":{"from":["Clepper Jensen","Miranda Jordan","The Intern","Green Guardians","Green Guardians","The Lookout","Neptune","Remora","Neptune","Oceanus City Council","The Intern","The Lookout","Himark Harbor","Neptune","Davis","Green Guardians","Liam Thorne","Mrs. Money","Oceanus City Council","Oceanus City Council","Osprey","Remora","Davis","Davis","EcoVigil","Himark Harbor","Mako","Mrs. Money","Oceanus City Council","Sentinel","Sentinel","The Lookout","Boss","Davis","Green Guardians","Horizon","Mako","Mako","Mako","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Rodriguez","Small Fry","The Lookout","The Middleman","V. Miesel Shipping","Boss","Defender","Elise","Green Guardians","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Horizon","Mako","Mrs. Money","Neptune","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Rodriguez","Rodriguez","Samantha Blake","Samantha Blake","Samantha Blake","The Lookout","The Middleman","The Middleman","Davis","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Green Guardians","Green Guardians","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Kelly","Knowles","Liam Thorne","Mako","Mako","Mako","Mako","Marlin","Marlin","Mrs. Money","Nadia Conti","Nadia Conti","Neptune","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Sentinel","Sentinel","Serenity","Serenity","Serenity","Serenity","Small Fry","The Accountant","The Middleman","V. Miesel Shipping","V. Miesel Shipping","Boss","Boss","Davis","Davis","Davis","Defender","Defender","EcoVigil","Elise","Elise","Glitters Team","Glitters Team","Glitters Team","Glitters Team","Green Guardians","Green Guardians","Green Guardians","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Horizon","Knowles","Knowles","Liam Thorne","Liam Thorne","Liam Thorne","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Marlin","Marlin","Marlin","Mrs. Money","Mrs. Money","Mrs. Money","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Neptune","Neptune","Neptune","Neptune","Northern Light","Northern Light","Northern Light","Northern Light","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Reef Guardian","Reef Guardian","Remora","Remora","Remora","Remora","Remora","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Sailor Shifts Team","Sailor Shifts Team","Sam","Seawatch","Seawatch","Seawatch","Sentinel","Sentinel","Sentinel","Sentinel","Small Fry","The Accountant","The Intern","The Lookout","The Middleman","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping"],"to":["Miranda Jordan","Clepper Jensen","Mrs. Money","Green Guardians","Oceanus City Council","The Intern","Remora","Mako","V. Miesel Shipping","Liam Thorne","The Lookout","Sam","Oceanus City Council","Mako","Davis","Reef Guardian","Oceanus City Council","Boss","Green Guardians","Paackland Harbor","Mako","Neptune","Mako","Nadia Conti","Horizon","Neptune","Remora","The Intern","Himark Harbor","Horizon","Mako","Horizon","Mrs. Money","Remora","Horizon","Sentinel","Himark Harbor","Samantha Blake","Sentinel","Remora","Sentinel","EcoVigil","Oceanus City Council","Rodriguez","Remora","Sentinel","Boss","Neptune","The Middleman","Reef Guardian","Nadia Conti","EcoVigil","Mako","Remora","Seawatch","Serenity","EcoVigil","Neptune","The Middleman","Elise","Mako","Horizon","Marlin","Reef Guardian","Seawatch","Sentinel","Serenity","Paackland Harbor","Boss","Davis","Mako","Oceanus City Council","Sailor Shifts Team","Green Guardians","Mrs. Money","The Accountant","V. Miesel Shipping","EcoVigil","Liam Thorne","Reef Guardian","Sentinel","Mako","Seawatch","Oceanus City Council","Marlin","Green Guardians","Seawatch","Sam","Davis","Nadia Conti","Boss","Osprey","Paackland Harbor","Reef Guardian","Himark Harbor","Remora","Neptune","Liam Thorne","Neptune","Davis","Mako","Reef Guardian","Samantha Blake","Oceanus City Council","Reef Guardian","Defender","Mako","Paackland Harbor","Sailor Shifts Team","Green Guardians","Oceanus City Council","Himark Harbor","Mako","Neptune","Reef Guardian","Davis","Boss","Liam Thorne","Remora","V. Miesel Shipping","Mako","V. Miesel Shipping","Boss","Himark Harbor","Neptune","Mako","Seawatch","Oceanus City Council","Liam Thorne","V. Miesel Shipping","Boss","Northern Light","Remora","Samantha Blake","Northern Light","Paackland Harbor","Sentinel","EcoVigil","Knowles","Mako","Nadia Conti","Osprey","Northern Light","Mako","Oceanus City Council","Reef Guardian","Haacklee Harbor","Mako","Boss","EcoVigil","Elise","Davis","Elise","Marlin","Oceanus City Council","Sailor Shifts Team","Serenity","V. Miesel Shipping","Mako","Oceanus City Council","Reef Guardian","Mako","Remora","V. Miesel Shipping","Haacklee Harbor","Marlin","Oceanus City Council","V. Miesel Shipping","City Officials","Himark Harbor","Nadia Conti","Reef Guardian","Serenity","Green Guardians","Himark Harbor","Oceanus City Council","Sailor Shifts Team","EcoVigil","Marlin","Nadia Conti","Northern Light","Oceanus City Council","Sentinel","Liam Thorne","Neptune","Port Security","Davis","Himark Harbor","Nadia Conti","Rodriguez","V. Miesel Shipping","Mrs. Money","Nadia Conti","Remora","Sailor Shifts Team","Nadia Conti","Remora","Kelly","Green Guardians","Himark Harbor","Reef Guardian","Nadia Conti","Paackland Harbor","Reef Guardian","Seawatch","Mako","The Middleman","The Intern","Reef Guardian","Paackland Harbor","Boss","Davis","Elise","Mako","Mrs. Money","Nadia Conti","Rodriguez"],"value":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"width":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"title":["Messages: 20","Messages: 18","Messages: 15","Messages: 12","Messages: 12","Messages: 12","Messages: 9","Messages: 9","Messages: 8","Messages: 8","Messages: 8","Messages: 8","Messages: 7","Messages: 7","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],"physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"enabled":false},"layout":{"randomSeed":1818}},"groups":null,"width":"100%","height":"900px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.15,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":[{"label":"Person","shape":"dot","color":"#2ca5ff"},{"label":"Organization","shape":"square","color":"#f5ee15"},{"label":"Vessel","shape":"triangle","color":"#FB7E81"},{"label":"Group","shape":"star","color":"#25e158"},{"label":"Location","shape":"diamond","color":"#ec4bff"}],"nodesToDataframe":false},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="task-1a-1b-daily-temporal-patterns-in-communications-over-the-two-weeks" class="level1">
<h1>4 - Task 1a &amp; 1b: Daily Temporal Patterns in Communications over the Two Weeks 🎯</h1>
<section id="vast-challenge-task-question-1a-and-1b" class="level2">
<h2 class="anchored" data-anchor-id="vast-challenge-task-question-1a-and-1b">VAST Challenge Task &amp; Question 1a and 1b</h2>
<p>Clepper found that messages frequently came in at around the same time each day.</p>
<ul>
<li>Develop a graph-based visual analytics approach to identify any daily temporal patterns in communications.</li>
<li>How do these patterns shift over the two weeks of observations?</li>
</ul>
<p><strong>Objective</strong></p>
<ol type="1">
<li>Identify <strong>when</strong> communications happen most often during each day.</li>
<li>Detect <strong>shifts in these patterns</strong> over the 2-week period.</li>
<li>Later: Focus on a <strong>specific entity</strong> (e.g., Nadia Conti) and explore <strong>who influences them</strong>.</li>
</ol>
<section id="step-1-extract-parse-communication-event-timestamps" class="level3">
<h3 class="anchored" data-anchor-id="step-1-extract-parse-communication-event-timestamps">Step 1: Extract &amp; Parse Communication Event Timestamps</h3>
<p>Extract the Communication Timestamps from <code>mc3_nodes_final</code> and filter for communication events.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Communication events</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>comm_events <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(timestamp)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Parse the Communication Timestamp into the format “dd/mm/yyy (ddd)” for ease of reference.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Communication events with parsed date and time</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>comm_events <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(timestamp),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_label =</span> <span class="fu">format</span>(timestamp, <span class="st">"%d/%m/%Y (%a)"</span>)  <span class="co"># e.g., "19/03/2040 (Tue)"</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="step-2-visualize-the-communication-volume-for-analysis" class="level3">
<h3 class="anchored" data-anchor-id="step-2-visualize-the-communication-volume-for-analysis">Step 2: Visualize the Communication Volume for Analysis</h3>
<section id="bar-plot-of-daily-communication-volume-over-the-2-weeks-period" class="level4">
<h4 class="anchored" data-anchor-id="bar-plot-of-daily-communication-volume-over-the-2-weeks-period"><strong>4.1 - Bar Plot of daily communication volume over the 2 weeks period:</strong></h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Prepare daily message volume data</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>daily_message_volume <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_label =</span> <span class="fu">format</span>(timestamp, <span class="st">"%d/%m/%Y (%a)"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date, date_label) <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">message_count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute average and total message count</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>avg_msg_count <span class="ot">&lt;-</span> <span class="fu">mean</span>(daily_message_volume<span class="sc">$</span>message_count)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>total_msg_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(daily_message_volume<span class="sc">$</span>message_count)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Plot bar chart with average + total labels</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_message_volume, <span class="fu">aes</span>(<span class="at">x =</span> date_label, <span class="at">y =</span> message_count)) <span class="sc">+</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> message_count),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.3</span>,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey40"</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> avg_msg_count, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"label"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> avg_msg_count <span class="sc">+</span> <span class="dv">2</span>,</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Average ="</span>, <span class="fu">round</span>(avg_msg_count, <span class="dv">1</span>)),</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"grey90"</span>,</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.size =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="dv">3</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"label"</span>, <span class="at">x =</span> <span class="fu">nrow</span>(daily_message_volume), <span class="at">y =</span> <span class="fu">max</span>(daily_message_volume<span class="sc">$</span>message_count) <span class="sc">+</span> <span class="dv">5</span>,</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total ="</span>, total_msg_count),</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"lightgrey"</span>,</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">label.size =</span> <span class="fl">0.3</span>, <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">vjust =</span> <span class="dv">1</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily Radio Communication Volume"</span>,</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Message Count"</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interactive-table-of-daily-communication-volume-variationmessage-count" class="level4">
<h4 class="anchored" data-anchor-id="interactive-table-of-daily-communication-volume-variationmessage-count"><strong>4.2 - Interactive Table of daily communication volume variation(message count)</strong></h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Daily message volume with comparisons</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>daily_message_volume <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp),</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_label =</span> <span class="fu">format</span>(timestamp, <span class="st">"%d/%m/%Y (%a)"</span>)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date, date_label) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">message_count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">change_from_prev =</span> message_count <span class="sc">-</span> <span class="fu">lag</span>(message_count),</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_change_from_prev =</span> <span class="fu">round</span>((message_count <span class="sc">-</span> <span class="fu">lag</span>(message_count)) <span class="sc">/</span> <span class="fu">lag</span>(message_count) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>  daily_message_volume <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>date),  <span class="co"># remove raw date if not needed</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Daily Message Volume with Day-over-Day Change"</span>,</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">14</span>, <span class="at">order =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">0</span>, <span class="st">'asc'</span>))),</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-08444c9e699161510b2c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-08444c9e699161510b2c">{"x":{"filter":"none","vertical":false,"caption":"<caption>Daily Message Volume with Day-over-Day Change<\/caption>","data":[["01/10/2040 (Mon)","02/10/2040 (Tue)","03/10/2040 (Wed)","04/10/2040 (Thu)","05/10/2040 (Fri)","06/10/2040 (Sat)","07/10/2040 (Sun)","08/10/2040 (Mon)","09/10/2040 (Tue)","10/10/2040 (Wed)","11/10/2040 (Thu)","12/10/2040 (Fri)","13/10/2040 (Sat)","14/10/2040 (Sun)"],[44,46,46,40,45,38,42,43,35,34,49,43,42,37],[null,2,0,-6,5,-7,4,1,-8,-1,15,-6,-1,-5],[null,4.55,0,-13.04,12.5,-15.56,10.53,2.38,-18.6,-2.86,44.12,-12.24,-2.33,-11.9]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>date_label<\/th>\n      <th>message_count<\/th>\n      <th>change_from_prev<\/th>\n      <th>pct_change_from_prev<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":14,"order":[[0,"asc"]],"columnDefs":[{"className":"dt-right","targets":[1,2,3]},{"name":"date_label","targets":0},{"name":"message_count","targets":1},{"name":"change_from_prev","targets":2},{"name":"pct_change_from_prev","targets":3}],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,14,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="a---heat-map-of-hourly-message-volume-for-each-day-over-the-2-weeks-period" class="level4">
<h4 class="anchored" data-anchor-id="a---heat-map-of-hourly-message-volume-for-each-day-over-the-2-weeks-period"><strong>4.3a - Heat Map of hourly message volume for each day over the 2 weeks period:</strong></h4>
<p>This heat map is interactive and you may choose to hover on the tile to display the <strong>date, time, and message count</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Reconstruct sender–receiver–timestamp structure</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>comm_events_raw <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> id, timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp),</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">hour =</span> <span class="fu">hour</span>(timestamp),</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">date_label =</span> <span class="fu">format</span>(timestamp, <span class="st">"%d/%m/%Y (%a)"</span>))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Get sender (sent) and receiver (received) links</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>comm_edges_sent <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> to_id, <span class="at">sender_id =</span> from_id)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>comm_edges_recv <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> from_id, <span class="at">receiver_id =</span> to_id)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Join all together into sender–receiver–timestamp</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>comm_links <span class="ot">&lt;-</span> comm_events_raw <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(comm_edges_sent, <span class="at">by =</span> <span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(comm_edges_recv, <span class="at">by =</span> <span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">sender_id =</span> id, <span class="at">sender_label =</span> label), <span class="at">by =</span> <span class="st">"sender_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">receiver_id =</span> id, <span class="at">receiver_label =</span> label), <span class="at">by =</span> <span class="st">"receiver_id"</span>)</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Aggregate total messages per hour/day</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>comm_heatmap <span class="ot">&lt;-</span> comm_links <span class="sc">%&gt;%</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_label, hour) <span class="sc">%&gt;%</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_sender =</span> <span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(sender_label), <span class="at">decreasing =</span> <span class="cn">TRUE</span>))[<span class="dv">1</span>],</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_count =</span> <span class="fu">max</span>(<span class="fu">table</span>(sender_label)),</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_receiver =</span> <span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(receiver_label), <span class="at">decreasing =</span> <span class="cn">TRUE</span>))[<span class="dv">1</span>],</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">receiver_count =</span> <span class="fu">max</span>(<span class="fu">table</span>(receiver_label)),</span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip =</span> <span class="fu">paste0</span>(</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">"📅 Date: "</span>, date_label,</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;⏰ Hour: "</span>, <span class="fu">sprintf</span>(<span class="st">"%02d:00"</span>, hour),</span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;📨 Messages: "</span>, count,</span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;🔴 Top Sender: "</span>, top_sender, <span class="st">" ("</span>, sender_count, <span class="st">")"</span>,</span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;🟢 Top Receiver: "</span>, top_receiver, <span class="st">" ("</span>, receiver_count, <span class="st">")"</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Static ggplot</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comm_heatmap, <span class="fu">aes</span>(</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> hour,</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">fct_rev</span>(<span class="fu">factor</span>(date_label)),</span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> count,</span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> tooltip</span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"inferno"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">name =</span> <span class="st">"Message Count"</span>) <span class="sc">+</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">23</span>,</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:00"</span>, x)</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Hourly Heatmap of Radio Communications by Day"</span>,</span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Hour of Day"</span>,</span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Make interactive</span></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7f489343c35a3911d555" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7f489343c35a3911d555">{"x":{"data":[{"x":[8,9,10,11,12,13,14],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14],"z":[[0.39130434782608697,0.2608695652173913,0.043478260869565216,0.17391304347826086,0.39130434782608697,0.086956521739130432,null],[0.34782608695652173,0.17391304347826086,null,0.21739130434782608,0.78260869565217395,0.086956521739130432,null],[0.13043478260869565,0.69565217391304346,0.21739130434782608,0.43478260869565216,0.17391304347826086,null,null],[0.43478260869565216,0.69565217391304346,0.86956521739130432,null,null,null,null],[0.086956521739130432,0.43478260869565216,0.21739130434782608,0.21739130434782608,0.21739130434782608,null,0.043478260869565216],[0.21739130434782608,0.13043478260869565,0.56521739130434778,0.17391304347826086,0.17391304347826086,0,null],[0.47826086956521741,null,0.52173913043478259,0.73913043478260865,null,null,null],[0.13043478260869565,0.34782608695652173,0.56521739130434778,0.56521739130434778,0,null,null],[null,0.34782608695652173,0.21739130434782608,0.2608695652173913,0.30434782608695654,0.30434782608695654,null],[0.2608695652173913,0.43478260869565216,1,null,0.086956521739130432,null,null],[0.39130434782608697,0.13043478260869565,0.34782608695652173,0.21739130434782608,0.043478260869565216,0.34782608695652173,null],[0.60869565217391308,0.43478260869565216,0.78260869565217395,0,null,null,null],[0.43478260869565216,0.043478260869565216,0.17391304347826086,0.17391304347826086,0.73913043478260865,0.17391304347826086,null],[0.60869565217391308,0.21739130434782608,0.30434782608695654,0.2608695652173913,0.30434782608695654,null,null]],"text":[["📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 08:00<br>📨 Messages: 10<br>🔴 Top Sender: Reef Guardian (2)<br>🟢 Top Receiver: The Intern (2)","📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 09:00<br>📨 Messages: 7<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Boss (1)","📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 10:00<br>📨 Messages: 2<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Reef Guardian (1)","📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: EcoVigil (3)<br>🟢 Top Receiver: Sentinel (2)","📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 12:00<br>📨 Messages: 10<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (2)","📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Knowles (2)<br>🟢 Top Receiver: Davis (2)",null],["📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 08:00<br>📨 Messages: 9<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Sam (2)","📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 09:00<br>📨 Messages: 5<br>🔴 Top Sender: Horizon (2)<br>🟢 Top Receiver: Green Guardians (1)",null,"📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Haacklee Harbor (2)<br>🟢 Top Receiver: Davis (1)","📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 12:00<br>📨 Messages: 19<br>🔴 Top Sender: Green Guardians (4)<br>🟢 Top Receiver: Sentinel (4)","📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Oceanus City Council (2)",null],["📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: Liam Thorne (1)","📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 09:00<br>📨 Messages: 17<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Mako (5)","📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Green Guardians (3)<br>🟢 Top Receiver: Oceanus City Council (2)","📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 11:00<br>📨 Messages: 11<br>🔴 Top Sender: V. Miesel Shipping (3)<br>🟢 Top Receiver: V. Miesel Shipping (3)","📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 12:00<br>📨 Messages: 5<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Remora (2)",null,null],["📅 Date: 11/10/2040 (Thu)<br>⏰ Hour: 08:00<br>📨 Messages: 11<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: The Intern (3)","📅 Date: 11/10/2040 (Thu)<br>⏰ Hour: 09:00<br>📨 Messages: 17<br>🔴 Top Sender: EcoVigil (4)<br>🟢 Top Receiver: EcoVigil (3)","📅 Date: 11/10/2040 (Thu)<br>⏰ Hour: 10:00<br>📨 Messages: 21<br>🔴 Top Sender: Miranda Jordan (5)<br>🟢 Top Receiver: Clepper Jensen (5)",null,null,null,null],["📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 08:00<br>📨 Messages: 3<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: Sam (1)","📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: Mako (3)<br>🟢 Top Receiver: EcoVigil (3)","📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Horizon (1)","📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Samantha Blake (2)<br>🟢 Top Receiver: Samantha Blake (2)","📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 12:00<br>📨 Messages: 6<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Liam Thorne (1)",null,"📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 14:00<br>📨 Messages: 2<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Horizon (1)"],["📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 08:00<br>📨 Messages: 6<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Mrs. Money (2)","📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (1)<br>🟢 Top Receiver: Neptune (1)","📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 10:00<br>📨 Messages: 14<br>🔴 Top Sender: Reef Guardian (4)<br>🟢 Top Receiver: Green Guardians (3)","📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: V. Miesel Shipping (2)<br>🟢 Top Receiver: V. Miesel Shipping (2)","📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 12:00<br>📨 Messages: 5<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Himark Harbor (2)","📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 13:00<br>📨 Messages: 1<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Liam Thorne (1)",null],["📅 Date: 08/10/2040 (Mon)<br>⏰ Hour: 08:00<br>📨 Messages: 12<br>🔴 Top Sender: Nadia Conti (3)<br>🟢 Top Receiver: Nadia Conti (3)",null,"📅 Date: 08/10/2040 (Mon)<br>⏰ Hour: 10:00<br>📨 Messages: 13<br>🔴 Top Sender: Mako (3)<br>🟢 Top Receiver: Mako (5)","📅 Date: 08/10/2040 (Mon)<br>⏰ Hour: 11:00<br>📨 Messages: 18<br>🔴 Top Sender: Davis (3)<br>🟢 Top Receiver: Sentinel (3)",null,null,null],["📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Sam (2)","📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 09:00<br>📨 Messages: 9<br>🔴 Top Sender: Mako (3)<br>🟢 Top Receiver: Mako (3)","📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 10:00<br>📨 Messages: 14<br>🔴 Top Sender: Clepper Jensen (5)<br>🟢 Top Receiver: Miranda Jordan (5)","📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 11:00<br>📨 Messages: 14<br>🔴 Top Sender: Neptune (4)<br>🟢 Top Receiver: Remora (4)","📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 12:00<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Nadia Conti (1)",null,null],[null,"📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 09:00<br>📨 Messages: 9<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (3)","📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Paackland Harbor (2)","📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 11:00<br>📨 Messages: 7<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Neptune (2)","📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 12:00<br>📨 Messages: 8<br>🔴 Top Sender: Neptune (4)<br>🟢 Top Receiver: Neptune (2)","📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 13:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (5)<br>🟢 Top Receiver: Green Guardians (2)",null],["📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 08:00<br>📨 Messages: 7<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Green Guardians (3)","📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: Oceanus City Council (3)<br>🟢 Top Receiver: Oceanus City Council (3)","📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 10:00<br>📨 Messages: 24<br>🔴 Top Sender: Clepper Jensen (3)<br>🟢 Top Receiver: Oceanus City Council (4)",null,"📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Clepper Jensen (1)<br>🟢 Top Receiver: Clepper Jensen (1)",null,null],["📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 08:00<br>📨 Messages: 10<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Mako (3)","📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Sentinel (2)","📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 10:00<br>📨 Messages: 9<br>🔴 Top Sender: The Middleman (3)<br>🟢 Top Receiver: Boss (3)","📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Davis (2)","📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 12:00<br>📨 Messages: 2<br>🔴 Top Sender: Sentinel (1)<br>🟢 Top Receiver: Horizon (1)","📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 13:00<br>📨 Messages: 9<br>🔴 Top Sender: Boss (2)<br>🟢 Top Receiver: Mako (3)",null],["📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 08:00<br>📨 Messages: 15<br>🔴 Top Sender: Green Guardians (4)<br>🟢 Top Receiver: Oceanus City Council (3)","📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: Clepper Jensen (3)<br>🟢 Top Receiver: Clepper Jensen (3)","📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 10:00<br>📨 Messages: 19<br>🔴 Top Sender: Northern Light (3)<br>🟢 Top Receiver: Paackland Harbor (5)","📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 11:00<br>📨 Messages: 1<br>🔴 Top Sender: Rodriguez (1)<br>🟢 Top Receiver: Davis (1)",null,null,null],["📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 08:00<br>📨 Messages: 11<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Sam (2)","📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 09:00<br>📨 Messages: 2<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (1)","📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 10:00<br>📨 Messages: 5<br>🔴 Top Sender: EcoVigil (2)<br>🟢 Top Receiver: EcoVigil (2)","📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Boss (1)","📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 12:00<br>📨 Messages: 18<br>🔴 Top Sender: Clepper Jensen (4)<br>🟢 Top Receiver: Mako (4)","📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 13:00<br>📨 Messages: 5<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Mako (1)",null],["📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 08:00<br>📨 Messages: 15<br>🔴 Top Sender: Boss (3)<br>🟢 Top Receiver: Boss (4)","📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 09:00<br>📨 Messages: 6<br>🔴 Top Sender: Boss (1)<br>🟢 Top Receiver: Serenity (2)","📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 10:00<br>📨 Messages: 8<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Mrs. Money (2)","📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 11:00<br>📨 Messages: 7<br>🔴 Top Sender: Marlin (2)<br>🟢 Top Receiver: Marlin (2)","📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 12:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Horizon (2)",null,null]],"colorscale":[[0,"#FCFFA4"],[0.043478260869565216,"#FFEB88"],[0.086956521739130432,"#FFD86B"],[0.13043478260869565,"#FFC44D"],[0.17391304347826086,"#FEB12B"],[0.21739130434782608,"#FA9E15"],[0.2608695652173913,"#F38D24"],[0.30434782608695654,"#ED7B2D"],[0.34782608695652173,"#E66934"],[0.39130434782608697,"#DE5539"],[0.43478260869565216,"#D14943"],[0.47826086956521741,"#C1404E"],[0.52173913043478259,"#B13657"],[0.56521739130434778,"#A12D60"],[0.60869565217391308,"#902567"],[0.69565217391304346,"#6E1768"],[0.73913043478260865,"#5D1168"],[0.78260869565217395,"#4A0C68"],[0.86956521739130432,"#2E0E45"],[1,"#000004"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8],"y":[1],"name":"0f46f65a832e95b0232c3c1582af6256","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FCFFA4"],[0.0033444816053511683,"#FCFDA2"],[0.0066889632107023367,"#FDFCA0"],[0.010033444816053515,"#FDFA9D"],[0.013377926421404684,"#FDF99B"],[0.016722408026755852,"#FEF799"],[0.020066889632107031,"#FEF697"],[0.023411371237458199,"#FEF495"],[0.026755852842809368,"#FEF392"],[0.030100334448160536,"#FFF190"],[0.033444816053511704,"#FFF08E"],[0.03678929765886288,"#FFEE8C"],[0.040133779264214048,"#FFED8A"],[0.043478260869565216,"#FFEB88"],[0.046822742474916398,"#FFEA85"],[0.050167224080267574,"#FFE883"],[0.053511705685618735,"#FFE781"],[0.05685618729096989,"#FFE57F"],[0.060200668896321072,"#FFE47D"],[0.06354515050167224,"#FFE27A"],[0.066889632107023408,"#FFE178"],[0.070234113712374577,"#FFDF76"],[0.073578595317725759,"#FFDE74"],[0.076923076923076913,"#FFDC72"],[0.080267558528428096,"#FFDB6F"],[0.083612040133779278,"#FFD96D"],[0.086956521739130432,"#FFD86B"],[0.090301003344481615,"#FFD669"],[0.093645484949832797,"#FFD566"],[0.096989966555183951,"#FFD364"],[0.10033444816053513,"#FFD262"],[0.10367892976588629,"#FFD060"],[0.10702341137123747,"#FFCF5D"],[0.11036789297658864,"#FFCD5B"],[0.11371237458193981,"#FFCC59"],[0.11705685618729098,"#FFCA56"],[0.12040133779264214,"#FFC954"],[0.12374581939799331,"#FFC752"],[0.12709030100334448,"#FFC64F"],[0.13043478260869565,"#FFC44D"],[0.13377926421404682,"#FFC34B"],[0.13712374581939801,"#FFC148"],[0.14046822742474915,"#FFC046"],[0.14381270903010038,"#FFBE43"],[0.14715719063545152,"#FFBD41"],[0.15050167224080269,"#FFBB3E"],[0.15384615384615383,"#FFBA3C"],[0.157190635451505,"#FFB839"],[0.16053511705685619,"#FFB736"],[0.16387959866220739,"#FFB534"],[0.16722408026755856,"#FEB431"],[0.17056856187290972,"#FEB22E"],[0.17391304347826086,"#FEB12B"],[0.17725752508361206,"#FEAF28"],[0.18060200668896323,"#FDAE25"],[0.1839464882943144,"#FDAC21"],[0.18729096989966559,"#FDAB1D"],[0.19063545150501673,"#FDA919"],[0.1939799331103679,"#FCA815"],[0.19732441471571907,"#FCA60F"],[0.20066889632107027,"#FCA50B"],[0.20401337792642141,"#FBA30D"],[0.20735785953177258,"#FBA20F"],[0.21070234113712377,"#FAA111"],[0.21404682274247494,"#FA9F13"],[0.21739130434782608,"#FA9E15"],[0.22073578595317728,"#F99D16"],[0.22408026755852845,"#F99C18"],[0.22742474916387961,"#F89A19"],[0.23076923076923081,"#F8991B"],[0.23411371237458195,"#F7981C"],[0.23745819397993312,"#F7961D"],[0.24080267558528429,"#F6951E"],[0.24414715719063548,"#F6941F"],[0.24749163879598662,"#F59220"],[0.25083612040133779,"#F59121"],[0.25418060200668896,"#F49022"],[0.25752508361204013,"#F48E23"],[0.2608695652173913,"#F38D24"],[0.26421404682274252,"#F38C25"],[0.26755852842809363,"#F28A26"],[0.2709030100334448,"#F28926"],[0.27424749163879603,"#F18727"],[0.27759197324414719,"#F18628"],[0.28093645484949831,"#F08529"],[0.28428093645484953,"#F08329"],[0.2876254180602007,"#EF822A"],[0.29096989966555187,"#EF812B"],[0.29431438127090304,"#EE7F2B"],[0.2976588628762542,"#EE7E2C"],[0.30100334448160537,"#ED7D2D"],[0.30434782608695654,"#ED7B2D"],[0.30769230769230765,"#EC7A2E"],[0.31103678929765882,"#EC782E"],[0.31438127090300999,"#EB772F"],[0.31772575250836121,"#EA7630"],[0.32107023411371238,"#EA7430"],[0.32441471571906355,"#E97331"],[0.32775919732441477,"#E97131"],[0.33110367892976594,"#E87032"],[0.33444816053511711,"#E86F32"],[0.33779264214046828,"#E76D33"],[0.34113712374581945,"#E76C33"],[0.34448160535117056,"#E66A34"],[0.34782608695652173,"#E66934"],[0.3511705685618729,"#E56734"],[0.35451505016722412,"#E56635"],[0.35785953177257529,"#E46435"],[0.36120401337792646,"#E36336"],[0.36454849498327763,"#E36136"],[0.3678929765886288,"#E26037"],[0.37123745819397991,"#E25E37"],[0.37458193979933119,"#E15D37"],[0.3779264214046823,"#E15B38"],[0.38127090301003347,"#E05A38"],[0.38461538461538464,"#E05838"],[0.38795986622073581,"#DF5739"],[0.39130434782608697,"#DE5539"],[0.39464882943143814,"#DE5439"],[0.39799331103678937,"#DD523A"],[0.40133779264214053,"#DD513A"],[0.40468227424749165,"#DB503B"],[0.40802675585284282,"#DA4F3C"],[0.41137123745819398,"#D94E3D"],[0.41471571906354515,"#D84E3E"],[0.41806020066889638,"#D74D3F"],[0.42140468227424754,"#D54C40"],[0.42474916387959871,"#D44B41"],[0.42809364548494988,"#D34B42"],[0.43143812709030099,"#D24A42"],[0.43478260869565216,"#D14943"],[0.43812709030100333,"#CF4944"],[0.44147157190635455,"#CE4845"],[0.44481605351170572,"#CD4746"],[0.44816053511705689,"#CC4647"],[0.45150501672240806,"#CB4647"],[0.45484949832775923,"#C94548"],[0.45819397993311034,"#C84449"],[0.46153846153846162,"#C7434A"],[0.46488294314381273,"#C6434B"],[0.4682274247491639,"#C5424B"],[0.47157190635451507,"#C3414C"],[0.47491638795986624,"#C2404D"],[0.47826086956521741,"#C1404E"],[0.48160535117056857,"#C03F4E"],[0.4849498327759198,"#BF3E4F"],[0.48829431438127097,"#BD3E50"],[0.49163879598662208,"#BC3D51"],[0.49498327759197325,"#BB3C51"],[0.49832775919732442,"#BA3B52"],[0.50167224080267558,"#B93B53"],[0.50501672240802686,"#B73A54"],[0.50836120401337792,"#B63954"],[0.51170568561872909,"#B53955"],[0.51505016722408026,"#B43856"],[0.51839464882943143,"#B23756"],[0.52173913043478259,"#B13657"],[0.52508361204013387,"#B03658"],[0.52842809364548504,"#AF3559"],[0.53177257525083621,"#AD3459"],[0.53511705685618727,"#AC345A"],[0.53846153846153844,"#AB335B"],[0.5418060200668896,"#AA325B"],[0.54515050167224077,"#A8315C"],[0.54849498327759205,"#A7315D"],[0.55183946488294322,"#A6305D"],[0.55518394648829439,"#A52F5E"],[0.55852842809364556,"#A32F5F"],[0.56187290969899661,"#A22E5F"],[0.56521739130434778,"#A12D60"],[0.56856187290969906,"#9F2C61"],[0.57190635451505023,"#9E2C61"],[0.5752508361204014,"#9D2B62"],[0.57859531772575257,"#9B2A63"],[0.58193979933110374,"#9A2A63"],[0.5852842809364549,"#992964"],[0.58862876254180607,"#982865"],[0.59197324414715724,"#962865"],[0.59531772575250841,"#952766"],[0.59866220735785958,"#942667"],[0.60200668896321075,"#922667"],[0.60535117056856191,"#912567"],[0.60869565217391308,"#902567"],[0.61204013377926425,"#8E2467"],[0.61538461538461542,"#8D2467"],[0.61872909698996659,"#8C2367"],[0.62207357859531776,"#8B2367"],[0.62541806020066892,"#892267"],[0.62876254180602009,"#882167"],[0.63210702341137126,"#872167"],[0.63545150501672243,"#862067"],[0.6387959866220736,"#842067"],[0.64214046822742477,"#831F67"],[0.64548494983277593,"#821F67"],[0.6488294314381271,"#811E67"],[0.65217391304347827,"#7F1E67"],[0.65551839464882955,"#7E1D68"],[0.65886287625418061,"#7D1D68"],[0.66220735785953189,"#7B1C68"],[0.66555183946488294,"#7A1C68"],[0.66889632107023422,"#791B68"],[0.67224080267558517,"#781B68"],[0.67558528428093656,"#761A68"],[0.67892976588628773,"#751A68"],[0.6822742474916389,"#741968"],[0.68561872909698995,"#721968"],[0.68896321070234112,"#711868"],[0.69230769230769229,"#701868"],[0.69565217391304346,"#6E1768"],[0.69899665551839463,"#6D1768"],[0.7023411371237458,"#6C1668"],[0.70568561872909696,"#6A1668"],[0.70903010033444824,"#691568"],[0.71237458193979941,"#681568"],[0.71571906354515058,"#661568"],[0.71906354515050175,"#651468"],[0.72240802675585292,"#641468"],[0.72575250836120409,"#621368"],[0.72909698996655525,"#611368"],[0.73244147157190642,"#601268"],[0.73578595317725759,"#5E1268"],[0.73913043478260865,"#5D1168"],[0.74247491638795982,"#5C1168"],[0.74581939799331098,"#5A1068"],[0.74916387959866237,"#591068"],[0.75250836120401343,"#571068"],[0.7558528428093646,"#560F68"],[0.75919732441471577,"#540F68"],[0.76254180602006694,"#530E68"],[0.76588628762541811,"#520E68"],[0.76923076923076927,"#500D68"],[0.77257525083612044,"#4F0D68"],[0.77591973244147161,"#4D0D68"],[0.77926421404682278,"#4C0C68"],[0.78260869565217395,"#4A0C68"],[0.78595317725752512,"#490C68"],[0.78929765886287628,"#470B68"],[0.79264214046822756,"#460B68"],[0.79598662207357873,"#440A68"],[0.7993311036789299,"#420A68"],[0.80267558528428107,"#410A67"],[0.80602006688963213,"#400B65"],[0.80936454849498329,"#3F0B63"],[0.81270903010033446,"#3E0B61"],[0.81605351170568563,"#3D0C60"],[0.8193979933110368,"#3C0C5E"],[0.82274247491638797,"#3B0C5C"],[0.82608695652173914,"#3A0C5A"],[0.8294314381270903,"#390D59"],[0.83277591973244147,"#380D57"],[0.83612040133779275,"#370D55"],[0.83946488294314392,"#360D54"],[0.84280936454849509,"#350D52"],[0.84615384615384626,"#340D50"],[0.84949832775919742,"#330D4F"],[0.85284280936454859,"#320E4D"],[0.85618729096989976,"#320E4B"],[0.85953177257525082,"#310E4A"],[0.86287625418060199,"#300E48"],[0.86622073578595316,"#2F0E46"],[0.86956521739130432,"#2E0E45"],[0.87290969899665549,"#2D0E43"],[0.87625418060200666,"#2C0E41"],[0.87959866220735794,"#2B0E40"],[0.88294314381270911,"#2A0E3E"],[0.88628762541806028,"#290E3D"],[0.88963210702341144,"#280E3B"],[0.89297658862876261,"#270E39"],[0.89632107023411378,"#260E38"],[0.89966555183946495,"#250E36"],[0.90301003344481612,"#240E35"],[0.90635451505016729,"#230E33"],[0.90969899665551845,"#220E32"],[0.91304347826086951,"#210D30"],[0.91638795986622068,"#200D2E"],[0.91973244147157185,"#1F0D2D"],[0.92307692307692324,"#1F0D2B"],[0.92642140468227441,"#1E0C2A"],[0.92976588628762546,"#1D0C28"],[0.93311036789297663,"#1C0C27"],[0.9364548494983278,"#1B0B25"],[0.93979933110367897,"#1A0B24"],[0.94314381270903014,"#1A0A23"],[0.94648829431438131,"#190921"],[0.94983277591973247,"#180920"],[0.95317725752508364,"#17081E"],[0.95652173913043481,"#16081D"],[0.95986622073578598,"#15071B"],[0.96321070234113715,"#14061A"],[0.96655518394648843,"#130619"],[0.9698996655518396,"#110517"],[0.97324414715719076,"#100516"],[0.97658862876254193,"#0E0414"],[0.9799331103678931,"#0C0312"],[0.98327759197324416,"#0A0310"],[0.98662207357859533,"#08020E"],[0.98996655518394649,"#06020C"],[0.99331103678929766,"#040109"],[0.99665551839464883,"#020107"],[1,"#000004"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":23.039999999999996,"title":"Message Count","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205},"tickmode":"array","ticktext":["5","10","15","20"],"tickvals":[0.17499999999999999,0.39166666666666666,0.60833333333333339,0.82499999999999996],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":41.238688252386886,"r":6.6417600664176026,"b":40.934205989380594,"l":94.977168949771681},"font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205},"title":{"text":"Hourly Heatmap of Radio Communications by Day","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402241},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[7.1500000000000004,14.85],"tickmode":"array","ticktext":["08:00","09:00","10:00","11:00","12:00","13:00","14:00"],"tickvals":[8,9,10,11,12,13,14],"categoryorder":"array","categoryarray":["08:00","09:00","10:00","11:00","12:00","13:00","14:00"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.3208800332088013,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Hour of Day","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,14.6],"tickmode":"array","ticktext":["14/10/2040 (Sun)","13/10/2040 (Sat)","12/10/2040 (Fri)","11/10/2040 (Thu)","10/10/2040 (Wed)","09/10/2040 (Tue)","08/10/2040 (Mon)","07/10/2040 (Sun)","06/10/2040 (Sat)","05/10/2040 (Fri)","04/10/2040 (Thu)","03/10/2040 (Wed)","02/10/2040 (Tue)","01/10/2040 (Mon)"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,7.9999999999999991,9,10,11,12,13,14],"categoryorder":"array","categoryarray":["14/10/2040 (Sun)","13/10/2040 (Sat)","12/10/2040 (Fri)","11/10/2040 (Thu)","10/10/2040 (Wed)","09/10/2040 (Tue)","08/10/2040 (Mon)","07/10/2040 (Sun)","06/10/2040 (Sat)","05/10/2040 (Fri)","04/10/2040 (Thu)","03/10/2040 (Wed)","02/10/2040 (Tue)","01/10/2040 (Mon)"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.3208800332088013,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Message Count","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c6819696b72":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"}},"cur_data":"4c6819696b72","visdat":{"4c6819696b72":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>We will increase the resolution to half-hour time slots.</p>
</section>
<section id="b---heat-map-of-half-hourly-message-volume-for-each-day-over-the-2-weeks-period" class="level4">
<h4 class="anchored" data-anchor-id="b---heat-map-of-half-hourly-message-volume-for-each-day-over-the-2-weeks-period"><strong>4.4b - Heat Map of half-hourly message volume for each day over the 2 weeks period:</strong></h4>
<p>This heat map is interactive and you may choose to hover on the tile to display the <strong>date, time, and message count</strong>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Fix sender and receiver edges</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>comm_edges_sent <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> to_id, <span class="at">sender_id =</span> from_id)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>comm_edges_recv <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> from_id, <span class="at">receiver_id =</span> to_id)  <span class="co"># ✅ fixed receiver_id</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Reconstruct sender–receiver–event linkage</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>comm_events_raw <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event_id =</span> id, timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp),</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(timestamp),</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">minute =</span> <span class="fu">minute</span>(timestamp),</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_bin =</span> hour <span class="sc">+</span> <span class="fu">ifelse</span>(minute <span class="sc">&lt;</span> <span class="dv">30</span>, <span class="dv">0</span>, <span class="fl">0.5</span>),</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_label =</span> <span class="fu">format</span>(timestamp, <span class="st">"%d/%m/%Y (%a)"</span>),</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_label =</span> <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(time_bin), <span class="fu">ifelse</span>(time_bin <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Join to get sender/receiver labels</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>comm_links <span class="ot">&lt;-</span> comm_events_raw <span class="sc">%&gt;%</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(comm_edges_sent, <span class="at">by =</span> <span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(comm_edges_recv, <span class="at">by =</span> <span class="st">"event_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">sender_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">receiver_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver_id"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Aggregate by half-hour + label top actors</span></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>comm_heatmap <span class="ot">&lt;-</span> comm_links <span class="sc">%&gt;%</span></span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_label, time_bin, time_label) <span class="sc">%&gt;%</span></span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_sender =</span> <span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(sender_label), <span class="at">decreasing =</span> <span class="cn">TRUE</span>))[<span class="dv">1</span>],</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_count =</span> <span class="fu">max</span>(<span class="fu">table</span>(sender_label)),</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">top_receiver =</span> <span class="fu">names</span>(<span class="fu">sort</span>(<span class="fu">table</span>(receiver_label), <span class="at">decreasing =</span> <span class="cn">TRUE</span>))[<span class="dv">1</span>],</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">receiver_count =</span> <span class="fu">max</span>(<span class="fu">table</span>(receiver_label)),</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">tooltip =</span> <span class="fu">paste0</span>(</span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">"📅 Date: "</span>, date_label,</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;🕒 Time: "</span>, time_label,</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;📨 Messages: "</span>, count,</span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;🔴 Top Sender: "</span>, top_sender, <span class="st">" ("</span>, sender_count, <span class="st">")"</span>,</span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;br&gt;🟢 Top Receiver: "</span>, top_receiver, <span class="st">" ("</span>, receiver_count, <span class="st">")"</span></span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: ggplot</span></span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comm_heatmap, <span class="fu">aes</span>(<span class="at">x =</span> time_bin, <span class="at">y =</span> <span class="fu">fct_rev</span>(<span class="fu">factor</span>(date_label)), <span class="at">fill =</span> count, <span class="at">text =</span> tooltip)) <span class="sc">+</span></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">option =</span> <span class="st">"inferno"</span>,</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Message Count"</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Heatmap of Radio Communications by Day"</span>,</span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Convert to interactive Plotly plot</span></span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">"text"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8dd753b0b23bfec2e741" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8dd753b0b23bfec2e741">{"x":{"data":[{"x":[8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14],"z":[[0.13333333333333333,0.40000000000000002,0.20000000000000001,0.13333333333333333,null,0.066666666666666666,0,0.20000000000000001,0.33333333333333331,0.20000000000000001,null,0.13333333333333333,null],[0.40000000000000002,0.066666666666666666,0.13333333333333333,0.066666666666666666,null,null,null,0.33333333333333331,0.46666666666666667,0.66666666666666663,0.13333333333333333,null,null],[0,0.13333333333333333,0.20000000000000001,0.80000000000000004,0.13333333333333333,0.13333333333333333,0.59999999999999998,0,null,0.26666666666666666,null,null,null],[0.40000000000000002,0.20000000000000001,0.66666666666666663,0.33333333333333331,0.80000000000000004,0.46666666666666667,null,null,null,null,null,null,null],[0.13333333333333333,null,0.26666666666666666,0.33333333333333331,null,0.33333333333333331,0.33333333333333331,null,0.26666666666666666,0,null,null,0.066666666666666666],[0.20000000000000001,0.066666666666666666,0.20000000000000001,null,0.33333333333333331,0.46666666666666667,0.066666666666666666,0.13333333333333333,0.13333333333333333,0.066666666666666666,null,0,null],[0.53333333333333333,0.13333333333333333,null,null,0.33333333333333331,0.40000000000000002,1,0.066666666666666666,null,null,null,null,null],[0.20000000000000001,null,0.20000000000000001,0.26666666666666666,0.46666666666666667,0.33333333333333331,0.66666666666666663,0.13333333333333333,0,null,null,null,null],[null,null,0.066666666666666666,0.40000000000000002,0.13333333333333333,0.13333333333333333,0.13333333333333333,0.20000000000000001,0.20000000000000001,0.20000000000000001,0.46666666666666667,null,null],[0.066666666666666666,0.26666666666666666,0,0.59999999999999998,0.66666666666666663,0.80000000000000004,null,null,0.13333333333333333,null,null,null,null],[0.26666666666666666,0.26666666666666666,0.20000000000000001,null,0.33333333333333331,0.13333333333333333,0.26666666666666666,0,0.066666666666666666,null,0.13333333333333333,0.33333333333333331,null],[0.26666666666666666,0.59999999999999998,0.26666666666666666,0.33333333333333331,0.73333333333333328,0.40000000000000002,null,0,null,null,null,null,null],[0.33333333333333331,0.26666666666666666,0,0,0.26666666666666666,null,0.066666666666666666,0.13333333333333333,0.66666666666666663,0.40000000000000002,0.26666666666666666,null,null],[0.53333333333333333,0.33333333333333331,0,0.26666666666666666,null,0.46666666666666667,0.33333333333333331,0,0.13333333333333333,0.26666666666666666,null,null,null]],"text":[["📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 08:00<br>📨 Messages: 3<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: The Intern (2)","📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 08:30<br>📨 Messages: 7<br>🔴 Top Sender: Reef Guardian (2)<br>🟢 Top Receiver: EcoVigil (1)","📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: EcoVigil (1)<br>🟢 Top Receiver: Horizon (1)","📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 09:30<br>📨 Messages: 3<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Boss (1)",null,"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 10:30<br>📨 Messages: 2<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Reef Guardian (1)","📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 11:00<br>📨 Messages: 1<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Port Security (1)","📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 11:30<br>📨 Messages: 4<br>🔴 Top Sender: EcoVigil (3)<br>🟢 Top Receiver: Sentinel (2)","📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 12:00<br>📨 Messages: 6<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (2)","📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 12:30<br>📨 Messages: 4<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (1)",null,"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 13:30<br>📨 Messages: 3<br>🔴 Top Sender: Knowles (2)<br>🟢 Top Receiver: Davis (2)",null],["📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 08:00<br>📨 Messages: 7<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Sam (2)","📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 08:30<br>📨 Messages: 2<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Davis (1)","📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 09:00<br>📨 Messages: 3<br>🔴 Top Sender: Horizon (2)<br>🟢 Top Receiver: Horizon (1)","📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 09:30<br>📨 Messages: 2<br>🔴 Top Sender: Liam Thorne (1)<br>🟢 Top Receiver: Green Guardians (1)",null,null,null,"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 11:30<br>📨 Messages: 6<br>🔴 Top Sender: Haacklee Harbor (2)<br>🟢 Top Receiver: Davis (1)","📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 12:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Sentinel (3)","📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 12:30<br>📨 Messages: 11<br>🔴 Top Sender: The Lookout (3)<br>🟢 Top Receiver: Mako (2)","📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Oceanus City Council (2)",null,null],["📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 08:00<br>📨 Messages: 1<br>🔴 Top Sender: The Lookout (1)<br>🟢 Top Receiver: Sam (1)","📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 08:30<br>📨 Messages: 3<br>🔴 Top Sender: Nadia Conti (1)<br>🟢 Top Receiver: Liam Thorne (1)","📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Rodriguez (2)<br>🟢 Top Receiver: Davis (1)","📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 09:30<br>📨 Messages: 13<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Mako (4)","📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 10:00<br>📨 Messages: 3<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Davis (1)","📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 10:30<br>📨 Messages: 3<br>🔴 Top Sender: Green Guardians (3)<br>🟢 Top Receiver: Green Guardians (1)","📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 11:00<br>📨 Messages: 10<br>🔴 Top Sender: V. Miesel Shipping (3)<br>🟢 Top Receiver: V. Miesel Shipping (3)","📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Remora (1)<br>🟢 Top Receiver: Mako (1)",null,"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 12:30<br>📨 Messages: 5<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Remora (2)",null,null,null],["📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 08:00<br>📨 Messages: 7<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: The Intern (2)","📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 08:30<br>📨 Messages: 4<br>🔴 Top Sender: EcoVigil (1)<br>🟢 Top Receiver: EcoVigil (1)","📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: EcoVigil (4)<br>🟢 Top Receiver: EcoVigil (3)","📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 09:30<br>📨 Messages: 6<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Mako (2)","📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 10:00<br>📨 Messages: 13<br>🔴 Top Sender: Miranda Jordan (5)<br>🟢 Top Receiver: Clepper Jensen (5)","📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 10:30<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Green Guardians (3)",null,null,null,null,null,null,null],["📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 08:00<br>📨 Messages: 3<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: Sam (1)",null,"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 09:00<br>📨 Messages: 5<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (2)","📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 09:30<br>📨 Messages: 6<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (3)",null,"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 10:30<br>📨 Messages: 6<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Horizon (1)","📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Samantha Blake (2)<br>🟢 Top Receiver: Samantha Blake (2)",null,"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 12:00<br>📨 Messages: 5<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Liam Thorne (1)","📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 12:30<br>📨 Messages: 1<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Nadia Conti (1)",null,null,"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 14:00<br>📨 Messages: 2<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Horizon (1)"],["📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: Mrs. Money (1)<br>🟢 Top Receiver: Mrs. Money (1)","📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 08:30<br>📨 Messages: 2<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Mrs. Money (1)","📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (1)<br>🟢 Top Receiver: Neptune (1)",null,"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Oceanus City Council (3)","📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 10:30<br>📨 Messages: 8<br>🔴 Top Sender: Reef Guardian (2)<br>🟢 Top Receiver: Green Guardians (2)","📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 11:00<br>📨 Messages: 2<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)","📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 11:30<br>📨 Messages: 3<br>🔴 Top Sender: V. Miesel Shipping (2)<br>🟢 Top Receiver: V. Miesel Shipping (2)","📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)","📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 12:30<br>📨 Messages: 2<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)",null,"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 13:30<br>📨 Messages: 1<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Liam Thorne (1)",null],["📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 08:00<br>📨 Messages: 9<br>🔴 Top Sender: Liam Thorne (2)<br>🟢 Top Receiver: Nadia Conti (3)","📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 08:30<br>📨 Messages: 3<br>🔴 Top Sender: Mrs. Money (1)<br>🟢 Top Receiver: Elise (1)",null,null,"📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Mako (3)","📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 10:30<br>📨 Messages: 7<br>🔴 Top Sender: Remora (3)<br>🟢 Top Receiver: Remora (3)","📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 11:00<br>📨 Messages: 16<br>🔴 Top Sender: Davis (3)<br>🟢 Top Receiver: Sentinel (3)","📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 11:30<br>📨 Messages: 2<br>🔴 Top Sender: Horizon (1)<br>🟢 Top Receiver: Green Guardians (1)",null,null,null,null,null],["📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Sam (2)",null,"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Elise (1)","📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 09:30<br>📨 Messages: 5<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (2)","📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 10:00<br>📨 Messages: 8<br>🔴 Top Sender: Clepper Jensen (4)<br>🟢 Top Receiver: Clepper Jensen (4)","📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 10:30<br>📨 Messages: 6<br>🔴 Top Sender: Reef Guardian (3)<br>🟢 Top Receiver: Reef Guardian (2)","📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 11:00<br>📨 Messages: 11<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Remora (4)","📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 11:30<br>📨 Messages: 3<br>🔴 Top Sender: Neptune (1)<br>🟢 Top Receiver: Elise (1)","📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 12:00<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Nadia Conti (1)",null,null,null,null],[null,null,"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 09:00<br>📨 Messages: 2<br>🔴 Top Sender: Mako (1)<br>🟢 Top Receiver: Mako (1)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 09:30<br>📨 Messages: 7<br>🔴 Top Sender: Glitters Team (1)<br>🟢 Top Receiver: Boss (2)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 10:00<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Himark Harbor (1)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 10:30<br>📨 Messages: 3<br>🔴 Top Sender: Mako (1)<br>🟢 Top Receiver: Paackland Harbor (2)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 11:00<br>📨 Messages: 3<br>🔴 Top Sender: Neptune (2)<br>🟢 Top Receiver: Mako (1)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 11:30<br>📨 Messages: 4<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Green Guardians (1)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 12:00<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (2)<br>🟢 Top Receiver: City Officials (1)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 12:30<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (2)<br>🟢 Top Receiver: Neptune (2)","📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 13:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (5)<br>🟢 Top Receiver: Green Guardians (2)",null,null],["📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 08:00<br>📨 Messages: 2<br>🔴 Top Sender: The Intern (1)<br>🟢 Top Receiver: Mrs. Money (1)","📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 08:30<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Green Guardians (3)","📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 09:00<br>📨 Messages: 1<br>🔴 Top Sender: Rodriguez (1)<br>🟢 Top Receiver: Boss (1)","📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 09:30<br>📨 Messages: 10<br>🔴 Top Sender: Oceanus City Council (3)<br>🟢 Top Receiver: Oceanus City Council (3)","📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 10:00<br>📨 Messages: 11<br>🔴 Top Sender: Green Guardians (3)<br>🟢 Top Receiver: Oceanus City Council (4)","📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 10:30<br>📨 Messages: 13<br>🔴 Top Sender: Mrs. Money (3)<br>🟢 Top Receiver: Mrs. Money (3)",null,null,"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Clepper Jensen (1)<br>🟢 Top Receiver: Clepper Jensen (1)",null,null,null,null],["📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 08:00<br>📨 Messages: 5<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Mrs. Money (2)","📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 08:30<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Mako (3)","📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Sentinel (2)",null,"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: The Middleman (3)<br>🟢 Top Receiver: Boss (3)","📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 10:30<br>📨 Messages: 3<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Remora (3)","📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: Marlin (2)<br>🟢 Top Receiver: Davis (1)","📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (1)","📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 12:00<br>📨 Messages: 2<br>🔴 Top Sender: Sentinel (1)<br>🟢 Top Receiver: Horizon (1)",null,"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Himark Harbor (1)","📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 13:30<br>📨 Messages: 6<br>🔴 Top Sender: Boss (2)<br>🟢 Top Receiver: Mako (2)",null],["📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 08:00<br>📨 Messages: 5<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Mrs. Money (2)","📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 08:30<br>📨 Messages: 10<br>🔴 Top Sender: Green Guardians (4)<br>🟢 Top Receiver: Oceanus City Council (3)","📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 09:00<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Boss (1)","📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 09:30<br>📨 Messages: 6<br>🔴 Top Sender: Clepper Jensen (3)<br>🟢 Top Receiver: Clepper Jensen (3)","📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 10:00<br>📨 Messages: 12<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Paackland Harbor (5)","📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 10:30<br>📨 Messages: 7<br>🔴 Top Sender: Northern Light (3)<br>🟢 Top Receiver: Northern Light (3)",null,"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Rodriguez (1)<br>🟢 Top Receiver: Davis (1)",null,null,null,null,null],["📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 08:00<br>📨 Messages: 6<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Sam (2)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 08:30<br>📨 Messages: 5<br>🔴 Top Sender: Haacklee Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 09:00<br>📨 Messages: 1<br>🔴 Top Sender: Samantha Blake (1)<br>🟢 Top Receiver: Sailor Shifts Team (1)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 09:30<br>📨 Messages: 1<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (1)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 10:00<br>📨 Messages: 5<br>🔴 Top Sender: EcoVigil (2)<br>🟢 Top Receiver: EcoVigil (2)",null,"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 11:00<br>📨 Messages: 2<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Mako (1)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 11:30<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Boss (1)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 12:00<br>📨 Messages: 11<br>🔴 Top Sender: Clepper Jensen (4)<br>🟢 Top Receiver: Miranda Jordan (4)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 12:30<br>📨 Messages: 7<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (2)","📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 13:00<br>📨 Messages: 5<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Mako (1)",null,null],["📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 08:00<br>📨 Messages: 9<br>🔴 Top Sender: Boss (2)<br>🟢 Top Receiver: Boss (3)","📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 08:30<br>📨 Messages: 6<br>🔴 Top Sender: Serenity (2)<br>🟢 Top Receiver: Mako (2)","📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 09:00<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (1)","📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 09:30<br>📨 Messages: 5<br>🔴 Top Sender: Boss (1)<br>🟢 Top Receiver: Serenity (2)",null,"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 10:30<br>📨 Messages: 8<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Mrs. Money (2)","📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Marlin (2)<br>🟢 Top Receiver: Marlin (2)","📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Reef Guardian (1)","📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Samantha Blake (2)<br>🟢 Top Receiver: Oceanus City Council (1)","📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 12:30<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Horizon (2)",null,null,null]],"colorscale":[[0,"#FCFFA4"],[0.066666666666666666,"#FFE178"],[0.13333333333333333,"#FFC34B"],[0.20000000000000001,"#FCA50A"],[0.26666666666666666,"#F28B25"],[0.33333333333333331,"#E86F32"],[0.40000000000000002,"#DD513A"],[0.46666666666666667,"#C5424B"],[0.53333333333333333,"#AD345A"],[0.59999999999999998,"#932667"],[0.66666666666666663,"#7A1C68"],[0.73333333333333328,"#5F1268"],[0.80000000000000004,"#420A68"],[1,"#000004"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.5],"y":[1],"name":"4a3fe985b480de24e74e517b362be2e4","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#FCFFA4"],[0.0033444816053511683,"#FCFDA2"],[0.0066889632107023367,"#FDFCA0"],[0.010033444816053521,"#FDFA9D"],[0.013377926421404689,"#FDF99B"],[0.016722408026755856,"#FEF799"],[0.020066889632107024,"#FEF697"],[0.023411371237458192,"#FEF495"],[0.026755852842809361,"#FEF392"],[0.030100334448160529,"#FFF190"],[0.033444816053511711,"#FFF08E"],[0.036789297658862866,"#FFEE8C"],[0.040133779264214048,"#FFED8A"],[0.043478260869565216,"#FFEB88"],[0.046822742474916385,"#FFEA85"],[0.050167224080267567,"#FFE883"],[0.053511705685618721,"#FFE781"],[0.056856187290969903,"#FFE57F"],[0.060200668896321072,"#FFE47D"],[0.06354515050167224,"#FFE27A"],[0.066889632107023422,"#FFE178"],[0.070234113712374577,"#FFDF76"],[0.073578595317725731,"#FFDE74"],[0.076923076923076941,"#FFDC72"],[0.080267558528428096,"#FFDB6F"],[0.08361204013377925,"#FFD96D"],[0.086956521739130432,"#FFD86B"],[0.090301003344481615,"#FFD669"],[0.093645484949832769,"#FFD566"],[0.096989966555183951,"#FFD364"],[0.10033444816053513,"#FFD262"],[0.10367892976588629,"#FFD060"],[0.10702341137123744,"#FFCF5D"],[0.11036789297658862,"#FFCD5B"],[0.11371237458193981,"#FFCC59"],[0.11705685618729096,"#FFCA56"],[0.12040133779264214,"#FFC954"],[0.12374581939799333,"#FFC752"],[0.12709030100334448,"#FFC64F"],[0.13043478260869565,"#FFC44D"],[0.13377926421404682,"#FFC34B"],[0.13712374581939801,"#FFC148"],[0.14046822742474915,"#FFC046"],[0.14381270903010035,"#FFBE43"],[0.14715719063545149,"#FFBD41"],[0.15050167224080269,"#FFBB3E"],[0.15384615384615385,"#FFBA3C"],[0.15719063545150502,"#FFB839"],[0.16053511705685619,"#FFB736"],[0.16387959866220736,"#FFB534"],[0.16722408026755853,"#FEB431"],[0.1705685618729097,"#FEB22E"],[0.17391304347826086,"#FEB12B"],[0.17725752508361206,"#FEAF28"],[0.1806020066889632,"#FDAE25"],[0.1839464882943144,"#FDAC21"],[0.18729096989966554,"#FDAB1D"],[0.19063545150501673,"#FDA919"],[0.1939799331103679,"#FCA815"],[0.19732441471571907,"#FCA60F"],[0.20066889632107027,"#FCA50B"],[0.20401337792642144,"#FBA30D"],[0.20735785953177258,"#FBA20F"],[0.21070234113712374,"#FAA111"],[0.21404682274247488,"#FA9F13"],[0.21739130434782611,"#FA9E15"],[0.22073578595317725,"#F99D16"],[0.22408026755852847,"#F99C18"],[0.22742474916387961,"#F89A19"],[0.23076923076923078,"#F8991B"],[0.23411371237458192,"#F7981C"],[0.23745819397993309,"#F7961D"],[0.24080267558528429,"#F6951E"],[0.24414715719063546,"#F6941F"],[0.24749163879598665,"#F59220"],[0.25083612040133779,"#F59121"],[0.25418060200668896,"#F49022"],[0.25752508361204013,"#F48E23"],[0.2608695652173913,"#F38D24"],[0.26421404682274247,"#F38C25"],[0.26755852842809363,"#F28A26"],[0.2709030100334448,"#F28926"],[0.27424749163879603,"#F18727"],[0.27759197324414714,"#F18628"],[0.28093645484949831,"#F08529"],[0.28428093645484953,"#F08329"],[0.2876254180602007,"#EF822A"],[0.29096989966555181,"#EF812B"],[0.29431438127090298,"#EE7F2B"],[0.2976588628762542,"#EE7E2C"],[0.30100334448160537,"#ED7D2D"],[0.30434782608695649,"#ED7B2D"],[0.30769230769230771,"#EC7A2E"],[0.31103678929765888,"#EC782E"],[0.31438127090301005,"#EB772F"],[0.31772575250836116,"#EA7630"],[0.32107023411371238,"#EA7430"],[0.32441471571906355,"#E97331"],[0.32775919732441472,"#E97131"],[0.33110367892976594,"#E87032"],[0.33444816053511706,"#E86F32"],[0.33779264214046822,"#E76D33"],[0.34113712374581939,"#E76C33"],[0.34448160535117062,"#E66A34"],[0.34782608695652173,"#E66934"],[0.3511705685618729,"#E56734"],[0.35451505016722412,"#E56635"],[0.35785953177257529,"#E46435"],[0.3612040133779264,"#E36336"],[0.36454849498327763,"#E36136"],[0.3678929765886288,"#E26037"],[0.37123745819397996,"#E25E37"],[0.37458193979933108,"#E15D37"],[0.3779264214046823,"#E15B38"],[0.38127090301003347,"#E05A38"],[0.38461538461538464,"#E05838"],[0.38795986622073581,"#DF5739"],[0.39130434782608697,"#DE5539"],[0.39464882943143814,"#DE5439"],[0.39799331103678931,"#DD523A"],[0.40133779264214048,"#DD513A"],[0.40468227424749165,"#DB503B"],[0.40802675585284282,"#DA4F3C"],[0.41137123745819404,"#D94E3D"],[0.41471571906354515,"#D84E3E"],[0.41806020066889632,"#D74D3F"],[0.42140468227424749,"#D54C40"],[0.42474916387959871,"#D44B41"],[0.42809364548494983,"#D34B42"],[0.43143812709030099,"#D24A42"],[0.43478260869565222,"#D14943"],[0.43812709030100339,"#CF4944"],[0.4414715719063545,"#CE4845"],[0.44481605351170567,"#CD4746"],[0.44816053511705689,"#CC4647"],[0.45150501672240806,"#CB4647"],[0.45484949832775917,"#C94548"],[0.4581939799331104,"#C84449"],[0.46153846153846156,"#C7434A"],[0.46488294314381273,"#C6434B"],[0.46822742474916385,"#C5424B"],[0.47157190635451512,"#C3414C"],[0.47491638795986618,"#C2404D"],[0.47826086956521746,"#C1404E"],[0.48160535117056857,"#C03F4E"],[0.48494983277591974,"#BF3E4F"],[0.48829431438127091,"#BD3E50"],[0.49163879598662208,"#BC3D51"],[0.4949832775919733,"#BB3C51"],[0.49832775919732436,"#BA3B52"],[0.50167224080267558,"#B93B53"],[0.50501672240802675,"#B73A54"],[0.50836120401337792,"#B63954"],[0.51170568561872909,"#B53955"],[0.51505016722408026,"#B43856"],[0.51839464882943154,"#B23756"],[0.52173913043478259,"#B13657"],[0.52508361204013387,"#B03658"],[0.52842809364548493,"#AF3559"],[0.5317725752508361,"#AD3459"],[0.53511705685618727,"#AC345A"],[0.53846153846153844,"#AB335B"],[0.5418060200668896,"#AA325B"],[0.54515050167224088,"#A8315C"],[0.54849498327759205,"#A7315D"],[0.55183946488294322,"#A6305D"],[0.55518394648829428,"#A52F5E"],[0.55852842809364545,"#A32F5F"],[0.56187290969899661,"#A22E5F"],[0.56521739130434778,"#A12D60"],[0.56856187290969906,"#9F2C61"],[0.57190635451505023,"#9E2C61"],[0.5752508361204014,"#9D2B62"],[0.57859531772575257,"#9B2A63"],[0.58193979933110362,"#9A2A63"],[0.58528428093645479,"#992964"],[0.58862876254180596,"#982865"],[0.59197324414715724,"#962865"],[0.59531772575250841,"#952766"],[0.59866220735785958,"#942667"],[0.60200668896321075,"#922667"],[0.60535117056856191,"#912567"],[0.60869565217391297,"#902567"],[0.61204013377926414,"#8E2467"],[0.61538461538461542,"#8D2467"],[0.61872909698996659,"#8C2367"],[0.62207357859531776,"#8B2367"],[0.62541806020066892,"#892267"],[0.62876254180602009,"#882167"],[0.63210702341137126,"#872167"],[0.63545150501672232,"#862067"],[0.6387959866220736,"#842067"],[0.64214046822742477,"#831F67"],[0.64548494983277593,"#821F67"],[0.6488294314381271,"#811E67"],[0.65217391304347827,"#7F1E67"],[0.65551839464882944,"#7E1D68"],[0.65886287625418061,"#7D1D68"],[0.66220735785953189,"#7B1C68"],[0.66555183946488294,"#7A1C68"],[0.66889632107023411,"#791B68"],[0.67224080267558528,"#781B68"],[0.67558528428093645,"#761A68"],[0.67892976588628762,"#751A68"],[0.68227424749163879,"#741968"],[0.68561872909699006,"#721968"],[0.68896321070234123,"#711868"],[0.69230769230769229,"#701868"],[0.69565217391304346,"#6E1768"],[0.69899665551839463,"#6D1768"],[0.7023411371237458,"#6C1668"],[0.70568561872909696,"#6A1668"],[0.70903010033444824,"#691568"],[0.71237458193979941,"#681568"],[0.71571906354515058,"#661568"],[0.71906354515050164,"#651468"],[0.72240802675585281,"#641468"],[0.72575250836120397,"#621368"],[0.72909698996655525,"#611368"],[0.73244147157190642,"#601268"],[0.73578595317725759,"#5E1268"],[0.73913043478260876,"#5D1168"],[0.74247491638795993,"#5C1168"],[0.74581939799331098,"#5A1068"],[0.74916387959866215,"#591068"],[0.75250836120401343,"#571068"],[0.7558528428093646,"#560F68"],[0.75919732441471577,"#540F68"],[0.76254180602006694,"#530E68"],[0.76588628762541811,"#520E68"],[0.76923076923076927,"#500D68"],[0.77257525083612033,"#4F0D68"],[0.77591973244147161,"#4D0D68"],[0.77926421404682278,"#4C0C68"],[0.78260869565217395,"#4A0C68"],[0.78595317725752512,"#490C68"],[0.78929765886287628,"#470B68"],[0.79264214046822745,"#460B68"],[0.79598662207357862,"#440A68"],[0.79933110367892979,"#420A68"],[0.80267558528428096,"#410A67"],[0.80602006688963213,"#400B65"],[0.80936454849498329,"#3F0B63"],[0.81270903010033446,"#3E0B61"],[0.81605351170568563,"#3D0C60"],[0.8193979933110368,"#3C0C5E"],[0.82274247491638808,"#3B0C5C"],[0.82608695652173914,"#3A0C5A"],[0.8294314381270903,"#390D59"],[0.83277591973244147,"#380D57"],[0.83612040133779264,"#370D55"],[0.83946488294314381,"#360D54"],[0.84280936454849498,"#350D52"],[0.84615384615384626,"#340D50"],[0.84949832775919742,"#330D4F"],[0.85284280936454848,"#320E4D"],[0.85618729096989965,"#320E4B"],[0.85953177257525082,"#310E4A"],[0.86287625418060199,"#300E48"],[0.86622073578595316,"#2F0E46"],[0.86956521739130443,"#2E0E45"],[0.8729096989966556,"#2D0E43"],[0.87625418060200677,"#2C0E41"],[0.87959866220735783,"#2B0E40"],[0.882943143812709,"#2A0E3E"],[0.88628762541806017,"#290E3D"],[0.88963210702341133,"#280E3B"],[0.89297658862876261,"#270E39"],[0.89632107023411378,"#260E38"],[0.89966555183946495,"#250E36"],[0.90301003344481612,"#240E35"],[0.90635451505016718,"#230E33"],[0.90969899665551834,"#220E32"],[0.91304347826086951,"#210D30"],[0.91638795986622079,"#200D2E"],[0.91973244147157196,"#1F0D2D"],[0.92307692307692313,"#1F0D2B"],[0.9264214046822743,"#1E0C2A"],[0.92976588628762546,"#1D0C28"],[0.93311036789297652,"#1C0C27"],[0.93645484949832769,"#1B0B25"],[0.93979933110367897,"#1A0B24"],[0.94314381270903014,"#1A0A23"],[0.94648829431438131,"#190921"],[0.94983277591973247,"#180920"],[0.95317725752508364,"#17081E"],[0.95652173913043481,"#16081D"],[0.95986622073578587,"#15071B"],[0.96321070234113715,"#14061A"],[0.96655518394648832,"#130619"],[0.96989966555183948,"#110517"],[0.97324414715719065,"#100516"],[0.97658862876254182,"#0E0414"],[0.97993311036789299,"#0C0312"],[0.98327759197324416,"#0A0310"],[0.98662207357859544,"#08020E"],[0.98996655518394649,"#06020C"],[0.99331103678929766,"#040109"],[0.99665551839464883,"#020107"],[1,"#000004"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":23.039999999999996,"title":"Message Count","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205},"tickmode":"array","ticktext":["4","8","12","16"],"tickvals":[0.20100000000000001,0.46677777777777774,0.73255555555555552,0.99833333333333329],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":41.238688252386886,"r":6.6417600664176026,"b":40.934205989380594,"l":94.977168949771681},"font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205},"title":{"text":"Half-Hourly Heatmap of Radio Communications by Day","font":{"color":"rgba(0,0,0,1)","family":"","size":15.940224159402241},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[7.4249999999999998,14.574999999999999],"tickmode":"array","ticktext":["07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30"],"tickvals":[7.5,8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14,14.5],"categoryorder":"array","categoryarray":["07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.3208800332088013,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Time of Day","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,14.6],"tickmode":"array","ticktext":["14/10/2040 (Sun)","13/10/2040 (Sat)","12/10/2040 (Fri)","11/10/2040 (Thu)","10/10/2040 (Wed)","09/10/2040 (Tue)","08/10/2040 (Mon)","07/10/2040 (Sun)","06/10/2040 (Sat)","05/10/2040 (Fri)","04/10/2040 (Thu)","03/10/2040 (Wed)","02/10/2040 (Tue)","01/10/2040 (Mon)"],"tickvals":[1,2,3,3.9999999999999996,5,6,7,7.9999999999999991,9,10,11,12,13,14],"categoryorder":"array","categoryarray":["14/10/2040 (Sun)","13/10/2040 (Sat)","12/10/2040 (Fri)","11/10/2040 (Thu)","10/10/2040 (Wed)","09/10/2040 (Tue)","08/10/2040 (Mon)","07/10/2040 (Sun)","06/10/2040 (Sat)","05/10/2040 (Fri)","04/10/2040 (Thu)","03/10/2040 (Wed)","02/10/2040 (Tue)","01/10/2040 (Mon)"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.3208800332088013,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":10.62681610626816},"title":{"text":"Message Count","font":{"color":"rgba(0,0,0,1)","family":"","size":13.283520132835205}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"4c6829b2edc2":{"x":{},"y":{},"fill":{},"text":{},"type":"heatmap"}},"cur_data":"4c6829b2edc2","visdat":{"4c6829b2edc2":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="c---density-plot-of-daily-half-hourly-message-volume-over-the-2-weeks-period" class="level4">
<h4 class="anchored" data-anchor-id="c---density-plot-of-daily-half-hourly-message-volume-over-the-2-weeks-period"><strong>4.4c - Density plot of Daily half-hourly message volume over the 2 weeks period:</strong></h4>
<p>The faceted density plot that shows the <strong>distribution of communication events by time of day</strong>, broken down for each day in the dataset. It helps to visually detect <strong>temporal communication patterns</strong>, intensity, and consistency over multiple days.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Overview of the 2 week period</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Day 1 - 01/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Day 2 - 02/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Day 3 - 03/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Day 4 - 04/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Day 5 - 05/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Day 6 - 06/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Day 7 - 07/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-9" role="tab" aria-controls="tabset-1-9" aria-selected="false">Day 8 - 08/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-10" role="tab" aria-controls="tabset-1-10" aria-selected="false">Day 9 - 09/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-11" role="tab" aria-controls="tabset-1-11" aria-selected="false">Day 10 - 10/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-12" role="tab" aria-controls="tabset-1-12" aria-selected="false">Day 11 - 11/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-13" role="tab" aria-controls="tabset-1-13" aria-selected="false">Day 12 - 12/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-14" role="tab" aria-controls="tabset-1-14" aria-selected="false">Day 13 - 13/10/2040</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-15-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-15" role="tab" aria-controls="tabset-1-15" aria-selected="false">Day 14 - 14/10/2040</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Preprocess communication events</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>comm_events <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_label =</span> <span class="fu">format</span>(timestamp, <span class="st">"%d/%m/%Y (%a)"</span>),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(timestamp),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">minute =</span> <span class="fu">minute</span>(timestamp),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_bin =</span> hour <span class="sc">+</span> <span class="fu">ifelse</span>(minute <span class="sc">&lt;</span> <span class="dv">30</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Summarise daily medians and counts</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>daily_stats <span class="ot">&lt;-</span> comm_events <span class="sc">%&gt;%</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date_label) <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">median_time =</span> <span class="fu">median</span>(time_bin),</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">msg_count =</span> <span class="fu">n</span>(),</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Plot</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comm_events, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> daily_stats, <span class="fu">aes</span>(<span class="at">xintercept =</span> median_time),</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> daily_stats,</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total:"</span>, msg_count)),</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey20"</span>,</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="dv">1</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> date_label, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cn">NULL</span>  <span class="co"># suppress all x-axis labels</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Daily Communication Patterns (Half-Hourly)"</span>,</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"01/10/2040 (Mon)"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"02/10/2040 (Tue)"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"03/10/2040 (Wed)"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"04/10/2040 (Thu)"</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"05/10/2040 (Fri)"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"06/10/2040 (Sat)"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"07/10/2040 (Sun)"</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-9-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"08/10/2040 (Mon)"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-10-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"09/10/2040 (Tue)"</span>)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-11-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"10/10/2040 (Wed)"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-12-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"11/10/2040 (Thu)"</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb53-52"><a href="#cb53-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb53-53"><a href="#cb53-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-13-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"12/10/2040 (Fri)"</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-14-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"13/10/2040 (Sat)"</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb55-55"><a href="#cb55-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-15" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-15-tab">
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for selected date</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>daily_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(comm_events, date_label <span class="sc">==</span> <span class="st">"14/10/2040 (Sun)"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Build density data to find full curve</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>density_data <span class="ot">&lt;-</span> <span class="fu">ggplot_build</span>(</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>()</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)<span class="sc">$</span>data[[<span class="dv">1</span>]]</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify peaks within ±10% of the maximum density</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>max_y <span class="ot">&lt;-</span> <span class="fu">max</span>(density_data<span class="sc">$</span>y)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>peak_threshold <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">*</span> max_y</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>major_peaks <span class="ot">&lt;-</span> density_data <span class="sc">%&gt;%</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(y <span class="sc">&gt;=</span> peak_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">grp =</span> <span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">diff</span>(x) <span class="sc">&gt;</span> <span class="fl">0.5</span>))) <span class="sc">%&gt;%</span>  <span class="co"># group close bins</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_time =</span> x[<span class="fu">which.max</span>(y)],</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">peak_density =</span> <span class="fu">max</span>(y),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"Peak: %02d:%02d"</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">floor</span>(peak_time),</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(peak_time <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Message count</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>msg_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(daily_data)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Final plot</span></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_data, <span class="fu">aes</span>(<span class="at">x =</span> time_bin)) <span class="sc">+</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> major_peaks, <span class="fu">aes</span>(<span class="at">xintercept =</span> peak_time),</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> major_peaks,</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> peak_time, <span class="at">y =</span> <span class="fl">0.23</span>, <span class="at">label =</span> label),</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">20.5</span>, <span class="at">y =</span> <span class="fl">0.25</span>,</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Total messages communicated:"</span>, msg_count),</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"grey30"</span>) <span class="sc">+</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Half-Hourly Communication Density (Multiple Peaks Highlighted)"</span>,</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day"</span>,</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">23.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, <span class="fu">floor</span>(x), <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>📈 <strong>Insights This Visualization Offers</strong></p>
</section>
</section>
<section id="step-3-plot-combined-hourly-and-half-hourly-communication-volume" class="level3">
<h3 class="anchored" data-anchor-id="step-3-plot-combined-hourly-and-half-hourly-communication-volume">Step 3: Plot Combined Hourly and Half-hourly Communication Volume</h3>
<p><strong>Bar Plot of combined hourly message volume over the 2 weeks period:</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>comm_hourly <span class="ot">&lt;-</span> comm_events <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(hour) <span class="sc">%&gt;%</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour_label =</span> <span class="fu">sprintf</span>(<span class="st">"%02d:00"</span>, hour),  <span class="co"># Format to hh:mm</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">percent =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comm_hourly, <span class="fu">aes</span>(<span class="at">x =</span> hour_label, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">percent</span>(percent, <span class="at">accuracy =</span> <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> <span class="dv">3</span>,</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"y"</span>,</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Overall Hourly Communication Volume"</span>,</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day (hh:mm)"</span>,</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Message Count"</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Bar Plot of combined half-hourly message volume in the 2 weeks period.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>comm_events <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(timestamp),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">minute =</span> <span class="fu">minute</span>(timestamp),</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">time_bin =</span> <span class="fu">sprintf</span>(<span class="st">"%02d:%02d"</span>, hour, <span class="fu">ifelse</span>(minute <span class="sc">&lt;</span> <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">30</span>))</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>comm_halfhour <span class="ot">&lt;-</span> comm_events <span class="sc">%&gt;%</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(time_bin) <span class="sc">%&gt;%</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(comm_halfhour, <span class="fu">aes</span>(<span class="at">x =</span> time_bin, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(n, <span class="st">" ("</span>, <span class="fu">percent</span>(percent, <span class="at">accuracy =</span> <span class="dv">1</span>), <span class="st">")"</span>)),</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">nudge_y =</span> <span class="dv">3</span>,</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"y"</span>,</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Overall Half-Hourly Communication Volume"</span>,</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Time of Day (hh:mm)"</span>,</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Message Count"</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1a. What are the identifiable daily temporal patterns in communications?
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>The daily communication volume fluctuates slightly between 34 and 49 messages, with an average of approximately 42 messages per day, highlighting a stable overall activity level. Notably, the highest volume occurs on 11th October (49 messages), immediately following the lowest volume the day before on 10th October (34 messages)—a sharp rebound that may signal a response to specific events or operational needs. Despite these fluctuations, the system maintains a consistent tempo across the two weeks.</p></li>
<li><p>The temporal analysis using both the heat map and time series plots reveals a pronounced morning-centric communication rhythm. The vast majority of radio traffic is concentrated between 9:00 AM and 11:30 AM, with the most intense peaks typically occurring between 10:00 and 11:00 AM. With reference to the Density plot of Daily half-hourly message volume, of the 14 days, we see message density peaks at 10:30 AM on 9 days, while on 3 days, it peaks at 12:30 PM.</p></li>
<li><p>For instance if we were to based in on the hourly plot, 5th October (Fri) and 11th October (Thu) both register their highest single-hour counts at 10:00 AM at 24 and 21 messages respectively. Communication activity drops off steeply after lunchtime, with more than 90% of the days showing little to no activity after 2:30 PM. This pattern suggests a highly structured daily workflow, where key decisions and coordination are front-loaded in the day. Importantly, the hourly heat map also indicates that this routine holds across both weekdays and weekends—communication volumes and peak hours remain similar, underlining the operational regularity of the group regardless of the day of week.</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1b. How do these patterns shift over the two weeks of observations?
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Over the two-week period, while the timing and structure of communication peaks remain broadly consistent, there are subtle shifts in both intensity and timing. Some days, such as 3rd, 5th, 11th and 12th October, see particularly high spikes in the mid-morning, which may correspond to critical events, decision points, or heightened urgency. The sharp dip on October 8th and 13th, immediately after a period of “surge” (3rd - 7th and 9th to 12th October), points to possible responses to interruptions, lulls, or triggering incidents. Overall, although the daily messaging routine is remarkably stable, these bursts and brief lulls provide clues to changing circumstances or stress points in the operation—an analytical signal that warrants closer inspection of event logs or external triggers for those dates.</p></li>
<li><p>Another notable change in the communication pattern is observed during the weekends. In the first week, weekend communication peaks occurred earlier, typically between 10:00 AM and 11:30 AM, closely mirroring the weekday rhythm. However, in the second week, the weekend peaks shifted noticeably later, with the highest message volumes concentrated around 12:00 PM and 1:00 PM. This shift not only marks a departure from the otherwise stable early-morning communication structure but also suggests an adaptive or reactive operational schedule—potentially in response to evolving events, increased coordination needs, or changing priorities as the observation period progressed. The contrast between the two weekends is clear in the heatmap, underscoring the importance of monitoring such shifts as possible indicators of underlying changes in group behavior or external pressures.</p></li>
</ol>
</div>
</div>
</section>
</section>
<section id="task-1c-focus-on-a-particular-entity---nadia-conti" class="level2">
<h2 class="anchored" data-anchor-id="task-1c-focus-on-a-particular-entity---nadia-conti">5 - Task 1c: Focus on a Particular Entity - “Nadia Conti”</h2>
</section>
<section id="vast-challenge-task-question-1c" class="level2">
<h2 class="anchored" data-anchor-id="vast-challenge-task-question-1c">VAST Challenge Task &amp; Question 1c</h2>
<p>Clepper found that messages frequently came in at around the same time each day.</p>
<ol type="1">
<li>Focus on a specific entity and use this information to determine who has influence over them.</li>
</ol>
<section id="data-preparation-for-nadia-conti-influence-analysis" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation-for-nadia-conti-influence-analysis">5.1 <strong>-</strong> Data Preparation for “Nadia Conti” Influence Analysis</h3>
<p>We first extracted the relevant communication edges from the dataset, pairing “sent” and “received” communication events to form entity-to-entity links. We retained only those edges where both nodes represent real-world entities (Person, Organization, Vessel, Group, or Location), ensuring that our analysis focuses on the meaningful actors in the Oceanus network.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract sent and received communication event edges</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sent_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">source_entity =</span> from_id, <span class="at">event =</span> to_id)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>received_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">event =</span> from_id, <span class="at">target_entity =</span> to_id)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pair sent and received to form communication edges</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>paired_edges <span class="ot">&lt;-</span> sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(received_edges, <span class="at">by =</span> <span class="st">"event"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> source_entity, <span class="at">to =</span> target_entity)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add unmatched sent and received edges (optional, for completeness)</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>single_sent_edges <span class="ot">&lt;-</span> sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> source_entity, <span class="at">to =</span> event)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>single_received_edges <span class="ot">&lt;-</span> received_edges <span class="sc">%&gt;%</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> event, <span class="at">to =</span> target_entity)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>all_edges <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(paired_edges, single_sent_edges, single_received_edges) <span class="sc">%&gt;%</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify entity nodes (Person, Organization, Vessel, Group, Location)</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>entity_ids <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Organization"</span>, <span class="st">"Vessel"</span>, <span class="st">"Group"</span>, <span class="st">"Location"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id) <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>entity_edges <span class="ot">&lt;-</span> all_edges <span class="sc">%&gt;%</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.character</span>(from) <span class="sc">%in%</span> entity_ids, <span class="fu">as.character</span>(to) <span class="sc">%in%</span> entity_ids)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>entity_nodes <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Organization"</span>, <span class="st">"Vessel"</span>, <span class="st">"Group"</span>, <span class="st">"Location"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, sub_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="build-the-global-network-and-compute-centrality" class="level3">
<h3 class="anchored" data-anchor-id="build-the-global-network-and-compute-centrality">5.2 <strong>-</strong> Build the Global Network and Compute Centrality</h3>
<p>Using these cleaned and filtered edges and nodes, we built a global directed graph representing the Oceanus community. We then computed key network centrality metrics for each node—PageRank, betweenness, and degree—quantifying the influence and connectivity of every entity in the overall network.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(<span class="at">d =</span> entity_edges, <span class="at">vertices =</span> entity_nodes, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute centralities</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>pagerank <span class="ot">&lt;-</span> <span class="fu">page_rank</span>(g)<span class="sc">$</span>vector</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>betweenness <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(g)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>degree <span class="ot">&lt;-</span> <span class="fu">degree</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="extract-nadia-conti-ego-network-2-hop-neighbourhood" class="level3">
<h3 class="anchored" data-anchor-id="extract-nadia-conti-ego-network-2-hop-neighbourhood">5.3 <strong>-</strong> Extract “Nadia Conti” Ego Network (2-hop Neighbourhood)</h3>
<p>Focusing on “Nadia Conti”, we identified her node and extracted her two-step ego network, capturing both direct and indirect connections within the broader network. This local subgraph reveals Nadia’s immediate sphere of influence and the key players connected to her.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>nadia_label <span class="ot">&lt;-</span> <span class="st">"Nadia Conti"</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>target_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g)<span class="sc">$</span>label <span class="sc">==</span> nadia_label)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>ego_graph <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(g, <span class="at">order =</span> <span class="dv">2</span>, <span class="at">nodes =</span> target_index, <span class="at">mode =</span> <span class="st">"all"</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-nadia-contis-ego-network-interactive" class="level3">
<h3 class="anchored" data-anchor-id="visualize-nadia-contis-ego-network-interactive">5.4 <strong>-</strong> Visualize Nadia Conti’s Ego Network (Interactive)</h3>
<p>We visualized Nadia’s ego network using node size, shape, and color to represent centrality and entity type. We also summarized centrality metrics in clear tables, ranking all ego network members by PageRank, Betweenness, and Degree. This allows for direct identification of the most influential, best-connected, and most strategic actors in Nadia Conti’s communication environment.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>nodes_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>name,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>label,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type,</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"&lt;b&gt;"</span>, <span class="fu">V</span>(ego_graph)<span class="sc">$</span>label, <span class="st">"&lt;/b&gt;&lt;br&gt;"</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Degree: "</span>, <span class="fu">round</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>degree, <span class="dv">2</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Betweenness: "</span>, <span class="fu">round</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>betweenness, <span class="dv">2</span>), <span class="st">"&lt;br&gt;"</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"PageRank: "</span>, <span class="fu">round</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>pagerank, <span class="dv">4</span>)),</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"dot"</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Organization"</span>, <span class="st">"square"</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="st">"triangle"</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Group"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>)))),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>pagerank <span class="sc">*</span> <span class="dv">30</span> <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>edges_df <span class="ot">&lt;-</span> <span class="fu">as_data_frame</span>(ego_graph, <span class="at">what =</span> <span class="st">"edges"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> from, <span class="at">to =</span> to)</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_df, edges_df, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"700px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">scaling =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">30</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="fu">list</span>(<span class="at">to =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">scaleFactor =</span> <span class="fl">0.3</span>)),</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"gray"</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">manipulation =</span> <span class="cn">FALSE</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">dragNodes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">dragView =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">zoomView =</span> <span class="cn">FALSE</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-07f780420729b276a227" style="width:100%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-07f780420729b276a227">{"x":{"nodes":{"id":["Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","The Lookout","Mrs. Money","The Middleman","Boss","Small Fry","Glitters Team","Oceanus City Council","Green Guardians","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Northern Light","Remora","Knowles","City Officials","Paackland Harbor","Haacklee Harbor","Himark Harbor"],"label":["Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","The Lookout","Mrs. Money","The Middleman","Boss","Small Fry","Glitters Team","Oceanus City Council","Green Guardians","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Northern Light","Remora","Knowles","City Officials","Paackland Harbor","Haacklee Harbor","Himark Harbor"],"group":["Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Organization","Organization","Organization","Organization","Organization","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Group","Location","Location","Location"],"title":["<b>Nadia Conti<\/b><br>Degree: 17<br>Betweenness: 117.87<br>PageRank: 0.0432","<b>Elise<\/b><br>Degree: 7<br>Betweenness: 4.6<br>PageRank: 0.0182","<b>Liam Thorne<\/b><br>Degree: 11<br>Betweenness: 41.81<br>PageRank: 0.0275","<b>Samantha Blake<\/b><br>Degree: 6<br>Betweenness: 4.49<br>PageRank: 0.0114","<b>Davis<\/b><br>Degree: 16<br>Betweenness: 22.36<br>PageRank: 0.0239","<b>Rodriguez<\/b><br>Degree: 10<br>Betweenness: 11.75<br>PageRank: 0.0122","<b>The Lookout<\/b><br>Degree: 7<br>Betweenness: 80.51<br>PageRank: 0.0062","<b>Mrs. Money<\/b><br>Degree: 12<br>Betweenness: 167.18<br>PageRank: 0.0192","<b>The Middleman<\/b><br>Degree: 8<br>Betweenness: 50.78<br>PageRank: 0.0142","<b>Boss<\/b><br>Degree: 13<br>Betweenness: 136.18<br>PageRank: 0.0272","<b>Small Fry<\/b><br>Degree: 3<br>Betweenness: 0<br>PageRank: 0.0035","<b>Glitters Team<\/b><br>Degree: 4<br>Betweenness: 0<br>PageRank: 0.0035","<b>Oceanus City Council<\/b><br>Degree: 28<br>Betweenness: 116.11<br>PageRank: 0.053","<b>Green Guardians<\/b><br>Degree: 17<br>Betweenness: 27.51<br>PageRank: 0.0224","<b>V. Miesel Shipping<\/b><br>Degree: 19<br>Betweenness: 118.7<br>PageRank: 0.0394","<b>Sailor Shifts Team<\/b><br>Degree: 7<br>Betweenness: 7.34<br>PageRank: 0.0186","<b>Neptune<\/b><br>Degree: 19<br>Betweenness: 82.59<br>PageRank: 0.0358","<b>Marlin<\/b><br>Degree: 10<br>Betweenness: 6.23<br>PageRank: 0.0235","<b>Serenity<\/b><br>Degree: 8<br>Betweenness: 0.81<br>PageRank: 0.017","<b>Mako<\/b><br>Degree: 37<br>Betweenness: 368.5<br>PageRank: 0.0687","<b>Reef Guardian<\/b><br>Degree: 27<br>Betweenness: 139.69<br>PageRank: 0.0454","<b>Horizon<\/b><br>Degree: 12<br>Betweenness: 6.72<br>PageRank: 0.0152","<b>Seawatch<\/b><br>Degree: 9<br>Betweenness: 5.2<br>PageRank: 0.0186","<b>EcoVigil<\/b><br>Degree: 13<br>Betweenness: 12.63<br>PageRank: 0.0233","<b>Sentinel<\/b><br>Degree: 16<br>Betweenness: 34.54<br>PageRank: 0.025","<b>Osprey<\/b><br>Degree: 3<br>Betweenness: 0<br>PageRank: 0.0088","<b>Northern Light<\/b><br>Degree: 8<br>Betweenness: 9.76<br>PageRank: 0.0135","<b>Remora<\/b><br>Degree: 21<br>Betweenness: 90.45<br>PageRank: 0.0409","<b>Knowles<\/b><br>Degree: 4<br>Betweenness: 0.5<br>PageRank: 0.0051","<b>City Officials<\/b><br>Degree: 1<br>Betweenness: 0<br>PageRank: 0.0066","<b>Paackland Harbor<\/b><br>Degree: 13<br>Betweenness: 27.08<br>PageRank: 0.0244","<b>Haacklee Harbor<\/b><br>Degree: 8<br>Betweenness: 41.3<br>PageRank: 0.0111","<b>Himark Harbor<\/b><br>Degree: 17<br>Betweenness: 52.61<br>PageRank: 0.0358"],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","star","diamond","diamond","diamond"],"value":[6.297086192940655,5.546984707878168,5.823674979714352,5.341903080060789,5.716727137412613,5.366531631035691,5.185823180115518,5.576625657577807,5.425218713427389,5.81696334194335,5.10587587464601,5.10587587464601,6.591393301385012,5.67208459997379,6.181213807960264,5.558266091317103,6.072999645744769,5.706400561681756,5.509799015300089,7.060723635120745,6.362444376099885,5.456949706479425,5.55667408305798,5.697659310767588,5.750152656749608,5.26252595678532,5.403713654078533,6.225537098067166,5.153050013669531,5.197080844534316,5.73335062064582,5.33299392251897,6.074440716571868]},"edges":{"from":["Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Elise","Elise","Elise","Liam Thorne","Liam Thorne","Liam Thorne","Liam Thorne","Liam Thorne","Samantha Blake","Samantha Blake","Samantha Blake","Davis","Davis","Davis","Davis","Davis","Davis","Davis","Davis","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","The Lookout","The Lookout","The Lookout","The Lookout","Mrs. Money","Mrs. Money","Mrs. Money","Mrs. Money","Mrs. Money","Mrs. Money","The Middleman","The Middleman","The Middleman","The Middleman","Boss","Boss","Boss","Boss","Small Fry","Small Fry","Small Fry","Glitters Team","Glitters Team","Glitters Team","Glitters Team","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Green Guardians","Green Guardians","Green Guardians","Green Guardians","Green Guardians","Green Guardians","Green Guardians","Green Guardians","Green Guardians","Green Guardians","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","Sailor Shifts Team","Sailor Shifts Team","Neptune","Neptune","Neptune","Neptune","Neptune","Neptune","Neptune","Neptune","Neptune","Neptune","Marlin","Marlin","Marlin","Marlin","Marlin","Serenity","Serenity","Serenity","Serenity","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Horizon","Horizon","Horizon","Horizon","Horizon","Horizon","Horizon","Seawatch","Seawatch","Seawatch","EcoVigil","EcoVigil","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Sentinel","Sentinel","Sentinel","Sentinel","Sentinel","Sentinel","Sentinel","Sentinel","Osprey","Northern Light","Northern Light","Northern Light","Northern Light","Remora","Remora","Remora","Remora","Remora","Remora","Remora","Remora","Remora","Knowles","Knowles","Knowles","Paackland Harbor","Paackland Harbor","Paackland Harbor","Paackland Harbor","Paackland Harbor","Paackland Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor"],"to":["Liam Thorne","Oceanus City Council","V. Miesel Shipping","Neptune","Marlin","Haacklee Harbor","Nadia Conti","Liam Thorne","V. Miesel Shipping","Nadia Conti","Elise","Boss","Oceanus City Council","EcoVigil","Oceanus City Council","Sailor Shifts Team","Mako","Nadia Conti","Davis","Boss","V. Miesel Shipping","Neptune","Mako","Remora","Himark Harbor","Nadia Conti","Davis","Rodriguez","Mrs. Money","Boss","Sailor Shifts Team","Remora","Green Guardians","Reef Guardian","Horizon","Sentinel","The Middleman","Boss","V. Miesel Shipping","Neptune","Mako","Remora","Liam Thorne","Mrs. Money","Boss","Paackland Harbor","Mrs. Money","The Middleman","V. Miesel Shipping","Mako","Davis","Mako","Remora","Samantha Blake","Boss","Northern Light","Remora","Nadia Conti","Liam Thorne","Samantha Blake","Oceanus City Council","Green Guardians","Marlin","Mako","Reef Guardian","EcoVigil","Sentinel","Northern Light","Paackland Harbor","Himark Harbor","Oceanus City Council","Green Guardians","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Northern Light","Paackland Harbor","Nadia Conti","Elise","Davis","Rodriguez","Mrs. Money","Boss","V. Miesel Shipping","Neptune","Mako","Remora","Nadia Conti","Remora","Nadia Conti","Elise","Davis","V. Miesel Shipping","Serenity","Mako","Reef Guardian","Remora","City Officials","Himark Harbor","Oceanus City Council","Mako","Reef Guardian","Remora","Himark Harbor","Neptune","Mako","Reef Guardian","Himark Harbor","Elise","Samantha Blake","Davis","Boss","Oceanus City Council","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Serenity","Reef Guardian","Sentinel","Osprey","Remora","Paackland Harbor","Himark Harbor","Oceanus City Council","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Paackland Harbor","Oceanus City Council","Green Guardians","Mako","Reef Guardian","Seawatch","EcoVigil","Sentinel","Green Guardians","Reef Guardian","Himark Harbor","Liam Thorne","Oceanus City Council","Reef Guardian","Horizon","EcoVigil","Sentinel","Nadia Conti","Oceanus City Council","Green Guardians","Mako","Reef Guardian","Horizon","Seawatch","Paackland Harbor","Mako","Oceanus City Council","Green Guardians","Sailor Shifts Team","Himark Harbor","Nadia Conti","Davis","Rodriguez","V. Miesel Shipping","Sailor Shifts Team","Neptune","Mako","Paackland Harbor","Himark Harbor","Davis","Mako","Haacklee Harbor","Liam Thorne","Oceanus City Council","Mako","Reef Guardian","Sentinel","Remora","Nadia Conti","Oceanus City Council","Mako","EcoVigil","Osprey","Knowles","Oceanus City Council","Neptune","Marlin","Serenity","Mako","Seawatch","Northern Light","Remora"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","scaling":{"min":5,"max":30}},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":0.3}},"color":{"color":"gray"}},"interaction":{"dragNodes":false,"dragView":false,"zoomView":false,"zoomSpeed":1},"layout":{"randomSeed":1818}},"groups":["Person","Organization","Vessel","Group","Location"],"width":"100%","height":"700px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","opts_manipulation":{"datacss":"table.legend_table {\n  font-size: 11px;\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n}\ntable.legend_table td {\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n  padding: 2px;\n}\ndiv.table_content {\n  width:80px;\n  text-align:center;\n}\ndiv.table_description {\n  width:100px;\n}\n\n.operation {\n  font-size:20px;\n}\n\n.network-popUp {\n  display:none;\n  z-index:299;\n  width:250px;\n  /*height:150px;*/\n  background-color: #f9f9f9;\n  border-style:solid;\n  border-width:1px;\n  border-color: #0d0d0d;\n  padding:10px;\n  text-align: center;\n  position:fixed;\n  top:50%;  \n  left:50%;  \n  margin:-100px 0 0 -100px;  \n\n}","addNodeCols":["id","label"],"editNodeCols":["id","label"],"tab_add_node":"<span id=\"addnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"addnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"addnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"addnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"addnode-cancelButton\"><\/button>","tab_edit_node":"<span id=\"editnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"editnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"editnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"editnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"editnode-cancelButton\"><\/button>"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="global-and-ego-network-structure" class="level2">
<h2 class="anchored" data-anchor-id="global-and-ego-network-structure">Global and Ego-Network Structure</h2>
<p>The overview network visualization reveals that <strong>Nadia Conti</strong> is centrally embedded in the Oceanus communication web, maintaining direct and indirect connections with major actors such as Neptune (Vessel), V. Miesel Shipping (Organization), Elise (Person), and others. The use of color and shape coding in the network allows for quick identification of the different types of entities in Nadia’s influence neighborhood.</p>
<section id="centrality-tables-for-nadias-ego-network" class="level3">
<h3 class="anchored" data-anchor-id="centrality-tables-for-nadias-ego-network">5.5 <strong>-</strong> Centrality Tables for Nadia’s Ego Network</h3>
<p>On both the global and Nadia-focused ego networks, we computed standard network centrality metrics for all nodes:</p>
<ul>
<li><strong>PageRank</strong> (overall influence),</li>
<li><strong>Betweenness</strong> (information brokerage/intermediary role), and</li>
<li><strong>Degree</strong> (number of direct connections).</li>
</ul>
<p>These measures quantify the importance and structural roles of each entity relative to Nadia and the broader community.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PageRank table</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>pagerank_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>label,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_type =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pagerank =</span> <span class="fu">round</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>pagerank, <span class="dv">4</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(pagerank))</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Betweenness table</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>betweenness_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>label,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_type =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">betweenness =</span> <span class="fu">round</span>(<span class="fu">V</span>(ego_graph)<span class="sc">$</span>betweenness, <span class="dv">2</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(betweenness))</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Degree table</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>degree_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>label,</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_type =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>sub_type,</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">degree =</span> <span class="fu">V</span>(ego_graph)<span class="sc">$</span>degree</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(degree))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pagerank_df, <span class="at">caption =</span> <span class="st">"PageRank Centrality (Nadia's Ego Network)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>PageRank Centrality (Nadia’s Ego Network)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">label</th>
<th style="text-align: left;">sub_type</th>
<th style="text-align: right;">pagerank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0687</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceanus City Council</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">0.0530</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reef Guardian</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0454</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nadia Conti</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0432</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Remora</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0409</td>
</tr>
<tr class="even">
<td style="text-align: left;">V. Miesel Shipping</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">0.0394</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neptune</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0358</td>
</tr>
<tr class="even">
<td style="text-align: left;">Himark Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">0.0358</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Liam Thorne</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0275</td>
</tr>
<tr class="even">
<td style="text-align: left;">Boss</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0272</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sentinel</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0250</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paackland Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">0.0244</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davis</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0239</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marlin</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0235</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EcoVigil</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0233</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green Guardians</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">0.0224</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mrs.&nbsp;Money</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0192</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sailor Shifts Team</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">0.0186</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Seawatch</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0186</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elise</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0182</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Serenity</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0170</td>
</tr>
<tr class="even">
<td style="text-align: left;">Horizon</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0152</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Middleman</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0142</td>
</tr>
<tr class="even">
<td style="text-align: left;">Northern Light</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rodriguez</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0122</td>
</tr>
<tr class="even">
<td style="text-align: left;">Samantha Blake</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0114</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Haacklee Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">0.0111</td>
</tr>
<tr class="even">
<td style="text-align: left;">Osprey</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0088</td>
</tr>
<tr class="odd">
<td style="text-align: left;">City Officials</td>
<td style="text-align: left;">Group</td>
<td style="text-align: right;">0.0066</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Lookout</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0062</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Knowles</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.0051</td>
</tr>
<tr class="even">
<td style="text-align: left;">Small Fry</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.0035</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Glitters Team</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">0.0035</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(betweenness_df, <span class="at">caption =</span> <span class="st">"Betweenness Centrality (Nadia's Ego Network)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Betweenness Centrality (Nadia’s Ego Network)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">label</th>
<th style="text-align: left;">sub_type</th>
<th style="text-align: right;">betweenness</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">368.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mrs.&nbsp;Money</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">167.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reef Guardian</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">139.69</td>
</tr>
<tr class="even">
<td style="text-align: left;">Boss</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">136.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V. Miesel Shipping</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">118.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nadia Conti</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">117.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oceanus City Council</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">116.11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Remora</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">90.45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Neptune</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">82.59</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Lookout</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">80.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Himark Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">52.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Middleman</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">50.78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Liam Thorne</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">41.81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Haacklee Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">41.30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sentinel</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">34.54</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green Guardians</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">27.51</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paackland Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">27.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davis</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">22.36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EcoVigil</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">12.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rodriguez</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">11.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Northern Light</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">9.76</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sailor Shifts Team</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">7.34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Horizon</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">6.72</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marlin</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">6.23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Seawatch</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">5.20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Elise</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">4.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Samantha Blake</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">4.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Serenity</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Knowles</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Small Fry</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Glitters Team</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Osprey</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">City Officials</td>
<td style="text-align: left;">Group</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(degree_df, <span class="at">caption =</span> <span class="st">"Degree Centrality (Nadia's Ego Network)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Degree Centrality (Nadia’s Ego Network)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">label</th>
<th style="text-align: left;">sub_type</th>
<th style="text-align: right;">degree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mako</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oceanus City Council</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reef Guardian</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Remora</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">V. Miesel Shipping</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Neptune</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nadia Conti</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green Guardians</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Himark Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davis</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sentinel</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Boss</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">EcoVigil</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Paackland Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mrs.&nbsp;Money</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Horizon</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Liam Thorne</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rodriguez</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Marlin</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Seawatch</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">The Middleman</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Serenity</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Northern Light</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Haacklee Harbor</td>
<td style="text-align: left;">Location</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Elise</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">The Lookout</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sailor Shifts Team</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Samantha Blake</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Glitters Team</td>
<td style="text-align: left;">Organization</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Knowles</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Small Fry</td>
<td style="text-align: left;">Person</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Osprey</td>
<td style="text-align: left;">Vessel</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">City Officials</td>
<td style="text-align: left;">Group</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="centrality-metrics-and-direct-indirect-influences" class="level2">
<h2 class="anchored" data-anchor-id="centrality-metrics-and-direct-indirect-influences">Centrality Metrics and Direct &amp; Indirect Influences</h2>
<p>By calculating centrality metrics within Nadia’s two-hop ego network, we observe that the most influential nodes in her environment—by PageRank, betweenness, and degree—are Neptune, V. Miesel Shipping, and Elise. Nadia herself consistently ranks among the top nodes by these measures, highlighting her role as both an influencer and an information bridge. Entities such as Neptune and V. Miesel Shipping, which also score highly in centrality, exert considerable influence over Nadia’s information flow and access to other parts of the network.</p>
<p>Degree centrality analysis shows Nadia maintains multiple direct connections, particularly with other highly active nodes, ensuring she is closely linked to key hubs in the network. Betweenness centrality further reveals that Nadia is not only well-connected but also acts as an important intermediary, facilitating communication between otherwise distant parts of the network. PageRank confirms that her immediate environment is composed of actors with significant structural power, increasing the likelihood that Nadia is both influenced by, and exerts influence upon, the most pivotal players in Oceanus.</p>
<section id="pagerank-for-nadia-conti" class="level4">
<h4 class="anchored" data-anchor-id="pagerank-for-nadia-conti"><strong>5.5.1 - PageRank for Nadia Conti</strong></h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Build the global network g as in your earlier code (using your entity_nodes/entity_edges) --</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">d =</span> entity_edges, </span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertices =</span> entity_nodes, </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Get Nadia's index in g --</span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>nadia_label <span class="ot">&lt;-</span> <span class="st">"Nadia Conti"</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>target_index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">V</span>(g)<span class="sc">$</span>label <span class="sc">==</span> nadia_label)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Extract Nadia's 1-hop ego network (all direct neighbors) --</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>ego_1 <span class="ot">&lt;-</span> <span class="fu">make_ego_graph</span>(g, <span class="at">order =</span> <span class="dv">1</span>, <span class="at">nodes =</span> target_index, <span class="at">mode =</span> <span class="st">"all"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Compute PageRank for the ego network</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(ego_1)<span class="sc">$</span>pagerank <span class="ot">&lt;-</span> <span class="fu">page_rank</span>(ego_1)<span class="sc">$</span>vector</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Prepare node data frame with your consistent color scheme</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>nodes_df_pagerank <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>name,</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>label,</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type,</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"&lt;b&gt;"</span>, <span class="fu">V</span>(ego_1)<span class="sc">$</span>label, <span class="st">"&lt;/b&gt;&lt;br&gt;PageRank: "</span>, <span class="fu">round</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>pagerank, <span class="dv">4</span>)),</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"dot"</span>,</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Organization"</span>, <span class="st">"square"</span>,</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="st">"triangle"</span>,</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Group"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>)))),</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"#25e158"</span>,</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#ec4bff"</span>,</span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>pagerank <span class="sc">*</span> <span class="dv">30</span> <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Prepare edges</span></span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a>edges_df <span class="ot">&lt;-</span> <span class="fu">as_data_frame</span>(ego_1, <span class="at">what =</span> <span class="st">"edges"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> from, <span class="at">to =</span> to)</span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Plot with visNetwork</span></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_df_pagerank, edges_df, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">30</span>),</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> nodes_df_pagerank<span class="sc">$</span>color, <span class="at">border =</span> <span class="st">"black"</span>),</span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> nodes_df_pagerank<span class="sc">$</span>shape</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="fu">list</span>(<span class="at">to =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">scaleFactor =</span> <span class="fl">0.3</span>)), <span class="at">color =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"gray"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>, <span class="at">manipulation =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">FALSE</span>, <span class="at">zoomView =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-63757eb28fcba0ee35bf" style="width:100%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-63757eb28fcba0ee35bf">{"x":{"nodes":{"id":["Nadia Conti","Elise","Liam Thorne","Davis","Rodriguez","Oceanus City Council","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Sentinel","Remora","Haacklee Harbor"],"label":["Nadia Conti","Elise","Liam Thorne","Davis","Rodriguez","Oceanus City Council","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Sentinel","Remora","Haacklee Harbor"],"group":["Person","Person","Person","Person","Person","Organization","Organization","Organization","Vessel","Vessel","Vessel","Vessel","Location"],"title":["<b>Nadia Conti<\/b><br>PageRank: 0.1756","<b>Elise<\/b><br>PageRank: 0.0584","<b>Liam Thorne<\/b><br>PageRank: 0.0762","<b>Davis<\/b><br>PageRank: 0.0699","<b>Rodriguez<\/b><br>PageRank: 0.0454","<b>Oceanus City Council<\/b><br>PageRank: 0.1369","<b>V. Miesel Shipping<\/b><br>PageRank: 0.1036","<b>Sailor Shifts Team<\/b><br>PageRank: 0.0328","<b>Neptune<\/b><br>PageRank: 0.0744","<b>Marlin<\/b><br>PageRank: 0.0597","<b>Sentinel<\/b><br>PageRank: 0.0348","<b>Remora<\/b><br>PageRank: 0.0957","<b>Haacklee Harbor<\/b><br>PageRank: 0.0364"],"shape":["dot","dot","dot","dot","dot","square","square","square","triangle","triangle","triangle","triangle","diamond"],"color":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#ec4bff"],"value":[10.26749522602823,6.751361277911808,7.286950987596573,7.098397194652232,6.361990315726688,9.107938954982632,8.109306360074374,5.984431686289086,7.233407975498029,6.790731958854893,6.044503468500894,7.87110225737672,6.092382336507845]},"edges":{"from":["Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Elise","Elise","Elise","Liam Thorne","Liam Thorne","Liam Thorne","Davis","Davis","Davis","Davis","Davis","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","Sailor Shifts Team","Sailor Shifts Team","Neptune","Neptune","Neptune","Neptune","Neptune","Marlin","Marlin","Sentinel","Sentinel","Remora","Remora","Remora","Remora","Remora","Remora","Haacklee Harbor","Haacklee Harbor"],"to":["Liam Thorne","Oceanus City Council","V. Miesel Shipping","Neptune","Marlin","Haacklee Harbor","Nadia Conti","Liam Thorne","V. Miesel Shipping","Nadia Conti","Elise","Oceanus City Council","Nadia Conti","Davis","V. Miesel Shipping","Neptune","Remora","Nadia Conti","Davis","Rodriguez","Sailor Shifts Team","Remora","Nadia Conti","Liam Thorne","Oceanus City Council","Marlin","Sentinel","Nadia Conti","Elise","Davis","Rodriguez","V. Miesel Shipping","Neptune","Remora","Nadia Conti","Remora","Nadia Conti","Elise","Davis","V. Miesel Shipping","Remora","Oceanus City Council","Remora","Nadia Conti","Oceanus City Council","Nadia Conti","Davis","Rodriguez","V. Miesel Shipping","Sailor Shifts Team","Neptune","Nadia Conti","Oceanus City Council"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":["dot","dot","dot","dot","dot","square","square","square","triangle","triangle","triangle","triangle","diamond"],"color":{"background":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#ec4bff"],"border":"black"},"scaling":{"min":5,"max":30}},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":0.3}},"color":{"color":"gray"}},"interaction":{"dragNodes":false,"dragView":false,"zoomView":false,"zoomSpeed":1},"layout":{"randomSeed":1818}},"groups":["Person","Organization","Vessel","Location"],"width":"100%","height":"400px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","opts_manipulation":{"datacss":"table.legend_table {\n  font-size: 11px;\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n}\ntable.legend_table td {\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n  padding: 2px;\n}\ndiv.table_content {\n  width:80px;\n  text-align:center;\n}\ndiv.table_description {\n  width:100px;\n}\n\n.operation {\n  font-size:20px;\n}\n\n.network-popUp {\n  display:none;\n  z-index:299;\n  width:250px;\n  /*height:150px;*/\n  background-color: #f9f9f9;\n  border-style:solid;\n  border-width:1px;\n  border-color: #0d0d0d;\n  padding:10px;\n  text-align: center;\n  position:fixed;\n  top:50%;  \n  left:50%;  \n  margin:-100px 0 0 -100px;  \n\n}","addNodeCols":["id","label"],"editNodeCols":["id","label"],"tab_add_node":"<span id=\"addnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"addnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"addnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"addnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"addnode-cancelButton\"><\/button>","tab_edit_node":"<span id=\"editnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"editnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"editnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"editnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"editnode-cancelButton\"><\/button>"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="betweenness-for-nadia-conti" class="level4">
<h4 class="anchored" data-anchor-id="betweenness-for-nadia-conti"><strong>5.5.2 - Betweenness for Nadia Conti</strong></h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Compute Betweenness for the ego network</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(ego_1)<span class="sc">$</span>betweenness <span class="ot">&lt;-</span> <span class="fu">betweenness</span>(ego_1, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Prepare node data frame</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>nodes_df_betweenness <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>name,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>label,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"&lt;b&gt;"</span>, <span class="fu">V</span>(ego_1)<span class="sc">$</span>label, <span class="st">"&lt;/b&gt;&lt;br&gt;Betweenness: "</span>, <span class="fu">round</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>betweenness, <span class="dv">2</span>)),</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"dot"</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Organization"</span>, <span class="st">"square"</span>,</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="st">"triangle"</span>,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Group"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>)))),</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"#25e158"</span>,</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#ec4bff"</span>,</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>betweenness <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Edges (same as before)</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="co"># edges_df already prepared</span></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Plot</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_df_betweenness, edges_df, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">30</span>),</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> nodes_df_betweenness<span class="sc">$</span>color, <span class="at">border =</span> <span class="st">"black"</span>),</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> nodes_df_betweenness<span class="sc">$</span>shape</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="fu">list</span>(<span class="at">to =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">scaleFactor =</span> <span class="fl">0.3</span>)), <span class="at">color =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"gray"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>, <span class="at">manipulation =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">FALSE</span>, <span class="at">zoomView =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-f900fe473d2d8ec593cf" style="width:100%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-f900fe473d2d8ec593cf">{"x":{"nodes":{"id":["Nadia Conti","Elise","Liam Thorne","Davis","Rodriguez","Oceanus City Council","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Sentinel","Remora","Haacklee Harbor"],"label":["Nadia Conti","Elise","Liam Thorne","Davis","Rodriguez","Oceanus City Council","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Sentinel","Remora","Haacklee Harbor"],"group":["Person","Person","Person","Person","Person","Organization","Organization","Organization","Vessel","Vessel","Vessel","Vessel","Location"],"title":["<b>Nadia Conti<\/b><br>Betweenness: 61.3","<b>Elise<\/b><br>Betweenness: 2.82","<b>Liam Thorne<\/b><br>Betweenness: 4.01","<b>Davis<\/b><br>Betweenness: 0.95","<b>Rodriguez<\/b><br>Betweenness: 1.94","<b>Oceanus City Council<\/b><br>Betweenness: 17.58","<b>V. Miesel Shipping<\/b><br>Betweenness: 18.6","<b>Sailor Shifts Team<\/b><br>Betweenness: 0","<b>Neptune<\/b><br>Betweenness: 6.99","<b>Marlin<\/b><br>Betweenness: 5.9","<b>Sentinel<\/b><br>Betweenness: 0","<b>Remora<\/b><br>Betweenness: 19.92","<b>Haacklee Harbor<\/b><br>Betweenness: 0"],"shape":["dot","dot","dot","dot","dot","square","square","square","triangle","triangle","triangle","triangle","diamond"],"color":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#ec4bff"],"value":[127.6,10.63809523809524,13.01904761904762,6.904761904761905,8.87142857142857,40.15238095238095,42.2,5,18.97619047619047,16.8047619047619,5,44.83333333333334,5]},"edges":{"from":["Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Elise","Elise","Elise","Liam Thorne","Liam Thorne","Liam Thorne","Davis","Davis","Davis","Davis","Davis","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","Sailor Shifts Team","Sailor Shifts Team","Neptune","Neptune","Neptune","Neptune","Neptune","Marlin","Marlin","Sentinel","Sentinel","Remora","Remora","Remora","Remora","Remora","Remora","Haacklee Harbor","Haacklee Harbor"],"to":["Liam Thorne","Oceanus City Council","V. Miesel Shipping","Neptune","Marlin","Haacklee Harbor","Nadia Conti","Liam Thorne","V. Miesel Shipping","Nadia Conti","Elise","Oceanus City Council","Nadia Conti","Davis","V. Miesel Shipping","Neptune","Remora","Nadia Conti","Davis","Rodriguez","Sailor Shifts Team","Remora","Nadia Conti","Liam Thorne","Oceanus City Council","Marlin","Sentinel","Nadia Conti","Elise","Davis","Rodriguez","V. Miesel Shipping","Neptune","Remora","Nadia Conti","Remora","Nadia Conti","Elise","Davis","V. Miesel Shipping","Remora","Oceanus City Council","Remora","Nadia Conti","Oceanus City Council","Nadia Conti","Davis","Rodriguez","V. Miesel Shipping","Sailor Shifts Team","Neptune","Nadia Conti","Oceanus City Council"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":["dot","dot","dot","dot","dot","square","square","square","triangle","triangle","triangle","triangle","diamond"],"color":{"background":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#ec4bff"],"border":"black"},"scaling":{"min":5,"max":30}},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":0.3}},"color":{"color":"gray"}},"interaction":{"dragNodes":false,"dragView":false,"zoomView":false,"zoomSpeed":1},"layout":{"randomSeed":1818}},"groups":["Person","Organization","Vessel","Location"],"width":"100%","height":"400px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","opts_manipulation":{"datacss":"table.legend_table {\n  font-size: 11px;\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n}\ntable.legend_table td {\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n  padding: 2px;\n}\ndiv.table_content {\n  width:80px;\n  text-align:center;\n}\ndiv.table_description {\n  width:100px;\n}\n\n.operation {\n  font-size:20px;\n}\n\n.network-popUp {\n  display:none;\n  z-index:299;\n  width:250px;\n  /*height:150px;*/\n  background-color: #f9f9f9;\n  border-style:solid;\n  border-width:1px;\n  border-color: #0d0d0d;\n  padding:10px;\n  text-align: center;\n  position:fixed;\n  top:50%;  \n  left:50%;  \n  margin:-100px 0 0 -100px;  \n\n}","addNodeCols":["id","label"],"editNodeCols":["id","label"],"tab_add_node":"<span id=\"addnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"addnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"addnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"addnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"addnode-cancelButton\"><\/button>","tab_edit_node":"<span id=\"editnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"editnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"editnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"editnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"editnode-cancelButton\"><\/button>"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="degree-for-nadia-conti" class="level4">
<h4 class="anchored" data-anchor-id="degree-for-nadia-conti"><strong>5.5.3 - Degree for Nadia Conti</strong></h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Compute Degree for the ego network</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(ego_1)<span class="sc">$</span>degree <span class="ot">&lt;-</span> <span class="fu">degree</span>(ego_1, <span class="at">mode =</span> <span class="st">"all"</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Prepare node data frame</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>nodes_df_degree <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>name,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>label,</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type,</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"&lt;b&gt;"</span>, <span class="fu">V</span>(ego_1)<span class="sc">$</span>label, <span class="st">"&lt;/b&gt;&lt;br&gt;Degree: "</span>, <span class="fu">round</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>degree, <span class="dv">2</span>)),</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Person"</span>, <span class="st">"dot"</span>,</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Organization"</span>, <span class="st">"square"</span>,</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Vessel"</span>, <span class="st">"triangle"</span>,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(<span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Group"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>)))),</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"#25e158"</span>,</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">V</span>(ego_1)<span class="sc">$</span>sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#ec4bff"</span>,</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">V</span>(ego_1)<span class="sc">$</span>degree <span class="sc">*</span> <span class="dv">5</span> <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Edges (same as before)</span></span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="co"># edges_df already prepared</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Plot</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_df_degree, edges_df, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"400px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">scaling =</span> <span class="fu">list</span>(<span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">30</span>),</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">list</span>(<span class="at">background =</span> nodes_df_degree<span class="sc">$</span>color, <span class="at">border =</span> <span class="st">"black"</span>),</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> nodes_df_degree<span class="sc">$</span>shape</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="fu">list</span>(<span class="at">to =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">scaleFactor =</span> <span class="fl">0.3</span>)), <span class="at">color =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"gray"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>, <span class="at">manipulation =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">FALSE</span>, <span class="at">zoomView =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-ea113c1c0c75f6a36624" style="width:100%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-ea113c1c0c75f6a36624">{"x":{"nodes":{"id":["Nadia Conti","Elise","Liam Thorne","Davis","Rodriguez","Oceanus City Council","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Sentinel","Remora","Haacklee Harbor"],"label":["Nadia Conti","Elise","Liam Thorne","Davis","Rodriguez","Oceanus City Council","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Sentinel","Remora","Haacklee Harbor"],"group":["Person","Person","Person","Person","Person","Organization","Organization","Organization","Vessel","Vessel","Vessel","Vessel","Location"],"title":["<b>Nadia Conti<\/b><br>Degree: 17","<b>Elise<\/b><br>Degree: 6","<b>Liam Thorne<\/b><br>Degree: 6","<b>Davis<\/b><br>Degree: 10","<b>Rodriguez<\/b><br>Degree: 8","<b>Oceanus City Council<\/b><br>Degree: 11","<b>V. Miesel Shipping<\/b><br>Degree: 13","<b>Sailor Shifts Team<\/b><br>Degree: 4","<b>Neptune<\/b><br>Degree: 9","<b>Marlin<\/b><br>Degree: 4","<b>Sentinel<\/b><br>Degree: 3","<b>Remora<\/b><br>Degree: 12","<b>Haacklee Harbor<\/b><br>Degree: 3"],"shape":["dot","dot","dot","dot","dot","square","square","square","triangle","triangle","triangle","triangle","diamond"],"color":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#ec4bff"],"value":[90,35,35,55,45,60,70,25,50,25,20,65,20]},"edges":{"from":["Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Elise","Elise","Elise","Liam Thorne","Liam Thorne","Liam Thorne","Davis","Davis","Davis","Davis","Davis","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","Sailor Shifts Team","Sailor Shifts Team","Neptune","Neptune","Neptune","Neptune","Neptune","Marlin","Marlin","Sentinel","Sentinel","Remora","Remora","Remora","Remora","Remora","Remora","Haacklee Harbor","Haacklee Harbor"],"to":["Liam Thorne","Oceanus City Council","V. Miesel Shipping","Neptune","Marlin","Haacklee Harbor","Nadia Conti","Liam Thorne","V. Miesel Shipping","Nadia Conti","Elise","Oceanus City Council","Nadia Conti","Davis","V. Miesel Shipping","Neptune","Remora","Nadia Conti","Davis","Rodriguez","Sailor Shifts Team","Remora","Nadia Conti","Liam Thorne","Oceanus City Council","Marlin","Sentinel","Nadia Conti","Elise","Davis","Rodriguez","V. Miesel Shipping","Neptune","Remora","Nadia Conti","Remora","Nadia Conti","Elise","Davis","V. Miesel Shipping","Remora","Oceanus City Council","Remora","Nadia Conti","Oceanus City Council","Nadia Conti","Davis","Rodriguez","V. Miesel Shipping","Sailor Shifts Team","Neptune","Nadia Conti","Oceanus City Council"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":["dot","dot","dot","dot","dot","square","square","square","triangle","triangle","triangle","triangle","diamond"],"color":{"background":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#ec4bff"],"border":"black"},"scaling":{"min":5,"max":30}},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":0.3}},"color":{"color":"gray"}},"interaction":{"dragNodes":false,"dragView":false,"zoomView":false,"zoomSpeed":1},"layout":{"randomSeed":1818}},"groups":["Person","Organization","Vessel","Location"],"width":"100%","height":"400px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","opts_manipulation":{"datacss":"table.legend_table {\n  font-size: 11px;\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n}\ntable.legend_table td {\n  border-width:1px;\n  border-color:#d3d3d3;\n  border-style:solid;\n  padding: 2px;\n}\ndiv.table_content {\n  width:80px;\n  text-align:center;\n}\ndiv.table_description {\n  width:100px;\n}\n\n.operation {\n  font-size:20px;\n}\n\n.network-popUp {\n  display:none;\n  z-index:299;\n  width:250px;\n  /*height:150px;*/\n  background-color: #f9f9f9;\n  border-style:solid;\n  border-width:1px;\n  border-color: #0d0d0d;\n  padding:10px;\n  text-align: center;\n  position:fixed;\n  top:50%;  \n  left:50%;  \n  margin:-100px 0 0 -100px;  \n\n}","addNodeCols":["id","label"],"editNodeCols":["id","label"],"tab_add_node":"<span id=\"addnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"addnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"addnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"addnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"addnode-cancelButton\"><\/button>","tab_edit_node":"<span id=\"editnode-operation\" class = \"operation\">node<\/span> <br><table style=\"margin:auto;\"><tr><td>id<\/td><td><input id=\"editnode-id\"  type= \"text\" value=\"new value\"><\/td><\/tr><tr><td>label<\/td><td><input id=\"editnode-label\"  type= \"text\" value=\"new value\"><\/td><\/tr><\/table><input type=\"button\" value=\"save\" id=\"editnode-saveButton\"><\/button><input type=\"button\" value=\"cancel\" id=\"editnode-cancelButton\"><\/button>"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
1c. With a focus on “Nadia Conti”, the visuals above could determine who has influence over this person.
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Degree centrality reveals that Nadia Conti is well-connected within her local network, with a degree of 17. However, she is not the most connected node; vessels such as Mako (37), Reef Guardian (27), and Remora (21), as well as organizations like Oceanus City Council (28) and V. Miesel Shipping (19), have even higher degrees. This indicates that while Nadia is an important hub, her sphere of direct interaction is embedded within a dense mesh of other highly connected entities.</p></li>
<li><p>Several other individuals (e.g., Davis with 16, Boss with 13, Mrs.&nbsp;Money with 12) and vessels (e.g., Neptune with 19, Sentinel with 16) also play significant roles in Nadia’s network. The presence of organizations (e.g., Green Guardians, Sailor Shifts Team), multiple vessels, and key persons shows that <strong>Nadia’s environment is both diverse and robust</strong>.</p></li>
<li><p><strong>Direct Connections</strong></p>
<p>These direct connections are clearly shown as nodes that have edges (arrows) going into or out of Nadia Conti’s node in the network diagrams. Nadia Conti directly connects to several core entities across different types:</p>
<ul>
<li><strong>People:</strong> Elise, Liam Thorne, Davis, Rodriguez</li>
<li><strong>Organization:</strong> V. Miesel Shipping, Oceanus City Council, Sailor Shifts Team</li>
<li><strong>Vessel:</strong> Neptune, Marlin, Remora, Sentinel</li>
<li><strong>Location:</strong> Haacklee Harbor</li>
</ul>
<p><strong>Interpretation:</strong> The PageRank, Betweenness, and Degree centrality plots all consistently show <strong>Nadia Conti as a major hub</strong>, with a large node size reflecting her high centrality. Her immediate network includes influential vessels (Neptune, Remora), organizations (V. Miesel Shipping, Oceanus City Council), and several persons (Elise, Davis, Rodriguez).</p>
<p>Nadia’s position suggests she is a <strong>key connector and influencer</strong> but is herself surrounded by even larger hubs, particularly among vessels and organizations. Her ability to influence—and be influenced—is amplified by these connections, as these high-degree entities are likely sources and conduits of critical information and operational coordination. This structure points to a tightly interwoven community, where central actors such as Mako, Oceanus City Council, and V. Miesel Shipping may exert the most substantial influence over Nadia’s access to information, resources, and strategic decisions.</p></li>
</ol>
</div>
</div>
</section>
</section>
</section>
<section id="task-4a-4b" class="level1">
<h1>5. Task 4a &amp; 4b</h1>
<ol type="1">
<li><p>Clepper suspects that Nadia Conti, who was formerly entangled in an illegal fishing scheme, may have continued illicit activity within Oceanus.</p>
<ol type="1">
<li><p>Through visual analytics, provide evidence that Nadia is, or is not, doing something illegal.</p></li>
<li><p>Summarize Nadia’s actions visually. Are Clepper’s suspicions justified?</p></li>
</ol></li>
</ol>
<section id="extracting-nadias-data" class="level2">
<h2 class="anchored" data-anchor-id="extracting-nadias-data">5.1 Extracting Nadia’s data</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="ot">&lt;-</span> MC3<span class="sc">$</span>nodes</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>edges <span class="ot">&lt;-</span> MC3<span class="sc">$</span>edges</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract communication events</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>comms <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, content)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Link to sender &amp; receiver</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>sent_edges <span class="ot">&lt;-</span> edges <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">source =</span> source, <span class="at">comm_id =</span> target)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>recv_edges <span class="ot">&lt;-</span> edges <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">comm_id =</span> source, <span class="at">target =</span> target)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>comms_data <span class="ot">&lt;-</span> comms <span class="sc">%&gt;%</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sent_edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"comm_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(recv_edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"comm_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver =</span> target)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add sender/receiver names</span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>comms_data <span class="ot">&lt;-</span> comms_data <span class="sc">%&gt;%</span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">sender_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">receiver_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Count Nadia's messages</span></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>nadia_counts <span class="ot">&lt;-</span> comms_data <span class="sc">%&gt;%</span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sent =</span> <span class="fu">sum</span>(sender_label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">Received =</span> <span class="fu">sum</span>(receiver_label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Type"</span>, <span class="at">values_to =</span> <span class="st">"Count"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">Percent =</span> Count <span class="sc">/</span> <span class="fu">sum</span>(Count),</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">Label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percent <span class="sc">*</span> <span class="dv">100</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">("</span>, Count, <span class="st">" msgs)"</span>)</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="message-count-of-nadia" class="level2">
<h2 class="anchored" data-anchor-id="message-count-of-nadia">5.2 Message count of Nadia</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nadia_counts, <span class="fu">aes</span>(<span class="at">x =</span> Count, <span class="at">y =</span> <span class="fu">reorder</span>(Type, Count), <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Count, <span class="st">" msgs ("</span>, <span class="fu">round</span>(Percent <span class="sc">*</span> <span class="dv">100</span>), <span class="st">"%)"</span>)),</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Sent"</span> <span class="ot">=</span> <span class="st">"deepskyblue3"</span>, <span class="st">"Received"</span> <span class="ot">=</span> <span class="st">"cyan"</span>)) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Nadia Conti's Messages (Total: "</span>, <span class="fu">sum</span>(nadia_counts<span class="sc">$</span>Count), <span class="st">")"</span>),</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Message Count"</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">max</span>(nadia_counts<span class="sc">$</span>Count) <span class="sc">*</span> <span class="fl">1.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="message-frequency-of-nadia" class="level2">
<h2 class="anchored" data-anchor-id="message-frequency-of-nadia">5.3 Message frequency of Nadia</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure nadia_data is created</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>nadia_data <span class="ot">&lt;-</span> comms_data <span class="sc">%&gt;%</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sender_label <span class="sc">==</span> <span class="st">"Nadia Conti"</span> <span class="sc">|</span> receiver_label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nodes <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, timestamp), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(timestamp), <span class="at">hour =</span> <span class="fu">hour</span>(timestamp))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create daily_freq</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>daily_freq <span class="ot">&lt;-</span> nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create hourly_freq</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>hourly_freq <span class="ot">&lt;-</span> nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date, hour) <span class="sc">%&gt;%</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="daily" class="level3">
<h3 class="anchored" data-anchor-id="daily">5.3.1 Daily</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(daily_freq, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> count), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nadia Conti's Daily Message Frequency"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Date"</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Message Count"</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hourly" class="level3">
<h3 class="anchored" data-anchor-id="hourly">5.3.2 Hourly</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> hourly_freq,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>hour,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>count,</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span><span class="fu">as.factor</span>(date),</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'bar'</span>,</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Date:"</span>, date, <span class="st">"&lt;br&gt;Hour:"</span>, hour, <span class="st">"&lt;br&gt;Messages:"</span>, count),</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">barmode =</span> <span class="st">'dodge'</span>,  <span class="co"># use 'stack' if you prefer stacked bars</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nadia Conti's Hourly Message Frequency"</span>,</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Hour of Day"</span>),</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Message Count"</span>),</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Date"</span>))</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-fb0049c35f2d9758a8d6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-fb0049c35f2d9758a8d6">{"x":{"visdat":{"4c685911b07c":["function () ","plotlyVisDat"]},"cur_data":"4c685911b07c","attrs":{"4c685911b07c":{"x":{},"y":{},"text":{},"hoverinfo":"text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"barmode":"dodge","title":"Nadia Conti's Hourly Message Frequency","xaxis":{"domain":[0,1],"automargin":true,"title":"Hour of Day"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Message Count"},"legend":{"title":{"text":"Date"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[9],"y":[4],"text":"Date: 2040-10-05 <br>Hour: 9 <br>Messages: 4","hoverinfo":"text","type":"bar","name":"2040-10-05","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[11,12],"y":[1,1],"text":["Date: 2040-10-07 <br>Hour: 11 <br>Messages: 1","Date: 2040-10-07 <br>Hour: 12 <br>Messages: 1"],"hoverinfo":["text","text"],"type":"bar","name":"2040-10-07","marker":{"color":"rgba(239,150,106,1)","line":{"color":"rgba(239,150,106,1)"}},"textfont":{"color":"rgba(239,150,106,1)"},"error_y":{"color":"rgba(239,150,106,1)"},"error_x":{"color":"rgba(239,150,106,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8,11],"y":[6,3],"text":["Date: 2040-10-08 <br>Hour: 8 <br>Messages: 6","Date: 2040-10-08 <br>Hour: 11 <br>Messages: 3"],"hoverinfo":["text","text"],"type":"bar","name":"2040-10-08","marker":{"color":"rgba(178,156,177,1)","line":{"color":"rgba(178,156,177,1)"}},"textfont":{"color":"rgba(178,156,177,1)"},"error_y":{"color":"rgba(178,156,177,1)"},"error_x":{"color":"rgba(178,156,177,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8],"y":[1],"text":"Date: 2040-10-09 <br>Hour: 8 <br>Messages: 1","hoverinfo":"text","type":"bar","name":"2040-10-09","marker":{"color":"rgba(201,148,198,1)","line":{"color":"rgba(201,148,198,1)"}},"textfont":{"color":"rgba(201,148,198,1)"},"error_y":{"color":"rgba(201,148,198,1)"},"error_x":{"color":"rgba(201,148,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[10,12],"y":[1,1],"text":["Date: 2040-10-10 <br>Hour: 10 <br>Messages: 1","Date: 2040-10-10 <br>Hour: 12 <br>Messages: 1"],"hoverinfo":["text","text"],"type":"bar","name":"2040-10-10","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[9],"y":[1],"text":"Date: 2040-10-11 <br>Hour: 9 <br>Messages: 1","hoverinfo":"text","type":"bar","name":"2040-10-11","marker":{"color":"rgba(202,217,72,1)","line":{"color":"rgba(202,217,72,1)"}},"textfont":{"color":"rgba(202,217,72,1)"},"error_y":{"color":"rgba(202,217,72,1)"},"error_x":{"color":"rgba(202,217,72,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8,9,11],"y":[1,1,3],"text":["Date: 2040-10-12 <br>Hour: 8 <br>Messages: 1","Date: 2040-10-12 <br>Hour: 9 <br>Messages: 1","Date: 2040-10-12 <br>Hour: 11 <br>Messages: 3"],"hoverinfo":["text","text","text"],"type":"bar","name":"2040-10-12","marker":{"color":"rgba(250,212,80,1)","line":{"color":"rgba(250,212,80,1)"}},"textfont":{"color":"rgba(250,212,80,1)"},"error_y":{"color":"rgba(250,212,80,1)"},"error_x":{"color":"rgba(250,212,80,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8],"y":[1],"text":"Date: 2040-10-13 <br>Hour: 8 <br>Messages: 1","hoverinfo":"text","type":"bar","name":"2040-10-13","marker":{"color":"rgba(223,194,152,1)","line":{"color":"rgba(223,194,152,1)"}},"textfont":{"color":"rgba(223,194,152,1)"},"error_y":{"color":"rgba(223,194,152,1)"},"error_x":{"color":"rgba(223,194,152,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[8],"y":[1],"text":"Date: 2040-10-14 <br>Hour: 8 <br>Messages: 1","hoverinfo":"text","type":"bar","name":"2040-10-14","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="nadias-relationship-pattern" class="level2">
<h2 class="anchored" data-anchor-id="nadias-relationship-pattern">5.4 Nadia’s relationship pattern</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Count relationships by type</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>relationship_counts <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">!=</span> <span class="st">"sent"</span>, type <span class="sc">!=</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Focus on relationships, not communication</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(type, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise Nadia's communication edges</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>nadia_edges <span class="ot">&lt;-</span> nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_label, receiver_label) <span class="sc">%&gt;%</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sender_label), <span class="sc">!</span><span class="fu">is.na</span>(receiver_label)) <span class="sc">%&gt;%</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> sender_label, <span class="at">to =</span> receiver_label, <span class="at">value =</span> n)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get sender + receiver entity info</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Get type info for sender and receiver</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>entity_info <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">name =</span> label, <span class="at">type =</span> sub_type),</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(name, type),</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">name =</span> label, <span class="at">type =</span> sub_type),</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(name, type)</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Build node table</span></span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>nadia_nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">unique</span>(<span class="fu">c</span>(nadia_edges<span class="sc">$</span>from, nadia_edges<span class="sc">$</span>to))) <span class="sc">%&gt;%</span></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(entity_info, <span class="at">by =</span> <span class="st">"name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>, <span class="st">"Nadia Conti"</span>, type),</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> name,</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> name,</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#fc8d62"</span>,       </span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#6baed6"</span>,</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#66c2a2"</span>,      </span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#c6dbef"</span>,    </span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Nadia Conti"</span> <span class="sc">~</span> <span class="st">"#ffd92f"</span>, </span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"#d9d9d9"</span></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">case_when</span>(</span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"dot"</span>,</span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"square"</span>,</span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"triangle"</span>,</span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"diamond"</span>,</span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>      group <span class="sc">==</span> <span class="st">"Nadia Conti"</span> <span class="sc">~</span> <span class="st">"star"</span>,</span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"dot"</span></span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Render network</span></span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(<span class="at">nodes =</span> nadia_nodes, <span class="at">edges =</span> nadia_edges) <span class="sc">%&gt;%</span></span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-53"><a href="#cb76-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-54"><a href="#cb76-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(</span>
<span id="cb76-55"><a href="#cb76-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">solver =</span> <span class="st">"forceAtlas2Based"</span>,</span>
<span id="cb76-56"><a href="#cb76-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">forceAtlas2Based =</span> <span class="fu">list</span>(<span class="at">gravitationalConstant =</span> <span class="sc">-</span><span class="dv">25</span>, <span class="at">centralGravity =</span> <span class="fl">0.01</span>, <span class="at">springLength =</span> <span class="dv">50</span>, <span class="at">springConstant =</span> <span class="fl">0.02</span>),</span>
<span id="cb76-57"><a href="#cb76-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">stabilization =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">iterations =</span> <span class="dv">100</span>)</span>
<span id="cb76-58"><a href="#cb76-58" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb76-59"><a href="#cb76-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb76-60"><a href="#cb76-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb76-61"><a href="#cb76-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span>,</span>
<span id="cb76-62"><a href="#cb76-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">list</span>(</span>
<span id="cb76-63"><a href="#cb76-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Person"</span>, <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">color =</span> <span class="st">"#fc8d62"</span>),</span>
<span id="cb76-64"><a href="#cb76-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Organization"</span>, <span class="at">shape =</span> <span class="st">"square"</span>, <span class="at">color =</span> <span class="st">"#6baed6"</span>),</span>
<span id="cb76-65"><a href="#cb76-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Vessel"</span>, <span class="at">shape =</span> <span class="st">"triangle"</span>, <span class="at">color =</span> <span class="st">"#66c2a2"</span>),</span>
<span id="cb76-66"><a href="#cb76-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Location"</span>, <span class="at">shape =</span> <span class="st">"diamond"</span>, <span class="at">color =</span> <span class="st">"#c6dbef"</span>),</span>
<span id="cb76-67"><a href="#cb76-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Nadia Conti"</span>, <span class="at">shape =</span> <span class="st">"star"</span>, <span class="at">color =</span> <span class="st">"#ffd92f"</span>)</span>
<span id="cb76-68"><a href="#cb76-68" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb76-69"><a href="#cb76-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.2</span>,</span>
<span id="cb76-70"><a href="#cb76-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="st">"left"</span>,</span>
<span id="cb76-71"><a href="#cb76-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">stepY =</span> <span class="dv">80</span>,</span>
<span id="cb76-72"><a href="#cb76-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">1</span></span>
<span id="cb76-73"><a href="#cb76-73" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-73bc3e0dfa32fae8d75e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-73bc3e0dfa32fae8d75e">{"x":{"nodes":{"name":["Davis","Elise","Haacklee Harbor","Liam Thorne","Nadia Conti","Neptune","Oceanus City Council","Remora","Rodriguez","Sailor Shifts Team","Sentinel","V. Miesel Shipping","Marlin"],"type":["Person","Person","Location","Person","Person","Vessel","Organization","Vessel","Person","Organization","Vessel","Organization","Vessel"],"group":["Person","Person","Location","Person","Nadia Conti","Vessel","Organization","Vessel","Person","Organization","Vessel","Organization","Vessel"],"id":["Davis","Elise","Haacklee Harbor","Liam Thorne","Nadia Conti","Neptune","Oceanus City Council","Remora","Rodriguez","Sailor Shifts Team","Sentinel","V. Miesel Shipping","Marlin"],"label":["Davis","Elise","Haacklee Harbor","Liam Thorne","Nadia Conti","Neptune","Oceanus City Council","Remora","Rodriguez","Sailor Shifts Team","Sentinel","V. Miesel Shipping","Marlin"],"color":["#fc8d62","#fc8d62","#c6dbef","#fc8d62","#ffd92f","#66c2a2","#6baed6","#66c2a2","#fc8d62","#6baed6","#66c2a2","#6baed6","#66c2a2"],"shape":["dot","dot","diamond","dot","star","triangle","square","triangle","dot","square","triangle","square","triangle"]},"edges":{"from":["Davis","Elise","Haacklee Harbor","Liam Thorne","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Oceanus City Council","Remora","Rodriguez","Sailor Shifts Team","Sentinel","V. Miesel Shipping"],"to":["Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Haacklee Harbor","Liam Thorne","Marlin","Neptune","Oceanus City Council","V. Miesel Shipping","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti"],"value":[5,3,1,2,1,2,1,2,1,1,1,1,1,1,1,1,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"randomSeed":123},"physics":{"solver":"forceAtlas2Based","stabilization":{"enabled":true,"iterations":100},"forceAtlas2Based":{"gravitationalConstant":-25,"centralGravity":0.01,"springLength":50,"springConstant":0.02}},"interaction":{"navigationButtons":true,"zoomSpeed":1}},"groups":["Person","Location","Nadia Conti","Vessel","Organization"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":80,"zoom":true,"nodes":[{"label":"Person","shape":"dot","color":"#fc8d62"},{"label":"Organization","shape":"square","color":"#6baed6"},{"label":"Vessel","shape":"triangle","color":"#66c2a2"},{"label":"Location","shape":"diamond","color":"#c6dbef"},{"label":"Nadia Conti","shape":"star","color":"#ffd92f"}],"nodesToDataframe":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="nadias-most-frequent-commuter" class="level2">
<h2 class="anchored" data-anchor-id="nadias-most-frequent-commuter">5.5 Nadia’s most frequent commuter</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get communication events linked to Nadia</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>nadia_comm_ids <span class="ot">&lt;-</span> edges <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span> <span class="sc">|</span> type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">==</span> mc3_nodes_cleaned<span class="sc">$</span>id[mc3_nodes_cleaned<span class="sc">$</span>label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>] <span class="sc">|</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>         target <span class="sc">==</span> mc3_nodes_cleaned<span class="sc">$</span>id[mc3_nodes_cleaned<span class="sc">$</span>label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comm_id =</span> <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"sent"</span>, target, source)) <span class="sc">%&gt;%</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(comm_id) <span class="sc">%&gt;%</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get edges related to these communications</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>nadia_related_edges <span class="ot">&lt;-</span> edges <span class="sc">%&gt;%</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">%in%</span> nadia_comm_ids <span class="sc">|</span> target <span class="sc">%in%</span> nadia_comm_ids)</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Get people connected (excluding comm events + Nadia herself)</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>nadia_id <span class="ot">&lt;-</span> mc3_nodes_cleaned<span class="sc">$</span>id[mc3_nodes_cleaned<span class="sc">$</span>label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>]</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a>nadia_contacts_ids <span class="ot">&lt;-</span> nadia_related_edges <span class="sc">%&gt;%</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">person_id =</span> <span class="fu">ifelse</span>(source <span class="sc">%in%</span> nadia_comm_ids, target, source)) <span class="sc">%&gt;%</span></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>person_id <span class="sc">%in%</span> nadia_comm_ids, person_id <span class="sc">!=</span> nadia_id) <span class="sc">%&gt;%</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(person_id, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with node labels</span></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a>top_contacts_named <span class="ot">&lt;-</span> nadia_contacts_ids <span class="sc">%&gt;%</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nodes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sub_type <span class="sc">==</span> <span class="st">"Person"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">name =</span> label),</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"person_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>top_contacts_named <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top 3 Contacts Communicating with Nadia Conti"</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Contact Person"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Messages"</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="testing_q4_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>nadia_id <span class="ot">&lt;-</span> mc3_nodes_cleaned<span class="sc">$</span>id[mc3_nodes_cleaned<span class="sc">$</span>label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>]</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Nadia's communication event IDs</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>nadia_comm_ids <span class="ot">&lt;-</span> edges <span class="sc">%&gt;%</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span> <span class="sc">|</span> type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source <span class="sc">==</span> nadia_id <span class="sc">|</span> target <span class="sc">==</span> nadia_id) <span class="sc">%&gt;%</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comm_id =</span> <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"sent"</span>, target, source)) <span class="sc">%&gt;%</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(comm_id) <span class="sc">%&gt;%</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Top contact comm IDs</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>top_contact_comm_ids <span class="ot">&lt;-</span> edges <span class="sc">%&gt;%</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    (source <span class="sc">%in%</span> nadia_comm_ids <span class="sc">&amp;</span> target <span class="sc">%in%</span> top_contacts_named<span class="sc">$</span>person_id) <span class="sc">|</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    (target <span class="sc">%in%</span> nadia_comm_ids <span class="sc">&amp;</span> source <span class="sc">%in%</span> top_contacts_named<span class="sc">$</span>person_id)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comm_id =</span> <span class="fu">ifelse</span>(source <span class="sc">%in%</span> nadia_comm_ids, source, target)) <span class="sc">%&gt;%</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(comm_id) <span class="sc">%&gt;%</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Get comm event details</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a>nadia_messages <span class="ot">&lt;-</span> nodes <span class="sc">%&gt;%</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> top_contact_comm_ids) <span class="sc">%&gt;%</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, timestamp, content) <span class="sc">%&gt;%</span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(edges <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">id =</span> target, <span class="at">sender =</span> source),</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(edges <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="at">id =</span> source, <span class="at">receiver =</span> target),</span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">sender_name =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">receiver_name =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp),</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">sender_receiver =</span> <span class="fu">paste</span>(sender_name, <span class="st">"→"</span>, receiver_name)</span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(timestamp, sender_receiver, content)</span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a>  nadia_messages,</span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">5</span>,</span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">initComplete =</span> htmlwidgets<span class="sc">::</span><span class="fu">JS</span>(</span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">"$(this.api().table().header()).css({'background-color': '#f8f9fa', 'color': '#333'});"</span>,</span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a>      <span class="st">"}"</span></span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">'stripe hover compact'</span>,</span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left; font-size:16px; color:#444;'</span>,</span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Messages'</span></span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-5625639226de3d255a48" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5625639226de3d255a48">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-size:16px; color:#444;\">Messages<\/caption>","data":[["2040-10-07T12:00:00Z","2040-10-08T08:15:00Z","2040-10-08T08:18:00Z","2040-10-08T08:24:00Z","2040-10-08T11:21:00Z","2040-10-08T11:26:00Z","2040-10-09T08:54:00Z","2040-10-10T12:30:00Z","2040-10-11T09:20:00Z","2040-10-12T08:44:00Z","2040-10-12T09:24:00Z","2040-10-12T11:14:00Z","2040-10-13T08:21:00Z"],["Davis → Nadia Conti","Elise → Nadia Conti","Nadia Conti → Liam Thorne","Liam Thorne → Nadia Conti","Davis → Nadia Conti","Davis → Nadia Conti","Elise → Nadia Conti","Elise → Nadia Conti","Liam Thorne → Nadia Conti","Nadia Conti → Liam Thorne","Rodriguez → Nadia Conti","Davis → Nadia Conti","Davis → Nadia Conti"],["Davis, Nadia here. Let's meet at 7PM at the marina office to review documentation. I've been working with alternative channels for permits. Bring all shipping manifests - we'll need to create a clean paper trail immediately.","Nadia, Elise here. Meeting at Nemo Reef 0500 tomorrow to establish payment protocols. Sam uncovered V. Miesel shipping lanes overlapping with Mako by 40%. Neptune mentioned 'underwater foundation work' - outside our original scope. Need your assessment.","Liam, Nadia here. Need your services urgently. Investigation brewing around Nemo Reef permits. Double your usual fee if you can ensure Harbor Master remains cooperative through next week. Meet at the usual place tomorrow, 10PM.","Nadia, Liam here. Meeting confirmed for tomorrow at 10PM. I've redirected Harbor Master's attention and implemented new patrol schedules that work in our favor. Council suspects nothing about Nemo Reef. Bring payment as discussed.","Nadia, Davis here. I'll be at the marina office at 7PM with all shipping manifests. Could you bring copies of permit #CR-7844? Marlin's asking about unusual vessel routes near eastern shoals - might need to address this.","Davis, Marlin here again. Nadia mentioned you'd provide documentation about those eastern shoal diversions tonight. Just checking if that's still coming through. Need to understand these new patterns while my vessel's being repaired.","Nadia, Elise here. Situation escalating. Permanent underwater construction confirmed at Nemo Reef. Sam reports concrete forms suggesting structures beyond equipment installation. Need urgent clarification on real scope and V. Miesel's involvement before tomorrow's meeting. Prepare contingencies.","Nadia, Elise here. Meeting confirmed for 0500 at Nemo Reef. Sam's evidence shows clear V. Miesel connection to permanent structures. Conservation vessels increasing surveillance - could complicate our operation. Bring alternate financial channels in case we need quick adaptation.","Nadia, Liam here. EcoVigil is questioning the ROV delay. I've redirected them to the northern quadrant, but they're suspicious about the southwest. We need to clean up operations there immediately. What's our contingency plan?","Liam, Nadia here. Redirect all remaining operations from southwest immediately. Move equipment to our secondary location. I'll handle EcoVigil through proper channels. Meet me at the usual place at 2100 hours with updated documentation.","Rodriguez, Davis here. Maintain current position with Mako at Nemo Reef. Security team arriving at 0600. Continue operating under permit #CR-7844 and keep tourism appearance. I'll update after meeting with Nadia tonight.","Davis here to V. Miesel Shipping. Crew reallocation from Remora to Neptune underway as requested. Will maintain confidentiality regarding permit #CR-7844. Security team arrives 0600 tomorrow. Meeting Nadia tonight to finalize documentation.","Davis, Nadia here. Need you to verify final equipment transport tonight at Nemo Reef. The Middleman reports increased surveillance. Ensure all operations follow encrypted protocols. Meet me at V. Miesel HQ tomorrow at 0900 to discuss contingency plans."]],"container":"<table class=\"stripe hover compact\">\n  <thead>\n    <tr>\n      <th>timestamp<\/th>\n      <th>sender_receiver<\/th>\n      <th>content<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"autoWidth":true,"scrollX":true,"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#f8f9fa', 'color': '#333'});\n}","columnDefs":[{"name":"timestamp","targets":0},{"name":"sender_receiver","targets":1},{"name":"content","targets":2}],"order":[],"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.initComplete"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="temporal-suspicious-event-alignment" class="level2">
<h2 class="anchored" data-anchor-id="temporal-suspicious-event-alignment">5.6 Temporal + suspicious event alignment</h2>
<section id="showing-nadias-unusually-active-days" class="level3">
<h3 class="anchored" data-anchor-id="showing-nadias-unusually-active-days">5.6.1 Showing Nadia’s unusually active days</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute mean + SD of daily messages</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>daily_summary <span class="ot">&lt;-</span> daily_freq <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_count =</span> <span class="fu">mean</span>(count), <span class="at">sd_count =</span> <span class="fu">sd</span>(count))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Flag days with unusually high message counts</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>spike_days <span class="ot">&lt;-</span> daily_freq <span class="sc">%&gt;%</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&gt;</span> daily_summary<span class="sc">$</span>mean_count <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> daily_summary<span class="sc">$</span>sd_count)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show spike days</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(spike_days)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  date       count
  &lt;date&gt;     &lt;int&gt;
1 2040-10-08     9</code></pre>
</div>
</div>
</section>
<section id="suspicious-dates" class="level3">
<h3 class="anchored" data-anchor-id="suspicious-dates">5.6.2 Suspicious dates</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>suspicious_dates <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2040-10-05"</span>, <span class="st">"2040-10-08"</span>, <span class="st">"2040-10-11"</span>)) <span class="co"># example reef closure, approvals, etc.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>spike_days <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">suspicious =</span> <span class="fu">ifelse</span>(date <span class="sc">%in%</span> suspicious_dates, <span class="st">"YES"</span>, <span class="st">"NO"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  date       count suspicious
  &lt;date&gt;     &lt;int&gt; &lt;chr&gt;     
1 2040-10-08     9 YES       </code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose suspicious dates (replace with real ones)</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>suspicious_dates <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2040-10-05"</span>, <span class="st">"2040-10-08"</span>, <span class="st">"2040-10-11"</span>))</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute threshold</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>daily_summary <span class="ot">&lt;-</span> daily_freq <span class="sc">%&gt;%</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_count =</span> <span class="fu">mean</span>(count), <span class="at">sd_count =</span> <span class="fu">sd</span>(count))</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> daily_summary<span class="sc">$</span>mean_count <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> daily_summary<span class="sc">$</span>sd_count</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add status column</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>daily_freq_plot <span class="ot">&lt;-</span> daily_freq <span class="sc">%&gt;%</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">status =</span> <span class="fu">case_when</span>(</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>      date <span class="sc">%in%</span> suspicious_dates <span class="sc">~</span> <span class="st">"Suspicious Date"</span>,</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>      count <span class="sc">&gt;</span> threshold <span class="sc">~</span> <span class="st">"Spike"</span>,</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Normal"</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign colors</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>status_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Normal"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>,</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Spike"</span> <span class="ot">=</span> <span class="st">"red"</span>,</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suspicious Date"</span> <span class="ot">=</span> <span class="st">"orange"</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Build Plotly bar chart</span></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> daily_freq_plot,</span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>date,</span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>count,</span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'bar'</span>,</span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span>status,</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">colors =</span> status_colors,</span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste</span>(<span class="st">"Date:"</span>, date, <span class="st">"&lt;br&gt;Messages:"</span>, count, <span class="st">"&lt;br&gt;Status:"</span>, status),</span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">hoverinfo =</span> <span class="st">'text'</span></span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb85-41"><a href="#cb85-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb85-42"><a href="#cb85-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nadia Conti's Daily Communication"</span>,</span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Date"</span>),</span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Message Count"</span>),</span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">barmode =</span> <span class="st">'group'</span>,</span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Status"</span>))</span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(</span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>date,</span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">rep</span>(threshold, <span class="fu">nrow</span>(daily_freq_plot)),</span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">'dash'</span>, <span class="at">color =</span> <span class="st">'red'</span>),</span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">'Spike Threshold'</span>,</span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit =</span> <span class="cn">FALSE</span></span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-350cb18560fd04b79a05" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-350cb18560fd04b79a05">{"x":{"visdat":{"4c685349c3ea":["function () ","plotlyVisDat"]},"cur_data":"4c685349c3ea","attrs":{"4c685349c3ea":{"x":{},"y":{},"text":{},"hoverinfo":"text","color":{},"colors":["steelblue","red","orange"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"},"4c685349c3ea.1":{"x":{},"y":[8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247],"type":"scatter","mode":"lines","line":{"dash":"dash","color":"red"},"name":"Spike Threshold","inherit":false}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Nadia Conti's Daily Communication","xaxis":{"domain":[0,1],"automargin":true,"title":"Date"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Message Count"},"barmode":"group","legend":{"title":{"text":"Status"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2040-10-07","2040-10-09","2040-10-10","2040-10-12","2040-10-13","2040-10-14"],"y":[2,1,2,5,1,1],"text":["Date: 2040-10-07 <br>Messages: 2 <br>Status: Normal","Date: 2040-10-09 <br>Messages: 1 <br>Status: Normal","Date: 2040-10-10 <br>Messages: 2 <br>Status: Normal","Date: 2040-10-12 <br>Messages: 5 <br>Status: Normal","Date: 2040-10-13 <br>Messages: 1 <br>Status: Normal","Date: 2040-10-14 <br>Messages: 1 <br>Status: Normal"],"hoverinfo":["text","text","text","text","text","text"],"type":"bar","name":"Normal","marker":{"color":"rgba(70,130,180,1)","line":{"color":"rgba(70,130,180,1)"}},"textfont":{"color":"rgba(70,130,180,1)"},"error_y":{"color":"rgba(70,130,180,1)"},"error_x":{"color":"rgba(70,130,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2040-10-05","2040-10-08","2040-10-11"],"y":[4,9,1],"text":["Date: 2040-10-05 <br>Messages: 4 <br>Status: Suspicious Date","Date: 2040-10-08 <br>Messages: 9 <br>Status: Suspicious Date","Date: 2040-10-11 <br>Messages: 1 <br>Status: Suspicious Date"],"hoverinfo":["text","text","text"],"type":"bar","name":"Suspicious Date","marker":{"color":"rgba(255,165,0,1)","line":{"color":"rgba(255,165,0,1)"}},"textfont":{"color":"rgba(255,165,0,1)"},"error_y":{"color":"rgba(255,165,0,1)"},"error_x":{"color":"rgba(255,165,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2040-10-05","2040-10-07","2040-10-08","2040-10-09","2040-10-10","2040-10-11","2040-10-12","2040-10-13","2040-10-14"],"y":[8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247,8.3151624209221247],"type":"scatter","mode":"lines","line":{"color":"red","dash":"dash"},"name":"Spike Threshold","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="drilling-down-on-spike-flagged-date" class="level2">
<h2 class="anchored" data-anchor-id="drilling-down-on-spike-flagged-date">5.7 Drilling down on spike + flagged date</h2>
<section id="extract-nadias-message-from-oct-8" class="level3">
<h3 class="anchored" data-anchor-id="extract-nadias-message-from-oct-8">5.7.1 Extract Nadia’s message from Oct 8</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build fresh nadia_data with content included at the start</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>nadia_data <span class="ot">&lt;-</span> comms <span class="sc">%&gt;%</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sent_edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"comm_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(recv_edges, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"comm_id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">sender_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">receiver_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(nodes <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, timestamp), <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp),</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">as.Date</span>(timestamp),</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">hour =</span> <span class="fu">hour</span>(timestamp)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sender_label <span class="sc">==</span> <span class="st">"Nadia Conti"</span> <span class="sc">|</span> receiver_label <span class="sc">==</span> <span class="st">"Nadia Conti"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(timestamp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>oct8_msgs <span class="ot">&lt;-</span> nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">"2040-10-08"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(timestamp, sender_label, receiver_label, content) <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(timestamp)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  oct8_msgs,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">5</span>,</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">columnDefs =</span> <span class="fu">list</span>(</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">targets =</span> <span class="dv">3</span>,  <span class="co"># adjust if content is not 3rd col</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">render =</span> <span class="fu">JS</span>(</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">"function(data, type, row, meta) {"</span>,</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">"return type === 'display' &amp;&amp; data.length &gt; 50 ?"</span>,</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">"'&lt;span title=</span><span class="sc">\"</span><span class="st">' + data + '</span><span class="sc">\"</span><span class="st">&gt;' + data.substr(0, 50) + '...&lt;/span&gt;' : data;"</span>,</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">"}"</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="st">'stripe hover compact'</span>,</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left; font-size:14px; color:#444;'</span>,</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">'📌 Nadia Conti Messages on Oct 8, 2040'</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ce99c6bed70d4f3fdc55" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ce99c6bed70d4f3fdc55">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-size:14px; color:#444;\">📌 Nadia Conti Messages on Oct 8, 2040<\/caption>","data":[["2040-10-08T08:15:00Z","2040-10-08T08:18:00Z","2040-10-08T08:24:00Z","2040-10-08T08:25:00Z","2040-10-08T08:27:00Z","2040-10-08T08:30:00Z","2040-10-08T11:21:00Z","2040-10-08T11:23:00Z","2040-10-08T11:26:00Z"],["Elise","Nadia Conti","Liam Thorne","Nadia Conti","Neptune","Nadia Conti","Davis","Nadia Conti","Davis"],["Nadia Conti","Liam Thorne","Nadia Conti","Neptune","Nadia Conti","Neptune","Nadia Conti","Marlin","Nadia Conti"],["Nadia, Elise here. Meeting at Nemo Reef 0500 tomorrow to establish payment protocols. Sam uncovered V. Miesel shipping lanes overlapping with Mako by 40%. Neptune mentioned 'underwater foundation work' - outside our original scope. Need your assessment.","Liam, Nadia here. Need your services urgently. Investigation brewing around Nemo Reef permits. Double your usual fee if you can ensure Harbor Master remains cooperative through next week. Meet at the usual place tomorrow, 10PM.","Nadia, Liam here. Meeting confirmed for tomorrow at 10PM. I've redirected Harbor Master's attention and implemented new patrol schedules that work in our favor. Council suspects nothing about Nemo Reef. Bring payment as discussed.","Neptune, this is Nadia. Need clarity on 'underwater foundation work' at Nemo Reef. This extends beyond our agreed scope. Meet me at the marina tomorrow at 6AM to discuss implications and additional resource requirements.","Neptune to Nadia. I'm aware of the foundation work concerns. We're delivering the additional heavy equipment today as requested. Will meet you at 0600 as planned to discuss resource adjustments and review modified equipment specifications that Elise has approved funding for.","Neptune, Nadia here. Just confirming our 0600 meeting at the marina. I've reviewed the modified equipment specs with The Accountant. Please bring detailed timeline for foundation work and cost implications. We need to stay under radar.","Nadia, Davis here. I'll be at the marina office at 7PM with all shipping manifests. Could you bring copies of permit #CR-7844? Marlin's asking about unusual vessel routes near eastern shoals - might need to address this.","Marlin, Nadia here. I understand you're inquiring about eastern shoal routes. Those are temporary diversions due to equipment transport needs. I'll have Davis provide the necessary documentation tonight. Nothing to be concerned about.","Davis, Marlin here again. Nadia mentioned you'd provide documentation about those eastern shoal diversions tonight. Just checking if that's still coming through. Need to understand these new patterns while my vessel's being repaired."]],"container":"<table class=\"stripe hover compact\">\n  <thead>\n    <tr>\n      <th>timestamp<\/th>\n      <th>sender_label<\/th>\n      <th>receiver_label<\/th>\n      <th>content<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"autoWidth":true,"scrollX":true,"columnDefs":[{"targets":3,"render":"function(data, type, row, meta) {\nreturn type === 'display' && data.length > 50 ?\n'<span title=\"' + data + '\">' + data.substr(0, 50) + '...<\/span>' : data;\n}"},{"name":"timestamp","targets":0},{"name":"sender_label","targets":1},{"name":"receiver_label","targets":2},{"name":"content","targets":3}],"order":[],"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="keywords-of-oct-8" class="level3">
<h3 class="anchored" data-anchor-id="keywords-of-oct-8">5.7.2 Keywords of Oct 8</h3>
<p>Showing messages on Oct 8 mentioning suspicious terms of:</p>
<ol type="1">
<li>permit</li>
<li>approval</li>
<li>reef</li>
<li>cargo</li>
<li>shipment</li>
<li>illegal</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define suspicious keywords</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"permit"</span>, <span class="st">"approval"</span>, <span class="st">"reef"</span>, <span class="st">"cargo"</span>, <span class="st">"shipment"</span>, <span class="st">"dock"</span>, <span class="st">"illegal"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter messages on Oct 8 with suspicious terms</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>oct8_flagged_msgs <span class="ot">&lt;-</span> nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">"2040-10-08"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(content)) <span class="sc">%&gt;%</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="fu">paste</span>(keywords, <span class="at">collapse =</span> <span class="st">"|"</span>), content, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(timestamp, sender_label, receiver_label, content) <span class="sc">%&gt;%</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(timestamp)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display in interactive table</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  oct8_flagged_msgs,</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">5</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>),</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> htmltools<span class="sc">::</span>tags<span class="sc">$</span><span class="fu">caption</span>(</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">'caption-side: top; text-align: left; font-size:16px; color:#444;'</span>,</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'📌 Oct 8 Messages with Suspicious Keywords'</span></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-b8e9811b3f0b12bb41ae" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b8e9811b3f0b12bb41ae">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: top; text-align: left; font-size:16px; color:#444;\">📌 Oct 8 Messages with Suspicious Keywords<\/caption>","data":[["2040-10-08T08:15:00Z","2040-10-08T08:18:00Z","2040-10-08T08:24:00Z","2040-10-08T08:25:00Z","2040-10-08T11:21:00Z"],["Elise","Nadia Conti","Liam Thorne","Nadia Conti","Davis"],["Nadia Conti","Liam Thorne","Nadia Conti","Neptune","Nadia Conti"],["Nadia, Elise here. Meeting at Nemo Reef 0500 tomorrow to establish payment protocols. Sam uncovered V. Miesel shipping lanes overlapping with Mako by 40%. Neptune mentioned 'underwater foundation work' - outside our original scope. Need your assessment.","Liam, Nadia here. Need your services urgently. Investigation brewing around Nemo Reef permits. Double your usual fee if you can ensure Harbor Master remains cooperative through next week. Meet at the usual place tomorrow, 10PM.","Nadia, Liam here. Meeting confirmed for tomorrow at 10PM. I've redirected Harbor Master's attention and implemented new patrol schedules that work in our favor. Council suspects nothing about Nemo Reef. Bring payment as discussed.","Neptune, this is Nadia. Need clarity on 'underwater foundation work' at Nemo Reef. This extends beyond our agreed scope. Meet me at the marina tomorrow at 6AM to discuss implications and additional resource requirements.","Nadia, Davis here. I'll be at the marina office at 7PM with all shipping manifests. Could you bring copies of permit #CR-7844? Marlin's asking about unusual vessel routes near eastern shoals - might need to address this."]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>timestamp<\/th>\n      <th>sender_label<\/th>\n      <th>receiver_label<\/th>\n      <th>content<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"autoWidth":true,"columnDefs":[{"name":"timestamp","targets":0},{"name":"sender_label","targets":1},{"name":"receiver_label","targets":2},{"name":"content","targets":3}],"order":[],"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="network-of-oct-8-communication" class="level3">
<h3 class="anchored" data-anchor-id="network-of-oct-8-communication">5.7.3 Network of Oct 8 communication</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize comms on Oct 8</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>oct8_edges <span class="ot">&lt;-</span> nadia_data <span class="sc">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">as.Date</span>(<span class="st">"2040-10-08"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_label, receiver_label) <span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sender_label), <span class="sc">!</span><span class="fu">is.na</span>(receiver_label)) <span class="sc">%&gt;%</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> sender_label, <span class="at">to =</span> receiver_label, <span class="at">value =</span> n)</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Build node list</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>oct8_nodes <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">unique</span>(<span class="fu">c</span>(oct8_edges<span class="sc">$</span>from, oct8_edges<span class="sc">$</span>to))) <span class="sc">%&gt;%</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(label, sub_type), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"name"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">"Nadia Conti"</span>, <span class="st">"Nadia Conti"</span>, sub_type),</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> name,</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> name</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Render network</span></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(oct8_nodes, oct8_edges) <span class="sc">%&gt;%</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">456</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">stabilization =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-5a4e90b711cd71049642" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5a4e90b711cd71049642">{"x":{"nodes":{"name":["Davis","Elise","Liam Thorne","Nadia Conti","Neptune","Marlin"],"sub_type":["Person","Person","Person","Person","Vessel","Vessel"],"group":["Person","Person","Person","Nadia Conti","Vessel","Vessel"],"id":["Davis","Elise","Liam Thorne","Nadia Conti","Neptune","Marlin"],"label":["Davis","Elise","Liam Thorne","Nadia Conti","Neptune","Marlin"]},"edges":{"from":["Davis","Elise","Liam Thorne","Nadia Conti","Nadia Conti","Nadia Conti","Neptune"],"to":["Nadia Conti","Nadia Conti","Nadia Conti","Liam Thorne","Marlin","Neptune","Nadia Conti"],"value":[2,1,1,1,1,2,1]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"edges":{"arrows":"to"},"layout":{"randomSeed":456},"physics":{"stabilization":true}},"groups":["Person","Nadia Conti","Vessel"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Nadia is heavily involved in:</p>
<ol type="1">
<li>Discussion of Nemo Reef, permits, foundation work</li>
<li>Coordinating payments, doubling fees, Harbor Master cooperation</li>
<li>Adjusting schedules to avoid council suspicion</li>
</ol>
<p><strong>Highly suspicious tone</strong>: manipulation, concealment, operational coordination beyond scope.</p>
</section>
</section>
<section id="linking-oct-8-comms-to-permits-approvals-or-vessel-activity" class="level2">
<h2 class="anchored" data-anchor-id="linking-oct-8-comms-to-permits-approvals-or-vessel-activity">5.8 Linking Oct 8 comms to permits, approvals, or vessel activity</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>suspicious_events_alt <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"VesselMovement"</span>, <span class="st">"Monitoring"</span>, <span class="st">"HarborReport"</span>, <span class="st">"Fishing"</span>, <span class="st">"Enforcement"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(timestamp <span class="sc">&gt;=</span> <span class="fu">as.POSIXct</span>(<span class="st">"2040-10-08"</span>))</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>  suspicious_events_alt <span class="sc">%&gt;%</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(type, label, sub_type, id, timestamp, monitoring_type, findings),</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageLength =</span> <span class="dv">5</span>,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">autoWidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">scrollX =</span> <span class="cn">TRUE</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-086aa3c03867ab3b000a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-086aa3c03867ab3b000a">{"x":{"filter":"none","vertical":false,"data":[["Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event","Event"],["Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement"],["Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","Monitoring","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","VesselMovement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement","Enforcement"],["Event_Monitoring_530","Event_Monitoring_595","Event_Monitoring_608","Event_Monitoring_631","Event_Monitoring_661","Event_Monitoring_678","Event_Monitoring_688","Event_Monitoring_690","Event_Monitoring_704","Event_Monitoring_709","Event_Monitoring_716","Event_Monitoring_752","Event_Monitoring_766","Event_Monitoring_777","Event_Monitoring_797","Event_Monitoring_803","Event_Monitoring_829","Event_Monitoring_835","Event_Monitoring_856","Event_Monitoring_878","Event_Monitoring_900","Event_Monitoring_909","Event_Monitoring_911","Event_Monitoring_917","Event_Monitoring_922","Event_Monitoring_929","Event_Monitoring_932","Event_Monitoring_934","Event_Monitoring_941","Event_Monitoring_942","Event_Monitoring_946","Event_Monitoring_957","Event_Monitoring_967","Event_Monitoring_971","Event_Monitoring_978","Event_Monitoring_995","Event_VesselMovement_494","Event_VesselMovement_495","Event_VesselMovement_503","Event_VesselMovement_509","Event_VesselMovement_510","Event_VesselMovement_516","Event_VesselMovement_540","Event_VesselMovement_549","Event_VesselMovement_563","Event_VesselMovement_569","Event_VesselMovement_577","Event_VesselMovement_580","Event_VesselMovement_624","Event_VesselMovement_670","Event_VesselMovement_798","Event_VesselMovement_806","Event_VesselMovement_843","Event_VesselMovement_883","Event_VesselMovement_887","Event_VesselMovement_892","Event_VesselMovement_944","Event_VesselMovement_980","Event_VesselMovement_1002","Event_Enforcement_666","Event_Enforcement_693","Event_Enforcement_745","Event_Enforcement_769","Event_Enforcement_784","Event_Enforcement_839","Event_Enforcement_854","Event_Enforcement_947","Event_Enforcement_952","Event_Enforcement_992","Event_Enforcement_998"],["2040-10-08T08:21:00Z","2040-10-09T08:12:00Z","2040-10-09T10:20:00Z","2040-10-09T10:44:00Z","2040-10-10T09:32:00Z","2040-10-10T10:47:00Z","2040-10-10T11:23:00Z","2040-10-10T11:24:00Z","2040-10-10T05:00:00Z","2040-10-10T21:00:00Z","2040-10-11T08:07:00Z","2040-10-11T09:20:00Z","2040-10-11T10:09:00Z","2040-10-11T10:38:00Z","2040-10-12T08:59:00Z","2040-10-12T09:24:00Z","2040-10-12T10:55:00Z","2040-10-12T11:02:00Z","2040-10-12T12:59:00Z","2040-10-13T09:08:00Z","2040-10-13T12:22:00Z","2040-10-13T12:34:00Z","2040-10-13T12:36:00Z","2040-10-13T12:41:00Z","2040-10-13T07:00:00Z","2040-10-13T13:20:00Z","2040-10-13T13:23:00Z","2040-10-14T08:06:00Z","2040-10-14T08:34:00Z","2040-10-14T08:34:00Z","2040-10-14T08:40:00Z","2040-10-14T09:04:00Z","2040-10-14T10:58:00Z","2040-10-14T11:32:00Z","2040-10-14T11:37:00Z","2040-10-14T12:51:00Z","2040-10-08T06:00:00Z","2040-10-08T06:00:00Z","2040-10-08T06:00:00Z","2040-10-08T05:30:00Z","2040-10-08T05:30:00Z","2040-10-08T06:00:00Z","2040-10-09T05:00:00Z","2040-10-08T19:00:00Z","2040-10-08T11:01:00Z","2040-10-08T11:08:00Z","2040-10-08T11:16:00Z","2040-10-08T11:20:00Z","2040-10-09T10:39:00Z","2040-10-10T09:56:00Z","2040-10-12T08:59:00Z","2040-10-13T08:00:00Z","2040-10-12T11:14:00Z","2040-10-13T22:00:00Z","2040-10-13T22:00:00Z","2040-10-13T02:00:00Z","2040-10-15T00:00:00Z","2040-10-14T04:00:00Z","2040-10-14T22:00:00Z","2040-10-10T09:54:00Z","2040-10-11T06:00:00Z","2040-10-11T09:12:00Z","2040-10-11T10:13:00Z","2040-10-11T10:44:00Z","2040-10-13T06:00:00Z","2040-10-12T12:57:00Z","2040-10-14T08:40:00Z","2040-10-14T09:00:00Z","2040-10-14T12:47:00Z","2040-10-14T13:31:00Z"],["patrol activity","surveillance","surveillance","surveillance","surveillance","surveillance","patrol activity","surveillance","surveillance","patrol activity","water quality testing","surveillance","surveillance","water quality testing","surveillance","surveillance","surveillance","surveillance","surveillance","surveillance","surveillance","water quality testing","surveillance","patrol activity","surveillance","surveillance","surveillance","drone surveillance","surveillance","surveillance","drone surveillance","miscellaneous monitoring","miscellaneous monitoring","drone surveillance","surveillance","miscellaneous monitoring",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["Harbor patrols confirm Mako's environmental sampling is legitimate. Increased vessel activity from V. Miesel Shipping near the reef documented.","Specialized underwater concrete forms discovered in fragile crates. Harbor master mentioned 'deep water construction' multiple times, suggesting permanent structures at Nemo Reef beyond equipment installation.","Identified unauthorized deep-sea extraction equipment at Nemo Reef. Multiple executive personnel supervising from distance. Documenting evidence of container transfers between Neptune's team and unmarked civilian vessels.","increased vessel activity for Nemo Reef operations","Container vessels observed at northwest perimeter (24°15'N, 81°48'W) loading coral samples and seabed materials.","Suspicious industrial equipment deliveries contradicting environmental closure claims observed around Nemo Reef","Planning increased night patrols at eastern boundary markers due to information about tourism vessels","Suspicious extraction activities and industrial equipment deliveries contradicting environmental closure claims at Nemo Reef","Evidence of concrete structures, V. Miesel's expansion plans, and unusual movement in the harbor","Patrol of eastern quadrant scheduled. Night vision systems operational. Seeking vessel registration numbers for documentation.","Two conservation vessels anchoring north of Nemo Reef using sonar equipment and taking water samples. Rare osprey spotted.","EcoVigil questioning ROV delay, showing interest in Western quadrant while being redirected to northern quadrant","Equipment labeled 'Project Poseidon: Resource Extraction Phase'. Conservation vessels conducting environmental surveys but restricted from certain areas.","Completed extensive sampling near Nemo Reef. Preliminary findings show normal water quality parameters with no significant environmental hazards detected. Full analysis available within hours.","12 vessels in east quadrant with heavy drilling equipment. Registration numbers documented.","Davis Rodriguez maintaining position with Mako at Nemo Reef. Operating under permit #CR-7844 while maintaining tourism appearance. Security team expected to arrive at 0600.","Documented vessel registrations show 7 unregistered boats at Nemo Reef. Equipment includes seabed drills and extraction pumps - clear mining preparation.","evidence of unregistered vessels and mining equipment","Reef Guardian covering southeast quadrant for surveillance, requesting information about Port Authority vessel encounters for protest documentation","Detected multiple transmission clusters near west reef edge. Recording frequency patterns of encrypted communications. Able to triangulate source vessels.","Unauthorized activity at Nemo Reef during closure - encrypted communications, equipment transfers, and fuel contamination","Need to gather additional evidence at Nemo Reef, including water sample collection and documenting vessel movements","Spotted what appears to be a music video shoot with lighting rigs and camera equipment on west reef. Unable to confirm details due to distance.","Unauthorized activity at Nemo Reef during closure, requiring patrol of western boundary to document vessel movements and equipment transfers","Conservation vessels moving equipment to the eastern side of Nemo Reef","EcoVigil positioning required. Western quadrant to remain completely restricted for 48 hours. Unauthorized conservation vessels near restricted zones to be monitored.","Western quadrant restriction confirmed for 48 hours. EcoVigil redirected north as instructed. Unauthorized vessel monitoring in place.","Conservation vessels deploying drones with cameras over Nemo Reef","Conservation vessels being monitored. Delta-3 protocols active, tourism facade maintained.","Conservation vessels being monitored. Delta-3 protocols active, tourism facade maintained.","Port Authority blocking approach to Nemo Reef, requesting aerial drone documentation of activities during closure","Operation proceeding as planned. Equipment transfer completed at south dock. Maintaining tourism facade successfully. Need authorization for additional fuel allocation due to extended perimeter monitoring.","Music video shoot occurring with potential environmental impact and permit violations. Green Guardians HQ confirming need to investigate and continue monitoring water contamination levels.","Port Authority blocking approach to Nemo Reef. Attempting to coordinate with Sentinel for documentation. Need aerial footage of equipment and activities at Nemo Reef.","Video production underway at Nemo Reef with performers, lighting rigs, and filming equipment visible. No environmental assessment was conducted before this commercial activity.","Video evidence collected of environmental impacts at Nemo Reef, with ongoing monitoring for cleanup efforts as vessels depart",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>type<\/th>\n      <th>label<\/th>\n      <th>sub_type<\/th>\n      <th>id<\/th>\n      <th>timestamp<\/th>\n      <th>monitoring_type<\/th>\n      <th>findings<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"autoWidth":true,"scrollX":true,"columnDefs":[{"name":"type","targets":0},{"name":"label","targets":1},{"name":"sub_type","targets":2},{"name":"id","targets":3},{"name":"timestamp","targets":4},{"name":"monitoring_type","targets":5},{"name":"findings","targets":6}],"order":[],"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1️⃣ Prepare entity-related vessel/harbor events</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>entity_events <span class="ot">&lt;-</span> suspicious_events_alt <span class="sc">%&gt;%</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(findings, <span class="fu">regex</span>(<span class="st">"Neptune|Miesel|Mako"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">entity =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(findings, <span class="fu">regex</span>(<span class="st">"Neptune"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Neptune"</span>,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(findings, <span class="fu">regex</span>(<span class="st">"Miesel"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Miesel"</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(findings, <span class="fu">regex</span>(<span class="st">"Mako"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">~</span> <span class="st">"Mako"</span>,</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other"</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 2️⃣ Build interactive plot</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nadia comms</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> nadia_data,</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>timestamp,</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span><span class="st">"Nadia Message"</span>,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">"Nadia Message&lt;br&gt;"</span>, timestamp),</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Nadia Message"</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Neptune events</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> entity_events <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entity <span class="sc">==</span> <span class="st">"Neptune"</span>),</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>timestamp,</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>entity,</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#1f77b4"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste0</span>(entity, <span class="st">" Event&lt;br&gt;"</span>, findings),</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Neptune Event"</span></span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Miesel events</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> entity_events <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entity <span class="sc">==</span> <span class="st">"Miesel"</span>),</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>timestamp,</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>entity,</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#17becf"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste0</span>(entity, <span class="st">" Event&lt;br&gt;"</span>, findings),</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Miesel Event"</span></span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mako events</span></span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> entity_events <span class="sc">%&gt;%</span> <span class="fu">filter</span>(entity <span class="sc">==</span> <span class="st">"Mako"</span>),</span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>timestamp,</span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="sc">~</span>entity,</span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#7f7f7f"</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">text =</span> <span class="sc">~</span><span class="fu">paste0</span>(entity, <span class="st">" Event&lt;br&gt;"</span>, findings),</span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">hoverinfo =</span> <span class="st">"text"</span>,</span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Mako Event"</span></span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nadia Comms + Vessel/Harbor Events"</span>,</span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Time"</span>),</span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">""</span>),</span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">orientation =</span> <span class="st">"h"</span>, <span class="at">x =</span> <span class="fl">0.1</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.3</span>)</span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a67b9f33aed76bfc9200" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a67b9f33aed76bfc9200">{"x":{"visdat":{"4c6811553de0":["function () ","plotlyVisDat"],"4c6873514603":["function () ","data"],"4c685ccbaa1a":["function () ","data"],"4c683f0cc08e":["function () ","data"],"4c685e35caf8":["function () ","data"]},"cur_data":"4c685e35caf8","attrs":{"4c6873514603":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","marker":{"color":"red","size":10},"text":{},"hoverinfo":"text","name":"Nadia Message","inherit":true},"4c685ccbaa1a":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","marker":{"color":"#1f77b4","size":10},"text":{},"hoverinfo":"text","name":"Neptune Event","inherit":true},"4c683f0cc08e":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","marker":{"color":"#17becf","size":10},"text":{},"hoverinfo":"text","name":"Miesel Event","inherit":true},"4c685e35caf8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"type":"scatter","mode":"markers","marker":{"color":"#7f7f7f","size":10},"text":{},"hoverinfo":"text","name":"Mako Event","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Nadia Comms + Vessel/Harbor Events","xaxis":{"domain":[0,1],"automargin":true,"title":"Time"},"yaxis":{"domain":[0,1],"automargin":true,"title":"","type":"category","categoryorder":"array","categoryarray":["Mako","Miesel","Nadia Message","Neptune"]},"legend":{"orientation":"h","x":0.10000000000000001,"y":-0.29999999999999999},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2040-10-05 09:44:00.000000","2040-10-05 09:45:00.000000","2040-10-05 09:48:00.000000","2040-10-05 09:49:00.000000","2040-10-07 11:57:00.000000","2040-10-07 12:00:00.000000","2040-10-08 08:15:00.000000","2040-10-08 08:18:00.000000","2040-10-08 08:24:00.000000","2040-10-08 08:25:00.000000","2040-10-08 08:27:00.000000","2040-10-08 08:30:00.000000","2040-10-08 11:21:00.000000","2040-10-08 11:23:00.000000","2040-10-08 11:26:00.000000","2040-10-09 08:54:00.000000","2040-10-10 10:45:00.000000","2040-10-10 12:30:00.000000","2040-10-11 09:20:00.000000","2040-10-12 08:44:00.000000","2040-10-12 09:24:00.000000","2040-10-12 11:14:00.000000","2040-10-12 11:17:00.000000","2040-10-12 11:19:00.000000","2040-10-13 08:21:00.000000","2040-10-14 08:34:00.000000"],"y":["Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message","Nadia Message"],"type":"scatter","mode":"markers","marker":{"color":"red","size":10,"line":{"color":"rgba(31,119,180,1)"}},"text":["Nadia Message<br>2040-10-05 09:44:00","Nadia Message<br>2040-10-05 09:45:00","Nadia Message<br>2040-10-05 09:48:00","Nadia Message<br>2040-10-05 09:49:00","Nadia Message<br>2040-10-07 11:57:00","Nadia Message<br>2040-10-07 12:00:00","Nadia Message<br>2040-10-08 08:15:00","Nadia Message<br>2040-10-08 08:18:00","Nadia Message<br>2040-10-08 08:24:00","Nadia Message<br>2040-10-08 08:25:00","Nadia Message<br>2040-10-08 08:27:00","Nadia Message<br>2040-10-08 08:30:00","Nadia Message<br>2040-10-08 11:21:00","Nadia Message<br>2040-10-08 11:23:00","Nadia Message<br>2040-10-08 11:26:00","Nadia Message<br>2040-10-09 08:54:00","Nadia Message<br>2040-10-10 10:45:00","Nadia Message<br>2040-10-10 12:30:00","Nadia Message<br>2040-10-11 09:20:00","Nadia Message<br>2040-10-12 08:44:00","Nadia Message<br>2040-10-12 09:24:00","Nadia Message<br>2040-10-12 11:14:00","Nadia Message<br>2040-10-12 11:17:00","Nadia Message<br>2040-10-12 11:19:00","Nadia Message<br>2040-10-13 08:21:00","Nadia Message<br>2040-10-14 08:34:00"],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"name":"Nadia Message","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2040-10-09 10:20:00.000000"],"y":["Neptune"],"type":"scatter","mode":"markers","marker":{"color":"#1f77b4","size":10,"line":{"color":"rgba(255,127,14,1)"}},"text":"Neptune Event<br>Identified unauthorized deep-sea extraction equipment at Nemo Reef. Multiple executive personnel supervising from distance. Documenting evidence of container transfers between Neptune's team and unmarked civilian vessels.","hoverinfo":"text","name":"Neptune Event","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2040-10-08 08:21:00.000000","2040-10-10 05:00:00.000000"],"y":["Miesel","Miesel"],"type":"scatter","mode":"markers","marker":{"color":"#17becf","size":10,"line":{"color":"rgba(44,160,44,1)"}},"text":["Miesel Event<br>Harbor patrols confirm Mako's environmental sampling is legitimate. Increased vessel activity from V. Miesel Shipping near the reef documented.","Miesel Event<br>Evidence of concrete structures, V. Miesel's expansion plans, and unusual movement in the harbor"],"hoverinfo":["text","text"],"name":"Miesel Event","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2040-10-12 09:24:00.000000"],"y":["Mako"],"type":"scatter","mode":"markers","marker":{"color":"#7f7f7f","size":10,"line":{"color":"rgba(214,39,40,1)"}},"text":"Mako Event<br>Davis Rodriguez maintaining position with Mako at Nemo Reef. Operating under permit #CR-7844 while maintaining tourism appearance. Security team expected to arrive at 0600.","hoverinfo":"text","name":"Mako Event","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The interactive timeline highlights that Nadia Conti’s communications were closely followed by vessel/harbor events involving Neptune, V. Miesel Shipping, and Mako. Notably:</p>
<pre><code>•   On **Oct 8**, Nadia’s messages spiked, coinciding with planned operations at Nemo Reef.

•   Shortly afterward, vessel activities linked to **Neptune, Miesel, and Mako** were logged.

•   This temporal proximity strongly suggests coordination between Nadia and these entities.</code></pre>
<p>There is no evidence of formal approvals or permits linked to these activities, pointing to potential covert operations.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>