{
  "hash": "2fba93f800105fea35aac795026590cc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take-Home Assignment 2\"\ndescription: \"\"\nauthor: \"David Chiam\"\ndate: \"22 May 2025\"\ndate-modified: \"31 May 2025\"\nformat: html\neditor: visual\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n\n# **Take Home Assignment 2 on Mini-Challenge 3**\n\n## **1 - Getting Started**\n\n### 1.1 - Load the R packages for this assignment\n\nFor the purpose of this assignment, five R packages will be used. They are tidyverse, jsonlite, tidygraph, ggraph and SmartEDA.\n\nIn the code chunk below, p_load() of pacman package is used to load the R packages into R environment.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, jsonlite, \n               tidygraph, ggraph, SmartEDA, \n               ggrepel, scales, lubridate, dplyr, viridis)\n```\n:::\n\n\n\n### 1.2 - Importing Knowledge Graph Data\n\nFor the purpose of this exercise, *mc3.json* file will be used. Before getting started, you should have the data set in the **data** sub-folder.\n\nIn the code chunk below, `fromJSON()` of **jsonlite** package is used to import *mc3.json* file into R and save the output object\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMC3 <- fromJSON(\"data/MC3_graph.json\")\nMC3_schema <- fromJSON(\"data/MC3_schema.json\")\n```\n:::\n\n\n\n### 1.3 - **Data Overview**\n\nThe dataset was provided by VAST Challenge for MC3. This report utilizes two core datasets: MC3_graph.json, which encodes the knowledge graph of communications, events, and relationships; and MC3_schema.json, which defines the structure, subtypes, and attributes of each node and edge type within the graph. There ngraph contains a total of 1159 nodes and 3226 edges. Full description of node attributes and edge attributes is shown below.\n\n**Nodes Attributes** are as such:\n\n![Node Subtypes](Images/Node%20Attributes.png){fig-align=\"center\" width=\"600\"}\n\n**Edge Attributes** are as such:\n\n![Node-Edge-Node Matrix](Images/Edge%20Attributes.png){fig-align=\"center\" width=\"594\"}\n\n### 1.4 - **Inspecting knowledge graph structure**\n\nBefore preparing the data, it is always a good practice to examine the structure of *mc3* knowledge graph.\n\nIn the code chunk below `glimpse()` is used to reveal the structure of *mc3* knowledge graph.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(MC3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nList of 5\n $ directed  : logi TRUE\n $ multigraph: logi FALSE\n $ graph     :List of 4\n  ..$ mode        : chr \"static\"\n  ..$ edge_default: Named list()\n  ..$ node_default: Named list()\n  ..$ name        : chr \"VAST_MC3_Knowledge_Graph\"\n $ nodes     :'data.frame':\t1159 obs. of  31 variables:\n  ..$ type             : chr [1:1159] \"Entity\" \"Entity\" \"Entity\" \"Entity\" ...\n  ..$ label            : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ name             : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ sub_type         : chr [1:1159] \"Person\" \"Person\" \"Person\" \"Person\" ...\n  ..$ id               : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  ..$ timestamp        : chr [1:1159] NA NA NA NA ...\n  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...\n  ..$ findings         : chr [1:1159] NA NA NA NA ...\n  ..$ content          : chr [1:1159] NA NA NA NA ...\n  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...\n  ..$ results          : chr [1:1159] NA NA NA NA ...\n  ..$ movement_type    : chr [1:1159] NA NA NA NA ...\n  ..$ destination      : chr [1:1159] NA NA NA NA ...\n  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...\n  ..$ outcome          : chr [1:1159] NA NA NA NA ...\n  ..$ activity_type    : chr [1:1159] NA NA NA NA ...\n  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...\n  ..$ thing_collected  :'data.frame':\t1159 obs. of  2 variables:\n  .. ..$ type: chr [1:1159] NA NA NA NA ...\n  .. ..$ name: chr [1:1159] NA NA NA NA ...\n  ..$ reference        : chr [1:1159] NA NA NA NA ...\n  ..$ date             : chr [1:1159] NA NA NA NA ...\n  ..$ time             : chr [1:1159] NA NA NA NA ...\n  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...\n  ..$ permission_type  : chr [1:1159] NA NA NA NA ...\n  ..$ start_date       : chr [1:1159] NA NA NA NA ...\n  ..$ end_date         : chr [1:1159] NA NA NA NA ...\n  ..$ report_type      : chr [1:1159] NA NA NA NA ...\n  ..$ submission_date  : chr [1:1159] NA NA NA NA ...\n  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...\n  ..$ authority_level  : chr [1:1159] NA NA NA NA ...\n  ..$ coordination_type: chr [1:1159] NA NA NA NA ...\n  ..$ operational_role : chr [1:1159] NA NA NA NA ...\n $ edges     :'data.frame':\t3226 obs. of  5 variables:\n  ..$ id         : chr [1:3226] \"2\" \"3\" \"5\" \"3013\" ...\n  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...\n  ..$ source     : chr [1:3226] \"Sam\" \"Sam\" \"Sam\" \"Sam\" ...\n  ..$ target     : chr [1:3226] \"Relationship_Suspicious_217\" \"Event_Communication_370\" \"Event_Assessment_600\" \"Relationship_Colleagues_430\" ...\n  ..$ type       : chr [1:3226] NA \"sent\" NA NA ...\n```\n\n\n:::\n:::\n\n\n\n::: callout-warning\nNotice that *Industry* field is in list data type. In general, this data type is not acceptable by `tbl_graph()` of **tidygraph**. In order to avoid error arise when building tidygraph object, it is wiser to exclude this field from the edges data table. However, it might be still useful in subsequent analysis.\n:::\n\n### 1.5 - Extract the edges and nodes tables\n\nNext, `as_tibble()` of **tibble** package package is used to extract the nodes and links tibble data frames from *mc3* tibble dataframe into two separate tibble dataframes called *mc3_nodes* and *mc3_edges* respectively.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_nodes <- as_tibble(MC3$nodes)\nmc3_edges <- as_tibble(MC3$edges)\n```\n:::\n\n\n\n### 1.6 - Brief Analyis of the extracted edges and nodes data (visuals)\n\nIt is time for us to apply appropriate EDA methods to examine the data.\n\n**Nodes:**\n\n:::: panel-tabset\nIn the code chunk below, `ExpCatViz()` of SmartEDA package is used to reveal the frequency distribution of all categorical fields in *mc3_nodes* tibble dataframe.\n\n### The Code Chunk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExpCatViz(data=mc3_nodes,\n          col=\"lightblue\")\n```\n:::\n\n\n\n### The Plots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExpCatViz(data=mc3_nodes,\n          col=\"lightblue\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[2]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[3]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[4]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[5]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[6]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[7]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[8]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-8.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[9]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-9.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[10]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-10.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[11]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-11.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[12]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-12.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[13]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-13.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[14]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-6-14.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\nWhat useful discovery can you obtained from the visualisation above?\n:::\n::::\n\n**Edges:**\n\n:::: panel-tabset\nOn the other hands, code chunk below uses `ExpCATViz()` of SmartEDA package to reveal the frequency distribution of all categorical fields in *mc3_edges* tibble dataframe.\n\n### The Code Chunk\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nExpCatViz(data=mc3_edges,\n          col=\"lightblue\")\n```\n:::\n\n\n\n### The Plots\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-note\nWhat useful discovery can you obtained from the visualisation above?\n:::\n::::\n\n## 2 - **Data Cleaning and Wrangling**\n\n### **2.1 - Cleaning and wrangling nodes**\n\nCode chunk below performs the following data cleaning tasks:\n\n-   convert values in id field into character data type,\n-   exclude records with `id` value are na,\n-   exclude records with similar id values,\n-   exclude `thing_collected` field, and\n-   save the cleaned tibble dataframe into a new tibble datatable called `mc3_nodes_cleaned`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_nodes_cleaned <- mc3_nodes %>%\n  mutate(id = as.character(id)) %>%\n  filter(!is.na(id)) %>%\n  distinct(id, .keep_all = TRUE) %>%\n  select(-thing_collected)\n```\n:::\n\n\n\n### **2.2 - Cleaning and wrangling edges**\n\nNext, the code chunk below will be used to:\n\n-   rename source and target fields to from_id and to_id respectively,\n-   convert values in from_id and to_id fields to character data type,\n-   exclude values in from_id and to_id which not found in the id field of mc3_nodes_cleaned,\n-   exclude records whereby from_id and/or to_id values are missing, and\n-   save the cleaned tibble dataframe and called it mc3_edges_cleaned.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_cleaned <- mc3_edges %>%\n  rename(from_id = source, \n         to_id = target) %>%\n  mutate(across(c(from_id, to_id), \n                as.character)) %>%\n  filter(from_id %in% mc3_nodes_cleaned$id, \n         to_id %in% mc3_nodes_cleaned$id) %>%\n  filter(!is.na(from_id), !is.na(to_id))\n```\n:::\n\n\n\nNext, code chunk below will be used to create mapping of character id in `mc3_nodes_cleaned` to row index.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nnode_index_lookup <- mc3_nodes_cleaned %>%\n  mutate(.row_id = row_number()) %>%\n  select(id, .row_id)\n```\n:::\n\n\n\nNext, the code chunk below will be used to join and convert `from_id` and `to_id` to integer indices. At the same time we also drop rows with unmatched nodes.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_indexed <- mc3_edges_cleaned %>%\n  left_join(node_index_lookup, \n            by = c(\"from_id\" = \"id\")) %>%\n  rename(from = .row_id) %>%\n  left_join(node_index_lookup, \n            by = c(\"to_id\" = \"id\")) %>%\n  rename(to = .row_id) %>%\n  select(from, to, is_inferred, type) %>%\n  filter(!is.na(from) & !is.na(to))  \n```\n:::\n\n\n\nNext the code chunk below is used to subset nodes to only those referenced by edges.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nused_node_indices <- sort(\n  unique(c(mc3_edges_indexed$from, \n           mc3_edges_indexed$to)))\n\nmc3_nodes_final <- mc3_nodes_cleaned %>%\n  slice(used_node_indices) %>%\n  mutate(new_index = row_number())\n```\n:::\n\n\n\nWe will then use the code chunk below to rebuild lookup from old index to new index.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nold_to_new_index <- tibble(\n  old_index = used_node_indices,\n  new_index = seq_along(\n    used_node_indices))\n```\n:::\n\n\n\nLastly, the code chunk below will be used to update edge indices to match new node table.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_edges_final <- mc3_edges_indexed %>%\n  left_join(old_to_new_index, \n            by = c(\"from\" = \"old_index\")) %>%\n  rename(from_new = new_index) %>%\n  left_join(old_to_new_index, \n            by = c(\"to\" = \"old_index\")) %>%\n  rename(to_new = new_index) %>%\n  select(from = from_new, to = to_new, \n         is_inferred, type)\n```\n:::\n\n\n\n### **2.3 - Building the tidygraph object**\n\nNow we are ready to build the tidygraph object by using the code chunk below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_graph <- tbl_graph(\n  nodes = mc3_nodes_final,\n  edges = mc3_edges_final,\n  directed = TRUE\n)\n```\n:::\n\n\n\nAfter the tidygraph object is created, it is always a good practice to examine the object by using `str()`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(mc3_graph)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'tbl_graph', 'igraph'  hidden list of 10\n $ : num 1159\n $ : logi TRUE\n $ : num [1:3226] 0 0 0 0 0 0 0 1 1 1 ...\n $ : num [1:3226] 1137 356 746 894 875 ...\n $ : NULL\n $ : NULL\n $ : NULL\n $ : NULL\n $ :List of 4\n  ..$ : num [1:3] 1 0 1\n  ..$ : Named list()\n  ..$ :List of 31\n  .. ..$ type             : chr [1:1159] \"Entity\" \"Entity\" \"Entity\" \"Entity\" ...\n  .. ..$ label            : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  .. ..$ name             : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  .. ..$ sub_type         : chr [1:1159] \"Person\" \"Person\" \"Person\" \"Person\" ...\n  .. ..$ id               : chr [1:1159] \"Sam\" \"Kelly\" \"Nadia Conti\" \"Elise\" ...\n  .. ..$ timestamp        : chr [1:1159] NA NA NA NA ...\n  .. ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ findings         : chr [1:1159] NA NA NA NA ...\n  .. ..$ content          : chr [1:1159] NA NA NA NA ...\n  .. ..$ assessment_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ results          : chr [1:1159] NA NA NA NA ...\n  .. ..$ movement_type    : chr [1:1159] NA NA NA NA ...\n  .. ..$ destination      : chr [1:1159] NA NA NA NA ...\n  .. ..$ enforcement_type : chr [1:1159] NA NA NA NA ...\n  .. ..$ outcome          : chr [1:1159] NA NA NA NA ...\n  .. ..$ activity_type    : chr [1:1159] NA NA NA NA ...\n  .. ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...\n  .. ..$ reference        : chr [1:1159] NA NA NA NA ...\n  .. ..$ date             : chr [1:1159] NA NA NA NA ...\n  .. ..$ time             : chr [1:1159] NA NA NA NA ...\n  .. ..$ friendship_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ permission_type  : chr [1:1159] NA NA NA NA ...\n  .. ..$ start_date       : chr [1:1159] NA NA NA NA ...\n  .. ..$ end_date         : chr [1:1159] NA NA NA NA ...\n  .. ..$ report_type      : chr [1:1159] NA NA NA NA ...\n  .. ..$ submission_date  : chr [1:1159] NA NA NA NA ...\n  .. ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...\n  .. ..$ authority_level  : chr [1:1159] NA NA NA NA ...\n  .. ..$ coordination_type: chr [1:1159] NA NA NA NA ...\n  .. ..$ operational_role : chr [1:1159] NA NA NA NA ...\n  .. ..$ new_index        : int [1:1159] 1 2 3 4 5 6 7 8 9 10 ...\n  ..$ :List of 2\n  .. ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...\n  .. ..$ type       : chr [1:3226] NA \"sent\" NA NA ...\n $ :<environment: 0x000002294cb8f620> \n - attr(*, \"active\")= chr \"nodes\"\n```\n\n\n:::\n:::\n\n\n\n## 3 - **Exploratory Data Analysis (after cleaning & wrangling)**\n\nSeveral of the **ggraph** layouts involve randomisation. In order to ensure reproducibility, it is necessary to set the seed value before plotting by using the code chunk below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1818)\n```\n:::\n\n\n\n### **3.1 - Visualising the knowledge graph**\n\nShows how many nodes are of type `Entity`, `Event`, or `Relationship`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_nodes_final %>%\n  count(type, sort = TRUE) %>%\n  ggplot(aes(x = reorder(type, -n), y = n, fill = type)) +\n  geom_col() +\n  geom_text(aes(label = n), vjust = -0.3) +\n  labs(title = \"Node Type Distribution\", x = \"Type\", y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\nIn the code chunk below, **ggraph** functions are used to create the whole graph.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nggraph(mc3_graph, \n       layout = \"fr\") +\n  geom_edge_link(alpha = 0.3, \n                 colour = \"gray\") +\n  geom_node_point(aes(color = `type`), \n                  size = 4) +\n  geom_node_text(aes(label = type), \n                 repel = TRUE, \n                 size = 2.5) +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n### **3.2 - Entity Sub_type Distribution**\n\nFocuses on what kinds of actors are in the graph — Person, Vessel, Organization, etc.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Define color mapping\nsubtype_colors <- c(\n  \"Person\" = \"#2ca5ff\",\n  \"Organization\" = \"#f5ee15\",\n  \"Vessel\" = \"#FB7E81\",\n  \"Group\" = \"#25e158\",\n  \"Location\" = \"#ec4bff\"\n)\n\nmc3_nodes_final %>%\n  filter(type == \"Entity\") %>%\n  count(sub_type, sort = TRUE) %>%\n  ggplot(aes(x = reorder(sub_type, n), y = n, fill = sub_type)) +\n  geom_col() +\n  coord_flip() +\n  geom_text(aes(label = n), hjust = -0.1) +\n  labs(title = \"Entity Sub-type Distribution\", x = \"Sub-type\", y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n### **3.3 - Event Sub_type Distribution**\n\nTo understand what kinds of actions dominate — Communication, Monitoring, Assessment, etc.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmc3_nodes_final %>%\n  filter(type == \"Event\") %>%\n  count(sub_type, sort = TRUE) %>%\n  ggplot(aes(x = reorder(sub_type, n), y = n, fill = sub_type)) +\n  geom_col() +\n  coord_flip() +\n  geom_text(aes(label = n), hjust = -0.1) +\n  labs(title = \"Event Sub-type Distribution\", x = \"Sub-type\", y = \"Count\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n### **3.4a - List of Communication Participants**\n\nThis finds all Entities that **sent or received** communication events — i.e., actors who participated in messaging.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(DT)\n\n# Step 1: Get all Communication Event IDs\ncomm_event_ids <- mc3_nodes_cleaned %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  pull(id)\n\n# Step 2: Extract 'sent' edges for communication events\ncomm_sent_edges <- mc3_edges_cleaned %>%\n  filter(type == \"sent\", to_id %in% comm_event_ids) %>%\n  select(comm_id = to_id, sender_id = from_id)\n\n# Step 3: Extract 'received' edges for same communication events\ncomm_received_edges <- mc3_edges_cleaned %>%\n  filter(type == \"received\", from_id %in% comm_event_ids) %>%\n  select(comm_id = from_id, receiver_id = to_id)\n\n# Step 4: Join sent and received edges by communication ID\ncomm_pairs <- comm_sent_edges %>%\n  inner_join(comm_received_edges, by = \"comm_id\")\n\n# Step 5: Add sender and receiver labels\nparticipants_named <- comm_pairs %>%\n  left_join(mc3_nodes_cleaned %>% select(id, sender_label = label), by = c(\"sender_id\" = \"id\")) %>%\n  left_join(mc3_nodes_cleaned %>% select(id, receiver_label = label), by = c(\"receiver_id\" = \"id\"))\n\n\n\n# Step7: Interactive summary of top sender–receiver pairs\nparticipants_named %>%\n  count(sender_label, receiver_label, sort = TRUE) %>%\n  datatable(\n    caption = \"Top Communication Pairs (Sender → Receiver)\",\n    colnames = c(\"Sender\", \"Receiver\", \"Message Count\"),\n    options = list(pageLength = 10, autoWidth = TRUE),\n    rownames = FALSE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-54575bd3d30a622838bc\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-54575bd3d30a622838bc\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Top Communication Pairs (Sender → Receiver)<\\/caption>\",\"data\":[[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"Green Guardians\",\"Green Guardians\",\"The Lookout\",\"Neptune\",\"Remora\",\"Neptune\",\"Oceanus City Council\",\"The Intern\",\"The Lookout\",\"Himark Harbor\",\"Neptune\",\"Davis\",\"Green Guardians\",\"Liam Thorne\",\"Mrs. Money\",\"Oceanus City Council\",\"Oceanus City Council\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Himark Harbor\",\"Mako\",\"Mrs. Money\",\"Oceanus City Council\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Green Guardians\",\"Horizon\",\"Mako\",\"Mako\",\"Mako\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"Boss\",\"Defender\",\"Elise\",\"Green Guardians\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"Davis\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Boss\",\"Boss\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"EcoVigil\",\"Elise\",\"Elise\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Horizon\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Sam\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\"],[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"Green Guardians\",\"Oceanus City Council\",\"The Intern\",\"Remora\",\"Mako\",\"V. Miesel Shipping\",\"Liam Thorne\",\"The Lookout\",\"Sam\",\"Oceanus City Council\",\"Mako\",\"Davis\",\"Reef Guardian\",\"Oceanus City Council\",\"Boss\",\"Green Guardians\",\"Paackland Harbor\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Neptune\",\"Remora\",\"The Intern\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Horizon\",\"Sentinel\",\"Himark Harbor\",\"Samantha Blake\",\"Sentinel\",\"Remora\",\"Sentinel\",\"EcoVigil\",\"Oceanus City Council\",\"Rodriguez\",\"Remora\",\"Sentinel\",\"Boss\",\"Neptune\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Remora\",\"Seawatch\",\"Serenity\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Mako\",\"Horizon\",\"Marlin\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Mako\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Green Guardians\",\"Mrs. Money\",\"The Accountant\",\"V. Miesel Shipping\",\"EcoVigil\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Marlin\",\"Green Guardians\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Himark Harbor\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Mako\",\"Reef Guardian\",\"Samantha Blake\",\"Oceanus City Council\",\"Reef Guardian\",\"Defender\",\"Mako\",\"Paackland Harbor\",\"Sailor Shifts Team\",\"Green Guardians\",\"Oceanus City Council\",\"Himark Harbor\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Remora\",\"V. Miesel Shipping\",\"Mako\",\"V. Miesel Shipping\",\"Boss\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Boss\",\"Northern Light\",\"Remora\",\"Samantha Blake\",\"Northern Light\",\"Paackland Harbor\",\"Sentinel\",\"EcoVigil\",\"Knowles\",\"Mako\",\"Nadia Conti\",\"Osprey\",\"Northern Light\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Haacklee Harbor\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Serenity\",\"V. Miesel Shipping\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Mako\",\"Remora\",\"V. Miesel Shipping\",\"Haacklee Harbor\",\"Marlin\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"City Officials\",\"Himark Harbor\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Green Guardians\",\"Himark Harbor\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"EcoVigil\",\"Marlin\",\"Nadia Conti\",\"Northern Light\",\"Oceanus City Council\",\"Sentinel\",\"Liam Thorne\",\"Neptune\",\"Port Security\",\"Davis\",\"Himark Harbor\",\"Nadia Conti\",\"Rodriguez\",\"V. Miesel Shipping\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Sailor Shifts Team\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Green Guardians\",\"Himark Harbor\",\"Reef Guardian\",\"Nadia Conti\",\"Paackland Harbor\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"The Intern\",\"Reef Guardian\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Elise\",\"Mako\",\"Mrs. Money\",\"Nadia Conti\",\"Rodriguez\"],[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>Sender<\\/th>\\n      <th>Receiver<\\/th>\\n      <th>Message Count<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"autoWidth\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":2},{\"name\":\"sender_label\",\"targets\":0},{\"name\":\"receiver_label\",\"targets\":1},{\"name\":\"n\",\"targets\":2}],\"order\":[],\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n### **3.4b - Network Visual of Communication Participants**\n\nThis code creates an **interactive communication network graph** using `visNetwork`, where:\n\n-   Each **node** represents a person or entity, **node size** is based on total messages **sent** by that participant.\n-   Each **edge (arrow)** represents a communication sent from one participant to another, the thicker the edge, the more message sent to that particular receiver.\n\n**Ver 1: Layout_in_circle**\n\nMessage Senders are arranged from most to the least number of messages sent.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(visNetwork)\n\n# Step 1: Summarize communication edges\ncomm_edges_vis <- participants_named %>%\n  count(sender_id, receiver_id, sort = TRUE) %>%\n  rename(from = sender_id, to = receiver_id, value = n)\n\n# Step 2: Compute messages sent per node\nmessage_counts <- comm_edges_vis %>%\n  group_by(from) %>%\n  summarise(sent_count = sum(value), .groups = \"drop\")\n\n# Step 3: Prepare nodes, merge with message count and add color/shape\nnodes_vis <- mc3_nodes_cleaned %>%\n  filter(id %in% unique(c(comm_edges_vis$from, comm_edges_vis$to))) %>%\n  select(id, label, sub_type) %>%\n  left_join(message_counts, by = c(\"id\" = \"from\")) %>%\n  mutate(\n    sent_count = replace_na(sent_count, 0),\n    size = rescale(sent_count, to = c(10, 40)),\n    title = paste0(label, \"<br>Sub-type: \", sub_type,\n                   ifelse(!is.na(sent_count), paste0(\"<br>Sent: \", sent_count, \" messages\"), \"\")),\n    color = case_when(\n      sub_type == \"Person\" ~ \"#2ca5ff\",\n      sub_type == \"Organization\" ~ \"#f5ee15\",\n      sub_type == \"Vessel\" ~ \"#FB7E81\",\n      sub_type == \"Group\" ~ \"#25e158\",\n      sub_type == \"Location\" ~ \"#ec4bff\",\n      TRUE ~ \"black\"\n    ),\n    shape = case_when(\n      sub_type == \"Person\" ~ \"dot\",\n      sub_type == \"Organization\" ~ \"square\",\n      sub_type == \"Vessel\" ~ \"triangle\",\n      sub_type == \"Group\" ~ \"star\",\n      sub_type == \"Location\" ~ \"diamond\",\n      TRUE ~ \"dot\"\n    ),\n  ) %>%\n  arrange(desc(size))\n\n# Step 4: Format visNetwork edges\nedges_vis <- comm_edges_vis %>%\n  mutate(\n    arrows = \"to\",\n    width = rescale(value, to = c(1, 6)),\n    title = paste(\"Messages:\", value)\n  )\n\n# Step 5: Define legend items\nlegend_nodes <- data.frame(\n  label = c(\"Person\", \"Organization\", \"Vessel\", \"Group\", \"Location\"),\n  color = c(\"#2ca5ff\", \"#f5ee15\", \"#FB7E81\", \"#25e158\", \"#ec4bff\"),\n  shape = c(\"dot\", \"square\", \"triangle\", \"star\", \"diamond\"),\n  stringsAsFactors = FALSE\n)\n\n# Step 6: Render network with legend\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"1000px\") %>%\n  visNodes(\n    size = nodes_vis$size\n    # color and shape are picked up from nodes_vis columns automatically\n  ) %>%\n  visLegend(\n    addNodes = lapply(1:nrow(legend_nodes), function(i) {\n      list(\n        label = legend_nodes$label[i],\n        shape = legend_nodes$shape[i],\n        color = legend_nodes$color[i]\n      )\n    }),\n    useGroups = FALSE,\n    width = 0.15\n  ) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visIgraphLayout(layout = \"layout_in_circle\") %>%\n  visPhysics(enabled = FALSE) %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-a09acc36575f53e3d2b2\" style=\"width:100%;height:1000px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a09acc36575f53e3d2b2\">{\"x\":{\"nodes\":{\"id\":[\"Green Guardians\",\"Oceanus City Council\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"The Lookout\",\"Himark Harbor\",\"Davis\",\"Remora\",\"The Intern\",\"Clepper Jensen\",\"Mrs. Money\",\"Miranda Jordan\",\"Sentinel\",\"Paackland Harbor\",\"V. Miesel Shipping\",\"Rodriguez\",\"Horizon\",\"EcoVigil\",\"The Middleman\",\"Liam Thorne\",\"Samantha Blake\",\"Boss\",\"Nadia Conti\",\"Serenity\",\"Small Fry\",\"Marlin\",\"Haacklee Harbor\",\"Osprey\",\"Elise\",\"Defender\",\"Glitters Team\",\"Northern Light\",\"Knowles\",\"The Accountant\",\"Seawatch\",\"Kelly\",\"Sailor Shifts Team\",\"Sam\",\"City Officials\",\"Port Security\"],\"label\":[\"Green Guardians\",\"Oceanus City Council\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"The Lookout\",\"Himark Harbor\",\"Davis\",\"Remora\",\"The Intern\",\"Clepper Jensen\",\"Mrs. Money\",\"Miranda Jordan\",\"Sentinel\",\"Paackland Harbor\",\"V. Miesel Shipping\",\"Rodriguez\",\"Horizon\",\"EcoVigil\",\"The Middleman\",\"Liam Thorne\",\"Samantha Blake\",\"Boss\",\"Nadia Conti\",\"Serenity\",\"Small Fry\",\"Marlin\",\"Haacklee Harbor\",\"Osprey\",\"Elise\",\"Defender\",\"Glitters Team\",\"Northern Light\",\"Knowles\",\"The Accountant\",\"Seawatch\",\"Kelly\",\"Sailor Shifts Team\",\"Sam\",\"City Officials\",\"Port Security\"],\"sub_type\":[\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Person\",\"Location\",\"Person\",\"Vessel\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Location\",\"Organization\",\"Person\",\"Vessel\",\"Vessel\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Person\",\"Vessel\",\"Location\",\"Vessel\",\"Person\",\"Vessel\",\"Organization\",\"Vessel\",\"Vessel\",\"Person\",\"Vessel\",\"Person\",\"Organization\",\"Person\",\"Group\",\"Location\"],\"sent_count\":[44,37,35,34,34,33,27,25,25,24,20,19,18,18,16,15,14,14,14,13,11,9,9,8,8,7,7,7,6,5,5,4,4,4,3,3,2,2,1,0,0],\"size\":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],\"title\":[\"Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages\",\"Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages\",\"Mako<br>Sub-type: Vessel<br>Sent: 35 messages\",\"Neptune<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages\",\"The Lookout<br>Sub-type: Person<br>Sent: 33 messages\",\"Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages\",\"Davis<br>Sub-type: Person<br>Sent: 25 messages\",\"Remora<br>Sub-type: Vessel<br>Sent: 25 messages\",\"The Intern<br>Sub-type: Person<br>Sent: 24 messages\",\"Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages\",\"Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages\",\"Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages\",\"Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages\",\"Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages\",\"V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages\",\"Rodriguez<br>Sub-type: Person<br>Sent: 14 messages\",\"Horizon<br>Sub-type: Vessel<br>Sent: 14 messages\",\"EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages\",\"The Middleman<br>Sub-type: Person<br>Sent: 13 messages\",\"Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages\",\"Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages\",\"Boss<br>Sub-type: Person<br>Sent: 9 messages\",\"Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages\",\"Serenity<br>Sub-type: Vessel<br>Sent: 8 messages\",\"Small Fry<br>Sub-type: Person<br>Sent: 7 messages\",\"Marlin<br>Sub-type: Vessel<br>Sent: 7 messages\",\"Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages\",\"Osprey<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Elise<br>Sub-type: Person<br>Sent: 5 messages\",\"Defender<br>Sub-type: Vessel<br>Sent: 5 messages\",\"Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages\",\"Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages\",\"Knowles<br>Sub-type: Vessel<br>Sent: 4 messages\",\"The Accountant<br>Sub-type: Person<br>Sent: 3 messages\",\"Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages\",\"Kelly<br>Sub-type: Person<br>Sent: 2 messages\",\"Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages\",\"Sam<br>Sub-type: Person<br>Sent: 1 messages\",\"City Officials<br>Sub-type: Group<br>Sent: 0 messages\",\"Port Security<br>Sub-type: Location<br>Sent: 0 messages\"],\"color\":[\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#2ca5ff\",\"#ec4bff\",\"#2ca5ff\",\"#FB7E81\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#FB7E81\",\"#ec4bff\",\"#f5ee15\",\"#2ca5ff\",\"#FB7E81\",\"#FB7E81\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#FB7E81\",\"#2ca5ff\",\"#FB7E81\",\"#ec4bff\",\"#FB7E81\",\"#2ca5ff\",\"#FB7E81\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#2ca5ff\",\"#FB7E81\",\"#2ca5ff\",\"#f5ee15\",\"#2ca5ff\",\"#25e158\",\"#ec4bff\"],\"shape\":[\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"dot\",\"diamond\",\"dot\",\"triangle\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"diamond\",\"square\",\"dot\",\"triangle\",\"triangle\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"dot\",\"triangle\",\"diamond\",\"triangle\",\"dot\",\"triangle\",\"square\",\"triangle\",\"triangle\",\"dot\",\"triangle\",\"dot\",\"square\",\"dot\",\"star\",\"diamond\"],\"x\":[1,0.988263204734962,0.9533279194732136,0.8960129976915159,0.8176618525785562,0.7201109685684317,0.6056468557020445,0.4769524557696989,0.3370442564294944,0.189201587293274,0.03688975521995497,-0.1163211795401867,-0.2668400825319395,-0.4111389182430832,-0.5458354442665709,-0.6677724881958929,-0.7740919490703919,-0.8623017888393665,-0.9303344436218247,-0.9765952856514705,-1,-1,-0.9765952856514704,-0.9303344436218246,-0.8623017888393664,-0.7740919490703918,-0.6677724881958926,-0.5458354442665705,-0.4111389182430827,-0.2668400825319392,-0.1163211795401862,0.03688975521995497,0.1892015872932742,0.3370442564294949,0.4769524557696991,0.6056468557020447,0.7201109685684317,0.8176618525785562,0.8960129976915159,0.9533279194732136,0.988263204734962],\"y\":[0,0.1527613834167303,0.3019421694807169,0.4440456870063911,0.5757411499843077,0.6939417283821623,0.7958769008244742,0.8791573932654411,0.9418311815475191,0.9824292451932162,1,0.9941316023674809,0.964961602562342,0.9131737206566701,0.8399818207089611,0.7471014588194116,0.6367096719489684,0.5113939500181348,0.3740915873362889,0.2280208349126063,0.07660546738007068,-0.07660546738007079,-0.2280208349126069,-0.374091587336289,-0.511393950018135,-0.6367096719489687,-0.7471014588194118,-0.8399818207089614,-0.9131737206566706,-0.964961602562342,-0.994131602367481,-1,-0.9824292451932162,-0.941831181547519,-0.879157393265441,-0.7958769008244738,-0.6939417283821623,-0.5757411499843074,-0.4440456870063906,-0.3019421694807168,-0.1527613834167298]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"Green Guardians\",\"Green Guardians\",\"The Lookout\",\"Neptune\",\"Remora\",\"Neptune\",\"Oceanus City Council\",\"The Intern\",\"The Lookout\",\"Himark Harbor\",\"Neptune\",\"Davis\",\"Green Guardians\",\"Liam Thorne\",\"Mrs. Money\",\"Oceanus City Council\",\"Oceanus City Council\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Himark Harbor\",\"Mako\",\"Mrs. Money\",\"Oceanus City Council\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Green Guardians\",\"Horizon\",\"Mako\",\"Mako\",\"Mako\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"Boss\",\"Defender\",\"Elise\",\"Green Guardians\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"Davis\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Boss\",\"Boss\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"EcoVigil\",\"Elise\",\"Elise\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Horizon\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Sam\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"Green Guardians\",\"Oceanus City Council\",\"The Intern\",\"Remora\",\"Mako\",\"V. Miesel Shipping\",\"Liam Thorne\",\"The Lookout\",\"Sam\",\"Oceanus City Council\",\"Mako\",\"Davis\",\"Reef Guardian\",\"Oceanus City Council\",\"Boss\",\"Green Guardians\",\"Paackland Harbor\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Neptune\",\"Remora\",\"The Intern\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Horizon\",\"Sentinel\",\"Himark Harbor\",\"Samantha Blake\",\"Sentinel\",\"Remora\",\"Sentinel\",\"EcoVigil\",\"Oceanus City Council\",\"Rodriguez\",\"Remora\",\"Sentinel\",\"Boss\",\"Neptune\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Remora\",\"Seawatch\",\"Serenity\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Mako\",\"Horizon\",\"Marlin\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Mako\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Green Guardians\",\"Mrs. Money\",\"The Accountant\",\"V. Miesel Shipping\",\"EcoVigil\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Marlin\",\"Green Guardians\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Himark Harbor\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Mako\",\"Reef Guardian\",\"Samantha Blake\",\"Oceanus City Council\",\"Reef Guardian\",\"Defender\",\"Mako\",\"Paackland Harbor\",\"Sailor Shifts Team\",\"Green Guardians\",\"Oceanus City Council\",\"Himark Harbor\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Remora\",\"V. Miesel Shipping\",\"Mako\",\"V. Miesel Shipping\",\"Boss\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Boss\",\"Northern Light\",\"Remora\",\"Samantha Blake\",\"Northern Light\",\"Paackland Harbor\",\"Sentinel\",\"EcoVigil\",\"Knowles\",\"Mako\",\"Nadia Conti\",\"Osprey\",\"Northern Light\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Haacklee Harbor\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Serenity\",\"V. Miesel Shipping\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Mako\",\"Remora\",\"V. Miesel Shipping\",\"Haacklee Harbor\",\"Marlin\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"City Officials\",\"Himark Harbor\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Green Guardians\",\"Himark Harbor\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"EcoVigil\",\"Marlin\",\"Nadia Conti\",\"Northern Light\",\"Oceanus City Council\",\"Sentinel\",\"Liam Thorne\",\"Neptune\",\"Port Security\",\"Davis\",\"Himark Harbor\",\"Nadia Conti\",\"Rodriguez\",\"V. Miesel Shipping\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Sailor Shifts Team\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Green Guardians\",\"Himark Harbor\",\"Reef Guardian\",\"Nadia Conti\",\"Paackland Harbor\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"The Intern\",\"Reef Guardian\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Elise\",\"Mako\",\"Mrs. Money\",\"Nadia Conti\",\"Rodriguez\"],\"value\":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 12\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"size\":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"enabled\":false},\"layout\":{\"randomSeed\":1818}},\"groups\":null,\"width\":\"100%\",\"height\":\"1000px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"legend\":{\"width\":0.15,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":[{\"label\":\"Person\",\"shape\":\"dot\",\"color\":\"#2ca5ff\"},{\"label\":\"Organization\",\"shape\":\"square\",\"color\":\"#f5ee15\"},{\"label\":\"Vessel\",\"shape\":\"triangle\",\"color\":\"#FB7E81\"},{\"label\":\"Group\",\"shape\":\"star\",\"color\":\"#25e158\"},{\"label\":\"Location\",\"shape\":\"diamond\",\"color\":\"#ec4bff\"}],\"nodesToDataframe\":false},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n**Ver 2: Layout_on_sphere**\n\nFrom this plot, it reveals that some pairs (e.g., Miranda Jordan and Clepper Jensen) mainly communicate with each other, suggesting isolated or private channels outside the broader network.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(visNetwork)\n\n# Step 1: Summarize communication edges\ncomm_edges_vis <- participants_named %>%\n  count(sender_id, receiver_id, sort = TRUE) %>%\n  rename(from = sender_id, to = receiver_id, value = n)\n\n# Step 2: Compute messages sent per person (by sender)\nmessage_counts <- comm_edges_vis %>%\n  group_by(from) %>%\n  summarise(sent_count = sum(value), .groups = \"drop\")\n\n# Step 3: Prepare nodes with label, subtype, color, shape, and scaled size\nnodes_vis <- mc3_nodes_cleaned %>%\n  filter(id %in% unique(c(comm_edges_vis$from, comm_edges_vis$to))) %>%\n  select(id, label, sub_type) %>%\n  left_join(message_counts, by = c(\"id\" = \"from\")) %>%\n  mutate(\n    size = if_else(\n      sub_type == \"Person\",\n      rescale(sent_count, to = c(10, 40), na.rm = TRUE),\n      15\n    ),\n    title = paste0(label, \"<br>Sub-type: \", sub_type,\n                   ifelse(!is.na(sent_count), paste0(\"<br>Sent: \", sent_count, \" messages\"), \"\")),\n    color = case_when(\n      sub_type == \"Person\" ~ \"#2ca5ff\",\n      sub_type == \"Organization\" ~ \"#f5ee15\",\n      sub_type == \"Vessel\" ~ \"#FB7E81\",\n      sub_type == \"Group\" ~ \"#25e158\",\n      sub_type == \"Location\" ~ \"#ec4bff\",\n      TRUE ~ \"black\"\n    ),\n    shape = case_when(\n      sub_type == \"Person\" ~ \"dot\",\n      sub_type == \"Organization\" ~ \"square\",\n      sub_type == \"Vessel\" ~ \"triangle\",\n      sub_type == \"Group\" ~ \"star\",\n      sub_type == \"Location\" ~ \"diamond\",\n      TRUE ~ \"dot\"\n    )\n  )\n\n# Step 4: Format edges\nedges_vis <- comm_edges_vis %>%\n  mutate(\n    arrows = \"to\",\n    width = rescale(value, to = c(1, 6)),\n    title = paste(\"Messages:\", value)\n  )\n\n# Step 5: Legend mapping\nlegend_nodes <- data.frame(\n  label = c(\"Person\", \"Organization\", \"Vessel\", \"Group\", \"Location\"),\n  color = c(\"#2ca5ff\", \"#f5ee15\", \"#FB7E81\", \"#25e158\", \"#ec4bff\"),\n  shape = c(\"dot\", \"square\", \"triangle\", \"star\", \"diamond\"),\n  stringsAsFactors = FALSE\n)\n\n# Step 6: Render the network with layout_on_sphere and legend\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"900px\") %>%\n  visNodes(\n    size = nodes_vis$size\n    # color and shape columns are automatically used\n  ) %>%\n  visLegend(\n    addNodes = lapply(1:nrow(legend_nodes), function(i) {\n      list(\n        label = legend_nodes$label[i],\n        shape = legend_nodes$shape[i],\n        color = legend_nodes$color[i]\n      )\n    }),\n    useGroups = FALSE,\n    width = 0.15\n  ) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visIgraphLayout(layout = \"layout_on_sphere\") %>%\n  visPhysics(enabled = FALSE) %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-175c971dccb8e6d83228\" style=\"width:100%;height:900px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-175c971dccb8e6d83228\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Port Security\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Port Security\"],\"sub_type\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Group\",\"Location\",\"Location\",\"Location\",\"Location\"],\"sent_count\":[1,2,8,5,11,9,25,14,20,18,24,33,3,19,13,9,7,4,37,44,15,2,34,7,8,35,34,14,3,14,18,6,5,4,25,4,null,16,7,27,null],\"size\":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],\"title\":[\"Sam<br>Sub-type: Person<br>Sent: 1 messages\",\"Kelly<br>Sub-type: Person<br>Sent: 2 messages\",\"Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages\",\"Elise<br>Sub-type: Person<br>Sent: 5 messages\",\"Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages\",\"Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages\",\"Davis<br>Sub-type: Person<br>Sent: 25 messages\",\"Rodriguez<br>Sub-type: Person<br>Sent: 14 messages\",\"Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages\",\"Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages\",\"The Intern<br>Sub-type: Person<br>Sent: 24 messages\",\"The Lookout<br>Sub-type: Person<br>Sent: 33 messages\",\"The Accountant<br>Sub-type: Person<br>Sent: 3 messages\",\"Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages\",\"The Middleman<br>Sub-type: Person<br>Sent: 13 messages\",\"Boss<br>Sub-type: Person<br>Sent: 9 messages\",\"Small Fry<br>Sub-type: Person<br>Sent: 7 messages\",\"Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages\",\"Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages\",\"Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages\",\"V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages\",\"Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages\",\"Neptune<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Marlin<br>Sub-type: Vessel<br>Sent: 7 messages\",\"Serenity<br>Sub-type: Vessel<br>Sent: 8 messages\",\"Mako<br>Sub-type: Vessel<br>Sent: 35 messages\",\"Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages\",\"Horizon<br>Sub-type: Vessel<br>Sent: 14 messages\",\"Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages\",\"EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages\",\"Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages\",\"Osprey<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Defender<br>Sub-type: Vessel<br>Sent: 5 messages\",\"Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages\",\"Remora<br>Sub-type: Vessel<br>Sent: 25 messages\",\"Knowles<br>Sub-type: Vessel<br>Sent: 4 messages\",\"City Officials<br>Sub-type: Group\",\"Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages\",\"Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages\",\"Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages\",\"Port Security<br>Sub-type: Location\"],\"color\":[\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#25e158\",\"#ec4bff\",\"#ec4bff\",\"#ec4bff\",\"#ec4bff\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"star\",\"diamond\",\"diamond\",\"diamond\",\"diamond\"],\"x\":[0.006440927175621391,-0.06664830184967618,-0.4409630997074512,-0.2787167727474305,0.2365064772775034,0.6476746072078645,0.667719144831592,0.2976986554858154,-0.2526935027451958,-0.7129586264042103,-0.8813060495281457,-0.6944798975090127,-0.2316698995019175,0.3317086862019816,0.794708147038439,1,0.8814846985123932,0.4796721568472757,-0.0759052165537506,-0.6094787616592352,-0.9536054047189444,-1,-0.732695736478211,-0.2342851279815245,0.3371692344569699,0.7953258761289943,0.9847209772943193,0.83512595572909,0.393361353839724,-0.1815498231890834,-0.6654615755328198,-0.851148143779292,-0.642764389284291,-0.1259267219792909,0.4310925572677355,0.6825812698064202,0.4211383409771228,-0.1688497446265791,-0.4410178911458582,0.09467015775055376,0.006440927175621391],\"y\":[-0.01598891125852964,0.2954839704434384,0.006862204298155872,-0.4747234670075287,-0.5862691145784071,-0.2409750687836689,0.3014469779380633,0.7063569373476082,0.7617907495947651,0.4507146812594094,-0.08001565513005549,-0.6066112860066712,-0.924405409326406,-0.9192001757418308,-0.5970787360481746,-0.07163254829246113,0.4807357855851913,0.8803103056319443,1,0.8025079340453891,0.3497092889073024,-0.2171529858949235,-0.7203891044614957,-1,-0.9640461487628595,-0.620602608247057,-0.08055603018195756,0.4725053352879633,0.8400550256881181,0.8794642891354818,0.5658741880942779,0.02003717536535121,-0.5188955272797955,-0.7832295634598994,-0.6126999832464018,-0.08620961161376928,0.4389235777464779,0.4945974391681667,-0.03774803939227411,-0.3235418088732364,-0.01598891125852964]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"Green Guardians\",\"Green Guardians\",\"The Lookout\",\"Neptune\",\"Remora\",\"Neptune\",\"Oceanus City Council\",\"The Intern\",\"The Lookout\",\"Himark Harbor\",\"Neptune\",\"Davis\",\"Green Guardians\",\"Liam Thorne\",\"Mrs. Money\",\"Oceanus City Council\",\"Oceanus City Council\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Himark Harbor\",\"Mako\",\"Mrs. Money\",\"Oceanus City Council\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Green Guardians\",\"Horizon\",\"Mako\",\"Mako\",\"Mako\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"Boss\",\"Defender\",\"Elise\",\"Green Guardians\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"Davis\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Boss\",\"Boss\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"EcoVigil\",\"Elise\",\"Elise\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Horizon\",\"Horizon\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Paackland Harbor\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Sam\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"Green Guardians\",\"Oceanus City Council\",\"The Intern\",\"Remora\",\"Mako\",\"V. Miesel Shipping\",\"Liam Thorne\",\"The Lookout\",\"Sam\",\"Oceanus City Council\",\"Mako\",\"Davis\",\"Reef Guardian\",\"Oceanus City Council\",\"Boss\",\"Green Guardians\",\"Paackland Harbor\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Neptune\",\"Remora\",\"The Intern\",\"Himark Harbor\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Horizon\",\"Sentinel\",\"Himark Harbor\",\"Samantha Blake\",\"Sentinel\",\"Remora\",\"Sentinel\",\"EcoVigil\",\"Oceanus City Council\",\"Rodriguez\",\"Remora\",\"Sentinel\",\"Boss\",\"Neptune\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Remora\",\"Seawatch\",\"Serenity\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Mako\",\"Horizon\",\"Marlin\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Mako\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Green Guardians\",\"Mrs. Money\",\"The Accountant\",\"V. Miesel Shipping\",\"EcoVigil\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Marlin\",\"Green Guardians\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Himark Harbor\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Mako\",\"Reef Guardian\",\"Samantha Blake\",\"Oceanus City Council\",\"Reef Guardian\",\"Defender\",\"Mako\",\"Paackland Harbor\",\"Sailor Shifts Team\",\"Green Guardians\",\"Oceanus City Council\",\"Himark Harbor\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Remora\",\"V. Miesel Shipping\",\"Mako\",\"V. Miesel Shipping\",\"Boss\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Seawatch\",\"Oceanus City Council\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Boss\",\"Northern Light\",\"Remora\",\"Samantha Blake\",\"Northern Light\",\"Paackland Harbor\",\"Sentinel\",\"EcoVigil\",\"Knowles\",\"Mako\",\"Nadia Conti\",\"Osprey\",\"Northern Light\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Haacklee Harbor\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Serenity\",\"V. Miesel Shipping\",\"Mako\",\"Oceanus City Council\",\"Reef Guardian\",\"Mako\",\"Remora\",\"V. Miesel Shipping\",\"Haacklee Harbor\",\"Marlin\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"City Officials\",\"Himark Harbor\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Green Guardians\",\"Himark Harbor\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"EcoVigil\",\"Marlin\",\"Nadia Conti\",\"Northern Light\",\"Oceanus City Council\",\"Sentinel\",\"Liam Thorne\",\"Neptune\",\"Port Security\",\"Davis\",\"Himark Harbor\",\"Nadia Conti\",\"Rodriguez\",\"V. Miesel Shipping\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Sailor Shifts Team\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Green Guardians\",\"Himark Harbor\",\"Reef Guardian\",\"Nadia Conti\",\"Paackland Harbor\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"The Intern\",\"Reef Guardian\",\"Paackland Harbor\",\"Boss\",\"Davis\",\"Elise\",\"Mako\",\"Mrs. Money\",\"Nadia Conti\",\"Rodriguez\"],\"value\":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 12\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"size\":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"enabled\":false},\"layout\":{\"randomSeed\":1818}},\"groups\":null,\"width\":\"100%\",\"height\":\"900px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"legend\":{\"width\":0.15,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true,\"nodes\":[{\"label\":\"Person\",\"shape\":\"dot\",\"color\":\"#2ca5ff\"},{\"label\":\"Organization\",\"shape\":\"square\",\"color\":\"#f5ee15\"},{\"label\":\"Vessel\",\"shape\":\"triangle\",\"color\":\"#FB7E81\"},{\"label\":\"Group\",\"shape\":\"star\",\"color\":\"#25e158\"},{\"label\":\"Location\",\"shape\":\"diamond\",\"color\":\"#ec4bff\"}],\"nodesToDataframe\":false},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## 4 - Task 1a & 1b: Daily Temporal Patterns in Communications over the Two Weeks 🎯\n\n::: callout-note\n## VAST Challenge Task & Question 1a and 1b\n\nClepper found that messages frequently came in at around the same time each day.\n\n-   Develop a graph-based visual analytics approach to identify any daily temporal patterns in communications.\n-   How do these patterns shift over the two weeks of observations?\n:::\n\n**Objective**\n\n1.  Identify **when** communications happen most often during each day.\n2.  Detect **shifts in these patterns** over the 2-week period.\n3.  Later: Focus on a **specific entity** (e.g., Nadia Conti) and explore **who influences them**.\n\n### Step 1: Extract & Parse Communication Event Timestamps\n\nExtract the Communication Timestamps from `mc3_nodes_final` and filter for communication events.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Filter for Communication events\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    day = as.Date(timestamp),\n    hour = hour(timestamp)\n  )\n```\n:::\n\n\n\nParse the Communication Timestamp into the format \"dd/mm/yyy (ddd)\" for ease of reference.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Communication events with parsed date and time\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    hour = hour(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\")  # e.g., \"19/03/2040 (Tue)\"\n  )\n```\n:::\n\n\n\n### Step 2: Visualize the Communication Volume for Analysis\n\n#### **4.1 - Bar Plot of daily communication volume over the 2 weeks period:**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Step 1: Prepare daily message volume data\ndaily_message_volume <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(\n    timestamp = ymd_hms(timestamp),\n    date = as.Date(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\")\n  ) %>%\n  group_by(date, date_label) %>%\n  summarise(message_count = n(), .groups = \"drop\") %>%\n  arrange(date)\n\n# Step 2: Compute average and total message count\navg_msg_count <- mean(daily_message_volume$message_count)\ntotal_msg_count <- sum(daily_message_volume$message_count)\n\n# Step 3: Plot bar chart with average + total labels\nggplot(daily_message_volume, aes(x = date_label, y = message_count)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  geom_text(\n    aes(label = message_count),\n    vjust = -0.3,\n    size = 2.5,\n    color = \"grey40\"\n  ) +\n  geom_hline(yintercept = avg_msg_count, color = \"red\", linetype = \"dashed\", size = 1.2) +\n  annotate(\n    \"label\", x = 1, y = avg_msg_count + 2,\n    label = paste(\"Average =\", round(avg_msg_count, 1)),\n    color = \"red\", fill = \"grey90\",\n    label.size = 0, hjust = -0.2, vjust = 3\n  ) +\n  annotate(\n    \"label\", x = nrow(daily_message_volume), y = max(daily_message_volume$message_count) + 5,\n    label = paste(\"Total =\", total_msg_count),\n    color = \"black\", fill = \"lightgrey\",\n    label.size = 0.3, hjust = 1.1, vjust = 1\n  ) +\n  labs(\n    title = \"Daily Radio Communication Volume\",\n    x = \"Date\",\n    y = \"Message Count\"\n  ) +\n  theme_minimal(base_size = 11) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n#### **4.2 - Interactive Table of daily communication volume variation(message count)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(DT)\n\n# Daily message volume with comparisons\ndaily_message_volume <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(\n    timestamp = ymd_hms(timestamp),\n    date = as.Date(timestamp),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\")\n  ) %>%\n  group_by(date, date_label) %>%\n  summarise(message_count = n(), .groups = \"drop\") %>%\n  arrange(date) %>%\n  mutate(\n    change_from_prev = message_count - lag(message_count),\n    pct_change_from_prev = round((message_count - lag(message_count)) / lag(message_count) * 100, 2)\n  )\n\ndatatable(\n  daily_message_volume %>% select(-date),  # remove raw date if not needed\n  caption = \"Daily Message Volume with Day-over-Day Change\",\n  options = list(pageLength = 14, order = list(list(0, 'asc'))),\n  rownames = FALSE\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-08444c9e699161510b2c\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-08444c9e699161510b2c\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"caption\":\"<caption>Daily Message Volume with Day-over-Day Change<\\/caption>\",\"data\":[[\"01/10/2040 (Mon)\",\"02/10/2040 (Tue)\",\"03/10/2040 (Wed)\",\"04/10/2040 (Thu)\",\"05/10/2040 (Fri)\",\"06/10/2040 (Sat)\",\"07/10/2040 (Sun)\",\"08/10/2040 (Mon)\",\"09/10/2040 (Tue)\",\"10/10/2040 (Wed)\",\"11/10/2040 (Thu)\",\"12/10/2040 (Fri)\",\"13/10/2040 (Sat)\",\"14/10/2040 (Sun)\"],[44,46,46,40,45,38,42,43,35,34,49,43,42,37],[null,2,0,-6,5,-7,4,1,-8,-1,15,-6,-1,-5],[null,4.55,0,-13.04,12.5,-15.56,10.53,2.38,-18.6,-2.86,44.12,-12.24,-2.33,-11.9]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th>date_label<\\/th>\\n      <th>message_count<\\/th>\\n      <th>change_from_prev<\\/th>\\n      <th>pct_change_from_prev<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":14,\"order\":[[0,\"asc\"]],\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3]},{\"name\":\"date_label\",\"targets\":0},{\"name\":\"message_count\",\"targets\":1},{\"name\":\"change_from_prev\",\"targets\":2},{\"name\":\"pct_change_from_prev\",\"targets\":3}],\"autoWidth\":false,\"orderClasses\":false,\"lengthMenu\":[10,14,25,50,100]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### **4.3a - Heat Map of hourly message volume for each day over the 2 weeks period:**\n\nThis heat map is interactive and you may choose to hover on the tile to display the **date, time, and message count**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(forcats)\nlibrary(plotly)\n\n# Step 1: Reconstruct sender–receiver–timestamp structure\ncomm_events_raw <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  select(event_id = id, timestamp) %>%\n  mutate(timestamp = ymd_hms(timestamp),\n         hour = hour(timestamp),\n         date_label = format(timestamp, \"%d/%m/%Y (%a)\"))\n\n# Step 2: Get sender (sent) and receiver (received) links\ncomm_edges_sent <- mc3_edges_cleaned %>%\n  filter(type == \"sent\") %>%\n  select(event_id = to_id, sender_id = from_id)\n\ncomm_edges_recv <- mc3_edges_cleaned %>%\n  filter(type == \"received\") %>%\n  select(event_id = from_id, receiver_id = to_id)\n\n# Step 3: Join all together into sender–receiver–timestamp\ncomm_links <- comm_events_raw %>%\n  left_join(comm_edges_sent, by = \"event_id\") %>%\n  left_join(comm_edges_recv, by = \"event_id\") %>%\n  left_join(mc3_nodes_cleaned %>% select(sender_id = id, sender_label = label), by = \"sender_id\") %>%\n  left_join(mc3_nodes_cleaned %>% select(receiver_id = id, receiver_label = label), by = \"receiver_id\")\n\n# Step 4: Aggregate total messages per hour/day\ncomm_heatmap <- comm_links %>%\n  group_by(date_label, hour) %>%\n  summarise(\n    count = n(),\n    top_sender = names(sort(table(sender_label), decreasing = TRUE))[1],\n    sender_count = max(table(sender_label)),\n    top_receiver = names(sort(table(receiver_label), decreasing = TRUE))[1],\n    receiver_count = max(table(receiver_label)),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    tooltip = paste0(\n      \"📅 Date: \", date_label,\n      \"<br>⏰ Hour: \", sprintf(\"%02d:00\", hour),\n      \"<br>📨 Messages: \", count,\n      \"<br>🔴 Top Sender: \", top_sender, \" (\", sender_count, \")\",\n      \"<br>🟢 Top Receiver: \", top_receiver, \" (\", receiver_count, \")\"\n    )\n  )\n\n# Step 5: Static ggplot\np <- ggplot(comm_heatmap, aes(\n  x = hour,\n  y = fct_rev(factor(date_label)),\n  fill = count,\n  text = tooltip\n)) +\n  geom_tile(color = \"white\") +\n  scale_fill_viridis_c(option = \"inferno\", direction = -1, name = \"Message Count\") +\n  scale_x_continuous(\n    breaks = 0:23,\n    labels = function(x) sprintf(\"%02d:00\", x)\n  ) +\n  labs(\n    title = \"Hourly Heatmap of Radio Communications by Day\",\n    x = \"Hour of Day\",\n    y = NULL\n  ) +\n  theme_minimal(base_size = 10) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid = element_blank()\n  )\n\n# Step 6: Make interactive\nggplotly(p, tooltip = \"text\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-7f489343c35a3911d555\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7f489343c35a3911d555\">{\"x\":{\"data\":[{\"x\":[8,9,10,11,12,13,14],\"y\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14],\"z\":[[0.39130434782608697,0.2608695652173913,0.043478260869565216,0.17391304347826086,0.39130434782608697,0.086956521739130432,null],[0.34782608695652173,0.17391304347826086,null,0.21739130434782608,0.78260869565217395,0.086956521739130432,null],[0.13043478260869565,0.69565217391304346,0.21739130434782608,0.43478260869565216,0.17391304347826086,null,null],[0.43478260869565216,0.69565217391304346,0.86956521739130432,null,null,null,null],[0.086956521739130432,0.43478260869565216,0.21739130434782608,0.21739130434782608,0.21739130434782608,null,0.043478260869565216],[0.21739130434782608,0.13043478260869565,0.56521739130434778,0.17391304347826086,0.17391304347826086,0,null],[0.47826086956521741,null,0.52173913043478259,0.73913043478260865,null,null,null],[0.13043478260869565,0.34782608695652173,0.56521739130434778,0.56521739130434778,0,null,null],[null,0.34782608695652173,0.21739130434782608,0.2608695652173913,0.30434782608695654,0.30434782608695654,null],[0.2608695652173913,0.43478260869565216,1,null,0.086956521739130432,null,null],[0.39130434782608697,0.13043478260869565,0.34782608695652173,0.21739130434782608,0.043478260869565216,0.34782608695652173,null],[0.60869565217391308,0.43478260869565216,0.78260869565217395,0,null,null,null],[0.43478260869565216,0.043478260869565216,0.17391304347826086,0.17391304347826086,0.73913043478260865,0.17391304347826086,null],[0.60869565217391308,0.21739130434782608,0.30434782608695654,0.2608695652173913,0.30434782608695654,null,null]],\"text\":[[\"📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 08:00<br>📨 Messages: 10<br>🔴 Top Sender: Reef Guardian (2)<br>🟢 Top Receiver: The Intern (2)\",\"📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 09:00<br>📨 Messages: 7<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Boss (1)\",\"📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 10:00<br>📨 Messages: 2<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Reef Guardian (1)\",\"📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: EcoVigil (3)<br>🟢 Top Receiver: Sentinel (2)\",\"📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 12:00<br>📨 Messages: 10<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (2)\",\"📅 Date: 14/10/2040 (Sun)<br>⏰ Hour: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Knowles (2)<br>🟢 Top Receiver: Davis (2)\",null],[\"📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 08:00<br>📨 Messages: 9<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Sam (2)\",\"📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 09:00<br>📨 Messages: 5<br>🔴 Top Sender: Horizon (2)<br>🟢 Top Receiver: Green Guardians (1)\",null,\"📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Haacklee Harbor (2)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 12:00<br>📨 Messages: 19<br>🔴 Top Sender: Green Guardians (4)<br>🟢 Top Receiver: Sentinel (4)\",\"📅 Date: 13/10/2040 (Sat)<br>⏰ Hour: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Oceanus City Council (2)\",null],[\"📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: Liam Thorne (1)\",\"📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 09:00<br>📨 Messages: 17<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Mako (5)\",\"📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Green Guardians (3)<br>🟢 Top Receiver: Oceanus City Council (2)\",\"📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 11:00<br>📨 Messages: 11<br>🔴 Top Sender: V. Miesel Shipping (3)<br>🟢 Top Receiver: V. Miesel Shipping (3)\",\"📅 Date: 12/10/2040 (Fri)<br>⏰ Hour: 12:00<br>📨 Messages: 5<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Remora (2)\",null,null],[\"📅 Date: 11/10/2040 (Thu)<br>⏰ Hour: 08:00<br>📨 Messages: 11<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: The Intern (3)\",\"📅 Date: 11/10/2040 (Thu)<br>⏰ Hour: 09:00<br>📨 Messages: 17<br>🔴 Top Sender: EcoVigil (4)<br>🟢 Top Receiver: EcoVigil (3)\",\"📅 Date: 11/10/2040 (Thu)<br>⏰ Hour: 10:00<br>📨 Messages: 21<br>🔴 Top Sender: Miranda Jordan (5)<br>🟢 Top Receiver: Clepper Jensen (5)\",null,null,null,null],[\"📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 08:00<br>📨 Messages: 3<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: Sam (1)\",\"📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: Mako (3)<br>🟢 Top Receiver: EcoVigil (3)\",\"📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Horizon (1)\",\"📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Samantha Blake (2)<br>🟢 Top Receiver: Samantha Blake (2)\",\"📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 12:00<br>📨 Messages: 6<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Liam Thorne (1)\",null,\"📅 Date: 10/10/2040 (Wed)<br>⏰ Hour: 14:00<br>📨 Messages: 2<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Horizon (1)\"],[\"📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 08:00<br>📨 Messages: 6<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Mrs. Money (2)\",\"📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (1)<br>🟢 Top Receiver: Neptune (1)\",\"📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 10:00<br>📨 Messages: 14<br>🔴 Top Sender: Reef Guardian (4)<br>🟢 Top Receiver: Green Guardians (3)\",\"📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: V. Miesel Shipping (2)<br>🟢 Top Receiver: V. Miesel Shipping (2)\",\"📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 12:00<br>📨 Messages: 5<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Himark Harbor (2)\",\"📅 Date: 09/10/2040 (Tue)<br>⏰ Hour: 13:00<br>📨 Messages: 1<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Liam Thorne (1)\",null],[\"📅 Date: 08/10/2040 (Mon)<br>⏰ Hour: 08:00<br>📨 Messages: 12<br>🔴 Top Sender: Nadia Conti (3)<br>🟢 Top Receiver: Nadia Conti (3)\",null,\"📅 Date: 08/10/2040 (Mon)<br>⏰ Hour: 10:00<br>📨 Messages: 13<br>🔴 Top Sender: Mako (3)<br>🟢 Top Receiver: Mako (5)\",\"📅 Date: 08/10/2040 (Mon)<br>⏰ Hour: 11:00<br>📨 Messages: 18<br>🔴 Top Sender: Davis (3)<br>🟢 Top Receiver: Sentinel (3)\",null,null,null],[\"📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Sam (2)\",\"📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 09:00<br>📨 Messages: 9<br>🔴 Top Sender: Mako (3)<br>🟢 Top Receiver: Mako (3)\",\"📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 10:00<br>📨 Messages: 14<br>🔴 Top Sender: Clepper Jensen (5)<br>🟢 Top Receiver: Miranda Jordan (5)\",\"📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 11:00<br>📨 Messages: 14<br>🔴 Top Sender: Neptune (4)<br>🟢 Top Receiver: Remora (4)\",\"📅 Date: 07/10/2040 (Sun)<br>⏰ Hour: 12:00<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Nadia Conti (1)\",null,null],[null,\"📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 09:00<br>📨 Messages: 9<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (3)\",\"📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Paackland Harbor (2)\",\"📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 11:00<br>📨 Messages: 7<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Neptune (2)\",\"📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 12:00<br>📨 Messages: 8<br>🔴 Top Sender: Neptune (4)<br>🟢 Top Receiver: Neptune (2)\",\"📅 Date: 06/10/2040 (Sat)<br>⏰ Hour: 13:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (5)<br>🟢 Top Receiver: Green Guardians (2)\",null],[\"📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 08:00<br>📨 Messages: 7<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Green Guardians (3)\",\"📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: Oceanus City Council (3)<br>🟢 Top Receiver: Oceanus City Council (3)\",\"📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 10:00<br>📨 Messages: 24<br>🔴 Top Sender: Clepper Jensen (3)<br>🟢 Top Receiver: Oceanus City Council (4)\",null,\"📅 Date: 05/10/2040 (Fri)<br>⏰ Hour: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Clepper Jensen (1)<br>🟢 Top Receiver: Clepper Jensen (1)\",null,null],[\"📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 08:00<br>📨 Messages: 10<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Mako (3)\",\"📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Sentinel (2)\",\"📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 10:00<br>📨 Messages: 9<br>🔴 Top Sender: The Middleman (3)<br>🟢 Top Receiver: Boss (3)\",\"📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Davis (2)\",\"📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 12:00<br>📨 Messages: 2<br>🔴 Top Sender: Sentinel (1)<br>🟢 Top Receiver: Horizon (1)\",\"📅 Date: 04/10/2040 (Thu)<br>⏰ Hour: 13:00<br>📨 Messages: 9<br>🔴 Top Sender: Boss (2)<br>🟢 Top Receiver: Mako (3)\",null],[\"📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 08:00<br>📨 Messages: 15<br>🔴 Top Sender: Green Guardians (4)<br>🟢 Top Receiver: Oceanus City Council (3)\",\"📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: Clepper Jensen (3)<br>🟢 Top Receiver: Clepper Jensen (3)\",\"📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 10:00<br>📨 Messages: 19<br>🔴 Top Sender: Northern Light (3)<br>🟢 Top Receiver: Paackland Harbor (5)\",\"📅 Date: 03/10/2040 (Wed)<br>⏰ Hour: 11:00<br>📨 Messages: 1<br>🔴 Top Sender: Rodriguez (1)<br>🟢 Top Receiver: Davis (1)\",null,null,null],[\"📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 08:00<br>📨 Messages: 11<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Sam (2)\",\"📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 09:00<br>📨 Messages: 2<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (1)\",\"📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 10:00<br>📨 Messages: 5<br>🔴 Top Sender: EcoVigil (2)<br>🟢 Top Receiver: EcoVigil (2)\",\"📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Boss (1)\",\"📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 12:00<br>📨 Messages: 18<br>🔴 Top Sender: Clepper Jensen (4)<br>🟢 Top Receiver: Mako (4)\",\"📅 Date: 02/10/2040 (Tue)<br>⏰ Hour: 13:00<br>📨 Messages: 5<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Mako (1)\",null],[\"📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 08:00<br>📨 Messages: 15<br>🔴 Top Sender: Boss (3)<br>🟢 Top Receiver: Boss (4)\",\"📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 09:00<br>📨 Messages: 6<br>🔴 Top Sender: Boss (1)<br>🟢 Top Receiver: Serenity (2)\",\"📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 10:00<br>📨 Messages: 8<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Mrs. Money (2)\",\"📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 11:00<br>📨 Messages: 7<br>🔴 Top Sender: Marlin (2)<br>🟢 Top Receiver: Marlin (2)\",\"📅 Date: 01/10/2040 (Mon)<br>⏰ Hour: 12:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Horizon (2)\",null,null]],\"colorscale\":[[0,\"#FCFFA4\"],[0.043478260869565216,\"#FFEB88\"],[0.086956521739130432,\"#FFD86B\"],[0.13043478260869565,\"#FFC44D\"],[0.17391304347826086,\"#FEB12B\"],[0.21739130434782608,\"#FA9E15\"],[0.2608695652173913,\"#F38D24\"],[0.30434782608695654,\"#ED7B2D\"],[0.34782608695652173,\"#E66934\"],[0.39130434782608697,\"#DE5539\"],[0.43478260869565216,\"#D14943\"],[0.47826086956521741,\"#C1404E\"],[0.52173913043478259,\"#B13657\"],[0.56521739130434778,\"#A12D60\"],[0.60869565217391308,\"#902567\"],[0.69565217391304346,\"#6E1768\"],[0.73913043478260865,\"#5D1168\"],[0.78260869565217395,\"#4A0C68\"],[0.86956521739130432,\"#2E0E45\"],[1,\"#000004\"]],\"type\":\"heatmap\",\"showscale\":false,\"autocolorscale\":false,\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[8],\"y\":[1],\"name\":\"0f46f65a832e95b0232c3c1582af6256\",\"type\":\"scatter\",\"mode\":\"markers\",\"opacity\":0,\"hoverinfo\":\"skip\",\"showlegend\":false,\"marker\":{\"color\":[0,1],\"colorscale\":[[0,\"#FCFFA4\"],[0.0033444816053511683,\"#FCFDA2\"],[0.0066889632107023367,\"#FDFCA0\"],[0.010033444816053515,\"#FDFA9D\"],[0.013377926421404684,\"#FDF99B\"],[0.016722408026755852,\"#FEF799\"],[0.020066889632107031,\"#FEF697\"],[0.023411371237458199,\"#FEF495\"],[0.026755852842809368,\"#FEF392\"],[0.030100334448160536,\"#FFF190\"],[0.033444816053511704,\"#FFF08E\"],[0.03678929765886288,\"#FFEE8C\"],[0.040133779264214048,\"#FFED8A\"],[0.043478260869565216,\"#FFEB88\"],[0.046822742474916398,\"#FFEA85\"],[0.050167224080267574,\"#FFE883\"],[0.053511705685618735,\"#FFE781\"],[0.05685618729096989,\"#FFE57F\"],[0.060200668896321072,\"#FFE47D\"],[0.06354515050167224,\"#FFE27A\"],[0.066889632107023408,\"#FFE178\"],[0.070234113712374577,\"#FFDF76\"],[0.073578595317725759,\"#FFDE74\"],[0.076923076923076913,\"#FFDC72\"],[0.080267558528428096,\"#FFDB6F\"],[0.083612040133779278,\"#FFD96D\"],[0.086956521739130432,\"#FFD86B\"],[0.090301003344481615,\"#FFD669\"],[0.093645484949832797,\"#FFD566\"],[0.096989966555183951,\"#FFD364\"],[0.10033444816053513,\"#FFD262\"],[0.10367892976588629,\"#FFD060\"],[0.10702341137123747,\"#FFCF5D\"],[0.11036789297658864,\"#FFCD5B\"],[0.11371237458193981,\"#FFCC59\"],[0.11705685618729098,\"#FFCA56\"],[0.12040133779264214,\"#FFC954\"],[0.12374581939799331,\"#FFC752\"],[0.12709030100334448,\"#FFC64F\"],[0.13043478260869565,\"#FFC44D\"],[0.13377926421404682,\"#FFC34B\"],[0.13712374581939801,\"#FFC148\"],[0.14046822742474915,\"#FFC046\"],[0.14381270903010038,\"#FFBE43\"],[0.14715719063545152,\"#FFBD41\"],[0.15050167224080269,\"#FFBB3E\"],[0.15384615384615383,\"#FFBA3C\"],[0.157190635451505,\"#FFB839\"],[0.16053511705685619,\"#FFB736\"],[0.16387959866220739,\"#FFB534\"],[0.16722408026755856,\"#FEB431\"],[0.17056856187290972,\"#FEB22E\"],[0.17391304347826086,\"#FEB12B\"],[0.17725752508361206,\"#FEAF28\"],[0.18060200668896323,\"#FDAE25\"],[0.1839464882943144,\"#FDAC21\"],[0.18729096989966559,\"#FDAB1D\"],[0.19063545150501673,\"#FDA919\"],[0.1939799331103679,\"#FCA815\"],[0.19732441471571907,\"#FCA60F\"],[0.20066889632107027,\"#FCA50B\"],[0.20401337792642141,\"#FBA30D\"],[0.20735785953177258,\"#FBA20F\"],[0.21070234113712377,\"#FAA111\"],[0.21404682274247494,\"#FA9F13\"],[0.21739130434782608,\"#FA9E15\"],[0.22073578595317728,\"#F99D16\"],[0.22408026755852845,\"#F99C18\"],[0.22742474916387961,\"#F89A19\"],[0.23076923076923081,\"#F8991B\"],[0.23411371237458195,\"#F7981C\"],[0.23745819397993312,\"#F7961D\"],[0.24080267558528429,\"#F6951E\"],[0.24414715719063548,\"#F6941F\"],[0.24749163879598662,\"#F59220\"],[0.25083612040133779,\"#F59121\"],[0.25418060200668896,\"#F49022\"],[0.25752508361204013,\"#F48E23\"],[0.2608695652173913,\"#F38D24\"],[0.26421404682274252,\"#F38C25\"],[0.26755852842809363,\"#F28A26\"],[0.2709030100334448,\"#F28926\"],[0.27424749163879603,\"#F18727\"],[0.27759197324414719,\"#F18628\"],[0.28093645484949831,\"#F08529\"],[0.28428093645484953,\"#F08329\"],[0.2876254180602007,\"#EF822A\"],[0.29096989966555187,\"#EF812B\"],[0.29431438127090304,\"#EE7F2B\"],[0.2976588628762542,\"#EE7E2C\"],[0.30100334448160537,\"#ED7D2D\"],[0.30434782608695654,\"#ED7B2D\"],[0.30769230769230765,\"#EC7A2E\"],[0.31103678929765882,\"#EC782E\"],[0.31438127090300999,\"#EB772F\"],[0.31772575250836121,\"#EA7630\"],[0.32107023411371238,\"#EA7430\"],[0.32441471571906355,\"#E97331\"],[0.32775919732441477,\"#E97131\"],[0.33110367892976594,\"#E87032\"],[0.33444816053511711,\"#E86F32\"],[0.33779264214046828,\"#E76D33\"],[0.34113712374581945,\"#E76C33\"],[0.34448160535117056,\"#E66A34\"],[0.34782608695652173,\"#E66934\"],[0.3511705685618729,\"#E56734\"],[0.35451505016722412,\"#E56635\"],[0.35785953177257529,\"#E46435\"],[0.36120401337792646,\"#E36336\"],[0.36454849498327763,\"#E36136\"],[0.3678929765886288,\"#E26037\"],[0.37123745819397991,\"#E25E37\"],[0.37458193979933119,\"#E15D37\"],[0.3779264214046823,\"#E15B38\"],[0.38127090301003347,\"#E05A38\"],[0.38461538461538464,\"#E05838\"],[0.38795986622073581,\"#DF5739\"],[0.39130434782608697,\"#DE5539\"],[0.39464882943143814,\"#DE5439\"],[0.39799331103678937,\"#DD523A\"],[0.40133779264214053,\"#DD513A\"],[0.40468227424749165,\"#DB503B\"],[0.40802675585284282,\"#DA4F3C\"],[0.41137123745819398,\"#D94E3D\"],[0.41471571906354515,\"#D84E3E\"],[0.41806020066889638,\"#D74D3F\"],[0.42140468227424754,\"#D54C40\"],[0.42474916387959871,\"#D44B41\"],[0.42809364548494988,\"#D34B42\"],[0.43143812709030099,\"#D24A42\"],[0.43478260869565216,\"#D14943\"],[0.43812709030100333,\"#CF4944\"],[0.44147157190635455,\"#CE4845\"],[0.44481605351170572,\"#CD4746\"],[0.44816053511705689,\"#CC4647\"],[0.45150501672240806,\"#CB4647\"],[0.45484949832775923,\"#C94548\"],[0.45819397993311034,\"#C84449\"],[0.46153846153846162,\"#C7434A\"],[0.46488294314381273,\"#C6434B\"],[0.4682274247491639,\"#C5424B\"],[0.47157190635451507,\"#C3414C\"],[0.47491638795986624,\"#C2404D\"],[0.47826086956521741,\"#C1404E\"],[0.48160535117056857,\"#C03F4E\"],[0.4849498327759198,\"#BF3E4F\"],[0.48829431438127097,\"#BD3E50\"],[0.49163879598662208,\"#BC3D51\"],[0.49498327759197325,\"#BB3C51\"],[0.49832775919732442,\"#BA3B52\"],[0.50167224080267558,\"#B93B53\"],[0.50501672240802686,\"#B73A54\"],[0.50836120401337792,\"#B63954\"],[0.51170568561872909,\"#B53955\"],[0.51505016722408026,\"#B43856\"],[0.51839464882943143,\"#B23756\"],[0.52173913043478259,\"#B13657\"],[0.52508361204013387,\"#B03658\"],[0.52842809364548504,\"#AF3559\"],[0.53177257525083621,\"#AD3459\"],[0.53511705685618727,\"#AC345A\"],[0.53846153846153844,\"#AB335B\"],[0.5418060200668896,\"#AA325B\"],[0.54515050167224077,\"#A8315C\"],[0.54849498327759205,\"#A7315D\"],[0.55183946488294322,\"#A6305D\"],[0.55518394648829439,\"#A52F5E\"],[0.55852842809364556,\"#A32F5F\"],[0.56187290969899661,\"#A22E5F\"],[0.56521739130434778,\"#A12D60\"],[0.56856187290969906,\"#9F2C61\"],[0.57190635451505023,\"#9E2C61\"],[0.5752508361204014,\"#9D2B62\"],[0.57859531772575257,\"#9B2A63\"],[0.58193979933110374,\"#9A2A63\"],[0.5852842809364549,\"#992964\"],[0.58862876254180607,\"#982865\"],[0.59197324414715724,\"#962865\"],[0.59531772575250841,\"#952766\"],[0.59866220735785958,\"#942667\"],[0.60200668896321075,\"#922667\"],[0.60535117056856191,\"#912567\"],[0.60869565217391308,\"#902567\"],[0.61204013377926425,\"#8E2467\"],[0.61538461538461542,\"#8D2467\"],[0.61872909698996659,\"#8C2367\"],[0.62207357859531776,\"#8B2367\"],[0.62541806020066892,\"#892267\"],[0.62876254180602009,\"#882167\"],[0.63210702341137126,\"#872167\"],[0.63545150501672243,\"#862067\"],[0.6387959866220736,\"#842067\"],[0.64214046822742477,\"#831F67\"],[0.64548494983277593,\"#821F67\"],[0.6488294314381271,\"#811E67\"],[0.65217391304347827,\"#7F1E67\"],[0.65551839464882955,\"#7E1D68\"],[0.65886287625418061,\"#7D1D68\"],[0.66220735785953189,\"#7B1C68\"],[0.66555183946488294,\"#7A1C68\"],[0.66889632107023422,\"#791B68\"],[0.67224080267558517,\"#781B68\"],[0.67558528428093656,\"#761A68\"],[0.67892976588628773,\"#751A68\"],[0.6822742474916389,\"#741968\"],[0.68561872909698995,\"#721968\"],[0.68896321070234112,\"#711868\"],[0.69230769230769229,\"#701868\"],[0.69565217391304346,\"#6E1768\"],[0.69899665551839463,\"#6D1768\"],[0.7023411371237458,\"#6C1668\"],[0.70568561872909696,\"#6A1668\"],[0.70903010033444824,\"#691568\"],[0.71237458193979941,\"#681568\"],[0.71571906354515058,\"#661568\"],[0.71906354515050175,\"#651468\"],[0.72240802675585292,\"#641468\"],[0.72575250836120409,\"#621368\"],[0.72909698996655525,\"#611368\"],[0.73244147157190642,\"#601268\"],[0.73578595317725759,\"#5E1268\"],[0.73913043478260865,\"#5D1168\"],[0.74247491638795982,\"#5C1168\"],[0.74581939799331098,\"#5A1068\"],[0.74916387959866237,\"#591068\"],[0.75250836120401343,\"#571068\"],[0.7558528428093646,\"#560F68\"],[0.75919732441471577,\"#540F68\"],[0.76254180602006694,\"#530E68\"],[0.76588628762541811,\"#520E68\"],[0.76923076923076927,\"#500D68\"],[0.77257525083612044,\"#4F0D68\"],[0.77591973244147161,\"#4D0D68\"],[0.77926421404682278,\"#4C0C68\"],[0.78260869565217395,\"#4A0C68\"],[0.78595317725752512,\"#490C68\"],[0.78929765886287628,\"#470B68\"],[0.79264214046822756,\"#460B68\"],[0.79598662207357873,\"#440A68\"],[0.7993311036789299,\"#420A68\"],[0.80267558528428107,\"#410A67\"],[0.80602006688963213,\"#400B65\"],[0.80936454849498329,\"#3F0B63\"],[0.81270903010033446,\"#3E0B61\"],[0.81605351170568563,\"#3D0C60\"],[0.8193979933110368,\"#3C0C5E\"],[0.82274247491638797,\"#3B0C5C\"],[0.82608695652173914,\"#3A0C5A\"],[0.8294314381270903,\"#390D59\"],[0.83277591973244147,\"#380D57\"],[0.83612040133779275,\"#370D55\"],[0.83946488294314392,\"#360D54\"],[0.84280936454849509,\"#350D52\"],[0.84615384615384626,\"#340D50\"],[0.84949832775919742,\"#330D4F\"],[0.85284280936454859,\"#320E4D\"],[0.85618729096989976,\"#320E4B\"],[0.85953177257525082,\"#310E4A\"],[0.86287625418060199,\"#300E48\"],[0.86622073578595316,\"#2F0E46\"],[0.86956521739130432,\"#2E0E45\"],[0.87290969899665549,\"#2D0E43\"],[0.87625418060200666,\"#2C0E41\"],[0.87959866220735794,\"#2B0E40\"],[0.88294314381270911,\"#2A0E3E\"],[0.88628762541806028,\"#290E3D\"],[0.88963210702341144,\"#280E3B\"],[0.89297658862876261,\"#270E39\"],[0.89632107023411378,\"#260E38\"],[0.89966555183946495,\"#250E36\"],[0.90301003344481612,\"#240E35\"],[0.90635451505016729,\"#230E33\"],[0.90969899665551845,\"#220E32\"],[0.91304347826086951,\"#210D30\"],[0.91638795986622068,\"#200D2E\"],[0.91973244147157185,\"#1F0D2D\"],[0.92307692307692324,\"#1F0D2B\"],[0.92642140468227441,\"#1E0C2A\"],[0.92976588628762546,\"#1D0C28\"],[0.93311036789297663,\"#1C0C27\"],[0.9364548494983278,\"#1B0B25\"],[0.93979933110367897,\"#1A0B24\"],[0.94314381270903014,\"#1A0A23\"],[0.94648829431438131,\"#190921\"],[0.94983277591973247,\"#180920\"],[0.95317725752508364,\"#17081E\"],[0.95652173913043481,\"#16081D\"],[0.95986622073578598,\"#15071B\"],[0.96321070234113715,\"#14061A\"],[0.96655518394648843,\"#130619\"],[0.9698996655518396,\"#110517\"],[0.97324414715719076,\"#100516\"],[0.97658862876254193,\"#0E0414\"],[0.9799331103678931,\"#0C0312\"],[0.98327759197324416,\"#0A0310\"],[0.98662207357859533,\"#08020E\"],[0.98996655518394649,\"#06020C\"],[0.99331103678929766,\"#040109\"],[0.99665551839464883,\"#020107\"],[1,\"#000004\"]],\"colorbar\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"thickness\":23.039999999999996,\"title\":\"Message Count\",\"titlefont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198},\"tickmode\":\"array\",\"ticktext\":[\"5\",\"10\",\"15\",\"20\"],\"tickvals\":[0.17499999999999999,0.39166666666666666,0.60833333333333339,0.82499999999999996],\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":10.62681610626816},\"ticklen\":2,\"len\":0.5}},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":41.238688252386879,\"r\":6.6417600664176026,\"b\":40.934205989380587,\"l\":94.977168949771681},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198},\"title\":{\"text\":\"Hourly Heatmap of Radio Communications by Day\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[7.1500000000000004,14.85],\"tickmode\":\"array\",\"ticktext\":[\"08:00\",\"09:00\",\"10:00\",\"11:00\",\"12:00\",\"13:00\",\"14:00\"],\"tickvals\":[8,9,10,11,12,13,14],\"categoryorder\":\"array\",\"categoryarray\":[\"08:00\",\"09:00\",\"10:00\",\"11:00\",\"12:00\",\"13:00\",\"14:00\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.3208800332087995,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Hour of Day\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,14.6],\"tickmode\":\"array\",\"ticktext\":[\"14/10/2040 (Sun)\",\"13/10/2040 (Sat)\",\"12/10/2040 (Fri)\",\"11/10/2040 (Thu)\",\"10/10/2040 (Wed)\",\"09/10/2040 (Tue)\",\"08/10/2040 (Mon)\",\"07/10/2040 (Sun)\",\"06/10/2040 (Sat)\",\"05/10/2040 (Fri)\",\"04/10/2040 (Thu)\",\"03/10/2040 (Wed)\",\"02/10/2040 (Tue)\",\"01/10/2040 (Mon)\"],\"tickvals\":[1,2,3,3.9999999999999996,5,6,7,7.9999999999999991,9,10,11,12,13,14],\"categoryorder\":\"array\",\"categoryarray\":[\"14/10/2040 (Sun)\",\"13/10/2040 (Sat)\",\"12/10/2040 (Fri)\",\"11/10/2040 (Thu)\",\"10/10/2040 (Wed)\",\"09/10/2040 (Tue)\",\"08/10/2040 (Mon)\",\"07/10/2040 (Sun)\",\"06/10/2040 (Sat)\",\"05/10/2040 (Fri)\",\"04/10/2040 (Thu)\",\"03/10/2040 (Wed)\",\"02/10/2040 (Tue)\",\"01/10/2040 (Mon)\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.3208800332088013,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":10.62681610626816},\"title\":{\"text\":\"Message Count\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"7b4391e22f1\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"heatmap\"}},\"cur_data\":\"7b4391e22f1\",\"visdat\":{\"7b4391e22f1\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nWe will increase the resolution to half-hour time slots.\n\n#### **4.4b - Heat Map of half-hourly message volume for each day over the 2 weeks period:**\n\nThis heat map is interactive and you may choose to hover on the tile to display the **date, time, and message count**.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(forcats)\nlibrary(plotly)\n\n# Step 1: Fix sender and receiver edges\ncomm_edges_sent <- mc3_edges_cleaned %>%\n  filter(type == \"sent\") %>%\n  select(event_id = to_id, sender_id = from_id)\n\ncomm_edges_recv <- mc3_edges_cleaned %>%\n  filter(type == \"received\") %>%\n  select(event_id = from_id, receiver_id = to_id)  # ✅ fixed receiver_id\n\n# Step 2: Reconstruct sender–receiver–event linkage\ncomm_events_raw <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  select(event_id = id, timestamp) %>%\n  mutate(\n    timestamp = ymd_hms(timestamp),\n    hour = hour(timestamp),\n    minute = minute(timestamp),\n    time_bin = hour + ifelse(minute < 30, 0, 0.5),\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\"),\n    time_label = sprintf(\"%02d:%02d\", floor(time_bin), ifelse(time_bin %% 1 == 0, 0, 30))\n  )\n\n# Step 3: Join to get sender/receiver labels\ncomm_links <- comm_events_raw %>%\n  left_join(comm_edges_sent, by = \"event_id\") %>%\n  left_join(comm_edges_recv, by = \"event_id\") %>%\n  left_join(mc3_nodes_cleaned %>% select(id, sender_label = label), by = c(\"sender_id\" = \"id\")) %>%\n  left_join(mc3_nodes_cleaned %>% select(id, receiver_label = label), by = c(\"receiver_id\" = \"id\"))\n\n# Step 4: Aggregate by half-hour + label top actors\ncomm_heatmap <- comm_links %>%\n  group_by(date_label, time_bin, time_label) %>%\n  summarise(\n    count = n(),\n    top_sender = names(sort(table(sender_label), decreasing = TRUE))[1],\n    sender_count = max(table(sender_label)),\n    top_receiver = names(sort(table(receiver_label), decreasing = TRUE))[1],\n    receiver_count = max(table(receiver_label)),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    tooltip = paste0(\n      \"📅 Date: \", date_label,\n      \"<br>🕒 Time: \", time_label,\n      \"<br>📨 Messages: \", count,\n      \"<br>🔴 Top Sender: \", top_sender, \" (\", sender_count, \")\",\n      \"<br>🟢 Top Receiver: \", top_receiver, \" (\", receiver_count, \")\"\n    )\n  )\n\n# Step 5: ggplot\np <- ggplot(comm_heatmap, aes(x = time_bin, y = fct_rev(factor(date_label)), fill = count, text = tooltip)) +\n  geom_tile(color = \"white\") +\n  scale_fill_viridis_c(\n    option = \"inferno\",\n    direction = -1,\n    name = \"Message Count\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  labs(\n    title = \"Half-Hourly Heatmap of Radio Communications by Day\",\n    x = \"Time of Day\",\n    y = NULL\n  ) +\n  theme_minimal(base_size = 10) +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    panel.grid = element_blank()\n  )\n\n# Step 6: Convert to interactive Plotly plot\nggplotly(p, tooltip = \"text\")\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-8dd753b0b23bfec2e741\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8dd753b0b23bfec2e741\">{\"x\":{\"data\":[{\"x\":[8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14],\"y\":[1,2,3,4,5,6,7,8,9,10,11,12,13,14],\"z\":[[0.13333333333333333,0.40000000000000002,0.20000000000000001,0.13333333333333333,null,0.066666666666666666,0,0.20000000000000001,0.33333333333333331,0.20000000000000001,null,0.13333333333333333,null],[0.40000000000000002,0.066666666666666666,0.13333333333333333,0.066666666666666666,null,null,null,0.33333333333333331,0.46666666666666667,0.66666666666666663,0.13333333333333333,null,null],[0,0.13333333333333333,0.20000000000000001,0.80000000000000004,0.13333333333333333,0.13333333333333333,0.59999999999999998,0,null,0.26666666666666666,null,null,null],[0.40000000000000002,0.20000000000000001,0.66666666666666663,0.33333333333333331,0.80000000000000004,0.46666666666666667,null,null,null,null,null,null,null],[0.13333333333333333,null,0.26666666666666666,0.33333333333333331,null,0.33333333333333331,0.33333333333333331,null,0.26666666666666666,0,null,null,0.066666666666666666],[0.20000000000000001,0.066666666666666666,0.20000000000000001,null,0.33333333333333331,0.46666666666666667,0.066666666666666666,0.13333333333333333,0.13333333333333333,0.066666666666666666,null,0,null],[0.53333333333333333,0.13333333333333333,null,null,0.33333333333333331,0.40000000000000002,1,0.066666666666666666,null,null,null,null,null],[0.20000000000000001,null,0.20000000000000001,0.26666666666666666,0.46666666666666667,0.33333333333333331,0.66666666666666663,0.13333333333333333,0,null,null,null,null],[null,null,0.066666666666666666,0.40000000000000002,0.13333333333333333,0.13333333333333333,0.13333333333333333,0.20000000000000001,0.20000000000000001,0.20000000000000001,0.46666666666666667,null,null],[0.066666666666666666,0.26666666666666666,0,0.59999999999999998,0.66666666666666663,0.80000000000000004,null,null,0.13333333333333333,null,null,null,null],[0.26666666666666666,0.26666666666666666,0.20000000000000001,null,0.33333333333333331,0.13333333333333333,0.26666666666666666,0,0.066666666666666666,null,0.13333333333333333,0.33333333333333331,null],[0.26666666666666666,0.59999999999999998,0.26666666666666666,0.33333333333333331,0.73333333333333328,0.40000000000000002,null,0,null,null,null,null,null],[0.33333333333333331,0.26666666666666666,0,0,0.26666666666666666,null,0.066666666666666666,0.13333333333333333,0.66666666666666663,0.40000000000000002,0.26666666666666666,null,null],[0.53333333333333333,0.33333333333333331,0,0.26666666666666666,null,0.46666666666666667,0.33333333333333331,0,0.13333333333333333,0.26666666666666666,null,null,null]],\"text\":[[\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 08:00<br>📨 Messages: 3<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: The Intern (2)\",\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 08:30<br>📨 Messages: 7<br>🔴 Top Sender: Reef Guardian (2)<br>🟢 Top Receiver: EcoVigil (1)\",\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: EcoVigil (1)<br>🟢 Top Receiver: Horizon (1)\",\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 09:30<br>📨 Messages: 3<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Boss (1)\",null,\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 10:30<br>📨 Messages: 2<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Reef Guardian (1)\",\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 11:00<br>📨 Messages: 1<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Port Security (1)\",\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 11:30<br>📨 Messages: 4<br>🔴 Top Sender: EcoVigil (3)<br>🟢 Top Receiver: Sentinel (2)\",\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 12:00<br>📨 Messages: 6<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (2)\",\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 12:30<br>📨 Messages: 4<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (1)\",null,\"📅 Date: 14/10/2040 (Sun)<br>🕒 Time: 13:30<br>📨 Messages: 3<br>🔴 Top Sender: Knowles (2)<br>🟢 Top Receiver: Davis (2)\",null],[\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 08:00<br>📨 Messages: 7<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Sam (2)\",\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 08:30<br>📨 Messages: 2<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 09:00<br>📨 Messages: 3<br>🔴 Top Sender: Horizon (2)<br>🟢 Top Receiver: Horizon (1)\",\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 09:30<br>📨 Messages: 2<br>🔴 Top Sender: Liam Thorne (1)<br>🟢 Top Receiver: Green Guardians (1)\",null,null,null,\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 11:30<br>📨 Messages: 6<br>🔴 Top Sender: Haacklee Harbor (2)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 12:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Sentinel (3)\",\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 12:30<br>📨 Messages: 11<br>🔴 Top Sender: The Lookout (3)<br>🟢 Top Receiver: Mako (2)\",\"📅 Date: 13/10/2040 (Sat)<br>🕒 Time: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Oceanus City Council (2)\",null,null],[\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 08:00<br>📨 Messages: 1<br>🔴 Top Sender: The Lookout (1)<br>🟢 Top Receiver: Sam (1)\",\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 08:30<br>📨 Messages: 3<br>🔴 Top Sender: Nadia Conti (1)<br>🟢 Top Receiver: Liam Thorne (1)\",\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Rodriguez (2)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 09:30<br>📨 Messages: 13<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Mako (4)\",\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 10:00<br>📨 Messages: 3<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 10:30<br>📨 Messages: 3<br>🔴 Top Sender: Green Guardians (3)<br>🟢 Top Receiver: Green Guardians (1)\",\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 11:00<br>📨 Messages: 10<br>🔴 Top Sender: V. Miesel Shipping (3)<br>🟢 Top Receiver: V. Miesel Shipping (3)\",\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Remora (1)<br>🟢 Top Receiver: Mako (1)\",null,\"📅 Date: 12/10/2040 (Fri)<br>🕒 Time: 12:30<br>📨 Messages: 5<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Remora (2)\",null,null,null],[\"📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 08:00<br>📨 Messages: 7<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: The Intern (2)\",\"📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 08:30<br>📨 Messages: 4<br>🔴 Top Sender: EcoVigil (1)<br>🟢 Top Receiver: EcoVigil (1)\",\"📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 09:00<br>📨 Messages: 11<br>🔴 Top Sender: EcoVigil (4)<br>🟢 Top Receiver: EcoVigil (3)\",\"📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 09:30<br>📨 Messages: 6<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Mako (2)\",\"📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 10:00<br>📨 Messages: 13<br>🔴 Top Sender: Miranda Jordan (5)<br>🟢 Top Receiver: Clepper Jensen (5)\",\"📅 Date: 11/10/2040 (Thu)<br>🕒 Time: 10:30<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Green Guardians (3)\",null,null,null,null,null,null,null],[\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 08:00<br>📨 Messages: 3<br>🔴 Top Sender: The Lookout (2)<br>🟢 Top Receiver: Sam (1)\",null,\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 09:00<br>📨 Messages: 5<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (2)\",\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 09:30<br>📨 Messages: 6<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (3)\",null,\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 10:30<br>📨 Messages: 6<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Horizon (1)\",\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Samantha Blake (2)<br>🟢 Top Receiver: Samantha Blake (2)\",null,\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 12:00<br>📨 Messages: 5<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Liam Thorne (1)\",\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 12:30<br>📨 Messages: 1<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Nadia Conti (1)\",null,null,\"📅 Date: 10/10/2040 (Wed)<br>🕒 Time: 14:00<br>📨 Messages: 2<br>🔴 Top Sender: Reef Guardian (1)<br>🟢 Top Receiver: Horizon (1)\"],[\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: Mrs. Money (1)<br>🟢 Top Receiver: Mrs. Money (1)\",\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 08:30<br>📨 Messages: 2<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Mrs. Money (1)\",\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (1)<br>🟢 Top Receiver: Neptune (1)\",null,\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Oceanus City Council (3)\",\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 10:30<br>📨 Messages: 8<br>🔴 Top Sender: Reef Guardian (2)<br>🟢 Top Receiver: Green Guardians (2)\",\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 11:00<br>📨 Messages: 2<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)\",\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 11:30<br>📨 Messages: 3<br>🔴 Top Sender: V. Miesel Shipping (2)<br>🟢 Top Receiver: V. Miesel Shipping (2)\",\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)\",\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 12:30<br>📨 Messages: 2<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)\",null,\"📅 Date: 09/10/2040 (Tue)<br>🕒 Time: 13:30<br>📨 Messages: 1<br>🔴 Top Sender: Elise (1)<br>🟢 Top Receiver: Liam Thorne (1)\",null],[\"📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 08:00<br>📨 Messages: 9<br>🔴 Top Sender: Liam Thorne (2)<br>🟢 Top Receiver: Nadia Conti (3)\",\"📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 08:30<br>📨 Messages: 3<br>🔴 Top Sender: Mrs. Money (1)<br>🟢 Top Receiver: Elise (1)\",null,null,\"📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Mako (3)\",\"📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 10:30<br>📨 Messages: 7<br>🔴 Top Sender: Remora (3)<br>🟢 Top Receiver: Remora (3)\",\"📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 11:00<br>📨 Messages: 16<br>🔴 Top Sender: Davis (3)<br>🟢 Top Receiver: Sentinel (3)\",\"📅 Date: 08/10/2040 (Mon)<br>🕒 Time: 11:30<br>📨 Messages: 2<br>🔴 Top Sender: Horizon (1)<br>🟢 Top Receiver: Green Guardians (1)\",null,null,null,null,null],[\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 08:00<br>📨 Messages: 4<br>🔴 Top Sender: The Intern (2)<br>🟢 Top Receiver: Sam (2)\",null,\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Elise (1)\",\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 09:30<br>📨 Messages: 5<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (2)\",\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 10:00<br>📨 Messages: 8<br>🔴 Top Sender: Clepper Jensen (4)<br>🟢 Top Receiver: Clepper Jensen (4)\",\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 10:30<br>📨 Messages: 6<br>🔴 Top Sender: Reef Guardian (3)<br>🟢 Top Receiver: Reef Guardian (2)\",\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 11:00<br>📨 Messages: 11<br>🔴 Top Sender: Neptune (3)<br>🟢 Top Receiver: Remora (4)\",\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 11:30<br>📨 Messages: 3<br>🔴 Top Sender: Neptune (1)<br>🟢 Top Receiver: Elise (1)\",\"📅 Date: 07/10/2040 (Sun)<br>🕒 Time: 12:00<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Nadia Conti (1)\",null,null,null,null],[null,null,\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 09:00<br>📨 Messages: 2<br>🔴 Top Sender: Mako (1)<br>🟢 Top Receiver: Mako (1)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 09:30<br>📨 Messages: 7<br>🔴 Top Sender: Glitters Team (1)<br>🟢 Top Receiver: Boss (2)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 10:00<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Himark Harbor (1)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 10:30<br>📨 Messages: 3<br>🔴 Top Sender: Mako (1)<br>🟢 Top Receiver: Paackland Harbor (2)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 11:00<br>📨 Messages: 3<br>🔴 Top Sender: Neptune (2)<br>🟢 Top Receiver: Mako (1)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 11:30<br>📨 Messages: 4<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Green Guardians (1)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 12:00<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (2)<br>🟢 Top Receiver: City Officials (1)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 12:30<br>📨 Messages: 4<br>🔴 Top Sender: Neptune (2)<br>🟢 Top Receiver: Neptune (2)\",\"📅 Date: 06/10/2040 (Sat)<br>🕒 Time: 13:00<br>📨 Messages: 8<br>🔴 Top Sender: Green Guardians (5)<br>🟢 Top Receiver: Green Guardians (2)\",null,null],[\"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 08:00<br>📨 Messages: 2<br>🔴 Top Sender: The Intern (1)<br>🟢 Top Receiver: Mrs. Money (1)\",\"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 08:30<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Green Guardians (3)\",\"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 09:00<br>📨 Messages: 1<br>🔴 Top Sender: Rodriguez (1)<br>🟢 Top Receiver: Boss (1)\",\"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 09:30<br>📨 Messages: 10<br>🔴 Top Sender: Oceanus City Council (3)<br>🟢 Top Receiver: Oceanus City Council (3)\",\"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 10:00<br>📨 Messages: 11<br>🔴 Top Sender: Green Guardians (3)<br>🟢 Top Receiver: Oceanus City Council (4)\",\"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 10:30<br>📨 Messages: 13<br>🔴 Top Sender: Mrs. Money (3)<br>🟢 Top Receiver: Mrs. Money (3)\",null,null,\"📅 Date: 05/10/2040 (Fri)<br>🕒 Time: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Clepper Jensen (1)<br>🟢 Top Receiver: Clepper Jensen (1)\",null,null,null,null],[\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 08:00<br>📨 Messages: 5<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Mrs. Money (2)\",\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 08:30<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Mako (3)\",\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 09:00<br>📨 Messages: 4<br>🔴 Top Sender: Sentinel (2)<br>🟢 Top Receiver: Sentinel (2)\",null,\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 10:00<br>📨 Messages: 6<br>🔴 Top Sender: The Middleman (3)<br>🟢 Top Receiver: Boss (3)\",\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 10:30<br>📨 Messages: 3<br>🔴 Top Sender: Davis (2)<br>🟢 Top Receiver: Remora (3)\",\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 11:00<br>📨 Messages: 5<br>🔴 Top Sender: Marlin (2)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 12:00<br>📨 Messages: 2<br>🔴 Top Sender: Sentinel (1)<br>🟢 Top Receiver: Horizon (1)\",null,\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 13:00<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (2)<br>🟢 Top Receiver: Himark Harbor (1)\",\"📅 Date: 04/10/2040 (Thu)<br>🕒 Time: 13:30<br>📨 Messages: 6<br>🔴 Top Sender: Boss (2)<br>🟢 Top Receiver: Mako (2)\",null],[\"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 08:00<br>📨 Messages: 5<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Mrs. Money (2)\",\"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 08:30<br>📨 Messages: 10<br>🔴 Top Sender: Green Guardians (4)<br>🟢 Top Receiver: Oceanus City Council (3)\",\"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 09:00<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Boss (1)\",\"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 09:30<br>📨 Messages: 6<br>🔴 Top Sender: Clepper Jensen (3)<br>🟢 Top Receiver: Clepper Jensen (3)\",\"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 10:00<br>📨 Messages: 12<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Paackland Harbor (5)\",\"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 10:30<br>📨 Messages: 7<br>🔴 Top Sender: Northern Light (3)<br>🟢 Top Receiver: Northern Light (3)\",null,\"📅 Date: 03/10/2040 (Wed)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Rodriguez (1)<br>🟢 Top Receiver: Davis (1)\",null,null,null,null,null],[\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 08:00<br>📨 Messages: 6<br>🔴 Top Sender: Mrs. Money (2)<br>🟢 Top Receiver: Sam (2)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 08:30<br>📨 Messages: 5<br>🔴 Top Sender: Haacklee Harbor (1)<br>🟢 Top Receiver: Himark Harbor (1)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 09:00<br>📨 Messages: 1<br>🔴 Top Sender: Samantha Blake (1)<br>🟢 Top Receiver: Sailor Shifts Team (1)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 09:30<br>📨 Messages: 1<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: EcoVigil (1)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 10:00<br>📨 Messages: 5<br>🔴 Top Sender: EcoVigil (2)<br>🟢 Top Receiver: EcoVigil (2)\",null,\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 11:00<br>📨 Messages: 2<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Mako (1)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 11:30<br>📨 Messages: 3<br>🔴 Top Sender: Himark Harbor (1)<br>🟢 Top Receiver: Boss (1)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 12:00<br>📨 Messages: 11<br>🔴 Top Sender: Clepper Jensen (4)<br>🟢 Top Receiver: Miranda Jordan (4)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 12:30<br>📨 Messages: 7<br>🔴 Top Sender: Mako (2)<br>🟢 Top Receiver: Mako (2)\",\"📅 Date: 02/10/2040 (Tue)<br>🕒 Time: 13:00<br>📨 Messages: 5<br>🔴 Top Sender: Remora (2)<br>🟢 Top Receiver: Mako (1)\",null,null],[\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 08:00<br>📨 Messages: 9<br>🔴 Top Sender: Boss (2)<br>🟢 Top Receiver: Boss (3)\",\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 08:30<br>📨 Messages: 6<br>🔴 Top Sender: Serenity (2)<br>🟢 Top Receiver: Mako (2)\",\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 09:00<br>📨 Messages: 1<br>🔴 Top Sender: Davis (1)<br>🟢 Top Receiver: Davis (1)\",\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 09:30<br>📨 Messages: 5<br>🔴 Top Sender: Boss (1)<br>🟢 Top Receiver: Serenity (2)\",null,\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 10:30<br>📨 Messages: 8<br>🔴 Top Sender: Oceanus City Council (2)<br>🟢 Top Receiver: Mrs. Money (2)\",\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 11:00<br>📨 Messages: 6<br>🔴 Top Sender: Marlin (2)<br>🟢 Top Receiver: Marlin (2)\",\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 11:30<br>📨 Messages: 1<br>🔴 Top Sender: Green Guardians (1)<br>🟢 Top Receiver: Reef Guardian (1)\",\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 12:00<br>📨 Messages: 3<br>🔴 Top Sender: Samantha Blake (2)<br>🟢 Top Receiver: Oceanus City Council (1)\",\"📅 Date: 01/10/2040 (Mon)<br>🕒 Time: 12:30<br>📨 Messages: 5<br>🔴 Top Sender: Green Guardians (2)<br>🟢 Top Receiver: Horizon (2)\",null,null,null]],\"colorscale\":[[0,\"#FCFFA4\"],[0.066666666666666666,\"#FFE178\"],[0.13333333333333333,\"#FFC34B\"],[0.20000000000000001,\"#FCA50A\"],[0.26666666666666666,\"#F28B25\"],[0.33333333333333331,\"#E86F32\"],[0.40000000000000002,\"#DD513A\"],[0.46666666666666667,\"#C5424B\"],[0.53333333333333333,\"#AD345A\"],[0.59999999999999998,\"#932667\"],[0.66666666666666663,\"#7A1C68\"],[0.73333333333333328,\"#5F1268\"],[0.80000000000000004,\"#420A68\"],[1,\"#000004\"]],\"type\":\"heatmap\",\"showscale\":false,\"autocolorscale\":false,\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[7.5],\"y\":[1],\"name\":\"4a3fe985b480de24e74e517b362be2e4\",\"type\":\"scatter\",\"mode\":\"markers\",\"opacity\":0,\"hoverinfo\":\"skip\",\"showlegend\":false,\"marker\":{\"color\":[0,1],\"colorscale\":[[0,\"#FCFFA4\"],[0.0033444816053511683,\"#FCFDA2\"],[0.0066889632107023367,\"#FDFCA0\"],[0.010033444816053521,\"#FDFA9D\"],[0.013377926421404689,\"#FDF99B\"],[0.016722408026755856,\"#FEF799\"],[0.020066889632107024,\"#FEF697\"],[0.023411371237458192,\"#FEF495\"],[0.026755852842809361,\"#FEF392\"],[0.030100334448160529,\"#FFF190\"],[0.033444816053511711,\"#FFF08E\"],[0.036789297658862866,\"#FFEE8C\"],[0.040133779264214048,\"#FFED8A\"],[0.043478260869565216,\"#FFEB88\"],[0.046822742474916385,\"#FFEA85\"],[0.050167224080267567,\"#FFE883\"],[0.053511705685618721,\"#FFE781\"],[0.056856187290969903,\"#FFE57F\"],[0.060200668896321072,\"#FFE47D\"],[0.06354515050167224,\"#FFE27A\"],[0.066889632107023422,\"#FFE178\"],[0.070234113712374577,\"#FFDF76\"],[0.073578595317725731,\"#FFDE74\"],[0.076923076923076941,\"#FFDC72\"],[0.080267558528428096,\"#FFDB6F\"],[0.08361204013377925,\"#FFD96D\"],[0.086956521739130432,\"#FFD86B\"],[0.090301003344481615,\"#FFD669\"],[0.093645484949832769,\"#FFD566\"],[0.096989966555183951,\"#FFD364\"],[0.10033444816053513,\"#FFD262\"],[0.10367892976588629,\"#FFD060\"],[0.10702341137123744,\"#FFCF5D\"],[0.11036789297658862,\"#FFCD5B\"],[0.11371237458193981,\"#FFCC59\"],[0.11705685618729096,\"#FFCA56\"],[0.12040133779264214,\"#FFC954\"],[0.12374581939799333,\"#FFC752\"],[0.12709030100334448,\"#FFC64F\"],[0.13043478260869565,\"#FFC44D\"],[0.13377926421404682,\"#FFC34B\"],[0.13712374581939801,\"#FFC148\"],[0.14046822742474915,\"#FFC046\"],[0.14381270903010035,\"#FFBE43\"],[0.14715719063545149,\"#FFBD41\"],[0.15050167224080269,\"#FFBB3E\"],[0.15384615384615385,\"#FFBA3C\"],[0.15719063545150502,\"#FFB839\"],[0.16053511705685619,\"#FFB736\"],[0.16387959866220736,\"#FFB534\"],[0.16722408026755853,\"#FEB431\"],[0.1705685618729097,\"#FEB22E\"],[0.17391304347826086,\"#FEB12B\"],[0.17725752508361206,\"#FEAF28\"],[0.1806020066889632,\"#FDAE25\"],[0.1839464882943144,\"#FDAC21\"],[0.18729096989966554,\"#FDAB1D\"],[0.19063545150501673,\"#FDA919\"],[0.1939799331103679,\"#FCA815\"],[0.19732441471571907,\"#FCA60F\"],[0.20066889632107027,\"#FCA50B\"],[0.20401337792642144,\"#FBA30D\"],[0.20735785953177258,\"#FBA20F\"],[0.21070234113712374,\"#FAA111\"],[0.21404682274247488,\"#FA9F13\"],[0.21739130434782611,\"#FA9E15\"],[0.22073578595317725,\"#F99D16\"],[0.22408026755852847,\"#F99C18\"],[0.22742474916387961,\"#F89A19\"],[0.23076923076923078,\"#F8991B\"],[0.23411371237458192,\"#F7981C\"],[0.23745819397993309,\"#F7961D\"],[0.24080267558528429,\"#F6951E\"],[0.24414715719063546,\"#F6941F\"],[0.24749163879598665,\"#F59220\"],[0.25083612040133779,\"#F59121\"],[0.25418060200668896,\"#F49022\"],[0.25752508361204013,\"#F48E23\"],[0.2608695652173913,\"#F38D24\"],[0.26421404682274247,\"#F38C25\"],[0.26755852842809363,\"#F28A26\"],[0.2709030100334448,\"#F28926\"],[0.27424749163879603,\"#F18727\"],[0.27759197324414714,\"#F18628\"],[0.28093645484949831,\"#F08529\"],[0.28428093645484953,\"#F08329\"],[0.2876254180602007,\"#EF822A\"],[0.29096989966555181,\"#EF812B\"],[0.29431438127090298,\"#EE7F2B\"],[0.2976588628762542,\"#EE7E2C\"],[0.30100334448160537,\"#ED7D2D\"],[0.30434782608695649,\"#ED7B2D\"],[0.30769230769230771,\"#EC7A2E\"],[0.31103678929765888,\"#EC782E\"],[0.31438127090301005,\"#EB772F\"],[0.31772575250836116,\"#EA7630\"],[0.32107023411371238,\"#EA7430\"],[0.32441471571906355,\"#E97331\"],[0.32775919732441472,\"#E97131\"],[0.33110367892976594,\"#E87032\"],[0.33444816053511706,\"#E86F32\"],[0.33779264214046822,\"#E76D33\"],[0.34113712374581939,\"#E76C33\"],[0.34448160535117062,\"#E66A34\"],[0.34782608695652173,\"#E66934\"],[0.3511705685618729,\"#E56734\"],[0.35451505016722412,\"#E56635\"],[0.35785953177257529,\"#E46435\"],[0.3612040133779264,\"#E36336\"],[0.36454849498327763,\"#E36136\"],[0.3678929765886288,\"#E26037\"],[0.37123745819397996,\"#E25E37\"],[0.37458193979933108,\"#E15D37\"],[0.3779264214046823,\"#E15B38\"],[0.38127090301003347,\"#E05A38\"],[0.38461538461538464,\"#E05838\"],[0.38795986622073581,\"#DF5739\"],[0.39130434782608697,\"#DE5539\"],[0.39464882943143814,\"#DE5439\"],[0.39799331103678931,\"#DD523A\"],[0.40133779264214048,\"#DD513A\"],[0.40468227424749165,\"#DB503B\"],[0.40802675585284282,\"#DA4F3C\"],[0.41137123745819404,\"#D94E3D\"],[0.41471571906354515,\"#D84E3E\"],[0.41806020066889632,\"#D74D3F\"],[0.42140468227424749,\"#D54C40\"],[0.42474916387959871,\"#D44B41\"],[0.42809364548494983,\"#D34B42\"],[0.43143812709030099,\"#D24A42\"],[0.43478260869565222,\"#D14943\"],[0.43812709030100339,\"#CF4944\"],[0.4414715719063545,\"#CE4845\"],[0.44481605351170567,\"#CD4746\"],[0.44816053511705689,\"#CC4647\"],[0.45150501672240806,\"#CB4647\"],[0.45484949832775917,\"#C94548\"],[0.4581939799331104,\"#C84449\"],[0.46153846153846156,\"#C7434A\"],[0.46488294314381273,\"#C6434B\"],[0.46822742474916385,\"#C5424B\"],[0.47157190635451512,\"#C3414C\"],[0.47491638795986618,\"#C2404D\"],[0.47826086956521746,\"#C1404E\"],[0.48160535117056857,\"#C03F4E\"],[0.48494983277591974,\"#BF3E4F\"],[0.48829431438127091,\"#BD3E50\"],[0.49163879598662208,\"#BC3D51\"],[0.4949832775919733,\"#BB3C51\"],[0.49832775919732436,\"#BA3B52\"],[0.50167224080267558,\"#B93B53\"],[0.50501672240802675,\"#B73A54\"],[0.50836120401337792,\"#B63954\"],[0.51170568561872909,\"#B53955\"],[0.51505016722408026,\"#B43856\"],[0.51839464882943154,\"#B23756\"],[0.52173913043478259,\"#B13657\"],[0.52508361204013387,\"#B03658\"],[0.52842809364548493,\"#AF3559\"],[0.5317725752508361,\"#AD3459\"],[0.53511705685618727,\"#AC345A\"],[0.53846153846153844,\"#AB335B\"],[0.5418060200668896,\"#AA325B\"],[0.54515050167224088,\"#A8315C\"],[0.54849498327759205,\"#A7315D\"],[0.55183946488294322,\"#A6305D\"],[0.55518394648829428,\"#A52F5E\"],[0.55852842809364545,\"#A32F5F\"],[0.56187290969899661,\"#A22E5F\"],[0.56521739130434778,\"#A12D60\"],[0.56856187290969906,\"#9F2C61\"],[0.57190635451505023,\"#9E2C61\"],[0.5752508361204014,\"#9D2B62\"],[0.57859531772575257,\"#9B2A63\"],[0.58193979933110362,\"#9A2A63\"],[0.58528428093645479,\"#992964\"],[0.58862876254180596,\"#982865\"],[0.59197324414715724,\"#962865\"],[0.59531772575250841,\"#952766\"],[0.59866220735785958,\"#942667\"],[0.60200668896321075,\"#922667\"],[0.60535117056856191,\"#912567\"],[0.60869565217391297,\"#902567\"],[0.61204013377926414,\"#8E2467\"],[0.61538461538461542,\"#8D2467\"],[0.61872909698996659,\"#8C2367\"],[0.62207357859531776,\"#8B2367\"],[0.62541806020066892,\"#892267\"],[0.62876254180602009,\"#882167\"],[0.63210702341137126,\"#872167\"],[0.63545150501672232,\"#862067\"],[0.6387959866220736,\"#842067\"],[0.64214046822742477,\"#831F67\"],[0.64548494983277593,\"#821F67\"],[0.6488294314381271,\"#811E67\"],[0.65217391304347827,\"#7F1E67\"],[0.65551839464882944,\"#7E1D68\"],[0.65886287625418061,\"#7D1D68\"],[0.66220735785953189,\"#7B1C68\"],[0.66555183946488294,\"#7A1C68\"],[0.66889632107023411,\"#791B68\"],[0.67224080267558528,\"#781B68\"],[0.67558528428093645,\"#761A68\"],[0.67892976588628762,\"#751A68\"],[0.68227424749163879,\"#741968\"],[0.68561872909699006,\"#721968\"],[0.68896321070234123,\"#711868\"],[0.69230769230769229,\"#701868\"],[0.69565217391304346,\"#6E1768\"],[0.69899665551839463,\"#6D1768\"],[0.7023411371237458,\"#6C1668\"],[0.70568561872909696,\"#6A1668\"],[0.70903010033444824,\"#691568\"],[0.71237458193979941,\"#681568\"],[0.71571906354515058,\"#661568\"],[0.71906354515050164,\"#651468\"],[0.72240802675585281,\"#641468\"],[0.72575250836120397,\"#621368\"],[0.72909698996655525,\"#611368\"],[0.73244147157190642,\"#601268\"],[0.73578595317725759,\"#5E1268\"],[0.73913043478260876,\"#5D1168\"],[0.74247491638795993,\"#5C1168\"],[0.74581939799331098,\"#5A1068\"],[0.74916387959866215,\"#591068\"],[0.75250836120401343,\"#571068\"],[0.7558528428093646,\"#560F68\"],[0.75919732441471577,\"#540F68\"],[0.76254180602006694,\"#530E68\"],[0.76588628762541811,\"#520E68\"],[0.76923076923076927,\"#500D68\"],[0.77257525083612033,\"#4F0D68\"],[0.77591973244147161,\"#4D0D68\"],[0.77926421404682278,\"#4C0C68\"],[0.78260869565217395,\"#4A0C68\"],[0.78595317725752512,\"#490C68\"],[0.78929765886287628,\"#470B68\"],[0.79264214046822745,\"#460B68\"],[0.79598662207357862,\"#440A68\"],[0.79933110367892979,\"#420A68\"],[0.80267558528428096,\"#410A67\"],[0.80602006688963213,\"#400B65\"],[0.80936454849498329,\"#3F0B63\"],[0.81270903010033446,\"#3E0B61\"],[0.81605351170568563,\"#3D0C60\"],[0.8193979933110368,\"#3C0C5E\"],[0.82274247491638808,\"#3B0C5C\"],[0.82608695652173914,\"#3A0C5A\"],[0.8294314381270903,\"#390D59\"],[0.83277591973244147,\"#380D57\"],[0.83612040133779264,\"#370D55\"],[0.83946488294314381,\"#360D54\"],[0.84280936454849498,\"#350D52\"],[0.84615384615384626,\"#340D50\"],[0.84949832775919742,\"#330D4F\"],[0.85284280936454848,\"#320E4D\"],[0.85618729096989965,\"#320E4B\"],[0.85953177257525082,\"#310E4A\"],[0.86287625418060199,\"#300E48\"],[0.86622073578595316,\"#2F0E46\"],[0.86956521739130443,\"#2E0E45\"],[0.8729096989966556,\"#2D0E43\"],[0.87625418060200677,\"#2C0E41\"],[0.87959866220735783,\"#2B0E40\"],[0.882943143812709,\"#2A0E3E\"],[0.88628762541806017,\"#290E3D\"],[0.88963210702341133,\"#280E3B\"],[0.89297658862876261,\"#270E39\"],[0.89632107023411378,\"#260E38\"],[0.89966555183946495,\"#250E36\"],[0.90301003344481612,\"#240E35\"],[0.90635451505016718,\"#230E33\"],[0.90969899665551834,\"#220E32\"],[0.91304347826086951,\"#210D30\"],[0.91638795986622079,\"#200D2E\"],[0.91973244147157196,\"#1F0D2D\"],[0.92307692307692313,\"#1F0D2B\"],[0.9264214046822743,\"#1E0C2A\"],[0.92976588628762546,\"#1D0C28\"],[0.93311036789297652,\"#1C0C27\"],[0.93645484949832769,\"#1B0B25\"],[0.93979933110367897,\"#1A0B24\"],[0.94314381270903014,\"#1A0A23\"],[0.94648829431438131,\"#190921\"],[0.94983277591973247,\"#180920\"],[0.95317725752508364,\"#17081E\"],[0.95652173913043481,\"#16081D\"],[0.95986622073578587,\"#15071B\"],[0.96321070234113715,\"#14061A\"],[0.96655518394648832,\"#130619\"],[0.96989966555183948,\"#110517\"],[0.97324414715719065,\"#100516\"],[0.97658862876254182,\"#0E0414\"],[0.97993311036789299,\"#0C0312\"],[0.98327759197324416,\"#0A0310\"],[0.98662207357859544,\"#08020E\"],[0.98996655518394649,\"#06020C\"],[0.99331103678929766,\"#040109\"],[0.99665551839464883,\"#020107\"],[1,\"#000004\"]],\"colorbar\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"thickness\":23.039999999999996,\"title\":\"Message Count\",\"titlefont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198},\"tickmode\":\"array\",\"ticktext\":[\"4\",\"8\",\"12\",\"16\"],\"tickvals\":[0.20100000000000001,0.46677777777777774,0.73255555555555552,0.99833333333333329],\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":10.62681610626816},\"ticklen\":2,\"len\":0.5}},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":41.238688252386879,\"r\":6.6417600664176026,\"b\":40.934205989380587,\"l\":94.977168949771681},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198},\"title\":{\"text\":\"Half-Hourly Heatmap of Radio Communications by Day\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":15.940224159402243},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[7.4249999999999998,14.574999999999999],\"tickmode\":\"array\",\"ticktext\":[\"07:30\",\"08:00\",\"08:30\",\"09:00\",\"09:30\",\"10:00\",\"10:30\",\"11:00\",\"11:30\",\"12:00\",\"12:30\",\"13:00\",\"13:30\",\"14:00\",\"14:30\"],\"tickvals\":[7.5,8,8.5,9,9.5,10,10.5,11,11.5,12,12.5,13,13.5,14,14.5],\"categoryorder\":\"array\",\"categoryarray\":[\"07:30\",\"08:00\",\"08:30\",\"09:00\",\"09:30\",\"10:00\",\"10:30\",\"11:00\",\"11:30\",\"12:00\",\"12:30\",\"13:00\",\"13:30\",\"14:00\",\"14:30\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.3208800332087995,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Time of Day\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,14.6],\"tickmode\":\"array\",\"ticktext\":[\"14/10/2040 (Sun)\",\"13/10/2040 (Sat)\",\"12/10/2040 (Fri)\",\"11/10/2040 (Thu)\",\"10/10/2040 (Wed)\",\"09/10/2040 (Tue)\",\"08/10/2040 (Mon)\",\"07/10/2040 (Sun)\",\"06/10/2040 (Sat)\",\"05/10/2040 (Fri)\",\"04/10/2040 (Thu)\",\"03/10/2040 (Wed)\",\"02/10/2040 (Tue)\",\"01/10/2040 (Mon)\"],\"tickvals\":[1,2,3,3.9999999999999996,5,6,7,7.9999999999999991,9,10,11,12,13,14],\"categoryorder\":\"array\",\"categoryarray\":[\"14/10/2040 (Sun)\",\"13/10/2040 (Sat)\",\"12/10/2040 (Fri)\",\"11/10/2040 (Thu)\",\"10/10/2040 (Wed)\",\"09/10/2040 (Tue)\",\"08/10/2040 (Mon)\",\"07/10/2040 (Sun)\",\"06/10/2040 (Sat)\",\"05/10/2040 (Fri)\",\"04/10/2040 (Thu)\",\"03/10/2040 (Wed)\",\"02/10/2040 (Tue)\",\"01/10/2040 (Mon)\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.3208800332088013,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":10.62681610626816},\"title\":{\"text\":\"Message Count\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":13.283520132835198}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"7b4d1546d9\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"heatmap\"}},\"cur_data\":\"7b4d1546d9\",\"visdat\":{\"7b4d1546d9\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### **4.4c - Density plot of Daily half-hourly message volume over the 2 weeks period:**\n\nThe faceted density plot that shows the **distribution of communication events by time of day**, broken down for each day in the dataset. It helps to visually detect **temporal communication patterns**, intensity, and consistency over multiple days.\n\n::: panel-tabset\n### Overview of the 2 week period\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Step 1: Preprocess communication events\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    date_label = format(timestamp, \"%d/%m/%Y (%a)\"),\n    hour = hour(timestamp),\n    minute = minute(timestamp),\n    time_bin = hour + ifelse(minute < 30, 0, 0.5)\n  )\n\n# Step 2: Summarise daily medians and counts\ndaily_stats <- comm_events %>%\n  group_by(date_label) %>%\n  summarise(\n    median_time = median(time_bin),\n    msg_count = n(),\n    .groups = \"drop\"\n  )\n\n# Step 3: Plot\nggplot(comm_events, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = daily_stats, aes(xintercept = median_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(\n    data = daily_stats,\n    aes(x = 20.5, y = 0.25, label = paste(\"Total:\", msg_count)),\n    inherit.aes = FALSE,\n    size = 3,\n    color = \"grey20\",\n    hjust = 1\n  ) +\n  facet_wrap(~ date_label, ncol = 4) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = NULL  # suppress all x-axis labels\n  ) +\n  labs(\n    title = \"Daily Communication Patterns (Half-Hourly)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\"),\n    panel.grid.minor = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n:::\n\n\n\n### Day 1 - 01/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"01/10/2040 (Mon)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n\n### Day 2 - 02/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"02/10/2040 (Tue)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n\n\n\n### Day 3 - 03/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"03/10/2040 (Wed)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-35-1.png){width=672}\n:::\n:::\n\n\n\n### Day 4 - 04/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"04/10/2040 (Thu)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-36-1.png){width=672}\n:::\n:::\n\n\n\n### Day 5 - 05/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"05/10/2040 (Fri)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n\n### Day 6 - 06/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"06/10/2040 (Sat)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-38-1.png){width=672}\n:::\n:::\n\n\n\n### Day 7 - 07/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"07/10/2040 (Sun)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\n\n### Day 8 - 08/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"08/10/2040 (Mon)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n\n\n### Day 9 - 09/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"09/10/2040 (Tue)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n\n### Day 10 - 10/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"10/10/2040 (Wed)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-42-1.png){width=672}\n:::\n:::\n\n\n\n### Day 11 - 11/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"11/10/2040 (Thu)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n\n\n### Day 12 - 12/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"12/10/2040 (Fri)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n\n\n### Day 13 - 13/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"13/10/2040 (Sat)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n:::\n\n\n\n### Day 14 - 14/10/2040\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Filter for selected date\ndaily_data <- filter(comm_events, date_label == \"14/10/2040 (Sun)\")\n\n# Build density data to find full curve\ndensity_data <- ggplot_build(\n  ggplot(daily_data, aes(x = time_bin)) +\n    geom_density()\n)$data[[1]]\n\n# Identify peaks within ±10% of the maximum density\nmax_y <- max(density_data$y)\npeak_threshold <- 0.9 * max_y\n\nmajor_peaks <- density_data %>%\n  filter(y >= peak_threshold) %>%\n  group_by(grp = cumsum(c(1, diff(x) > 0.5))) %>%  # group close bins\n  summarise(\n    peak_time = x[which.max(y)],\n    peak_density = max(y),\n    .groups = \"drop\"\n  ) %>%\n  mutate(\n    label = sprintf(\"Peak: %02d:%02d\",\n                    floor(peak_time),\n                    ifelse(peak_time %% 1 == 0, 0, 30))\n  )\n\n# Message count\nmsg_count <- nrow(daily_data)\n\n# Final plot\nggplot(daily_data, aes(x = time_bin)) +\n  geom_density(fill = \"steelblue\", alpha = 0.7) +\n  geom_vline(data = major_peaks, aes(xintercept = peak_time),\n             color = \"red\", linetype = \"dashed\", linewidth = 0.6) +\n  geom_text(data = major_peaks,\n            aes(x = peak_time, y = 0.23, label = label),\n            color = \"red\", size = 3.5, hjust = -0.1, inherit.aes = FALSE) +\n  annotate(\"text\", x = 20.5, y = 0.25,\n           label = paste(\"Total messages communicated:\", msg_count),\n           hjust = 1, size = 4, color = \"grey30\") +\n  labs(\n    title = \"Half-Hourly Communication Density (Multiple Peaks Highlighted)\",\n    x = \"Time of Day\",\n    y = \"Density\"\n  ) +\n  scale_x_continuous(\n    breaks = seq(0, 23.5, by = 0.5),\n    labels = function(x) sprintf(\"%02d:%02d\", floor(x), ifelse(x %% 1 == 0, 0, 30))\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    strip.text = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n:::\n\n\n:::\n\n📈 **Insights This Visualization Offers**\n\n### Step 3: Plot Combined Hourly and Half-hourly Communication Volume\n\n**Bar Plot of combined hourly message volume over the 2 weeks period:**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Prepare data\ncomm_hourly <- comm_events %>%\n  count(hour) %>%\n  mutate(\n    hour_label = sprintf(\"%02d:00\", hour),  # Format to hh:mm\n    percent = n / sum(n)\n  )\n\n# Plot\nggplot(comm_hourly, aes(x = hour_label, y = n)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  geom_text_repel(\n    aes(label = paste0(n, \" (\", percent(percent, accuracy = 1), \")\")),\n    nudge_y = 3,\n    size = 2.5,\n    direction = \"y\",\n    max.overlaps = Inf\n  ) +\n  labs(\n    title = \"Overall Hourly Communication Volume\",\n    x = \"Time of Day (hh:mm)\",\n    y = \"Message Count\"\n  ) +\n  scale_y_continuous(expand = expansion(mult = c(0, 0.1))) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n:::\n\n\n\n**Bar Plot of combined half-hourly message volume in the 2 weeks period.**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ncomm_events <- mc3_nodes_final %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  mutate(timestamp = ymd_hms(timestamp)) %>%\n  filter(!is.na(timestamp)) %>%\n  mutate(\n    hour = hour(timestamp),\n    minute = minute(timestamp),\n    time_bin = sprintf(\"%02d:%02d\", hour, ifelse(minute < 30, 0, 30))\n  )\n\ncomm_halfhour <- comm_events %>%\n  count(time_bin) %>%\n  mutate(percent = n / sum(n))\n\nggplot(comm_halfhour, aes(x = time_bin, y = n)) +\n  geom_bar(stat = \"identity\", fill = \"steelblue\") +\n  geom_text_repel(\n    aes(label = paste0(n, \" (\", percent(percent, accuracy = 1), \")\")),\n    nudge_y = 3,\n    size = 2.5,\n    direction = \"y\",\n    max.overlaps = Inf\n  ) +\n  labs(\n    title = \"Overall Half-Hourly Communication Volume\",\n    x = \"Time of Day (hh:mm)\",\n    y = \"Message Count\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n:::\n\n\n\n::: callout-tip\n## 1a. What are the identifiable daily temporal patterns in communications?\n\n1.  The daily communication volume fluctuates slightly between 34 and 49 messages, with an average of approximately 42 messages per day, highlighting a stable overall activity level. Notably, the highest volume occurs on 11th October (49 messages), immediately following the lowest volume the day before on 10th October (34 messages)—a sharp rebound that may signal a response to specific events or operational needs. Despite these fluctuations, the system maintains a consistent tempo across the two weeks.\n\n2.  The temporal analysis using both the heat map and time series plots reveals a pronounced morning-centric communication rhythm. The vast majority of radio traffic is concentrated between 9:00 AM and 11:30 AM, with the most intense peaks typically occurring between 10:00 and 11:00 AM. With reference to the Density plot of Daily half-hourly message volume, of the 14 days, we see message density peaks at 10:30 AM on 9 days, while on 3 days, it peaks at 12:30 PM.\n\n3.  For instance if we were to based in on the hourly plot, 5th October (Fri) and 11th October (Thu) both register their highest single-hour counts at 10:00 AM at 24 and 21 messages respectively. Communication activity drops off steeply after lunchtime, with more than 90% of the days showing little to no activity after 2:30 PM. This pattern suggests a highly structured daily workflow, where key decisions and coordination are front-loaded in the day. Importantly, the hourly heat map also indicates that this routine holds across both weekdays and weekends—communication volumes and peak hours remain similar, underlining the operational regularity of the group regardless of the day of week.\n:::\n\n::: callout-tip\n## 1b. How do these patterns shift over the two weeks of observations?\n\n1.  Over the two-week period, while the timing and structure of communication peaks remain broadly consistent, there are subtle shifts in both intensity and timing. Some days, such as 3rd, 5th, 11th and 12th October, see particularly high spikes in the mid-morning, which may correspond to critical events, decision points, or heightened urgency. The sharp dip on October 8th and 13th, immediately after a period of \"surge\" (3rd - 7th and 9th to 12th October), points to possible responses to interruptions, lulls, or triggering incidents. Overall, although the daily messaging routine is remarkably stable, these bursts and brief lulls provide clues to changing circumstances or stress points in the operation—an analytical signal that warrants closer inspection of event logs or external triggers for those dates.\n\n2.  Another notable change in the communication pattern is observed during the weekends. In the first week, weekend communication peaks occurred earlier, typically between 10:00 AM and 11:30 AM, closely mirroring the weekday rhythm. However, in the second week, the weekend peaks shifted noticeably later, with the highest message volumes concentrated around 12:00 PM and 1:00 PM. This shift not only marks a departure from the otherwise stable early-morning communication structure but also suggests an adaptive or reactive operational schedule—potentially in response to evolving events, increased coordination needs, or changing priorities as the observation period progressed. The contrast between the two weekends is clear in the heatmap, underscoring the importance of monitoring such shifts as possible indicators of underlying changes in group behavior or external pressures.\n:::\n\n## 5 - Task 1c: Focus on a Particular Entity - \"Nadia Conti\"\n\n::: callout-note\n## VAST Challenge Task & Question 1c\n\nClepper found that messages frequently came in at around the same time each day.\n\n1.  Focus on a specific entity and use this information to determine who has influence over them.\n:::\n\n### 5.1 **-** Data Preparation for \"Nadia Conti\" Influence Analysis\n\nWe first extracted the relevant communication edges from the dataset, pairing “sent” and “received” communication events to form entity-to-entity links. We retained only those edges where both nodes represent real-world entities (Person, Organization, Vessel, Group, or Location), ensuring that our analysis focuses on the meaningful actors in the Oceanus network.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Extract sent and received communication event edges\nsent_edges <- mc3_edges_cleaned %>%\n  filter(type == \"sent\") %>%\n  select(source_entity = from_id, event = to_id)\n\nreceived_edges <- mc3_edges_cleaned %>%\n  filter(type == \"received\") %>%\n  select(event = from_id, target_entity = to_id)\n\n# Pair sent and received to form communication edges\npaired_edges <- sent_edges %>%\n  inner_join(received_edges, by = \"event\") %>%\n  select(from = source_entity, to = target_entity)\n\n# Add unmatched sent and received edges (optional, for completeness)\nsingle_sent_edges <- sent_edges %>%\n  select(from = source_entity, to = event)\nsingle_received_edges <- received_edges %>%\n  select(from = event, to = target_entity)\n\nall_edges <- bind_rows(paired_edges, single_sent_edges, single_received_edges) %>%\n  distinct()\n\n# Identify entity nodes (Person, Organization, Vessel, Group, Location)\nentity_ids <- mc3_nodes_cleaned %>%\n  filter(sub_type %in% c(\"Person\", \"Organization\", \"Vessel\", \"Group\", \"Location\")) %>%\n  pull(id) %>% as.character()\n\nentity_edges <- all_edges %>%\n  filter(as.character(from) %in% entity_ids, as.character(to) %in% entity_ids)\n\nentity_nodes <- mc3_nodes_cleaned %>%\n  filter(sub_type %in% c(\"Person\", \"Organization\", \"Vessel\", \"Group\", \"Location\")) %>%\n  select(id, label, sub_type)\n```\n:::\n\n\n\n### 5.2 **-** Build the Global Network and Compute Centrality\n\nUsing these cleaned and filtered edges and nodes, we built a global directed graph representing the Oceanus community. We then computed key network centrality metrics for each node—PageRank, betweenness, and degree—quantifying the influence and connectivity of every entity in the overall network.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(igraph)\n\ng <- graph_from_data_frame(d = entity_edges, vertices = entity_nodes, directed = TRUE)\n\n# Compute centralities\nV(g)$pagerank <- page_rank(g)$vector\nV(g)$betweenness <- betweenness(g)\nV(g)$degree <- degree(g)\n```\n:::\n\n\n\n### 5.3 **-** Extract \"Nadia Conti\" Ego Network (2-hop Neighbourhood)\n\nFocusing on \"Nadia Conti\", we identified her node and extracted her two-step ego network, capturing both direct and indirect connections within the broader network. This local subgraph reveals Nadia’s immediate sphere of influence and the key players connected to her.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nnadia_label <- \"Nadia Conti\"\ntarget_index <- which(V(g)$label == nadia_label)\n\nego_graph <- make_ego_graph(g, order = 2, nodes = target_index, mode = \"all\")[[1]]\n```\n:::\n\n\n\n### 5.4 **-** Visualize Nadia Conti’s Ego Network (Interactive)\n\nWe visualized Nadia’s ego network using node size, shape, and color to represent centrality and entity type. We also summarized centrality metrics in clear tables, ranking all ego network members by PageRank, Betweenness, and Degree. This allows for direct identification of the most influential, best-connected, and most strategic actors in Nadia Conti’s communication environment.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nnodes_df <- data.frame(\n  id = V(ego_graph)$name,\n  label = V(ego_graph)$label,\n  group = V(ego_graph)$sub_type,\n  title = paste0(\"<b>\", V(ego_graph)$label, \"</b><br>\",\n                 \"Degree: \", round(V(ego_graph)$degree, 2), \"<br>\",\n                 \"Betweenness: \", round(V(ego_graph)$betweenness, 2), \"<br>\",\n                 \"PageRank: \", round(V(ego_graph)$pagerank, 4)),\n  shape = ifelse(V(ego_graph)$sub_type == \"Person\", \"dot\",\n                 ifelse(V(ego_graph)$sub_type == \"Organization\", \"square\",\n                        ifelse(V(ego_graph)$sub_type == \"Vessel\", \"triangle\",\n                               ifelse(V(ego_graph)$sub_type == \"Group\", \"star\", \"diamond\")))),\n  value = V(ego_graph)$pagerank * 30 + 5\n)\n\nedges_df <- as_data_frame(ego_graph, what = \"edges\") %>%\n  rename(from = from, to = to)\n\nlibrary(visNetwork)\nvisNetwork(nodes_df, edges_df, width = \"100%\", height = \"700px\") %>%\n  visNodes(scaling = list(min = 5, max = 30)) %>%\n  visEdges(\n    arrows = list(to = list(enabled = TRUE, scaleFactor = 0.3)),\n    color = list(color = \"gray\")\n  ) %>%\n  visOptions(\n    highlightNearest = TRUE,\n    nodesIdSelection = TRUE,\n    manipulation = FALSE\n  ) %>%\n  visInteraction(\n    dragNodes = FALSE,\n    dragView = FALSE,\n    zoomView = FALSE\n  ) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-07f780420729b276a227\" style=\"width:100%;height:700px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-07f780420729b276a227\">{\"x\":{\"nodes\":{\"id\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"The Lookout\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\"],\"label\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"The Lookout\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Glitters Team\",\"Oceanus City Council\",\"Green Guardians\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Northern Light\",\"Remora\",\"Knowles\",\"City Officials\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Himark Harbor\"],\"group\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Group\",\"Location\",\"Location\",\"Location\"],\"title\":[\"<b>Nadia Conti<\\/b><br>Degree: 17<br>Betweenness: 117.87<br>PageRank: 0.0432\",\"<b>Elise<\\/b><br>Degree: 7<br>Betweenness: 4.6<br>PageRank: 0.0182\",\"<b>Liam Thorne<\\/b><br>Degree: 11<br>Betweenness: 41.81<br>PageRank: 0.0275\",\"<b>Samantha Blake<\\/b><br>Degree: 6<br>Betweenness: 4.49<br>PageRank: 0.0114\",\"<b>Davis<\\/b><br>Degree: 16<br>Betweenness: 22.36<br>PageRank: 0.0239\",\"<b>Rodriguez<\\/b><br>Degree: 10<br>Betweenness: 11.75<br>PageRank: 0.0122\",\"<b>The Lookout<\\/b><br>Degree: 7<br>Betweenness: 80.51<br>PageRank: 0.0062\",\"<b>Mrs. Money<\\/b><br>Degree: 12<br>Betweenness: 167.18<br>PageRank: 0.0192\",\"<b>The Middleman<\\/b><br>Degree: 8<br>Betweenness: 50.78<br>PageRank: 0.0142\",\"<b>Boss<\\/b><br>Degree: 13<br>Betweenness: 136.18<br>PageRank: 0.0272\",\"<b>Small Fry<\\/b><br>Degree: 3<br>Betweenness: 0<br>PageRank: 0.0035\",\"<b>Glitters Team<\\/b><br>Degree: 4<br>Betweenness: 0<br>PageRank: 0.0035\",\"<b>Oceanus City Council<\\/b><br>Degree: 28<br>Betweenness: 116.11<br>PageRank: 0.053\",\"<b>Green Guardians<\\/b><br>Degree: 17<br>Betweenness: 27.51<br>PageRank: 0.0224\",\"<b>V. Miesel Shipping<\\/b><br>Degree: 19<br>Betweenness: 118.7<br>PageRank: 0.0394\",\"<b>Sailor Shifts Team<\\/b><br>Degree: 7<br>Betweenness: 7.34<br>PageRank: 0.0186\",\"<b>Neptune<\\/b><br>Degree: 19<br>Betweenness: 82.59<br>PageRank: 0.0358\",\"<b>Marlin<\\/b><br>Degree: 10<br>Betweenness: 6.23<br>PageRank: 0.0235\",\"<b>Serenity<\\/b><br>Degree: 8<br>Betweenness: 0.81<br>PageRank: 0.017\",\"<b>Mako<\\/b><br>Degree: 37<br>Betweenness: 368.5<br>PageRank: 0.0687\",\"<b>Reef Guardian<\\/b><br>Degree: 27<br>Betweenness: 139.69<br>PageRank: 0.0454\",\"<b>Horizon<\\/b><br>Degree: 12<br>Betweenness: 6.72<br>PageRank: 0.0152\",\"<b>Seawatch<\\/b><br>Degree: 9<br>Betweenness: 5.2<br>PageRank: 0.0186\",\"<b>EcoVigil<\\/b><br>Degree: 13<br>Betweenness: 12.63<br>PageRank: 0.0233\",\"<b>Sentinel<\\/b><br>Degree: 16<br>Betweenness: 34.54<br>PageRank: 0.025\",\"<b>Osprey<\\/b><br>Degree: 3<br>Betweenness: 0<br>PageRank: 0.0088\",\"<b>Northern Light<\\/b><br>Degree: 8<br>Betweenness: 9.76<br>PageRank: 0.0135\",\"<b>Remora<\\/b><br>Degree: 21<br>Betweenness: 90.45<br>PageRank: 0.0409\",\"<b>Knowles<\\/b><br>Degree: 4<br>Betweenness: 0.5<br>PageRank: 0.0051\",\"<b>City Officials<\\/b><br>Degree: 1<br>Betweenness: 0<br>PageRank: 0.0066\",\"<b>Paackland Harbor<\\/b><br>Degree: 13<br>Betweenness: 27.08<br>PageRank: 0.0244\",\"<b>Haacklee Harbor<\\/b><br>Degree: 8<br>Betweenness: 41.3<br>PageRank: 0.0111\",\"<b>Himark Harbor<\\/b><br>Degree: 17<br>Betweenness: 52.61<br>PageRank: 0.0358\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"star\",\"diamond\",\"diamond\",\"diamond\"],\"value\":[6.297086192940655,5.546984707878168,5.823674979714352,5.341903080060789,5.716727137412613,5.366531631035691,5.185823180115518,5.576625657577807,5.425218713427389,5.81696334194335,5.10587587464601,5.10587587464601,6.591393301385012,5.67208459997379,6.181213807960264,5.558266091317103,6.072999645744769,5.706400561681756,5.509799015300089,7.060723635120745,6.362444376099885,5.456949706479425,5.55667408305798,5.697659310767588,5.750152656749608,5.26252595678532,5.403713654078533,6.225537098067166,5.153050013669531,5.197080844534316,5.73335062064582,5.33299392251897,6.074440716571868]},\"edges\":{\"from\":[\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Elise\",\"Elise\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Samantha Blake\",\"Samantha Blake\",\"Samantha Blake\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"The Lookout\",\"The Lookout\",\"The Lookout\",\"The Lookout\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"The Middleman\",\"The Middleman\",\"The Middleman\",\"The Middleman\",\"Boss\",\"Boss\",\"Boss\",\"Boss\",\"Small Fry\",\"Small Fry\",\"Small Fry\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Glitters Team\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"Green Guardians\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Marlin\",\"Marlin\",\"Marlin\",\"Marlin\",\"Marlin\",\"Serenity\",\"Serenity\",\"Serenity\",\"Serenity\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Horizon\",\"Horizon\",\"Horizon\",\"Horizon\",\"Horizon\",\"Horizon\",\"Horizon\",\"Seawatch\",\"Seawatch\",\"Seawatch\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Osprey\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Northern Light\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Knowles\",\"Knowles\",\"Knowles\",\"Paackland Harbor\",\"Paackland Harbor\",\"Paackland Harbor\",\"Paackland Harbor\",\"Paackland Harbor\",\"Paackland Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Haacklee Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\",\"Himark Harbor\"],\"to\":[\"Liam Thorne\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Neptune\",\"Marlin\",\"Haacklee Harbor\",\"Nadia Conti\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Nadia Conti\",\"Elise\",\"Boss\",\"Oceanus City Council\",\"EcoVigil\",\"Oceanus City Council\",\"Sailor Shifts Team\",\"Mako\",\"Nadia Conti\",\"Davis\",\"Boss\",\"V. Miesel Shipping\",\"Neptune\",\"Mako\",\"Remora\",\"Himark Harbor\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"Mrs. Money\",\"Boss\",\"Sailor Shifts Team\",\"Remora\",\"Green Guardians\",\"Reef Guardian\",\"Horizon\",\"Sentinel\",\"The Middleman\",\"Boss\",\"V. Miesel Shipping\",\"Neptune\",\"Mako\",\"Remora\",\"Liam Thorne\",\"Mrs. Money\",\"Boss\",\"Paackland Harbor\",\"Mrs. Money\",\"The Middleman\",\"V. Miesel Shipping\",\"Mako\",\"Davis\",\"Mako\",\"Remora\",\"Samantha Blake\",\"Boss\",\"Northern Light\",\"Remora\",\"Nadia Conti\",\"Liam Thorne\",\"Samantha Blake\",\"Oceanus City Council\",\"Green Guardians\",\"Marlin\",\"Mako\",\"Reef Guardian\",\"EcoVigil\",\"Sentinel\",\"Northern Light\",\"Paackland Harbor\",\"Himark Harbor\",\"Oceanus City Council\",\"Green Guardians\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Northern Light\",\"Paackland Harbor\",\"Nadia Conti\",\"Elise\",\"Davis\",\"Rodriguez\",\"Mrs. Money\",\"Boss\",\"V. Miesel Shipping\",\"Neptune\",\"Mako\",\"Remora\",\"Nadia Conti\",\"Remora\",\"Nadia Conti\",\"Elise\",\"Davis\",\"V. Miesel Shipping\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Remora\",\"City Officials\",\"Himark Harbor\",\"Oceanus City Council\",\"Mako\",\"Reef Guardian\",\"Remora\",\"Himark Harbor\",\"Neptune\",\"Mako\",\"Reef Guardian\",\"Himark Harbor\",\"Elise\",\"Samantha Blake\",\"Davis\",\"Boss\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Serenity\",\"Reef Guardian\",\"Sentinel\",\"Osprey\",\"Remora\",\"Paackland Harbor\",\"Himark Harbor\",\"Oceanus City Council\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Paackland Harbor\",\"Oceanus City Council\",\"Green Guardians\",\"Mako\",\"Reef Guardian\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Green Guardians\",\"Reef Guardian\",\"Himark Harbor\",\"Liam Thorne\",\"Oceanus City Council\",\"Reef Guardian\",\"Horizon\",\"EcoVigil\",\"Sentinel\",\"Nadia Conti\",\"Oceanus City Council\",\"Green Guardians\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"Paackland Harbor\",\"Mako\",\"Oceanus City Council\",\"Green Guardians\",\"Sailor Shifts Team\",\"Himark Harbor\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Mako\",\"Paackland Harbor\",\"Himark Harbor\",\"Davis\",\"Mako\",\"Haacklee Harbor\",\"Liam Thorne\",\"Oceanus City Council\",\"Mako\",\"Reef Guardian\",\"Sentinel\",\"Remora\",\"Nadia Conti\",\"Oceanus City Council\",\"Mako\",\"EcoVigil\",\"Osprey\",\"Knowles\",\"Oceanus City Council\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Seawatch\",\"Northern Light\",\"Remora\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"scaling\":{\"min\":5,\"max\":30}},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":{\"to\":{\"enabled\":true,\"scaleFactor\":0.3}},\"color\":{\"color\":\"gray\"}},\"interaction\":{\"dragNodes\":false,\"dragView\":false,\"zoomView\":false,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":1818}},\"groups\":[\"Person\",\"Organization\",\"Vessel\",\"Group\",\"Location\"],\"width\":\"100%\",\"height\":\"700px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"opts_manipulation\":{\"datacss\":\"table.legend_table {\\n  font-size: 11px;\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n}\\ntable.legend_table td {\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n  padding: 2px;\\n}\\ndiv.table_content {\\n  width:80px;\\n  text-align:center;\\n}\\ndiv.table_description {\\n  width:100px;\\n}\\n\\n.operation {\\n  font-size:20px;\\n}\\n\\n.network-popUp {\\n  display:none;\\n  z-index:299;\\n  width:250px;\\n  /*height:150px;*/\\n  background-color: #f9f9f9;\\n  border-style:solid;\\n  border-width:1px;\\n  border-color: #0d0d0d;\\n  padding:10px;\\n  text-align: center;\\n  position:fixed;\\n  top:50%;  \\n  left:50%;  \\n  margin:-100px 0 0 -100px;  \\n\\n}\",\"addNodeCols\":[\"id\",\"label\"],\"editNodeCols\":[\"id\",\"label\"],\"tab_add_node\":\"<span id=\\\"addnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"addnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"addnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"addnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"addnode-cancelButton\\\"><\\/button>\",\"tab_edit_node\":\"<span id=\\\"editnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"editnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"editnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"editnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"editnode-cancelButton\\\"><\\/button>\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: callout-note\n## Global and Ego-Network Structure\n\nThe overview network visualization reveals that **Nadia Conti** is centrally embedded in the Oceanus communication web, maintaining direct and indirect connections with major actors such as Neptune (Vessel), V. Miesel Shipping (Organization), Elise (Person), and others. The use of color and shape coding in the network allows for quick identification of the different types of entities in Nadia’s influence neighborhood.\n:::\n\n### 5.5 **-** Centrality Tables for Nadia’s Ego Network\n\nOn both the global and Nadia-focused ego networks, we computed standard network centrality metrics for all nodes:\n\n-   **PageRank** (overall influence),\n-   **Betweenness** (information brokerage/intermediary role), and\n-   **Degree** (number of direct connections).\n\nThese measures quantify the importance and structural roles of each entity relative to Nadia and the broader community.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# PageRank table\npagerank_df <- data.frame(\n  label = V(ego_graph)$label,\n  sub_type = V(ego_graph)$sub_type,\n  pagerank = round(V(ego_graph)$pagerank, 4)\n) %>% arrange(desc(pagerank))\n\n# Betweenness table\nbetweenness_df <- data.frame(\n  label = V(ego_graph)$label,\n  sub_type = V(ego_graph)$sub_type,\n  betweenness = round(V(ego_graph)$betweenness, 2)\n) %>% arrange(desc(betweenness))\n\n# Degree table\ndegree_df <- data.frame(\n  label = V(ego_graph)$label,\n  sub_type = V(ego_graph)$sub_type,\n  degree = V(ego_graph)$degree\n) %>% arrange(desc(degree))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(pagerank_df, caption = \"PageRank Centrality (Nadia's Ego Network)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: PageRank Centrality (Nadia's Ego Network)\n\n|label                |sub_type     | pagerank|\n|:--------------------|:------------|--------:|\n|Mako                 |Vessel       |   0.0687|\n|Oceanus City Council |Organization |   0.0530|\n|Reef Guardian        |Vessel       |   0.0454|\n|Nadia Conti          |Person       |   0.0432|\n|Remora               |Vessel       |   0.0409|\n|V. Miesel Shipping   |Organization |   0.0394|\n|Neptune              |Vessel       |   0.0358|\n|Himark Harbor        |Location     |   0.0358|\n|Liam Thorne          |Person       |   0.0275|\n|Boss                 |Person       |   0.0272|\n|Sentinel             |Vessel       |   0.0250|\n|Paackland Harbor     |Location     |   0.0244|\n|Davis                |Person       |   0.0239|\n|Marlin               |Vessel       |   0.0235|\n|EcoVigil             |Vessel       |   0.0233|\n|Green Guardians      |Organization |   0.0224|\n|Mrs. Money           |Person       |   0.0192|\n|Sailor Shifts Team   |Organization |   0.0186|\n|Seawatch             |Vessel       |   0.0186|\n|Elise                |Person       |   0.0182|\n|Serenity             |Vessel       |   0.0170|\n|Horizon              |Vessel       |   0.0152|\n|The Middleman        |Person       |   0.0142|\n|Northern Light       |Vessel       |   0.0135|\n|Rodriguez            |Person       |   0.0122|\n|Samantha Blake       |Person       |   0.0114|\n|Haacklee Harbor      |Location     |   0.0111|\n|Osprey               |Vessel       |   0.0088|\n|City Officials       |Group        |   0.0066|\n|The Lookout          |Person       |   0.0062|\n|Knowles              |Vessel       |   0.0051|\n|Small Fry            |Person       |   0.0035|\n|Glitters Team        |Organization |   0.0035|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(betweenness_df, caption = \"Betweenness Centrality (Nadia's Ego Network)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Betweenness Centrality (Nadia's Ego Network)\n\n|label                |sub_type     | betweenness|\n|:--------------------|:------------|-----------:|\n|Mako                 |Vessel       |      368.50|\n|Mrs. Money           |Person       |      167.18|\n|Reef Guardian        |Vessel       |      139.69|\n|Boss                 |Person       |      136.18|\n|V. Miesel Shipping   |Organization |      118.70|\n|Nadia Conti          |Person       |      117.87|\n|Oceanus City Council |Organization |      116.11|\n|Remora               |Vessel       |       90.45|\n|Neptune              |Vessel       |       82.59|\n|The Lookout          |Person       |       80.51|\n|Himark Harbor        |Location     |       52.61|\n|The Middleman        |Person       |       50.78|\n|Liam Thorne          |Person       |       41.81|\n|Haacklee Harbor      |Location     |       41.30|\n|Sentinel             |Vessel       |       34.54|\n|Green Guardians      |Organization |       27.51|\n|Paackland Harbor     |Location     |       27.08|\n|Davis                |Person       |       22.36|\n|EcoVigil             |Vessel       |       12.63|\n|Rodriguez            |Person       |       11.75|\n|Northern Light       |Vessel       |        9.76|\n|Sailor Shifts Team   |Organization |        7.34|\n|Horizon              |Vessel       |        6.72|\n|Marlin               |Vessel       |        6.23|\n|Seawatch             |Vessel       |        5.20|\n|Elise                |Person       |        4.60|\n|Samantha Blake       |Person       |        4.49|\n|Serenity             |Vessel       |        0.81|\n|Knowles              |Vessel       |        0.50|\n|Small Fry            |Person       |        0.00|\n|Glitters Team        |Organization |        0.00|\n|Osprey               |Vessel       |        0.00|\n|City Officials       |Group        |        0.00|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(degree_df, caption = \"Degree Centrality (Nadia's Ego Network)\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Degree Centrality (Nadia's Ego Network)\n\n|label                |sub_type     | degree|\n|:--------------------|:------------|------:|\n|Mako                 |Vessel       |     37|\n|Oceanus City Council |Organization |     28|\n|Reef Guardian        |Vessel       |     27|\n|Remora               |Vessel       |     21|\n|V. Miesel Shipping   |Organization |     19|\n|Neptune              |Vessel       |     19|\n|Nadia Conti          |Person       |     17|\n|Green Guardians      |Organization |     17|\n|Himark Harbor        |Location     |     17|\n|Davis                |Person       |     16|\n|Sentinel             |Vessel       |     16|\n|Boss                 |Person       |     13|\n|EcoVigil             |Vessel       |     13|\n|Paackland Harbor     |Location     |     13|\n|Mrs. Money           |Person       |     12|\n|Horizon              |Vessel       |     12|\n|Liam Thorne          |Person       |     11|\n|Rodriguez            |Person       |     10|\n|Marlin               |Vessel       |     10|\n|Seawatch             |Vessel       |      9|\n|The Middleman        |Person       |      8|\n|Serenity             |Vessel       |      8|\n|Northern Light       |Vessel       |      8|\n|Haacklee Harbor      |Location     |      8|\n|Elise                |Person       |      7|\n|The Lookout          |Person       |      7|\n|Sailor Shifts Team   |Organization |      7|\n|Samantha Blake       |Person       |      6|\n|Glitters Team        |Organization |      4|\n|Knowles              |Vessel       |      4|\n|Small Fry            |Person       |      3|\n|Osprey               |Vessel       |      3|\n|City Officials       |Group        |      1|\n\n\n:::\n:::\n\n\n\n::: callout-note\n## Centrality Metrics and Direct & Indirect Influences\n\nBy calculating centrality metrics within Nadia’s two-hop ego network, we observe that the most influential nodes in her environment—by PageRank, betweenness, and degree—are Neptune, V. Miesel Shipping, and Elise. Nadia herself consistently ranks among the top nodes by these measures, highlighting her role as both an influencer and an information bridge. Entities such as Neptune and V. Miesel Shipping, which also score highly in centrality, exert considerable influence over Nadia’s information flow and access to other parts of the network.\n\nDegree centrality analysis shows Nadia maintains multiple direct connections, particularly with other highly active nodes, ensuring she is closely linked to key hubs in the network. Betweenness centrality further reveals that Nadia is not only well-connected but also acts as an important intermediary, facilitating communication between otherwise distant parts of the network. PageRank confirms that her immediate environment is composed of actors with significant structural power, increasing the likelihood that Nadia is both influenced by, and exerts influence upon, the most pivotal players in Oceanus.\n:::\n\n#### **5.5.1 - PageRank for Nadia Conti**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(igraph)\nlibrary(visNetwork)\n\n# -- Build the global network g as in your earlier code (using your entity_nodes/entity_edges) --\n\ng <- graph_from_data_frame(\n  d = entity_edges, \n  vertices = entity_nodes, \n  directed = TRUE\n)\n\n# -- Get Nadia's index in g --\nnadia_label <- \"Nadia Conti\"\ntarget_index <- which(V(g)$label == nadia_label)\n\n# -- Extract Nadia's 1-hop ego network (all direct neighbors) --\nego_1 <- make_ego_graph(g, order = 1, nodes = target_index, mode = \"all\")[[1]]\n\n\n# 1. Compute PageRank for the ego network\nV(ego_1)$pagerank <- page_rank(ego_1)$vector\n\n# 2. Prepare node data frame with your consistent color scheme\nnodes_df_pagerank <- data.frame(\n  id = V(ego_1)$name,\n  label = V(ego_1)$label,\n  group = V(ego_1)$sub_type,\n  title = paste0(\"<b>\", V(ego_1)$label, \"</b><br>PageRank: \", round(V(ego_1)$pagerank, 4)),\n  shape = ifelse(V(ego_1)$sub_type == \"Person\", \"dot\",\n                 ifelse(V(ego_1)$sub_type == \"Organization\", \"square\",\n                        ifelse(V(ego_1)$sub_type == \"Vessel\", \"triangle\",\n                               ifelse(V(ego_1)$sub_type == \"Group\", \"star\", \"diamond\")))),\n  color = case_when(\n    V(ego_1)$sub_type == \"Person\" ~ \"#2ca5ff\",\n    V(ego_1)$sub_type == \"Organization\" ~ \"#f5ee15\",\n    V(ego_1)$sub_type == \"Vessel\" ~ \"#FB7E81\",\n    V(ego_1)$sub_type == \"Group\" ~ \"#25e158\",\n    V(ego_1)$sub_type == \"Location\" ~ \"#ec4bff\",\n    TRUE ~ \"black\"\n  ),\n  value = V(ego_1)$pagerank * 30 + 5\n)\n\n# 3. Prepare edges\nedges_df <- as_data_frame(ego_1, what = \"edges\") %>%\n  rename(from = from, to = to)\n\n# 4. Plot with visNetwork\nvisNetwork(nodes_df_pagerank, edges_df, width = \"100%\", height = \"400px\") %>%\n  visNodes(\n    scaling = list(min = 5, max = 30),\n    color = list(background = nodes_df_pagerank$color, border = \"black\"),\n    shape = nodes_df_pagerank$shape\n  ) %>%\n  visEdges(arrows = list(to = list(enabled = TRUE, scaleFactor = 0.3)), color = list(color = \"gray\")) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE, manipulation = FALSE) %>%\n  visInteraction(dragNodes = FALSE, dragView = FALSE, zoomView = FALSE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-63757eb28fcba0ee35bf\" style=\"width:100%;height:400px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-63757eb28fcba0ee35bf\">{\"x\":{\"nodes\":{\"id\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Davis\",\"Rodriguez\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Sentinel\",\"Remora\",\"Haacklee Harbor\"],\"label\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Davis\",\"Rodriguez\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Sentinel\",\"Remora\",\"Haacklee Harbor\"],\"group\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Location\"],\"title\":[\"<b>Nadia Conti<\\/b><br>PageRank: 0.1756\",\"<b>Elise<\\/b><br>PageRank: 0.0584\",\"<b>Liam Thorne<\\/b><br>PageRank: 0.0762\",\"<b>Davis<\\/b><br>PageRank: 0.0699\",\"<b>Rodriguez<\\/b><br>PageRank: 0.0454\",\"<b>Oceanus City Council<\\/b><br>PageRank: 0.1369\",\"<b>V. Miesel Shipping<\\/b><br>PageRank: 0.1036\",\"<b>Sailor Shifts Team<\\/b><br>PageRank: 0.0328\",\"<b>Neptune<\\/b><br>PageRank: 0.0744\",\"<b>Marlin<\\/b><br>PageRank: 0.0597\",\"<b>Sentinel<\\/b><br>PageRank: 0.0348\",\"<b>Remora<\\/b><br>PageRank: 0.0957\",\"<b>Haacklee Harbor<\\/b><br>PageRank: 0.0364\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"diamond\"],\"color\":[\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#ec4bff\"],\"value\":[10.26749522602823,6.751361277911808,7.286950987596573,7.098397194652232,6.361990315726688,9.107938954982632,8.109306360074374,5.984431686289086,7.233407975498029,6.790731958854893,6.044503468500894,7.87110225737672,6.092382336507845]},\"edges\":{\"from\":[\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Elise\",\"Elise\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Marlin\",\"Marlin\",\"Sentinel\",\"Sentinel\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Haacklee Harbor\",\"Haacklee Harbor\"],\"to\":[\"Liam Thorne\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Neptune\",\"Marlin\",\"Haacklee Harbor\",\"Nadia Conti\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Nadia Conti\",\"Elise\",\"Oceanus City Council\",\"Nadia Conti\",\"Davis\",\"V. Miesel Shipping\",\"Neptune\",\"Remora\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"Sailor Shifts Team\",\"Remora\",\"Nadia Conti\",\"Liam Thorne\",\"Oceanus City Council\",\"Marlin\",\"Sentinel\",\"Nadia Conti\",\"Elise\",\"Davis\",\"Rodriguez\",\"V. Miesel Shipping\",\"Neptune\",\"Remora\",\"Nadia Conti\",\"Remora\",\"Nadia Conti\",\"Elise\",\"Davis\",\"V. Miesel Shipping\",\"Remora\",\"Oceanus City Council\",\"Remora\",\"Nadia Conti\",\"Oceanus City Council\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Nadia Conti\",\"Oceanus City Council\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"diamond\"],\"color\":{\"background\":[\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#ec4bff\"],\"border\":\"black\"},\"scaling\":{\"min\":5,\"max\":30}},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":{\"to\":{\"enabled\":true,\"scaleFactor\":0.3}},\"color\":{\"color\":\"gray\"}},\"interaction\":{\"dragNodes\":false,\"dragView\":false,\"zoomView\":false,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":1818}},\"groups\":[\"Person\",\"Organization\",\"Vessel\",\"Location\"],\"width\":\"100%\",\"height\":\"400px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"opts_manipulation\":{\"datacss\":\"table.legend_table {\\n  font-size: 11px;\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n}\\ntable.legend_table td {\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n  padding: 2px;\\n}\\ndiv.table_content {\\n  width:80px;\\n  text-align:center;\\n}\\ndiv.table_description {\\n  width:100px;\\n}\\n\\n.operation {\\n  font-size:20px;\\n}\\n\\n.network-popUp {\\n  display:none;\\n  z-index:299;\\n  width:250px;\\n  /*height:150px;*/\\n  background-color: #f9f9f9;\\n  border-style:solid;\\n  border-width:1px;\\n  border-color: #0d0d0d;\\n  padding:10px;\\n  text-align: center;\\n  position:fixed;\\n  top:50%;  \\n  left:50%;  \\n  margin:-100px 0 0 -100px;  \\n\\n}\",\"addNodeCols\":[\"id\",\"label\"],\"editNodeCols\":[\"id\",\"label\"],\"tab_add_node\":\"<span id=\\\"addnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"addnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"addnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"addnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"addnode-cancelButton\\\"><\\/button>\",\"tab_edit_node\":\"<span id=\\\"editnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"editnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"editnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"editnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"editnode-cancelButton\\\"><\\/button>\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### **5.5.2 - Betweenness for Nadia Conti**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# 1. Compute Betweenness for the ego network\nV(ego_1)$betweenness <- betweenness(ego_1, directed = TRUE)\n\n# 2. Prepare node data frame\nnodes_df_betweenness <- data.frame(\n  id = V(ego_1)$name,\n  label = V(ego_1)$label,\n  group = V(ego_1)$sub_type,\n  title = paste0(\"<b>\", V(ego_1)$label, \"</b><br>Betweenness: \", round(V(ego_1)$betweenness, 2)),\n  shape = ifelse(V(ego_1)$sub_type == \"Person\", \"dot\",\n                 ifelse(V(ego_1)$sub_type == \"Organization\", \"square\",\n                        ifelse(V(ego_1)$sub_type == \"Vessel\", \"triangle\",\n                               ifelse(V(ego_1)$sub_type == \"Group\", \"star\", \"diamond\")))),\n  color = case_when(\n    V(ego_1)$sub_type == \"Person\" ~ \"#2ca5ff\",\n    V(ego_1)$sub_type == \"Organization\" ~ \"#f5ee15\",\n    V(ego_1)$sub_type == \"Vessel\" ~ \"#FB7E81\",\n    V(ego_1)$sub_type == \"Group\" ~ \"#25e158\",\n    V(ego_1)$sub_type == \"Location\" ~ \"#ec4bff\",\n    TRUE ~ \"black\"\n  ),\n  value = V(ego_1)$betweenness * 2 + 5\n)\n\n# 3. Edges (same as before)\n# edges_df already prepared\n\n# 4. Plot\nvisNetwork(nodes_df_betweenness, edges_df, width = \"100%\", height = \"400px\") %>%\n  visNodes(\n    scaling = list(min = 5, max = 30),\n    color = list(background = nodes_df_betweenness$color, border = \"black\"),\n    shape = nodes_df_betweenness$shape\n  ) %>%\n  visEdges(arrows = list(to = list(enabled = TRUE, scaleFactor = 0.3)), color = list(color = \"gray\")) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE, manipulation = FALSE) %>%\n  visInteraction(dragNodes = FALSE, dragView = FALSE, zoomView = FALSE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-f900fe473d2d8ec593cf\" style=\"width:100%;height:400px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f900fe473d2d8ec593cf\">{\"x\":{\"nodes\":{\"id\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Davis\",\"Rodriguez\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Sentinel\",\"Remora\",\"Haacklee Harbor\"],\"label\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Davis\",\"Rodriguez\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Sentinel\",\"Remora\",\"Haacklee Harbor\"],\"group\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Location\"],\"title\":[\"<b>Nadia Conti<\\/b><br>Betweenness: 61.3\",\"<b>Elise<\\/b><br>Betweenness: 2.82\",\"<b>Liam Thorne<\\/b><br>Betweenness: 4.01\",\"<b>Davis<\\/b><br>Betweenness: 0.95\",\"<b>Rodriguez<\\/b><br>Betweenness: 1.94\",\"<b>Oceanus City Council<\\/b><br>Betweenness: 17.58\",\"<b>V. Miesel Shipping<\\/b><br>Betweenness: 18.6\",\"<b>Sailor Shifts Team<\\/b><br>Betweenness: 0\",\"<b>Neptune<\\/b><br>Betweenness: 6.99\",\"<b>Marlin<\\/b><br>Betweenness: 5.9\",\"<b>Sentinel<\\/b><br>Betweenness: 0\",\"<b>Remora<\\/b><br>Betweenness: 19.92\",\"<b>Haacklee Harbor<\\/b><br>Betweenness: 0\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"diamond\"],\"color\":[\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#ec4bff\"],\"value\":[127.6,10.63809523809524,13.01904761904762,6.904761904761905,8.87142857142857,40.15238095238095,42.2,5,18.97619047619047,16.8047619047619,5,44.83333333333334,5]},\"edges\":{\"from\":[\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Elise\",\"Elise\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Marlin\",\"Marlin\",\"Sentinel\",\"Sentinel\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Haacklee Harbor\",\"Haacklee Harbor\"],\"to\":[\"Liam Thorne\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Neptune\",\"Marlin\",\"Haacklee Harbor\",\"Nadia Conti\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Nadia Conti\",\"Elise\",\"Oceanus City Council\",\"Nadia Conti\",\"Davis\",\"V. Miesel Shipping\",\"Neptune\",\"Remora\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"Sailor Shifts Team\",\"Remora\",\"Nadia Conti\",\"Liam Thorne\",\"Oceanus City Council\",\"Marlin\",\"Sentinel\",\"Nadia Conti\",\"Elise\",\"Davis\",\"Rodriguez\",\"V. Miesel Shipping\",\"Neptune\",\"Remora\",\"Nadia Conti\",\"Remora\",\"Nadia Conti\",\"Elise\",\"Davis\",\"V. Miesel Shipping\",\"Remora\",\"Oceanus City Council\",\"Remora\",\"Nadia Conti\",\"Oceanus City Council\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Nadia Conti\",\"Oceanus City Council\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"diamond\"],\"color\":{\"background\":[\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#ec4bff\"],\"border\":\"black\"},\"scaling\":{\"min\":5,\"max\":30}},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":{\"to\":{\"enabled\":true,\"scaleFactor\":0.3}},\"color\":{\"color\":\"gray\"}},\"interaction\":{\"dragNodes\":false,\"dragView\":false,\"zoomView\":false,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":1818}},\"groups\":[\"Person\",\"Organization\",\"Vessel\",\"Location\"],\"width\":\"100%\",\"height\":\"400px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"opts_manipulation\":{\"datacss\":\"table.legend_table {\\n  font-size: 11px;\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n}\\ntable.legend_table td {\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n  padding: 2px;\\n}\\ndiv.table_content {\\n  width:80px;\\n  text-align:center;\\n}\\ndiv.table_description {\\n  width:100px;\\n}\\n\\n.operation {\\n  font-size:20px;\\n}\\n\\n.network-popUp {\\n  display:none;\\n  z-index:299;\\n  width:250px;\\n  /*height:150px;*/\\n  background-color: #f9f9f9;\\n  border-style:solid;\\n  border-width:1px;\\n  border-color: #0d0d0d;\\n  padding:10px;\\n  text-align: center;\\n  position:fixed;\\n  top:50%;  \\n  left:50%;  \\n  margin:-100px 0 0 -100px;  \\n\\n}\",\"addNodeCols\":[\"id\",\"label\"],\"editNodeCols\":[\"id\",\"label\"],\"tab_add_node\":\"<span id=\\\"addnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"addnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"addnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"addnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"addnode-cancelButton\\\"><\\/button>\",\"tab_edit_node\":\"<span id=\\\"editnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"editnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"editnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"editnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"editnode-cancelButton\\\"><\\/button>\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n#### **5.5.3 - Degree for Nadia Conti**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# 1. Compute Degree for the ego network\nV(ego_1)$degree <- degree(ego_1, mode = \"all\")\n\n# 2. Prepare node data frame\nnodes_df_degree <- data.frame(\n  id = V(ego_1)$name,\n  label = V(ego_1)$label,\n  group = V(ego_1)$sub_type,\n  title = paste0(\"<b>\", V(ego_1)$label, \"</b><br>Degree: \", round(V(ego_1)$degree, 2)),\n  shape = ifelse(V(ego_1)$sub_type == \"Person\", \"dot\",\n                 ifelse(V(ego_1)$sub_type == \"Organization\", \"square\",\n                        ifelse(V(ego_1)$sub_type == \"Vessel\", \"triangle\",\n                               ifelse(V(ego_1)$sub_type == \"Group\", \"star\", \"diamond\")))),\n  color = case_when(\n    V(ego_1)$sub_type == \"Person\" ~ \"#2ca5ff\",\n    V(ego_1)$sub_type == \"Organization\" ~ \"#f5ee15\",\n    V(ego_1)$sub_type == \"Vessel\" ~ \"#FB7E81\",\n    V(ego_1)$sub_type == \"Group\" ~ \"#25e158\",\n    V(ego_1)$sub_type == \"Location\" ~ \"#ec4bff\",\n    TRUE ~ \"black\"\n  ),\n  value = V(ego_1)$degree * 5 + 5\n)\n\n# 3. Edges (same as before)\n# edges_df already prepared\n\n# 4. Plot\nvisNetwork(nodes_df_degree, edges_df, width = \"100%\", height = \"400px\") %>%\n  visNodes(\n    scaling = list(min = 5, max = 30),\n    color = list(background = nodes_df_degree$color, border = \"black\"),\n    shape = nodes_df_degree$shape\n  ) %>%\n  visEdges(arrows = list(to = list(enabled = TRUE, scaleFactor = 0.3)), color = list(color = \"gray\")) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE, manipulation = FALSE) %>%\n  visInteraction(dragNodes = FALSE, dragView = FALSE, zoomView = FALSE) %>%\n  visLegend() %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-ea113c1c0c75f6a36624\" style=\"width:100%;height:400px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ea113c1c0c75f6a36624\">{\"x\":{\"nodes\":{\"id\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Davis\",\"Rodriguez\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Sentinel\",\"Remora\",\"Haacklee Harbor\"],\"label\":[\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Davis\",\"Rodriguez\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Marlin\",\"Sentinel\",\"Remora\",\"Haacklee Harbor\"],\"group\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Organization\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Location\"],\"title\":[\"<b>Nadia Conti<\\/b><br>Degree: 17\",\"<b>Elise<\\/b><br>Degree: 6\",\"<b>Liam Thorne<\\/b><br>Degree: 6\",\"<b>Davis<\\/b><br>Degree: 10\",\"<b>Rodriguez<\\/b><br>Degree: 8\",\"<b>Oceanus City Council<\\/b><br>Degree: 11\",\"<b>V. Miesel Shipping<\\/b><br>Degree: 13\",\"<b>Sailor Shifts Team<\\/b><br>Degree: 4\",\"<b>Neptune<\\/b><br>Degree: 9\",\"<b>Marlin<\\/b><br>Degree: 4\",\"<b>Sentinel<\\/b><br>Degree: 3\",\"<b>Remora<\\/b><br>Degree: 12\",\"<b>Haacklee Harbor<\\/b><br>Degree: 3\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"diamond\"],\"color\":[\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#ec4bff\"],\"value\":[90,35,35,55,45,60,70,25,50,25,20,65,20]},\"edges\":{\"from\":[\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Elise\",\"Elise\",\"Elise\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Sailor Shifts Team\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Marlin\",\"Marlin\",\"Sentinel\",\"Sentinel\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Haacklee Harbor\",\"Haacklee Harbor\"],\"to\":[\"Liam Thorne\",\"Oceanus City Council\",\"V. Miesel Shipping\",\"Neptune\",\"Marlin\",\"Haacklee Harbor\",\"Nadia Conti\",\"Liam Thorne\",\"V. Miesel Shipping\",\"Nadia Conti\",\"Elise\",\"Oceanus City Council\",\"Nadia Conti\",\"Davis\",\"V. Miesel Shipping\",\"Neptune\",\"Remora\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"Sailor Shifts Team\",\"Remora\",\"Nadia Conti\",\"Liam Thorne\",\"Oceanus City Council\",\"Marlin\",\"Sentinel\",\"Nadia Conti\",\"Elise\",\"Davis\",\"Rodriguez\",\"V. Miesel Shipping\",\"Neptune\",\"Remora\",\"Nadia Conti\",\"Remora\",\"Nadia Conti\",\"Elise\",\"Davis\",\"V. Miesel Shipping\",\"Remora\",\"Oceanus City Council\",\"Remora\",\"Nadia Conti\",\"Oceanus City Council\",\"Nadia Conti\",\"Davis\",\"Rodriguez\",\"V. Miesel Shipping\",\"Sailor Shifts Team\",\"Neptune\",\"Nadia Conti\",\"Oceanus City Council\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"square\",\"square\",\"square\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"diamond\"],\"color\":{\"background\":[\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#2ca5ff\",\"#f5ee15\",\"#f5ee15\",\"#f5ee15\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#FB7E81\",\"#ec4bff\"],\"border\":\"black\"},\"scaling\":{\"min\":5,\"max\":30}},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":{\"to\":{\"enabled\":true,\"scaleFactor\":0.3}},\"color\":{\"color\":\"gray\"}},\"interaction\":{\"dragNodes\":false,\"dragView\":false,\"zoomView\":false,\"zoomSpeed\":1},\"layout\":{\"randomSeed\":1818}},\"groups\":[\"Person\",\"Organization\",\"Vessel\",\"Location\"],\"width\":\"100%\",\"height\":\"400px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"opts_manipulation\":{\"datacss\":\"table.legend_table {\\n  font-size: 11px;\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n}\\ntable.legend_table td {\\n  border-width:1px;\\n  border-color:#d3d3d3;\\n  border-style:solid;\\n  padding: 2px;\\n}\\ndiv.table_content {\\n  width:80px;\\n  text-align:center;\\n}\\ndiv.table_description {\\n  width:100px;\\n}\\n\\n.operation {\\n  font-size:20px;\\n}\\n\\n.network-popUp {\\n  display:none;\\n  z-index:299;\\n  width:250px;\\n  /*height:150px;*/\\n  background-color: #f9f9f9;\\n  border-style:solid;\\n  border-width:1px;\\n  border-color: #0d0d0d;\\n  padding:10px;\\n  text-align: center;\\n  position:fixed;\\n  top:50%;  \\n  left:50%;  \\n  margin:-100px 0 0 -100px;  \\n\\n}\",\"addNodeCols\":[\"id\",\"label\"],\"editNodeCols\":[\"id\",\"label\"],\"tab_add_node\":\"<span id=\\\"addnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"addnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"addnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"addnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"addnode-cancelButton\\\"><\\/button>\",\"tab_edit_node\":\"<span id=\\\"editnode-operation\\\" class = \\\"operation\\\">node<\\/span> <br><table style=\\\"margin:auto;\\\"><tr><td>id<\\/td><td><input id=\\\"editnode-id\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><tr><td>label<\\/td><td><input id=\\\"editnode-label\\\"  type= \\\"text\\\" value=\\\"new value\\\"><\\/td><\\/tr><\\/table><input type=\\\"button\\\" value=\\\"save\\\" id=\\\"editnode-saveButton\\\"><\\/button><input type=\\\"button\\\" value=\\\"cancel\\\" id=\\\"editnode-cancelButton\\\"><\\/button>\"},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"legend\":{\"width\":0.2,\"useGroups\":true,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":100,\"zoom\":true}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n::: callout-tip\n## 1c. With a focus on \"Nadia Conti\", the visuals above could determine who has influence over this person.\n\n1.  Degree centrality reveals that Nadia Conti is well-connected within her local network, with a degree of 17. However, she is not the most connected node; vessels such as Mako (37), Reef Guardian (27), and Remora (21), as well as organizations like Oceanus City Council (28) and V. Miesel Shipping (19), have even higher degrees. This indicates that while Nadia is an important hub, her sphere of direct interaction is embedded within a dense mesh of other highly connected entities.\n\n2.  Several other individuals (e.g., Davis with 16, Boss with 13, Mrs. Money with 12) and vessels (e.g., Neptune with 19, Sentinel with 16) also play significant roles in Nadia’s network. The presence of organizations (e.g., Green Guardians, Sailor Shifts Team), multiple vessels, and key persons shows that **Nadia’s environment is both diverse and robust**.\n\n3.  **Direct Connections**\n\n    These direct connections are clearly shown as nodes that have edges (arrows) going into or out of Nadia Conti’s node in the network diagrams. Nadia Conti directly connects to several core entities across different types:\n\n    -   **People:** Elise, Liam Thorne, Davis, Rodriguez\n    -   **Organization:** V. Miesel Shipping, Oceanus City Council, Sailor Shifts Team\n    -   **Vessel:** Neptune, Marlin, Remora, Sentinel\n    -   **Location:** Haacklee Harbor\n\n    **Interpretation:** The PageRank, Betweenness, and Degree centrality plots all consistently show **Nadia Conti as a major hub**, with a large node size reflecting her high centrality. Her immediate network includes influential vessels (Neptune, Remora), organizations (V. Miesel Shipping, Oceanus City Council), and several persons (Elise, Davis, Rodriguez).\n\n    Nadia’s position suggests she is a **key connector and influencer** but is herself surrounded by even larger hubs, particularly among vessels and organizations. Her ability to influence—and be influenced—is amplified by these connections, as these high-degree entities are likely sources and conduits of critical information and operational coordination. This structure points to a tightly interwoven community, where central actors such as Mako, Oceanus City Council, and V. Miesel Shipping may exert the most substantial influence over Nadia’s access to information, resources, and strategic decisions.\n:::\n\n## 5 - Task 2: Interactions and Relationships Between People & Vessels\n\n**Question 2 Goals**:\n\n> Understand and explore interactions and relationships groups between people and vessels.\\\n> Identify closely associated groups and their thematic focus.\n\n### Step-by-step Plan\n\n#### Step 1: Run Community Detection\n\nEnsure we have a usable network graph:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Step 1: Convert directed tidygraph to igraph, then undirected\nigraph_undirected <- as.undirected(as.igraph(mc3_graph), mode = \"collapse\")\n\n# Step 2: Convert back to tidygraph (tbl_graph)\nmc3_graph_undirected <- as_tbl_graph(igraph_undirected)\n\n# Step 3: Apply Louvain community detection\nmc3_graph_undirected <- mc3_graph_undirected %>%\n  mutate(community = as.factor(group_louvain()))\n```\n:::\n\n\n\n#### Step 2: Extract People & Vessels with Community Info\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract node table from graph\npeople_vessels_comm <- mc3_graph_undirected %>%\n  as_tibble() %>%\n  filter(sub_type %in% c(\"Person\", \"Vessel\")) %>%\n  select(label, sub_type, community)\n\n# Quick look\nhead(people_vessels_comm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n  label          sub_type community\n  <chr>          <chr>    <fct>    \n1 Sam            Person   9        \n2 Kelly          Person   9        \n3 Nadia Conti    Person   9        \n4 Elise          Person   9        \n5 Liam Thorne    Person   6        \n6 Samantha Blake Person   1        \n```\n\n\n:::\n:::\n\n\n\n#### Step 3: Summary Table of People & Vessels by Community\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Community composition\nlibrary(knitr)\n\ngroup_summary <- people_vessels_comm %>%\n  count(community, sub_type, sort = TRUE)\n\nkable(group_summary, caption = \"Distribution of People and Vessels Across Detected Communities\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Distribution of People and Vessels Across Detected Communities\n\n|community |sub_type |  n|\n|:---------|:--------|--:|\n|5         |Person   |  6|\n|3         |Vessel   |  4|\n|9         |Person   |  4|\n|1         |Person   |  3|\n|4         |Vessel   |  3|\n|7         |Vessel   |  3|\n|1         |Vessel   |  2|\n|2         |Vessel   |  2|\n|8         |Person   |  2|\n|2         |Person   |  1|\n|6         |Person   |  1|\n|9         |Vessel   |  1|\n|10        |Person   |  1|\n\n\n:::\n:::\n\n\n\n#### Step 4: Visualize Clusters of People & Vessels\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggraph(mc3_graph_undirected, layout = \"fr\") +\n  geom_edge_link(alpha = 0.1, colour = \"grey\") +\n  geom_node_point(aes(color = community, shape = sub_type), size = 3, alpha = 0.9) +\n  geom_node_text(aes(label = ifelse(sub_type %in% c(\"Person\", \"Vessel\"), label, NA_character_)), \n                 size = 2.3, repel = TRUE) +\n  labs(\n    title = \"Community Clusters of People and Vessels in Oceanus\",\n    subtitle = \"Identified using Louvain Algorithm on Undirected Graph\"\n  ) +\n  theme_graph() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-63-1.png){width=672}\n:::\n:::\n\n\n\n#### **Step 5 – Thematic Tagging of Communities**\n\nWe will assign **themes** to nodes and communities based on keywords in `label` or `sub_type`. For example:\n\n-   Entities with “Green” or “Guardian” → `Environmental`\n-   Labels with “Sailor Shift” or “Pop” → `Sailor Shift`\n-   Any node with `sub_type == \"Vessel\"` → `Vessel`\n-   All others → `Other`\n\nCode: Assign Themes to Nodes\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Tag each node in the undirected graph with a thematic label\nmc3_graph_undirected <- mc3_graph_undirected %>%\n  mutate(theme = case_when(\n    str_detect(label, regex(\"Green|Guardian\", ignore_case = TRUE)) ~ \"Environmental\",\n    str_detect(label, regex(\"Sailor Shift|Pop\", ignore_case = TRUE)) ~ \"Sailor Shift\",\n    sub_type == \"Vessel\" ~ \"Vessel\",\n    TRUE ~ \"Other\"\n  ))\n```\n:::\n\n\n\nCode: Summarize Theme Composition\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Theme breakdown per community\ntheme_summary <- mc3_graph_undirected %>%\n  as_tibble() %>%\n  count(community, theme, sort = TRUE)\n\nknitr::kable(theme_summary, caption = \"Theme Breakdown per Community\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Theme Breakdown per Community\n\n|community |theme         |   n|\n|:---------|:-------------|---:|\n|1         |Other         | 173|\n|2         |Other         | 165|\n|3         |Other         | 152|\n|4         |Other         | 150|\n|5         |Other         | 131|\n|6         |Other         | 113|\n|7         |Other         |  92|\n|8         |Other         |  72|\n|9         |Other         |  65|\n|10        |Other         |  28|\n|3         |Vessel        |   3|\n|4         |Vessel        |   3|\n|7         |Vessel        |   3|\n|1         |Sailor Shift  |   2|\n|1         |Vessel        |   2|\n|2         |Vessel        |   2|\n|3         |Environmental |   1|\n|4         |Environmental |   1|\n|9         |Vessel        |   1|\n\n\n:::\n:::\n\n\n\n#### **Step 6 – Faceted or Thematic Visualization**\n\nWe will now plot **faceted or color-coded networks** to show how these communities and themes look visually.\n\n🔹 Option A: **Color by Theme**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggraph(mc3_graph_undirected, layout = \"fr\") +\n  geom_edge_link(alpha = 0.1, colour = \"grey\") +\n  geom_node_point(aes(color = theme, shape = sub_type), size = 3, alpha = 0.9) +\n  geom_node_text(aes(label = ifelse(sub_type %in% c(\"Person\", \"Vessel\"), label, NA_character_)), \n                 size = 2.3, repel = TRUE) +\n  labs(\n    title = \"Network of People and Vessels in Oceanus\",\n    subtitle = \"Color-coded by Theme (Environmental, Sailor Shift, Vessel)\"\n  ) +\n  theme_graph() +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-66-1.png){width=672}\n:::\n:::\n\n\n\n🔹 Option B: **Facet by Theme**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggraph(mc3_graph_undirected, layout = \"fr\") +\n  geom_edge_link(alpha = 0.1, colour = \"grey\") +\n  geom_node_point(aes(color = community, shape = sub_type), size = 3, alpha = 0.9) +\n  geom_node_text(aes(label = ifelse(sub_type %in% c(\"Person\", \"Vessel\"), label, NA_character_)), \n                 size = 2.3, repel = TRUE) +\n  facet_nodes(~ theme) +\n  labs(\n    title = \"Community Clusters Faceted by Theme\",\n    subtitle = \"Facets: Environmental, Sailor Shift, Vessel, Other\"\n  ) +\n  theme_graph() +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-67-1.png){width=672}\n:::\n:::\n\n\n\n## Strategy for Question 2:\n\n### 1. **Filter for Communication Events Only**\n\n-   Use `edges` that connect `Entity → Event (Communication)` and `Event (Communication) → Entity`.\n-   Focus only on `Communication` events and extract senders and receivers.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract Communication Events from nodes\ncommunication_events <- mc3_nodes_cleaned %>%\n  filter(type == \"Event\", sub_type == \"Communication\") %>%\n  select(id, label)\n\n# Extract sent edges: Entity → Communication Event\ncomm_sent_edges <- mc3_edges_cleaned %>%\n  filter(type == \"sent\", to_id %in% communication_events$id)\n\n# Extract received edges: Communication Event → Entity\ncomm_received_edges <- mc3_edges_cleaned %>%\n  filter(type == \"received\", from_id %in% communication_events$id)\n\n# Join both to get Sender → Communication → Receiver\ncomm_links <- comm_sent_edges %>%\n  select(comm_id = to_id, sender = from_id) %>%\n  inner_join(\n    comm_received_edges %>% select(comm_id = from_id, receiver = to_id),\n    by = \"comm_id\"\n  ) %>%\n  filter(sender != receiver)\n```\n:::\n\n\n\n### 2. **Construct a Bipartite Graph of Communications**\n\n-   From edges:\n\n    -   **Sender (Entity)** → **Communication Event**\n    -   **Communication Event** → **Receiver (Entity)**\n\n-   Join both directions to link:\\\n    `Entity A → Communication Event → Entity B` → derive `Entity A → Entity B` communication links.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get people and vessel node IDs\npeople_vessels <- mc3_nodes_cleaned %>%\n  filter(sub_type %in% c(\"Person\", \"Vessel\")) %>%\n  select(id, label, group = sub_type)\n\n# Filter comm links to include only person ↔ vessel or person ↔ person, etc.\ncomm_links_filtered <- comm_links %>%\n  filter(sender %in% people_vessels$id, receiver %in% people_vessels$id)\n```\n:::\n\n\n\n### 3. **Build Communication Network**\n\n-   Nodes: People and Vessels only (from `mc3_nodes_cleaned`).\n-   Edges: Summarized links between these nodes based on co-involvement in the same communication event.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Edge weight (number of communications)\nedge_df <- comm_links_filtered %>%\n  count(sender, receiver, name = \"weight\")\n\n# Create node list for graph\nnodes_df <- people_vessels %>%\n  filter(id %in% c(edge_df$sender, edge_df$receiver))\n\n# Build graph object\ncomm_graph <- tbl_graph(nodes = nodes_df, edges = edge_df, directed = FALSE)\n```\n:::\n\n\n\n### 4. **Apply Community Detection (e.g., Louvain or Walktrap)**\n\n-   Use `igraph` or `tidygraph` to detect communities.\n-   Annotate communities for possible labels (e.g., Green Guardians, Sailor Shift fans) using node metadata.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomm_graph <- comm_graph %>%\n  mutate(community = as.factor(group_louvain()))\n```\n:::\n\n\n\n### 5. **Visualize Network**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshape_map <- c(\"Person\" = \"circle\", \"Vessel\" = \"triangle\")\n\ncolor_map <- c(\n  \"Person\" = \"#fc8d62\",\n  \"Organization\" = \"#6baed6\",\n  \"Vessel\" = \"#66c2a2\",\n  \"Location\" = \"#c6dbef\",\n  \"Nadia Conti\" = \"#ffd92f\"\n)\n\nggraph(comm_graph, layout = \"fr\") +\n  geom_edge_link(aes(width = weight), alpha = 0.2, color = \"gray50\") +\n  geom_node_point(aes(color = group, shape = group), size = 4) +\n  geom_node_text(aes(label = label), repel = TRUE, size = 2.5) +\n  scale_shape_manual(values = shape_map) +\n  scale_color_manual(values = color_map) +\n  theme_graph() +\n  labs(title = \"Communication Clusters Between People and Vessels\",\n       subtitle = \"Communities detected using Louvain algorithm\")\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-71-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get only Person and Vessel nodes\npeople_vessels <- mc3_nodes_cleaned %>%\n  filter(sub_type %in% c(\"Person\", \"Vessel\")) %>%\n  select(id, label, group = sub_type)\n\n# Filter communication links for person ↔ vessel/person only\ncomm_links_filtered <- comm_links %>%\n  filter(sender %in% people_vessels$id, receiver %in% people_vessels$id)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count number of communications between each sender–receiver pair\ncomm_edge_df <- comm_links_filtered %>%\n  count(sender, receiver, name = \"weight\")\n\n# Build node dataframe from involved IDs only\ncomm_node_df <- people_vessels %>%\n  filter(id %in% unique(c(comm_edge_df$sender, comm_edge_df$receiver))) %>%\n  mutate(\n    shape = case_when(\n      group == \"Person\" ~ \"dot\",\n      group == \"Vessel\" ~ \"triangle\"\n    ),\n    color = case_when(\n      group == \"Person\" ~ \"#fc8d62\",\n      group == \"Vessel\" ~ \"#66c2a2\",\n      label == \"Nadia Conti\" ~ \"#ffd92f\",\n      TRUE ~ \"#c6dbef\"\n    )\n  )\n\n# Format edges for visNetwork\ncomm_vis_edges <- comm_edge_df %>%\n  rename(from = sender, to = receiver) %>%\n  mutate(width = weight)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\n\n# Create igraph object\ngraph_ig <- graph_from_data_frame(comm_vis_edges, directed = FALSE, vertices = comm_node_df)\n\n# Apply Louvain clustering\nlouvain_groups <- cluster_louvain(graph_ig)\ncomm_node_df$group_comm <- as.factor(membership(louvain_groups))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(visNetwork)\n\n# Title heading\ncat(\"### Interactive Network of Communication Between People and Vessels\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n### Interactive Network of Communication Between People and Vessels\n```\n\n\n:::\n\n```{.r .cell-code}\n# Final interactive visNetwork with consistent styling\nvisNetwork(\n  nodes = comm_node_df,\n  edges = comm_vis_edges\n) %>%\n  visEdges(arrows = \"to\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visLayout(randomSeed = 123) %>%\n  visPhysics(\n    solver = \"forceAtlas2Based\",\n    forceAtlas2Based = list(\n      gravitationalConstant = -80,\n      centralGravity = 0.01,\n      springLength = 50,\n      springConstant = 0.02\n    ),\n    stabilization = list(enabled = TRUE, iterations = 100)\n  ) %>%\n  visInteraction(navigationButtons = TRUE) %>%\n  visLegend(\n    useGroups = FALSE,\n    addNodes = list(\n      list(label = \"Person\", shape = \"dot\", color = \"#fc8d62\"),\n      list(label = \"Vessel\", shape = \"triangle\", color = \"#66c2a2\")\n    ),\n    width = 0.1,\n    position = \"left\",\n    stepY = 80,\n    ncol = 1\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"visNetwork html-widget html-fill-item\" id=\"htmlwidget-fb0049c35f2d9758a8d6\" style=\"width:100%;height:541px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fb0049c35f2d9758a8d6\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"group\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"color\":[\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\"],\"group_comm\":[\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"1\",\"3\",\"3\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"4\",\"4\",\"2\",\"4\",\"4\",\"4\",\"4\",\"4\",\"2\",\"4\",\"2\",\"2\"]},\"edges\":{\"from\":[\"Boss\",\"Boss\",\"Boss\",\"Clepper Jensen\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"Defender\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Elise\",\"Elise\",\"Horizon\",\"Horizon\",\"Horizon\",\"Horizon\",\"Horizon\",\"Kelly\",\"Knowles\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Marlin\",\"Miranda Jordan\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Neptune\",\"Osprey\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sam\",\"Samantha Blake\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"Small Fry\",\"Small Fry\",\"The Accountant\",\"The Accountant\",\"The Intern\",\"The Intern\",\"The Lookout\",\"The Lookout\",\"The Lookout\",\"The Lookout\",\"The Lookout\",\"The Middleman\",\"The Middleman\",\"The Middleman\",\"The Middleman\"],\"to\":[\"Mako\",\"Mrs. Money\",\"The Middleman\",\"Miranda Jordan\",\"Boss\",\"Mako\",\"Nadia Conti\",\"Neptune\",\"Remora\",\"Mako\",\"Reef Guardian\",\"Seawatch\",\"Horizon\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Liam Thorne\",\"Nadia Conti\",\"EcoVigil\",\"Mako\",\"Reef Guardian\",\"Seawatch\",\"Sentinel\",\"Sam\",\"Davis\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Nadia Conti\",\"Boss\",\"Davis\",\"Elise\",\"Marlin\",\"Neptune\",\"Osprey\",\"Reef Guardian\",\"Remora\",\"Samantha Blake\",\"Sentinel\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Remora\",\"Clepper Jensen\",\"Boss\",\"Mako\",\"Neptune\",\"Remora\",\"The Intern\",\"The Middleman\",\"Liam Thorne\",\"Marlin\",\"Neptune\",\"Davis\",\"Elise\",\"Mako\",\"Nadia Conti\",\"Reef Guardian\",\"Remora\",\"Serenity\",\"Mako\",\"Defender\",\"EcoVigil\",\"Horizon\",\"Mako\",\"Marlin\",\"Neptune\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Davis\",\"Mako\",\"Nadia Conti\",\"Neptune\",\"Rodriguez\",\"Boss\",\"Davis\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Mako\",\"Nadia Conti\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Mako\",\"Remora\",\"Boss\",\"The Middleman\",\"Mrs. Money\",\"The Lookout\",\"Horizon\",\"Reef Guardian\",\"Sam\",\"Sentinel\",\"The Intern\",\"Boss\",\"Liam Thorne\",\"Mrs. Money\",\"The Accountant\"],\"weight\":[1,4,3,20,1,5,5,1,4,1,3,1,5,2,2,2,1,3,3,1,1,2,4,2,2,1,1,1,1,2,2,1,1,1,3,2,2,5,4,4,1,1,1,2,18,6,1,2,1,5,3,2,1,2,2,3,7,1,1,9,1,6,2,4,3,2,3,1,3,3,3,1,9,1,6,1,3,3,1,1,1,1,3,1,5,5,1,1,1,2,2,2,2,1,4,2,1,15,8,5,1,8,4,12,4,2,3,3],\"width\":[1,4,3,20,1,5,5,1,4,1,3,1,5,2,2,2,1,3,3,1,1,2,4,2,2,1,1,1,1,2,2,1,1,1,3,2,2,5,4,4,1,1,1,2,18,6,1,2,1,5,3,2,1,2,2,3,7,1,1,9,1,6,2,4,3,2,3,1,3,3,3,1,9,1,6,1,3,3,1,1,1,1,3,1,5,5,1,1,1,2,2,2,2,1,4,2,1,15,8,5,1,8,4,12,4,2,3,3]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\"},\"manipulation\":{\"enabled\":false},\"edges\":{\"arrows\":\"to\"},\"layout\":{\"randomSeed\":123},\"physics\":{\"solver\":\"forceAtlas2Based\",\"stabilization\":{\"enabled\":true,\"iterations\":100},\"forceAtlas2Based\":{\"gravitationalConstant\":-80,\"centralGravity\":0.01,\"springLength\":50,\"springConstant\":0.02}},\"interaction\":{\"navigationButtons\":true,\"zoomSpeed\":1}},\"groups\":[\"Person\",\"Vessel\"],\"width\":null,\"height\":null,\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\",\"legend\":{\"width\":0.1,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":80,\"zoom\":true,\"nodes\":[{\"label\":\"Person\",\"shape\":\"dot\",\"color\":\"#fc8d62\"},{\"label\":\"Vessel\",\"shape\":\"triangle\",\"color\":\"#66c2a2\"}],\"nodesToDataframe\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(scales)  # for rescale()\n\n# Step 1: Summarize sender–receiver communication volume\ncomm_edges_vis <- comm_links_filtered %>%\n  count(sender, receiver, sort = TRUE) %>%\n  rename(from = sender, to = receiver, value = n)\n\n# Step 2: Compute messages sent per person\nmessage_counts <- comm_edges_vis %>%\n  group_by(from) %>%\n  summarise(sent_count = sum(value), .groups = \"drop\")\n\n# Step 3: Prepare node attributes (label, shape, color, size)\nnodes_vis <- mc3_nodes_cleaned %>%\n  filter(id %in% unique(c(comm_edges_vis$from, comm_edges_vis$to))) %>%\n  select(id, label, sub_type) %>%\n  left_join(message_counts, by = c(\"id\" = \"from\")) %>%\n  mutate(\n    size = if_else(\n      sub_type == \"Person\",\n      rescale(sent_count, to = c(10, 40), na.rm = TRUE),\n      15\n    ),\n    title = paste0(label, \"<br>Sub-type: \", sub_type,\n                   ifelse(!is.na(sent_count), paste0(\"<br>Sent: \", sent_count, \" messages\"), \"\")),\n    color = case_when(\n      sub_type == \"Person\" ~ \"#fc8d62\",\n      sub_type == \"Vessel\" ~ \"#66c2a2\",\n      TRUE ~ \"black\"\n    ),\n    shape = case_when(\n      sub_type == \"Person\" ~ \"dot\",\n      sub_type == \"Vessel\" ~ \"triangle\",\n      TRUE ~ \"dot\"\n    )\n  )\n\n# Step 4: Format edges\nedges_vis <- comm_edges_vis %>%\n  mutate(\n    arrows = \"to\",\n    width = rescale(value, to = c(1, 6)),\n    title = paste(\"Messages:\", value)\n  )\n\n# Step 5: Define proper legend nodes (explicit list)\nlegend_nodes <- list(\n  list(label = \"Person\", shape = \"dot\", color = \"#fc8d62\"),\n  list(label = \"Vessel\", shape = \"triangle\", color = \"#66c2a2\")\n)\n\n\n# Step 6: Render visNetwork with layout_on_sphere and custom legend\ncat(\"### Styled Communication Network (Scaled by Sent Messages)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n### Styled Communication Network (Scaled by Sent Messages)\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"900px\") %>%\n  visNodes(size = nodes_vis$size) %>%\n  visLegend(\n    useGroups = FALSE,\n    addNodes = legend_nodes,\n    width = 0.1,\n    position = \"left\",\n    stepY = 80,\n    ncol = 1\n  ) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visIgraphLayout(layout = \"layout_on_sphere\") %>%\n  visPhysics(enabled = FALSE) %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-73bc3e0dfa32fae8d75e\" style=\"width:100%;height:900px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-73bc3e0dfa32fae8d75e\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"sub_type\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\"],\"sent_count\":[1,2,5,4,5,3,16,9,20,18,23,30,3,18,12,8,7,24,4,6,26,24,11,1,11,13,6,5,18,3],\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15],\"title\":[\"Sam<br>Sub-type: Person<br>Sent: 1 messages\",\"Kelly<br>Sub-type: Person<br>Sent: 2 messages\",\"Nadia Conti<br>Sub-type: Person<br>Sent: 5 messages\",\"Elise<br>Sub-type: Person<br>Sent: 4 messages\",\"Liam Thorne<br>Sub-type: Person<br>Sent: 5 messages\",\"Samantha Blake<br>Sub-type: Person<br>Sent: 3 messages\",\"Davis<br>Sub-type: Person<br>Sent: 16 messages\",\"Rodriguez<br>Sub-type: Person<br>Sent: 9 messages\",\"Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages\",\"Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages\",\"The Intern<br>Sub-type: Person<br>Sent: 23 messages\",\"The Lookout<br>Sub-type: Person<br>Sent: 30 messages\",\"The Accountant<br>Sub-type: Person<br>Sent: 3 messages\",\"Mrs. Money<br>Sub-type: Person<br>Sent: 18 messages\",\"The Middleman<br>Sub-type: Person<br>Sent: 12 messages\",\"Boss<br>Sub-type: Person<br>Sent: 8 messages\",\"Small Fry<br>Sub-type: Person<br>Sent: 7 messages\",\"Neptune<br>Sub-type: Vessel<br>Sent: 24 messages\",\"Marlin<br>Sub-type: Vessel<br>Sent: 4 messages\",\"Serenity<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Mako<br>Sub-type: Vessel<br>Sent: 26 messages\",\"Reef Guardian<br>Sub-type: Vessel<br>Sent: 24 messages\",\"Horizon<br>Sub-type: Vessel<br>Sent: 11 messages\",\"Seawatch<br>Sub-type: Vessel<br>Sent: 1 messages\",\"EcoVigil<br>Sub-type: Vessel<br>Sent: 11 messages\",\"Sentinel<br>Sub-type: Vessel<br>Sent: 13 messages\",\"Osprey<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Defender<br>Sub-type: Vessel<br>Sent: 5 messages\",\"Remora<br>Sub-type: Vessel<br>Sent: 18 messages\",\"Knowles<br>Sub-type: Vessel<br>Sent: 3 messages\"],\"color\":[\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"x\":[-0.0164016790279049,-0.1026135974506925,-0.5404493846356658,-0.3379794459495071,0.2731915647269529,0.7344293486603517,0.7078527859424231,0.2237941584707337,-0.4277208594852183,-0.8985809210224573,-0.9587792299036473,-0.5850776403328641,0.05023845122158987,0.6672254213613049,1,0.9055055838150528,0.4213885318424024,-0.246864742474069,-0.8065039839619059,-1,-0.7260240649493297,-0.1080676794267668,0.5328077129009241,0.8186908893206482,0.5399220128399846,-0.1311577559946691,-0.6127645983460153,-0.3143580228953072,0.335227779387782,-0.0164016790279049],\"y\":[0.01204131659955188,0.3778669347577224,0.03478599041096286,-0.5273674345567976,-0.6369856649613506,-0.2052087745614,0.4324609800598234,0.8602252372341319,0.8364682178603009,0.3828176504799945,-0.2693956028626937,-0.8115758923587716,-1,-0.753670091151123,-0.1791801779577675,0.4787499462630427,0.938932740202054,1,0.6289775767617096,-0.01332773823932343,-0.6277163702484623,-0.9038110584374476,-0.6793487992323514,-0.06357718493007369,0.5586674127693319,0.7128942504961329,0.2153957757424554,-0.4174109379874491,-0.1251747277900545,0.01204131659955188]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Remora\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Mrs. Money\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Mako\",\"Mrs. Money\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Horizon\",\"Mako\",\"Mako\",\"Reef Guardian\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"Boss\",\"Defender\",\"Elise\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"The Middleman\",\"The Middleman\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"Boss\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"Elise\",\"Horizon\",\"Horizon\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sam\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Lookout\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"The Intern\",\"Remora\",\"Mako\",\"The Lookout\",\"Sam\",\"Mako\",\"Boss\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Remora\",\"The Intern\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Sentinel\",\"Samantha Blake\",\"Sentinel\",\"EcoVigil\",\"Remora\",\"Sentinel\",\"Boss\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Horizon\",\"Marlin\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Boss\",\"Davis\",\"Mako\",\"Mrs. Money\",\"The Accountant\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Reef Guardian\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Defender\",\"Mako\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Mako\",\"Boss\",\"Neptune\",\"Mako\",\"Seawatch\",\"Liam Thorne\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Remora\",\"Marlin\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Neptune\",\"Davis\",\"Nadia Conti\",\"Rodriguez\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Reef Guardian\",\"Nadia Conti\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"Reef Guardian\"],\"value\":[20,18,15,12,9,9,8,8,7,6,6,6,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15],\"physics\":false},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"enabled\":false},\"layout\":{\"randomSeed\":1818}},\"groups\":null,\"width\":\"100%\",\"height\":\"900px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"legend\":{\"width\":0.1,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":80,\"zoom\":true,\"nodes\":[{\"label\":\"Person\",\"shape\":\"dot\",\"color\":\"#fc8d62\"},{\"label\":\"Vessel\",\"shape\":\"triangle\",\"color\":\"#66c2a2\"}],\"nodesToDataframe\":false},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"igraphlayout\":{\"type\":\"square\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(scales)  # for rescale()\n\n# Step 1: Summarize sender–receiver communication volume\ncomm_edges_vis <- comm_links_filtered %>%\n  count(sender, receiver, sort = TRUE) %>%\n  rename(from = sender, to = receiver, value = n)\n\n# Step 2: Compute messages sent per person\nmessage_counts <- comm_edges_vis %>%\n  group_by(from) %>%\n  summarise(sent_count = sum(value), .groups = \"drop\")\n\n# Step 3: Prepare node attributes (label, shape, color, size)\nnodes_vis <- mc3_nodes_cleaned %>%\n  filter(id %in% unique(c(comm_edges_vis$from, comm_edges_vis$to))) %>%\n  select(id, label, sub_type) %>%\n  left_join(message_counts, by = c(\"id\" = \"from\")) %>%\n  mutate(\n    size = if_else(\n      sub_type == \"Person\",\n      rescale(sent_count, to = c(10, 40), na.rm = TRUE),\n      15\n    ),\n    title = paste0(label, \"<br>Sub-type: \", sub_type,\n                   ifelse(!is.na(sent_count), paste0(\"<br>Sent: \", sent_count, \" messages\"), \"\")),\n    color = case_when(\n      sub_type == \"Person\" ~ \"#fc8d62\",\n      sub_type == \"Vessel\" ~ \"#66c2a2\",\n      TRUE ~ \"black\"\n    ),\n    shape = case_when(\n      sub_type == \"Person\" ~ \"dot\",\n      sub_type == \"Vessel\" ~ \"triangle\",\n      TRUE ~ \"dot\"\n    )\n  )\n\n# Step 4: Format edges\nedges_vis <- comm_edges_vis %>%\n  mutate(\n    arrows = \"to\",\n    width = rescale(value, to = c(1, 6)),\n    title = paste(\"Messages:\", value)\n  )\n\n# Step 5: Define proper legend nodes (explicit list)\nlegend_nodes <- list(\n  list(label = \"Person\", shape = \"dot\", color = \"#fc8d62\"),\n  list(label = \"Vessel\", shape = \"triangle\", color = \"#66c2a2\")\n)\n\n\n# Step 6: Render visNetwork with layout_on_sphere and custom legend\ncat(\"### Styled Communication Network (Scaled by Sent Messages)\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n### Styled Communication Network (Scaled by Sent Messages)\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nvisNetwork(nodes_vis, edges_vis, width = \"100%\", height = \"900px\") %>%\n  visNodes(size = nodes_vis$size) %>%\n  visLegend(\n    useGroups = FALSE,\n    addNodes = legend_nodes,\n    width = 0.1,\n    position = \"left\",\n    stepY = 80,\n    ncol = 1\n  ) %>%\n  visEdges(smooth = FALSE) %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visPhysics(\n    solver = \"forceAtlas2Based\",\n    forceAtlas2Based = list(\n      gravitationalConstant = -50,   # Increase pull toward center\n      centralGravity = 0.005,        # Lower keeps outer nodes further\n      springLength = 100,            # Length between nodes\n      springConstant = 0.02\n    ),\n    stabilization = list(enabled = TRUE, iterations = 100)\n  ) %>%\n  visLayout(randomSeed = 1818)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-5625639226de3d255a48\" style=\"width:100%;height:900px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5625639226de3d255a48\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"sub_type\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\"],\"sent_count\":[1,2,5,4,5,3,16,9,20,18,23,30,3,18,12,8,7,24,4,6,26,24,11,1,11,13,6,5,18,3],\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15],\"title\":[\"Sam<br>Sub-type: Person<br>Sent: 1 messages\",\"Kelly<br>Sub-type: Person<br>Sent: 2 messages\",\"Nadia Conti<br>Sub-type: Person<br>Sent: 5 messages\",\"Elise<br>Sub-type: Person<br>Sent: 4 messages\",\"Liam Thorne<br>Sub-type: Person<br>Sent: 5 messages\",\"Samantha Blake<br>Sub-type: Person<br>Sent: 3 messages\",\"Davis<br>Sub-type: Person<br>Sent: 16 messages\",\"Rodriguez<br>Sub-type: Person<br>Sent: 9 messages\",\"Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages\",\"Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages\",\"The Intern<br>Sub-type: Person<br>Sent: 23 messages\",\"The Lookout<br>Sub-type: Person<br>Sent: 30 messages\",\"The Accountant<br>Sub-type: Person<br>Sent: 3 messages\",\"Mrs. Money<br>Sub-type: Person<br>Sent: 18 messages\",\"The Middleman<br>Sub-type: Person<br>Sent: 12 messages\",\"Boss<br>Sub-type: Person<br>Sent: 8 messages\",\"Small Fry<br>Sub-type: Person<br>Sent: 7 messages\",\"Neptune<br>Sub-type: Vessel<br>Sent: 24 messages\",\"Marlin<br>Sub-type: Vessel<br>Sent: 4 messages\",\"Serenity<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Mako<br>Sub-type: Vessel<br>Sent: 26 messages\",\"Reef Guardian<br>Sub-type: Vessel<br>Sent: 24 messages\",\"Horizon<br>Sub-type: Vessel<br>Sent: 11 messages\",\"Seawatch<br>Sub-type: Vessel<br>Sent: 1 messages\",\"EcoVigil<br>Sub-type: Vessel<br>Sent: 11 messages\",\"Sentinel<br>Sub-type: Vessel<br>Sent: 13 messages\",\"Osprey<br>Sub-type: Vessel<br>Sent: 6 messages\",\"Defender<br>Sub-type: Vessel<br>Sent: 5 messages\",\"Remora<br>Sub-type: Vessel<br>Sent: 18 messages\",\"Knowles<br>Sub-type: Vessel<br>Sent: 3 messages\"],\"color\":[\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#fc8d62\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\",\"#66c2a2\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Remora\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Mrs. Money\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Mako\",\"Mrs. Money\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Horizon\",\"Mako\",\"Mako\",\"Reef Guardian\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"Boss\",\"Defender\",\"Elise\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"The Middleman\",\"The Middleman\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"Boss\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"Elise\",\"Horizon\",\"Horizon\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sam\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Lookout\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"The Intern\",\"Remora\",\"Mako\",\"The Lookout\",\"Sam\",\"Mako\",\"Boss\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Remora\",\"The Intern\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Sentinel\",\"Samantha Blake\",\"Sentinel\",\"EcoVigil\",\"Remora\",\"Sentinel\",\"Boss\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Horizon\",\"Marlin\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Boss\",\"Davis\",\"Mako\",\"Mrs. Money\",\"The Accountant\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Reef Guardian\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Defender\",\"Mako\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Mako\",\"Boss\",\"Neptune\",\"Mako\",\"Seawatch\",\"Liam Thorne\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Remora\",\"Marlin\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Neptune\",\"Davis\",\"Nadia Conti\",\"Rodriguez\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Reef Guardian\",\"Nadia Conti\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"Reef Guardian\"],\"value\":[20,18,15,12,9,9,8,8,7,6,6,6,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":\"dot\",\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15]},\"manipulation\":{\"enabled\":false},\"edges\":{\"smooth\":false},\"physics\":{\"solver\":\"forceAtlas2Based\",\"stabilization\":{\"enabled\":true,\"iterations\":100},\"forceAtlas2Based\":{\"gravitationalConstant\":-50,\"centralGravity\":0.005,\"springLength\":100,\"springConstant\":0.02}},\"layout\":{\"randomSeed\":1818}},\"groups\":null,\"width\":\"100%\",\"height\":\"900px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"legend\":{\"width\":0.1,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":80,\"zoom\":true,\"nodes\":[{\"label\":\"Person\",\"shape\":\"dot\",\"color\":\"#fc8d62\"},{\"label\":\"Vessel\",\"shape\":\"triangle\",\"color\":\"#66c2a2\"}],\"nodesToDataframe\":false},\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\n\n# Step 1: Filter only Communication edges\ncomm_edges_all <- mc3_edges_cleaned %>%\n  filter(type %in% c(\"sent\", \"received\"))\n\n# Step 2: Count messages by sender/receiver\nsent_counts <- comm_edges_all %>%\n  filter(type == \"sent\") %>%\n  count(from_id, name = \"sent\")\n\nreceived_counts <- comm_edges_all %>%\n  filter(type == \"received\") %>%\n  count(to_id, name = \"received\")\n\n# Step 3: Join and label\ncomm_summary <- full_join(sent_counts, received_counts, by = c(\"from_id\" = \"to_id\")) %>%\n  rename(id = from_id) %>%\n  replace_na(list(sent = 0, received = 0)) %>%\n  left_join(mc3_nodes_cleaned %>% select(id, label, sub_type), by = \"id\") %>%\n  pivot_longer(cols = c(sent, received), names_to = \"direction\", values_to = \"count\")\n\n# Step 4: Bar plot\nggplot(comm_summary, aes(x = reorder(label, -count), y = count, fill = direction)) +\n  geom_col(position = \"dodge\") +\n  scale_fill_manual(values = c(\"sent\" = \"#2ca5ff\", \"received\" = \"#fb8072\")) +\n  labs(\n    title = \"Message Volume by Entity\",\n    x = \"Entity\",\n    y = \"Message Count\",\n    fill = \"Direction\"\n  ) +\n  theme_minimal() +\n  theme(\n    axis.text.x = element_text(angle = 45, hjust = 1),\n    plot.title = element_text(size = 14, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-78-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(ggtext)\n\n# Step 1: Filter only Communication edges\ncomm_edges_all <- mc3_edges_cleaned %>%\n  filter(type %in% c(\"sent\", \"received\"))\n\n# Step 2: Count messages sent and received\nsent_counts <- comm_edges_all %>%\n  filter(type == \"sent\") %>%\n  count(from_id, name = \"sent\")\n\nreceived_counts <- comm_edges_all %>%\n  filter(type == \"received\") %>%\n  count(to_id, name = \"received\")\n\n# Step 3: Join and format\ncomm_summary <- full_join(sent_counts, received_counts, by = c(\"from_id\" = \"to_id\")) %>%\n  rename(id = from_id) %>%\n  replace_na(list(sent = 0, received = 0)) %>%\n  left_join(mc3_nodes_cleaned %>% select(id, label, sub_type), by = \"id\") %>%\n  pivot_longer(cols = c(sent, received), names_to = \"direction\", values_to = \"count\")\n\n# Step 4: Create colored labels for x-axis\ncomm_summary <- comm_summary %>%\n  mutate(\n    x_label = paste0(\n      \"<span style='color:\",\n      case_when(\n        sub_type == \"Vessel\" ~ \"#66c2a2\",\n        sub_type == \"Person\" ~ \"#fc8d62\",\n        TRUE ~ \"gray\"\n      ),\n      \"'>\", label, \"</span>\"\n    )\n  )\n\n# Step 5: Bar Plot with colored axis text\nggplot(comm_summary, aes(x = reorder(x_label, -count), y = count, fill = direction)) +\n  geom_col(position = \"dodge\") +\n  scale_fill_manual(values = c(\"sent\" = \"#2ca5ff\", \"received\" = \"#fb8072\")) +\n  labs(\n    title = \"Message Volume by Entity\",\n    x = \"Entity\",\n    y = \"Message Count\",\n    fill = \"Direction\"\n  ) +\n  theme_minimal(base_size = 11) +\n  theme(\n    axis.text.x = element_markdown(angle = 45, hjust = 1),\n    plot.title = element_text(size = 14, face = \"bold\")\n  )\n```\n\n::: {.cell-output-display}\n![](Take-Home_Ex02_MC3---Q2_files/figure-html/unnamed-chunk-79-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(plotly)\nlibrary(DT)\n\n# Step 1: Compute message counts\ncomm_edges_all <- mc3_edges_cleaned %>%\n  filter(type %in% c(\"sent\", \"received\"))\n\nsent_counts <- comm_edges_all %>%\n  filter(type == \"sent\") %>%\n  count(from_id, name = \"sent\")\n\nreceived_counts <- comm_edges_all %>%\n  filter(type == \"received\") %>%\n  count(to_id, name = \"received\")\n\n# Step 2: Combine counts\ncomm_summary <- full_join(sent_counts, received_counts, by = c(\"from_id\" = \"to_id\")) %>%\n  rename(id = from_id) %>%\n  replace_na(list(sent = 0, received = 0)) %>%\n  left_join(mc3_nodes_cleaned %>% select(id, label, sub_type), by = \"id\")\n\n# Step 3: Reshape for plotly\ncomm_long <- comm_summary %>%\n  pivot_longer(cols = c(sent, received), names_to = \"direction\", values_to = \"count\")\n\n# Step 4: Plotly bar chart (interactive)\nplot_ly(\n  comm_long,\n  x = ~label,\n  y = ~count,\n  color = ~direction,\n  colors = c(\"sent\" = \"#2ca5ff\", \"received\" = \"#fb8072\"),\n  type = 'bar',\n  text = ~paste0(\"Entity: \", label, \"<br>Type: \", sub_type, \"<br>Count: \", count),\n  hoverinfo = 'text',\n  name = ~direction\n) %>%\n  layout(\n    title = \"Interactive Message Volume by Entity\",\n    barmode = 'group',\n    xaxis = list(title = \"Entity\", tickangle = -45),\n    yaxis = list(title = \"Message Count\")\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-350cb18560fd04b79a05\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-350cb18560fd04b79a05\">{\"x\":{\"visdat\":{\"7b438f028fe\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"7b438f028fe\",\"attrs\":{\"7b438f028fe\":{\"x\":{},\"y\":{},\"text\":{},\"hoverinfo\":\"text\",\"name\":{},\"color\":{},\"colors\":[\"#2ca5ff\",\"#fb8072\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Interactive Message Volume by Entity\",\"barmode\":\"group\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Entity\",\"tickangle\":-45,\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"Boss\",\"City Officials\",\"Clepper Jensen\",\"Davis\",\"Defender\",\"EcoVigil\",\"Elise\",\"Glitters Team\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Marlin\",\"Miranda Jordan\",\"Mrs. Money\",\"Nadia Conti\",\"Neptune\",\"Northern Light\",\"Oceanus City Council\",\"Osprey\",\"Paackland Harbor\",\"Port Security\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sam\",\"Samantha Blake\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Message Count\"},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[\"Boss\",\"Clepper Jensen\",\"Davis\",\"Defender\",\"EcoVigil\",\"Elise\",\"Glitters Team\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Marlin\",\"Miranda Jordan\",\"Mrs. Money\",\"Nadia Conti\",\"Neptune\",\"Northern Light\",\"Oceanus City Council\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sam\",\"Samantha Blake\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"City Officials\",\"Port Security\"],\"y\":[21,18,18,2,15,6,0,27,2,18,22,1,1,16,58,8,20,24,18,26,4,45,3,16,28,37,6,8,10,7,12,23,8,0,3,18,8,7,18,1,1],\"text\":[\"Entity: Boss<br>Type: Person<br>Count: 21\",\"Entity: Clepper Jensen<br>Type: Person<br>Count: 18\",\"Entity: Davis<br>Type: Person<br>Count: 18\",\"Entity: Defender<br>Type: Vessel<br>Count: 2\",\"Entity: EcoVigil<br>Type: Vessel<br>Count: 15\",\"Entity: Elise<br>Type: Person<br>Count: 6\",\"Entity: Glitters Team<br>Type: Organization<br>Count: 0\",\"Entity: Green Guardians<br>Type: Organization<br>Count: 27\",\"Entity: Haacklee Harbor<br>Type: Location<br>Count: 2\",\"Entity: Himark Harbor<br>Type: Location<br>Count: 18\",\"Entity: Horizon<br>Type: Vessel<br>Count: 22\",\"Entity: Kelly<br>Type: Person<br>Count: 1\",\"Entity: Knowles<br>Type: Vessel<br>Count: 1\",\"Entity: Liam Thorne<br>Type: Person<br>Count: 16\",\"Entity: Mako<br>Type: Vessel<br>Count: 58\",\"Entity: Marlin<br>Type: Vessel<br>Count: 8\",\"Entity: Miranda Jordan<br>Type: Person<br>Count: 20\",\"Entity: Mrs. Money<br>Type: Person<br>Count: 24\",\"Entity: Nadia Conti<br>Type: Person<br>Count: 18\",\"Entity: Neptune<br>Type: Vessel<br>Count: 26\",\"Entity: Northern Light<br>Type: Vessel<br>Count: 4\",\"Entity: Oceanus City Council<br>Type: Organization<br>Count: 45\",\"Entity: Osprey<br>Type: Vessel<br>Count: 3\",\"Entity: Paackland Harbor<br>Type: Location<br>Count: 16\",\"Entity: Reef Guardian<br>Type: Vessel<br>Count: 28\",\"Entity: Remora<br>Type: Vessel<br>Count: 37\",\"Entity: Rodriguez<br>Type: Person<br>Count: 6\",\"Entity: Sailor Shifts Team<br>Type: Organization<br>Count: 8\",\"Entity: Sam<br>Type: Person<br>Count: 10\",\"Entity: Samantha Blake<br>Type: Person<br>Count: 7\",\"Entity: Seawatch<br>Type: Vessel<br>Count: 12\",\"Entity: Sentinel<br>Type: Vessel<br>Count: 23\",\"Entity: Serenity<br>Type: Vessel<br>Count: 8\",\"Entity: Small Fry<br>Type: Person<br>Count: 0\",\"Entity: The Accountant<br>Type: Person<br>Count: 3\",\"Entity: The Intern<br>Type: Person<br>Count: 18\",\"Entity: The Lookout<br>Type: Person<br>Count: 8\",\"Entity: The Middleman<br>Type: Person<br>Count: 7\",\"Entity: V. Miesel Shipping<br>Type: Organization<br>Count: 18\",\"Entity: City Officials<br>Type: Group<br>Count: 1\",\"Entity: Port Security<br>Type: Location<br>Count: 1\"],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"name\":\"received\",\"type\":\"bar\",\"marker\":{\"color\":\"rgba(251,128,114,1)\",\"line\":{\"color\":\"rgba(251,128,114,1)\"}},\"textfont\":{\"color\":\"rgba(251,128,114,1)\"},\"error_y\":{\"color\":\"rgba(251,128,114,1)\"},\"error_x\":{\"color\":\"rgba(251,128,114,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"Boss\",\"Clepper Jensen\",\"Davis\",\"Defender\",\"EcoVigil\",\"Elise\",\"Glitters Team\",\"Green Guardians\",\"Haacklee Harbor\",\"Himark Harbor\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Marlin\",\"Miranda Jordan\",\"Mrs. Money\",\"Nadia Conti\",\"Neptune\",\"Northern Light\",\"Oceanus City Council\",\"Osprey\",\"Paackland Harbor\",\"Reef Guardian\",\"Remora\",\"Rodriguez\",\"Sailor Shifts Team\",\"Sam\",\"Samantha Blake\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Intern\",\"The Lookout\",\"The Middleman\",\"V. Miesel Shipping\",\"City Officials\",\"Port Security\"],\"y\":[9,20,25,5,14,5,4,44,7,27,14,2,4,11,35,7,18,19,8,34,4,37,6,16,34,25,14,2,1,9,3,18,8,7,3,24,33,13,15,0,0],\"text\":[\"Entity: Boss<br>Type: Person<br>Count: 9\",\"Entity: Clepper Jensen<br>Type: Person<br>Count: 20\",\"Entity: Davis<br>Type: Person<br>Count: 25\",\"Entity: Defender<br>Type: Vessel<br>Count: 5\",\"Entity: EcoVigil<br>Type: Vessel<br>Count: 14\",\"Entity: Elise<br>Type: Person<br>Count: 5\",\"Entity: Glitters Team<br>Type: Organization<br>Count: 4\",\"Entity: Green Guardians<br>Type: Organization<br>Count: 44\",\"Entity: Haacklee Harbor<br>Type: Location<br>Count: 7\",\"Entity: Himark Harbor<br>Type: Location<br>Count: 27\",\"Entity: Horizon<br>Type: Vessel<br>Count: 14\",\"Entity: Kelly<br>Type: Person<br>Count: 2\",\"Entity: Knowles<br>Type: Vessel<br>Count: 4\",\"Entity: Liam Thorne<br>Type: Person<br>Count: 11\",\"Entity: Mako<br>Type: Vessel<br>Count: 35\",\"Entity: Marlin<br>Type: Vessel<br>Count: 7\",\"Entity: Miranda Jordan<br>Type: Person<br>Count: 18\",\"Entity: Mrs. Money<br>Type: Person<br>Count: 19\",\"Entity: Nadia Conti<br>Type: Person<br>Count: 8\",\"Entity: Neptune<br>Type: Vessel<br>Count: 34\",\"Entity: Northern Light<br>Type: Vessel<br>Count: 4\",\"Entity: Oceanus City Council<br>Type: Organization<br>Count: 37\",\"Entity: Osprey<br>Type: Vessel<br>Count: 6\",\"Entity: Paackland Harbor<br>Type: Location<br>Count: 16\",\"Entity: Reef Guardian<br>Type: Vessel<br>Count: 34\",\"Entity: Remora<br>Type: Vessel<br>Count: 25\",\"Entity: Rodriguez<br>Type: Person<br>Count: 14\",\"Entity: Sailor Shifts Team<br>Type: Organization<br>Count: 2\",\"Entity: Sam<br>Type: Person<br>Count: 1\",\"Entity: Samantha Blake<br>Type: Person<br>Count: 9\",\"Entity: Seawatch<br>Type: Vessel<br>Count: 3\",\"Entity: Sentinel<br>Type: Vessel<br>Count: 18\",\"Entity: Serenity<br>Type: Vessel<br>Count: 8\",\"Entity: Small Fry<br>Type: Person<br>Count: 7\",\"Entity: The Accountant<br>Type: Person<br>Count: 3\",\"Entity: The Intern<br>Type: Person<br>Count: 24\",\"Entity: The Lookout<br>Type: Person<br>Count: 33\",\"Entity: The Middleman<br>Type: Person<br>Count: 13\",\"Entity: V. Miesel Shipping<br>Type: Organization<br>Count: 15\",\"Entity: City Officials<br>Type: Group<br>Count: 0\",\"Entity: Port Security<br>Type: Location<br>Count: 0\"],\"hoverinfo\":[\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\",\"text\"],\"name\":\"sent\",\"type\":\"bar\",\"marker\":{\"color\":\"rgba(44,165,255,1)\",\"line\":{\"color\":\"rgba(44,165,255,1)\"}},\"textfont\":{\"color\":\"rgba(44,165,255,1)\"},\"error_y\":{\"color\":\"rgba(44,165,255,1)\"},\"error_x\":{\"color\":\"rgba(44,165,255,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\ndatatable(\n  comm_summary %>% arrange(desc(sent + received)),\n  options = list(\n    pageLength = 10,\n    autoWidth = TRUE,\n    searchHighlight = TRUE\n  ),\n  colnames = c(\"ID\", \"Name\", \"Sent\", \"Received\", \"Type\")\n)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-ce99c6bed70d4f3fdc55\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ce99c6bed70d4f3fdc55\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\"],[\"Mako\",\"Oceanus City Council\",\"Green Guardians\",\"Reef Guardian\",\"Remora\",\"Neptune\",\"Himark Harbor\",\"Davis\",\"Mrs. Money\",\"The Intern\",\"Sentinel\",\"The Lookout\",\"Clepper Jensen\",\"Miranda Jordan\",\"Horizon\",\"V. Miesel Shipping\",\"Paackland Harbor\",\"Boss\",\"EcoVigil\",\"Liam Thorne\",\"Nadia Conti\",\"Rodriguez\",\"The Middleman\",\"Samantha Blake\",\"Serenity\",\"Marlin\",\"Seawatch\",\"Elise\",\"Sam\",\"Sailor Shifts Team\",\"Haacklee Harbor\",\"Osprey\",\"Northern Light\",\"Defender\",\"Small Fry\",\"The Accountant\",\"Knowles\",\"Glitters Team\",\"Kelly\",\"City Officials\",\"Port Security\"],[35,37,44,34,25,34,27,25,19,24,18,33,20,18,14,15,16,9,14,11,8,14,13,9,8,7,3,5,1,2,7,6,4,5,7,3,4,4,2,0,0],[58,45,27,28,37,26,18,18,24,18,23,8,18,20,22,18,16,21,15,16,18,6,7,7,8,8,12,6,10,8,2,3,4,2,0,3,1,0,1,1,1],[\"Mako\",\"Oceanus City Council\",\"Green Guardians\",\"Reef Guardian\",\"Remora\",\"Neptune\",\"Himark Harbor\",\"Davis\",\"Mrs. Money\",\"The Intern\",\"Sentinel\",\"The Lookout\",\"Clepper Jensen\",\"Miranda Jordan\",\"Horizon\",\"V. Miesel Shipping\",\"Paackland Harbor\",\"Boss\",\"EcoVigil\",\"Liam Thorne\",\"Nadia Conti\",\"Rodriguez\",\"The Middleman\",\"Samantha Blake\",\"Serenity\",\"Marlin\",\"Seawatch\",\"Elise\",\"Sam\",\"Sailor Shifts Team\",\"Haacklee Harbor\",\"Osprey\",\"Northern Light\",\"Defender\",\"Small Fry\",\"The Accountant\",\"Knowles\",\"Glitters Team\",\"Kelly\",\"City Officials\",\"Port Security\"],[\"Vessel\",\"Organization\",\"Organization\",\"Vessel\",\"Vessel\",\"Vessel\",\"Location\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Organization\",\"Location\",\"Person\",\"Vessel\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Vessel\",\"Vessel\",\"Person\",\"Person\",\"Organization\",\"Location\",\"Vessel\",\"Vessel\",\"Vessel\",\"Person\",\"Person\",\"Vessel\",\"Organization\",\"Person\",\"Group\",\"Location\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>ID<\\/th>\\n      <th>Name<\\/th>\\n      <th>Sent<\\/th>\\n      <th>Received<\\/th>\\n      <th>Type<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"autoWidth\":true,\"searchHighlight\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,3]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"id\",\"targets\":1},{\"name\":\"sent\",\"targets\":2},{\"name\":\"received\",\"targets\":3},{\"name\":\"label\",\"targets\":4},{\"name\":\"sub_type\",\"targets\":5}],\"order\":[],\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n## **Strategy to Tackle Q2b**\n\n### Step 1: **Community Detection with Louvain**\n\n-   Use `igraph::cluster_louvain()` on the communication network built in 2a (undirected).\n-   Assign a `community` ID to each node (`nodes_vis$community`).\n\n### Step 2: **Inspect and Interpret Communities**\n\n-   Summarize the composition of each community by:\n\n    -   Number of persons/vessels\n    -   Top labels in each group\n    -   Known keywords (e.g., “Green Guardians”, “Sailor Shift”, vessel names like “Aurora” or “Bluefin”)\n\n### Step 3: **Color-code the Network by Community**\n\n-   Assign a distinct color to each detected community.\n-   Retain shape encoding (dot = Person, triangle = Vessel).\n\n### Step 4: **Interactive Visualization**\n\n-   Use `visNetwork` to display the full communication network:\n\n    -   Color nodes by `community`\n\n    -   Tooltip includes label, type, community\n\n    -   Legend for each detected community\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(igraph)\nlibrary(visNetwork)\nlibrary(RColorBrewer)\nlibrary(dplyr)\nlibrary(tibble)\n\n# Create igraph from person-vessel edges\ng_comm <- graph_from_data_frame(edges_vis, directed = FALSE, vertices = nodes_vis)\n\n# Louvain detection\nlouvain_clusters <- cluster_louvain(g_comm)\nnodes_vis$louvain_comm <- as.factor(membership(louvain_clusters))\n\n# Walktrap detection\nwalktrap_clusters <- cluster_walktrap(g_comm)\nnodes_vis$walktrap_comm <- as.factor(membership(walktrap_clusters))\n\n# Create color palettes\nmax_comm <- max(as.numeric(nodes_vis$louvain_comm), as.numeric(nodes_vis$walktrap_comm))\ncomm_colors <- brewer.pal(n = min(max_comm, 8), name = \"Set2\")\n\n# Assign community color for each method\nnodes_louvain <- nodes_vis %>%\n  mutate(\n    color = comm_colors[as.numeric(louvain_comm)],\n    title = paste0(label, \"<br>Type: \", sub_type, \"<br>Louvain: \", louvain_comm)\n  )\n\nnodes_walktrap <- nodes_vis %>%\n  mutate(\n    color = comm_colors[as.numeric(walktrap_comm)],\n    title = paste0(label, \"<br>Type: \", sub_type, \"<br>Walktrap: \", walktrap_comm)\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define consistent edge formatting\nedges_format <- edges_vis %>%\n  mutate(arrows = \"to\", width = width)\n\n# Louvain network\nlouvain_net <- visNetwork(nodes_louvain, edges_format, height = \"700px\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visPhysics(stabilization = TRUE) %>%\n  visLayout(randomSeed = 42) %>%\n  visNodes(shape = nodes_louvain$shape, size = nodes_louvain$size) %>%\n  visEdges(smooth = FALSE) %>%\n  visLegend(main = list(text = \"Louvain Communities\"), useGroups = FALSE)\n\n# Walktrap network\nwalktrap_net <- visNetwork(nodes_walktrap, edges_format, height = \"700px\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visPhysics(stabilization = TRUE) %>%\n  visLayout(randomSeed = 42) %>%\n  visNodes(shape = nodes_walktrap$shape, size = nodes_walktrap$size) %>%\n  visEdges(smooth = FALSE) %>%\n  visLegend(main = list(text = \"Walktrap Communities\"), useGroups = FALSE)\n```\n:::\n\n\n\n📌 **Louvain Community Network**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Generate cluster legend for Louvain\nlouvain_legend <- unique(nodes_louvain$louvain_comm) %>%\n  sort() %>%\n  purrr::map(function(comm_id) {\n    list(\n      label = paste(\"Cluster\", comm_id),\n      shape = \"dot\",\n      color = unique(nodes_louvain$color[nodes_louvain$louvain_comm == comm_id])[1]\n    )\n  })\n\n# Render Louvain network\ncat(\"## Louvain Community Detection Network\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n## Louvain Community Detection Network\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nvisNetwork(nodes_louvain, edges_format, width = \"100%\", height = \"750px\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visPhysics(\n    solver = \"forceAtlas2Based\",\n    forceAtlas2Based = list(\n      gravitationalConstant = -30,\n      centralGravity = 0.001,\n      springLength = 150,\n      springConstant = 0.03\n    ),\n    stabilization = list(enabled = TRUE, iterations = 200)\n  ) %>%\n  visLayout(randomSeed = 42, improvedLayout = TRUE) %>%\n  visNodes(shape = nodes_louvain$shape, size = nodes_louvain$size) %>%\n  visEdges(smooth = FALSE) %>%\n  visLegend(\n    useGroups = FALSE,\n    addNodes = louvain_legend,\n    position = \"left\",\n    width = 0.075,\n    stepY = 70,\n    ncol = 1\n  ) %>%\n  visInteraction(\n    dragNodes = TRUE,\n    navigationButtons = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-b8e9811b3f0b12bb41ae\" style=\"width:100%;height:750px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b8e9811b3f0b12bb41ae\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"sub_type\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\"],\"sent_count\":[1,2,5,4,5,3,16,9,20,18,23,30,3,18,12,8,7,24,4,6,26,24,11,1,11,13,6,5,18,3],\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15],\"title\":[\"Sam<br>Type: Person<br>Louvain: 1\",\"Kelly<br>Type: Person<br>Louvain: 1\",\"Nadia Conti<br>Type: Person<br>Louvain: 2\",\"Elise<br>Type: Person<br>Louvain: 3\",\"Liam Thorne<br>Type: Person<br>Louvain: 3\",\"Samantha Blake<br>Type: Person<br>Louvain: 2\",\"Davis<br>Type: Person<br>Louvain: 2\",\"Rodriguez<br>Type: Person<br>Louvain: 2\",\"Clepper Jensen<br>Type: Person<br>Louvain: 4\",\"Miranda Jordan<br>Type: Person<br>Louvain: 4\",\"The Intern<br>Type: Person<br>Louvain: 1\",\"The Lookout<br>Type: Person<br>Louvain: 1\",\"The Accountant<br>Type: Person<br>Louvain: 3\",\"Mrs. Money<br>Type: Person<br>Louvain: 3\",\"The Middleman<br>Type: Person<br>Louvain: 3\",\"Boss<br>Type: Person<br>Louvain: 3\",\"Small Fry<br>Type: Person<br>Louvain: 2\",\"Neptune<br>Type: Vessel<br>Louvain: 2\",\"Marlin<br>Type: Vessel<br>Louvain: 2\",\"Serenity<br>Type: Vessel<br>Louvain: 2\",\"Mako<br>Type: Vessel<br>Louvain: 2\",\"Reef Guardian<br>Type: Vessel<br>Louvain: 5\",\"Horizon<br>Type: Vessel<br>Louvain: 5\",\"Seawatch<br>Type: Vessel<br>Louvain: 5\",\"EcoVigil<br>Type: Vessel<br>Louvain: 5\",\"Sentinel<br>Type: Vessel<br>Louvain: 5\",\"Osprey<br>Type: Vessel<br>Louvain: 2\",\"Defender<br>Type: Vessel<br>Louvain: 5\",\"Remora<br>Type: Vessel<br>Louvain: 2\",\"Knowles<br>Type: Vessel<br>Louvain: 2\"],\"color\":[\"#66C2A5\",\"#66C2A5\",\"#FC8D62\",\"#8DA0CB\",\"#8DA0CB\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#E78AC3\",\"#E78AC3\",\"#66C2A5\",\"#66C2A5\",\"#8DA0CB\",\"#8DA0CB\",\"#8DA0CB\",\"#8DA0CB\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#FC8D62\",\"#A6D854\",\"#FC8D62\",\"#FC8D62\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"louvain_comm\":[\"1\",\"1\",\"2\",\"3\",\"3\",\"2\",\"2\",\"2\",\"4\",\"4\",\"1\",\"1\",\"3\",\"3\",\"3\",\"3\",\"2\",\"2\",\"2\",\"2\",\"2\",\"5\",\"5\",\"5\",\"5\",\"5\",\"2\",\"5\",\"2\",\"2\"],\"walktrap_comm\":[\"3\",\"3\",\"6\",\"6\",\"6\",\"1\",\"1\",\"1\",\"7\",\"7\",\"4\",\"4\",\"2\",\"2\",\"2\",\"2\",\"1\",\"1\",\"1\",\"1\",\"1\",\"5\",\"5\",\"5\",\"5\",\"5\",\"1\",\"5\",\"1\",\"1\"]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Remora\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Mrs. Money\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Mako\",\"Mrs. Money\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Horizon\",\"Mako\",\"Mako\",\"Reef Guardian\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"Boss\",\"Defender\",\"Elise\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"The Middleman\",\"The Middleman\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"Boss\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"Elise\",\"Horizon\",\"Horizon\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sam\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Lookout\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"The Intern\",\"Remora\",\"Mako\",\"The Lookout\",\"Sam\",\"Mako\",\"Boss\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Remora\",\"The Intern\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Sentinel\",\"Samantha Blake\",\"Sentinel\",\"EcoVigil\",\"Remora\",\"Sentinel\",\"Boss\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Horizon\",\"Marlin\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Boss\",\"Davis\",\"Mako\",\"Mrs. Money\",\"The Accountant\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Reef Guardian\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Defender\",\"Mako\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Mako\",\"Boss\",\"Neptune\",\"Mako\",\"Seawatch\",\"Liam Thorne\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Remora\",\"Marlin\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Neptune\",\"Davis\",\"Nadia Conti\",\"Rodriguez\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Reef Guardian\",\"Nadia Conti\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"Reef Guardian\"],\"value\":[20,18,15,12,9,9,8,8,7,6,6,6,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15]},\"manipulation\":{\"enabled\":false},\"physics\":{\"solver\":\"forceAtlas2Based\",\"stabilization\":{\"enabled\":true,\"iterations\":200},\"forceAtlas2Based\":{\"gravitationalConstant\":-30,\"centralGravity\":0.001,\"springLength\":150,\"springConstant\":0.03}},\"layout\":{\"randomSeed\":42,\"improvedLayout\":true},\"edges\":{\"smooth\":false},\"interaction\":{\"dragNodes\":true,\"navigationButtons\":true,\"zoomSpeed\":1}},\"groups\":null,\"width\":\"100%\",\"height\":\"750px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.075,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":70,\"zoom\":true,\"nodes\":[{\"label\":\"Cluster 1\",\"shape\":\"dot\",\"color\":\"#66C2A5\"},{\"label\":\"Cluster 2\",\"shape\":\"dot\",\"color\":\"#FC8D62\"},{\"label\":\"Cluster 3\",\"shape\":\"dot\",\"color\":\"#8DA0CB\"},{\"label\":\"Cluster 4\",\"shape\":\"dot\",\"color\":\"#E78AC3\"},{\"label\":\"Cluster 5\",\"shape\":\"dot\",\"color\":\"#A6D854\"}],\"nodesToDataframe\":false},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n📌 **Walktrap Community Network**\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Generate cluster legend for Walktrap\nwalktrap_legend <- unique(nodes_walktrap$walktrap_comm) %>%\n  sort() %>%\n  purrr::map(function(comm_id) {\n    list(\n      label = paste(\"Cluster\", comm_id),\n      shape = \"dot\",\n      color = unique(nodes_walktrap$color[nodes_walktrap$walktrap_comm == comm_id])[1]\n    )\n  })\n\n# Render Walktrap network\ncat(\"## Walktrap Community Detection Network\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n## Walktrap Community Detection Network\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"true\"}\nvisNetwork(nodes_walktrap, edges_format, width = \"100%\", height = \"750px\") %>%\n  visOptions(highlightNearest = TRUE, nodesIdSelection = TRUE) %>%\n  visPhysics(\n    solver = \"forceAtlas2Based\",\n    forceAtlas2Based = list(\n      gravitationalConstant = -30,\n      centralGravity = 0.001,\n      springLength = 150,\n      springConstant = 0.03\n    ),\n    stabilization = list(enabled = TRUE, iterations = 200)\n  ) %>%\n  visLayout(randomSeed = 42, improvedLayout = TRUE) %>%\n  visNodes(shape = nodes_walktrap$shape, size = nodes_walktrap$size) %>%\n  visEdges(smooth = FALSE) %>%\n  visLegend(\n    useGroups = FALSE,\n    addNodes = walktrap_legend,\n    position = \"left\",\n    width = 0.075,\n    stepY = 70,\n    ncol = 1\n  ) %>%\n  visInteraction(\n    dragNodes = TRUE,\n    navigationButtons = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"htmlwidget-5a4e90b711cd71049642\" style=\"width:100%;height:750px;\" class=\"visNetwork html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5a4e90b711cd71049642\">{\"x\":{\"nodes\":{\"id\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"label\":[\"Sam\",\"Kelly\",\"Nadia Conti\",\"Elise\",\"Liam Thorne\",\"Samantha Blake\",\"Davis\",\"Rodriguez\",\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"The Accountant\",\"Mrs. Money\",\"The Middleman\",\"Boss\",\"Small Fry\",\"Neptune\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Horizon\",\"Seawatch\",\"EcoVigil\",\"Sentinel\",\"Osprey\",\"Defender\",\"Remora\",\"Knowles\"],\"sub_type\":[\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Person\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\",\"Vessel\"],\"sent_count\":[1,2,5,4,5,3,16,9,20,18,23,30,3,18,12,8,7,24,4,6,26,24,11,1,11,13,6,5,18,3],\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15],\"title\":[\"Sam<br>Type: Person<br>Walktrap: 3\",\"Kelly<br>Type: Person<br>Walktrap: 3\",\"Nadia Conti<br>Type: Person<br>Walktrap: 6\",\"Elise<br>Type: Person<br>Walktrap: 6\",\"Liam Thorne<br>Type: Person<br>Walktrap: 6\",\"Samantha Blake<br>Type: Person<br>Walktrap: 1\",\"Davis<br>Type: Person<br>Walktrap: 1\",\"Rodriguez<br>Type: Person<br>Walktrap: 1\",\"Clepper Jensen<br>Type: Person<br>Walktrap: 7\",\"Miranda Jordan<br>Type: Person<br>Walktrap: 7\",\"The Intern<br>Type: Person<br>Walktrap: 4\",\"The Lookout<br>Type: Person<br>Walktrap: 4\",\"The Accountant<br>Type: Person<br>Walktrap: 2\",\"Mrs. Money<br>Type: Person<br>Walktrap: 2\",\"The Middleman<br>Type: Person<br>Walktrap: 2\",\"Boss<br>Type: Person<br>Walktrap: 2\",\"Small Fry<br>Type: Person<br>Walktrap: 1\",\"Neptune<br>Type: Vessel<br>Walktrap: 1\",\"Marlin<br>Type: Vessel<br>Walktrap: 1\",\"Serenity<br>Type: Vessel<br>Walktrap: 1\",\"Mako<br>Type: Vessel<br>Walktrap: 1\",\"Reef Guardian<br>Type: Vessel<br>Walktrap: 5\",\"Horizon<br>Type: Vessel<br>Walktrap: 5\",\"Seawatch<br>Type: Vessel<br>Walktrap: 5\",\"EcoVigil<br>Type: Vessel<br>Walktrap: 5\",\"Sentinel<br>Type: Vessel<br>Walktrap: 5\",\"Osprey<br>Type: Vessel<br>Walktrap: 1\",\"Defender<br>Type: Vessel<br>Walktrap: 5\",\"Remora<br>Type: Vessel<br>Walktrap: 1\",\"Knowles<br>Type: Vessel<br>Walktrap: 1\"],\"color\":[\"#8DA0CB\",\"#8DA0CB\",\"#FFD92F\",\"#FFD92F\",\"#FFD92F\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#E5C494\",\"#E5C494\",\"#E78AC3\",\"#E78AC3\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#FC8D62\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#66C2A5\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#A6D854\",\"#66C2A5\",\"#A6D854\",\"#66C2A5\",\"#66C2A5\"],\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"louvain_comm\":[\"1\",\"1\",\"2\",\"3\",\"3\",\"2\",\"2\",\"2\",\"4\",\"4\",\"1\",\"1\",\"3\",\"3\",\"3\",\"3\",\"2\",\"2\",\"2\",\"2\",\"2\",\"5\",\"5\",\"5\",\"5\",\"5\",\"2\",\"5\",\"2\",\"2\"],\"walktrap_comm\":[\"3\",\"3\",\"6\",\"6\",\"6\",\"1\",\"1\",\"1\",\"7\",\"7\",\"4\",\"4\",\"2\",\"2\",\"2\",\"2\",\"1\",\"1\",\"1\",\"1\",\"1\",\"5\",\"5\",\"5\",\"5\",\"5\",\"1\",\"5\",\"1\",\"1\"]},\"edges\":{\"from\":[\"Clepper Jensen\",\"Miranda Jordan\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Remora\",\"The Intern\",\"The Lookout\",\"Neptune\",\"Mrs. Money\",\"Osprey\",\"Remora\",\"Davis\",\"Davis\",\"EcoVigil\",\"Mako\",\"Mrs. Money\",\"Sentinel\",\"Sentinel\",\"The Lookout\",\"Boss\",\"Davis\",\"Horizon\",\"Mako\",\"Mako\",\"Reef Guardian\",\"Small Fry\",\"The Lookout\",\"The Middleman\",\"Boss\",\"Defender\",\"Elise\",\"Horizon\",\"Mako\",\"Mrs. Money\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Reef Guardian\",\"Rodriguez\",\"Rodriguez\",\"Samantha Blake\",\"The Middleman\",\"The Middleman\",\"EcoVigil\",\"EcoVigil\",\"EcoVigil\",\"Horizon\",\"Kelly\",\"Knowles\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Mrs. Money\",\"Nadia Conti\",\"Nadia Conti\",\"Neptune\",\"Reef Guardian\",\"Reef Guardian\",\"Serenity\",\"Serenity\",\"Serenity\",\"Small Fry\",\"The Accountant\",\"The Middleman\",\"Boss\",\"Davis\",\"Davis\",\"Defender\",\"Defender\",\"Elise\",\"Horizon\",\"Horizon\",\"Knowles\",\"Liam Thorne\",\"Liam Thorne\",\"Liam Thorne\",\"Mako\",\"Mako\",\"Mako\",\"Mako\",\"Marlin\",\"Marlin\",\"Mrs. Money\",\"Mrs. Money\",\"Nadia Conti\",\"Neptune\",\"Neptune\",\"Neptune\",\"Reef Guardian\",\"Remora\",\"Remora\",\"Remora\",\"Rodriguez\",\"Rodriguez\",\"Rodriguez\",\"Sam\",\"Seawatch\",\"Sentinel\",\"Sentinel\",\"Sentinel\",\"Small Fry\",\"The Accountant\",\"The Lookout\"],\"to\":[\"Miranda Jordan\",\"Clepper Jensen\",\"Mrs. Money\",\"The Intern\",\"Remora\",\"Mako\",\"The Lookout\",\"Sam\",\"Mako\",\"Boss\",\"Mako\",\"Neptune\",\"Mako\",\"Nadia Conti\",\"Horizon\",\"Remora\",\"The Intern\",\"Horizon\",\"Mako\",\"Horizon\",\"Mrs. Money\",\"Remora\",\"Sentinel\",\"Samantha Blake\",\"Sentinel\",\"EcoVigil\",\"Remora\",\"Sentinel\",\"Boss\",\"The Middleman\",\"Reef Guardian\",\"Nadia Conti\",\"EcoVigil\",\"Neptune\",\"The Middleman\",\"Elise\",\"Horizon\",\"Marlin\",\"Seawatch\",\"Sentinel\",\"Serenity\",\"Boss\",\"Davis\",\"Mako\",\"Mrs. Money\",\"The Accountant\",\"Liam Thorne\",\"Reef Guardian\",\"Sentinel\",\"Seawatch\",\"Sam\",\"Davis\",\"Nadia Conti\",\"Boss\",\"Osprey\",\"Reef Guardian\",\"Remora\",\"Neptune\",\"Liam Thorne\",\"Neptune\",\"Davis\",\"Defender\",\"Mako\",\"Mako\",\"Neptune\",\"Reef Guardian\",\"Davis\",\"Boss\",\"Liam Thorne\",\"Mako\",\"Boss\",\"Neptune\",\"Mako\",\"Seawatch\",\"Liam Thorne\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Boss\",\"EcoVigil\",\"Elise\",\"Davis\",\"Elise\",\"Marlin\",\"Serenity\",\"Mako\",\"Reef Guardian\",\"Mako\",\"Remora\",\"Marlin\",\"Nadia Conti\",\"Reef Guardian\",\"Serenity\",\"Neptune\",\"Davis\",\"Nadia Conti\",\"Rodriguez\",\"Mrs. Money\",\"Nadia Conti\",\"Remora\",\"Kelly\",\"Reef Guardian\",\"Nadia Conti\",\"Reef Guardian\",\"Seawatch\",\"Mako\",\"The Middleman\",\"Reef Guardian\"],\"value\":[20,18,15,12,9,9,8,8,7,6,6,6,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"arrows\":[\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\",\"to\"],\"width\":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],\"title\":[\"Messages: 20\",\"Messages: 18\",\"Messages: 15\",\"Messages: 12\",\"Messages: 9\",\"Messages: 9\",\"Messages: 8\",\"Messages: 8\",\"Messages: 7\",\"Messages: 6\",\"Messages: 6\",\"Messages: 6\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 5\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 4\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 3\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 2\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\",\"Messages: 1\"]},\"nodesToDataframe\":true,\"edgesToDataframe\":true,\"options\":{\"width\":\"100%\",\"height\":\"100%\",\"nodes\":{\"shape\":[\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"dot\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\",\"triangle\"],\"size\":[10,11.03448275862069,14.13793103448276,13.10344827586207,14.13793103448276,12.06896551724138,25.51724137931035,18.27586206896552,29.6551724137931,27.58620689655172,32.75862068965517,40,12.06896551724138,27.58620689655172,21.37931034482759,17.24137931034483,16.20689655172414,15,15,15,15,15,15,15,15,15,15,15,15,15]},\"manipulation\":{\"enabled\":false},\"physics\":{\"solver\":\"forceAtlas2Based\",\"stabilization\":{\"enabled\":true,\"iterations\":200},\"forceAtlas2Based\":{\"gravitationalConstant\":-30,\"centralGravity\":0.001,\"springLength\":150,\"springConstant\":0.03}},\"layout\":{\"randomSeed\":42,\"improvedLayout\":true},\"edges\":{\"smooth\":false},\"interaction\":{\"dragNodes\":true,\"navigationButtons\":true,\"zoomSpeed\":1}},\"groups\":null,\"width\":\"100%\",\"height\":\"750px\",\"idselection\":{\"enabled\":true,\"style\":\"width: 150px; height: 26px\",\"useLabels\":true,\"main\":\"Select by id\"},\"byselection\":{\"enabled\":false,\"style\":\"width: 150px; height: 26px\",\"multiple\":false,\"hideColor\":\"rgba(200,200,200,0.5)\",\"highlight\":false},\"main\":null,\"submain\":null,\"footer\":null,\"background\":\"rgba(0, 0, 0, 0)\",\"highlight\":{\"enabled\":true,\"hoverNearest\":false,\"degree\":1,\"algorithm\":\"all\",\"hideColor\":\"rgba(200,200,200,0.5)\",\"labelOnly\":true},\"collapse\":{\"enabled\":false,\"fit\":false,\"resetHighlight\":true,\"clusterOptions\":null,\"keepCoord\":true,\"labelSuffix\":\"(cluster)\"},\"legend\":{\"width\":0.075,\"useGroups\":false,\"position\":\"left\",\"ncol\":1,\"stepX\":100,\"stepY\":70,\"zoom\":true,\"nodes\":[{\"label\":\"Cluster 1\",\"shape\":\"dot\",\"color\":\"#66C2A5\"},{\"label\":\"Cluster 2\",\"shape\":\"dot\",\"color\":\"#FC8D62\"},{\"label\":\"Cluster 3\",\"shape\":\"dot\",\"color\":\"#8DA0CB\"},{\"label\":\"Cluster 4\",\"shape\":\"dot\",\"color\":\"#E78AC3\"},{\"label\":\"Cluster 5\",\"shape\":\"dot\",\"color\":\"#A6D854\"},{\"label\":\"Cluster 6\",\"shape\":\"dot\",\"color\":\"#FFD92F\"},{\"label\":\"Cluster 7\",\"shape\":\"dot\",\"color\":\"#E5C494\"}],\"nodesToDataframe\":false},\"tooltipStay\":300,\"tooltipStyle\":\"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [
      "Take-Home_Ex02_MC3---Q2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/vis-9.1.0/vis-network.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/vis-9.1.0/vis-network.min.js\"></script>\n<script src=\"../../site_libs/visNetwork-binding-2.1.2/visNetwork.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n<link href=\"../../site_libs/dt-plugin-searchhighlight-1.13.6/source.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/dt-plugin-searchhighlight-1.13.6/jquery.highlight.js\"></script>\n<script src=\"../../site_libs/dt-plugin-searchhighlight-1.13.6/source.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}