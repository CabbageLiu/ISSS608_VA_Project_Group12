<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Enrico Sebastian">
<meta name="dcterms.date" content="2025-04-29">

<title>Take-Home Exercise 3 – ISSS608 Visual Analytics Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608 Visual Analytics Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-menu" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Menu</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-menu">    
        <li>
    <a class="dropdown-item" href="../../project_proposal/proposal_DC.html">
 <span class="dropdown-text">Project Proposal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/TestQuarto_David.html">
 <span class="dropdown-text">Test</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../TH3/Take-Home_Ex02_MC3.html">
 <span class="dropdown-text">Test2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/adrian_test_q4/testing_q4.html">
 <span class="dropdown-text">Adrian Task 4a &amp; 4b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/Rico_q3/Take Home Exercise 3.html">
 <span class="dropdown-text">Rico Task 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Test_Folder/David_Q2/Take-Home_Ex02_MC3 - Q2.html">
 <span class="dropdown-text">David Task 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../main_project_qmd/main_project_qmd/main.html">
 <span class="dropdown-text">Report Draft (Main)</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#shiny-project-a-visual-analysis-of-oceanus" id="toc-shiny-project-a-visual-analysis-of-oceanus" class="nav-link active" data-scroll-target="#shiny-project-a-visual-analysis-of-oceanus">SHINY project: A Visual Analysis of Oceanus</a>
  <ul class="collapse">
  <li><a href="#motivation-of-this-project" id="toc-motivation-of-this-project" class="nav-link" data-scroll-target="#motivation-of-this-project">1. Motivation of this project</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">2. Data Preparation</a>
  <ul class="collapse">
  <li><a href="#getting-the-required-r-packages" id="toc-getting-the-required-r-packages" class="nav-link" data-scroll-target="#getting-the-required-r-packages">2.1 Getting the required R packages</a></li>
  <li><a href="#reading-the-data" id="toc-reading-the-data" class="nav-link" data-scroll-target="#reading-the-data">2.2 Reading the data</a></li>
  <li><a href="#data-cleaning-and-wrangling" id="toc-data-cleaning-and-wrangling" class="nav-link" data-scroll-target="#data-cleaning-and-wrangling">2.3 Data cleaning and wrangling</a></li>
  <li><a href="#answering-question-3" id="toc-answering-question-3" class="nav-link" data-scroll-target="#answering-question-3">2.4 Answering question 3</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-Home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Enrico Sebastian </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 29, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 20, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="shiny-project-a-visual-analysis-of-oceanus" class="level1">
<h1>SHINY project: A Visual Analysis of Oceanus</h1>
<p><img src="images/fish.jpg" class="img-fluid"></p>
<p>In this part of the Take home Exercise, I will be impplementing the possible prototype that I will be using as part of our <a href="https://isss608projectgroup12.netlify.app/">group’s SHINY project</a>.</p>
<section id="motivation-of-this-project" class="level2">
<h2 class="anchored" data-anchor-id="motivation-of-this-project">1. Motivation of this project</h2>
<p>The Oceanus knowledge graph reveals complex interactions among vessels, individuals, organizations, and locations in a region suspected of illegal activities, particularly around Nemo Reef. With numerous monitoring, communication, and suspicious activity records, this dataset presents an opportunity to uncover hidden patterns of behavior, influence networks, and potential illicit operations. The goal is to leverage interactive visual analytics to support investigative journalism, policy enforcement, and regulatory audits, especially regarding unauthorized vessel activities and environmental violations.</p>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">2. Data Preparation</h2>
<section id="getting-the-required-r-packages" class="level3">
<h3 class="anchored" data-anchor-id="getting-the-required-r-packages">2.1 Getting the required R packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               tidygraph, ggraph, SmartEDA, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               ggrepel, scales, lubridate, dplyr, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               visNetwork, viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reading-the-data" class="level3">
<h3 class="anchored" data-anchor-id="reading-the-data">2.2 Reading the data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_graph.json"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_schema.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>nodes)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning-and-wrangling">2.3 Data cleaning and wrangling</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># To rename source and target fields</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source, </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># To create mapping of fields</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Concert from_id to to_id</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to)) </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset nodes to those only used by edges</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, </span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>           mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Rebuild from old index to old index</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    used_node_indices))</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Update edge indices to node</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>         is_inferred, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="answering-question-3" class="level3">
<h3 class="anchored" data-anchor-id="answering-question-3">2.4 Answering question 3</h3>
<section id="cleaning-the-dataset" class="level4">
<h4 class="anchored" data-anchor-id="cleaning-the-dataset">2.4.1 Cleaning the dataset</h4>
<p>The code below is to help us to further clean the data first before we can start to answer question 3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Define pseudonyms</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pseudonym_keywords <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Boss"</span>, <span class="st">"The Lookout"</span>, <span class="st">"The Intern"</span>, <span class="st">"Mrs. Money"</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"The Accountant"</span>, <span class="st">"The Middleman"</span>, <span class="st">"Small Fry"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Filter pseudonym nodes (from mc3_nodes_final)</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>pseudonym_nodes <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    sub_type <span class="sc">==</span> <span class="st">"Person"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_detect</span>(name, <span class="fu">regex</span>(<span class="fu">paste</span>(pseudonym_keywords, <span class="at">collapse =</span> <span class="st">"|"</span>), <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Get all edge rows where from/to match pseudonym node indices</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>pseudonym_node_indices <span class="ot">&lt;-</span> pseudonym_nodes<span class="sc">$</span>new_index</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>pseudonym_edges_final <span class="ot">&lt;-</span> mc3_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from <span class="sc">%in%</span> pseudonym_node_indices <span class="sc">|</span> to <span class="sc">%in%</span> pseudonym_node_indices)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Get only nodes that are involved in these edges</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(pseudonym_edges_final<span class="sc">$</span>from, pseudonym_edges_final<span class="sc">$</span>to))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>pseudonym_nodes_final <span class="ot">&lt;-</span> mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(new_index <span class="sc">%in%</span> used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label_type =</span> <span class="fu">ifelse</span>(new_index <span class="sc">%in%</span> pseudonym_node_indices, <span class="st">"Pseudonym"</span>, <span class="st">"Regular"</span>))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Reindex nodes to match edge structure (0-based problem fix)</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>pseudonym_nodes_final <span class="ot">&lt;-</span> pseudonym_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Mapping old new_index to new temp_index (for tbl_graph alignment)</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>index_map <span class="ot">&lt;-</span> pseudonym_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">old =</span> new_index, <span class="at">new =</span> temp_index)</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Update edges to new 1-based index</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>pseudonym_edges_final <span class="ot">&lt;-</span> pseudonym_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(index_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(index_map, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new) <span class="sc">%&gt;%</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_new), <span class="sc">!</span><span class="fu">is.na</span>(to_new)) <span class="sc">%&gt;%</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, type)</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Build graph</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>pseudonym_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> pseudonym_nodes_final,</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> pseudonym_edges_final,</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before we start to answer the questions, let us first test out if the data cleaning is effective, which should be if not you wil not be able to see this!</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Test code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Test</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(pseudonym_graph, <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> label_type), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Pseudonym Communication Network"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Highlighting entities and their use of pseudonyms"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Entity Type"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home-Exercise-3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-3a" class="level4">
<h4 class="anchored" data-anchor-id="question-3a">2.4.2 Question 3a</h4>
<p>The visualisations below shows the entities labelled based on their real names or pseudinyms which are labelled differently using color codes so as for easier visualisation.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Method 1</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Method 2</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count how many connections each pseudonym has</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pseudonym_links <span class="ot">&lt;-</span> pseudonym_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(pseudonym_nodes_final, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"temp_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">pseudonym =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(pseudonym)) <span class="sc">%&gt;%</span>   <span class="co"># ✅ Only valid pseudonym nodes</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pseudonym) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">connection_count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(connection_count))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot it</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pseudonym_links, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(pseudonym, connection_count), <span class="at">y =</span> connection_count)) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"tomato"</span>) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Communication Frequency by Pseudonym"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Pseudonym Name"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Connections"</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home-Exercise-3_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare node dataframe</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> pseudonym_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> temp_index,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> name,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">ifelse</span>(label_type <span class="sc">==</span> <span class="st">"Pseudonym"</span>, <span class="st">"Pseudonym"</span>, <span class="st">"Regular"</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Name:"</span>, name, <span class="st">"&lt;br&gt;Type:"</span>, label_type)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare edge dataframe</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> pseudonym_edges_final <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> from,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> to,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> type,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visNetwork</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis, <span class="at">height =</span> <span class="st">"600px"</span>, <span class="at">width =</span> <span class="st">"100%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Pseudonym"</span>, <span class="at">color =</span> <span class="st">"tomato"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Regular"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(<span class="at">addNodes =</span> <span class="fu">list</span>(</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Pseudonym"</span>, <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">color =</span> <span class="st">"tomato"</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Regular"</span>, <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">42</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">stabilization =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-231e35bb8cb59250af42" style="width:100%;height:600px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-231e35bb8cb59250af42">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184],"label":["The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"group":["Pseudonym","Pseudonym","Pseudonym","Pseudonym","Pseudonym","Pseudonym","Pseudonym","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular","Regular"],"title":["Name: The Intern <br>Type: Pseudonym","Name: The Lookout <br>Type: Pseudonym","Name: The Accountant <br>Type: Pseudonym","Name: Mrs. Money <br>Type: Pseudonym","Name: The Middleman <br>Type: Pseudonym","Name: Boss <br>Type: Pseudonym","Name: Small Fry <br>Type: Pseudonym","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular","Name: NA <br>Type: Regular"]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28,29,30,31,33,37,38,39,40,41,44,46,47,48,49,50,51,52,53,54,57,59,60,61,62,63,65,66,67,68,69,70,71,73,74,79,80,82,85,86,88,90,91,94,95,97,98,99,100,102,103,104,105,108,113,115,116,117,119,120,121,123,124,125,126,127,129,142,162,164,166,167,168,169],"to":[14,15,28,162,31,147,38,40,46,60,68,73,169,74,80,86,88,134,91,161,183,94,135,11,95,98,142,100,136,178,113,115,119,121,153,124,143,8,13,27,32,37,42,43,45,55,59,182,67,72,9,132,79,83,163,84,85,10,89,90,92,93,96,97,99,137,106,107,12,139,109,112,114,118,120,122,123,125,131,143,153,102,171,116,184,155,127,150,154,144,16,18,24,29,30,33,39,41,47,49,174,158,149,54,176,64,66,69,75,133,177,76,81,87,161,183,136,178,103,147,20,22,145,25,26,35,50,140,52,53,78,101,170,164,108,117,126,155,149,17,19,21,23,157,48,140,51,173,56,58,181,175,63,180,152,148,154,144,145,151,34,138,36,141,159,160,77,179,110,165,111,128,172,130,156,151,146,1,2,4,6,4,6,5,6,5,6,4,5,4,4,4,1,1,2,6,1,4,1,4,5,6,4,6,4,5,6,5,4,6,6,6,1,4,6,6,4,4,1,1,4,6,6,6,2,4,1,4,4,1,4,4,1,2,1,4,1,2,1,4,6,1,6,6,3,2,4,6,3,2,1,4,1,2,1,3,5,6,2,4,6,6,7,6,4],"label":["sent","sent","sent",null,"sent",null,"sent","sent","sent","sent","sent","sent",null,"sent","sent","sent","sent",null,"sent",null,null,"sent",null,null,"sent","sent",null,"sent",null,null,"sent","sent","sent","sent",null,"sent",null,null,"sent","sent","sent","sent","sent","sent","sent","sent","sent",null,"sent","sent",null,null,"sent","sent",null,"sent","sent",null,"sent","sent","sent","sent","sent","sent","sent",null,"sent","sent",null,null,"sent","sent","sent","sent","sent","sent","sent","sent","sent",null,null,"sent",null,"sent",null,null,"sent",null,null,null,"sent","sent","sent","sent","sent","sent","sent","sent","sent","sent",null,null,null,"sent",null,"sent","sent","sent","sent",null,null,"sent","sent","sent",null,null,null,null,"sent",null,"sent","sent",null,"sent","sent","sent","sent",null,"sent","sent","sent","sent",null,null,"sent","sent","sent",null,null,"sent","sent","sent","sent",null,"sent",null,"sent",null,"sent","sent",null,null,"sent",null,null,null,null,null,null,null,"sent",null,"sent",null,null,null,"sent",null,"sent",null,"sent","sent",null,"sent",null,null,null,"received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received","received",null,null,null,null,null,null,null],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"groups":{"Pseudonym":{"color":"tomato"},"useDefaultGroups":true,"Regular":{"color":"steelblue"}},"layout":{"randomSeed":42},"physics":{"stabilization":true}},"groups":["Pseudonym","Regular"],"width":"100%","height":"600px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":[{"label":"Pseudonym","shape":"dot","color":"tomato"},{"label":"Regular","shape":"dot","color":"steelblue"}],"nodesToDataframe":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>As we can see, there are 2 methods that we can use to visualise this case. The aim of this visualisation is to help clepper to visually identufy which nodes are pseudonuyms, and how are they connected to the real identity. Suspicious names or aliases will appear isolated</p>
<div class="callout callout-style-default callout-note callout-titled" title="What can we learn from the observations above?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What can we learn from the observations above?
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>From this visualisation, we can easily determine which names are Pseudonyms. These names can be easily identified via the color codes</p></li>
<li><p>We can easily trace who talks to and/or through aliases</p></li>
<li><p>This visualisation makes it easier for Clepper to spot suspicious names</p></li>
</ul>
</div>
</div>
</section>
<section id="question-3b" class="level4">
<h4 class="anchored" data-anchor-id="question-3b">2.4.3 Question 3b</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Visualisation output</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Q3b: Extract edges involving those pseudonyms</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Build pseudonym network using tidygraph</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>pseudonym_graph_tbl <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> pseudonym_nodes_final,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> pseudonym_edges_final,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree_centrality =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">"all"</span>))  <span class="co"># centrality values added to nodes</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn into tibble for ggplot</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>top_central <span class="ot">&lt;-</span> pseudonym_graph_tbl <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label_type <span class="sc">==</span> <span class="st">"Pseudonym"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(degree_centrality)) <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_central, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(name, degree_centrality), <span class="at">y =</span> degree_centrality)) <span class="sc">+</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Top 10 Central Pseudonym Entities"</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Pseudonym Name"</span>,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Degree Centrality"</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-Home-Exercise-3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1920"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The visualisation shows a bar chart of degree centrality that shows the tiop 10 most connectd pseudonyms. The aim of this graph is to heko clepper to quantify influence by measuring the cetrakity of the pseudonyms for deeper investigation. It also helps Clepper t identify who are the key players who may be controlling the flow of information</p>
<div class="callout callout-style-default callout-note callout-titled" title="What can we learn from the above visualisation?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What can we learn from the above visualisation?
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>These visualisation helps Clepper to identify wich of the pseudonyms are most active</p></li>
<li><p>We can see that the nodes act as central hubs wihin the pseudonym network</p></li>
<li><p>This visualisation can help clepper to prioritize pseudionyms first as part of his investigations</p></li>
</ul>
</div>
</div>
</section>
<section id="question-3c" class="level4">
<h4 class="anchored" data-anchor-id="question-3c">2.4.4 Question 3c</h4>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Visualisation Output</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>shared_pseudonyms <span class="ot">&lt;-</span> pseudonym_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create nodes: both entities and pseudonyms</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>vis_nodes_3c <span class="ot">&lt;-</span> shared_pseudonyms <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">id =</span> id, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> id, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">group =</span> <span class="st">"Entity"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Entity ID:"</span>, id)) <span class="sc">%&gt;%</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    shared_pseudonyms <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="at">id =</span> name) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">label =</span> id,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">group =</span> <span class="st">"Pseudonym"</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Pseudonym:"</span>, id))</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>vis_edges_3c <span class="ot">&lt;-</span> shared_pseudonyms <span class="sc">%&gt;%</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">from =</span> id, <span class="at">to =</span> name)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(vis_nodes_3c, vis_edges_3c, <span class="at">height =</span> <span class="st">"600px"</span>, <span class="at">width =</span> <span class="st">"100%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Entity"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Pseudonym"</span>, <span class="at">color =</span> <span class="st">"tomato"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(<span class="at">addNodes =</span> <span class="fu">list</span>(</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Entity"</span>, <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>),</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">label =</span> <span class="st">"Pseudonym"</span>, <span class="at">shape =</span> <span class="st">"dot"</span>, <span class="at">color =</span> <span class="st">"tomato"</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output-display">
<div id="htmlwidget-38cc1d9eef477a7422c9" style="width:100%;height:600px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-38cc1d9eef477a7422c9">{"x":{"nodes":{"id":["Event_Monitoring_0","Event_Monitoring_444","Event_Monitoring_595","Event_Monitoring_704","Event_Monitoring_797","Event_Communication_1","Event_Communication_2","Event_Communication_5","Event_Communication_6","Event_Communication_7","Event_Communication_8","Event_Communication_9","Event_Communication_10","Event_Communication_11","Event_Communication_12","Event_Communication_21","Event_Communication_22","Event_Communication_39","Event_Communication_40","Event_Communication_87","Event_Communication_89","Event_Communication_90","Event_Communication_91","Event_Communication_92","Event_Communication_94","Event_Communication_120","Event_Communication_143","Event_Communication_150","Event_Communication_156","Event_Communication_159","Event_Communication_160","Event_Communication_161","Event_Communication_162","Event_Communication_163","Event_Communication_171","Event_Communication_189","Event_Communication_199","Event_Communication_244","Event_Communication_246","Event_Communication_248","Event_Communication_249","Event_Communication_250","Event_Communication_275","Event_Communication_277","Event_Communication_278","Event_Communication_279","Event_Communication_280","Event_Communication_297","Event_Communication_312","Event_Communication_313","Event_Communication_316","Event_Communication_317","Event_Communication_318","Event_Communication_328","Event_Communication_365","Event_Communication_366","Event_Communication_367","Event_Communication_368","Event_Communication_369","Event_Communication_371","Event_Communication_372","Event_Communication_373","Event_Communication_382","Event_Communication_389","Event_Communication_441","Event_Communication_442","Event_Communication_446","Event_Communication_458","Event_Communication_464","Event_Communication_513","Event_Communication_519","Event_Communication_523","Event_Communication_525","Event_Communication_541","Event_Communication_562","Event_Communication_590","Event_Communication_593","Event_Communication_594","Event_Communication_596","Event_Communication_597","Event_Communication_599","Event_Communication_619","Event_Communication_649","Event_Communication_651","Event_Communication_652","Event_Communication_683","Event_Communication_702","Event_Communication_705","Event_Communication_712","Event_Communication_714","Event_Communication_715","Event_Communication_717","Event_Communication_720","Event_Communication_721","Event_Communication_726","Event_Communication_730","Event_Communication_739","Event_Communication_764","Event_Communication_792","Event_Communication_794","Event_Communication_796","Event_Communication_799","Event_Communication_811","Event_Communication_842","Event_Communication_859","Event_Communication_860","Event_Communication_862","Event_Communication_864","Event_Communication_866","Event_Communication_867","Event_Communication_912","Event_Communication_921","Event_Communication_923","Event_Communication_925","Event_Communication_926","Event_Communication_935","Event_Communication_936","Event_Communication_937","Event_Communication_950","Event_Communication_951","Event_Communication_955","Event_Communication_963","Event_Communication_984","Event_Communication_991","Event_Assessment_445","Event_Assessment_463","Event_Assessment_650","Event_Assessment_703","Event_Assessment_729","Event_Assessment_791","Event_VesselMovement_154","Event_VesselMovement_798","Event_Collaborate_276","Event_Collaborate_512","Event_Collaborate_719","Relationship_Friends_0","Relationship_Colleagues_2","Relationship_Colleagues_11","Relationship_Colleagues_80","Relationship_Colleagues_84","Relationship_Colleagues_102","Relationship_Colleagues_158","Relationship_Colleagues_322","Relationship_Colleagues_535","Relationship_Colleagues_536","Relationship_Colleagues_589","Relationship_Colleagues_599","Relationship_Colleagues_601","Relationship_Colleagues_617","Relationship_AccessPermission_101","Relationship_AccessPermission_156","Relationship_AccessPermission_303","Relationship_AccessPermission_304","Relationship_AccessPermission_425","Relationship_Reports_41","Relationship_Reports_355","Relationship_Reports_496","Relationship_Reports_537","Relationship_Reports_622","Relationship_Coordinates_77","Relationship_Coordinates_236","Relationship_Coordinates_274","Relationship_Coordinates_437","Relationship_Coordinates_550","Relationship_Coordinates_618","Relationship_Operates_153","Relationship_Operates_154","Relationship_Operates_210","Relationship_Operates_211","Relationship_Operates_283","Relationship_Operates_439","Relationship_Operates_506","Relationship_Operates_602","Relationship_Suspicious_209","Relationship_Suspicious_219","Relationship_Suspicious_426","Relationship_Suspicious_600",null],"label":["Event_Monitoring_0","Event_Monitoring_444","Event_Monitoring_595","Event_Monitoring_704","Event_Monitoring_797","Event_Communication_1","Event_Communication_2","Event_Communication_5","Event_Communication_6","Event_Communication_7","Event_Communication_8","Event_Communication_9","Event_Communication_10","Event_Communication_11","Event_Communication_12","Event_Communication_21","Event_Communication_22","Event_Communication_39","Event_Communication_40","Event_Communication_87","Event_Communication_89","Event_Communication_90","Event_Communication_91","Event_Communication_92","Event_Communication_94","Event_Communication_120","Event_Communication_143","Event_Communication_150","Event_Communication_156","Event_Communication_159","Event_Communication_160","Event_Communication_161","Event_Communication_162","Event_Communication_163","Event_Communication_171","Event_Communication_189","Event_Communication_199","Event_Communication_244","Event_Communication_246","Event_Communication_248","Event_Communication_249","Event_Communication_250","Event_Communication_275","Event_Communication_277","Event_Communication_278","Event_Communication_279","Event_Communication_280","Event_Communication_297","Event_Communication_312","Event_Communication_313","Event_Communication_316","Event_Communication_317","Event_Communication_318","Event_Communication_328","Event_Communication_365","Event_Communication_366","Event_Communication_367","Event_Communication_368","Event_Communication_369","Event_Communication_371","Event_Communication_372","Event_Communication_373","Event_Communication_382","Event_Communication_389","Event_Communication_441","Event_Communication_442","Event_Communication_446","Event_Communication_458","Event_Communication_464","Event_Communication_513","Event_Communication_519","Event_Communication_523","Event_Communication_525","Event_Communication_541","Event_Communication_562","Event_Communication_590","Event_Communication_593","Event_Communication_594","Event_Communication_596","Event_Communication_597","Event_Communication_599","Event_Communication_619","Event_Communication_649","Event_Communication_651","Event_Communication_652","Event_Communication_683","Event_Communication_702","Event_Communication_705","Event_Communication_712","Event_Communication_714","Event_Communication_715","Event_Communication_717","Event_Communication_720","Event_Communication_721","Event_Communication_726","Event_Communication_730","Event_Communication_739","Event_Communication_764","Event_Communication_792","Event_Communication_794","Event_Communication_796","Event_Communication_799","Event_Communication_811","Event_Communication_842","Event_Communication_859","Event_Communication_860","Event_Communication_862","Event_Communication_864","Event_Communication_866","Event_Communication_867","Event_Communication_912","Event_Communication_921","Event_Communication_923","Event_Communication_925","Event_Communication_926","Event_Communication_935","Event_Communication_936","Event_Communication_937","Event_Communication_950","Event_Communication_951","Event_Communication_955","Event_Communication_963","Event_Communication_984","Event_Communication_991","Event_Assessment_445","Event_Assessment_463","Event_Assessment_650","Event_Assessment_703","Event_Assessment_729","Event_Assessment_791","Event_VesselMovement_154","Event_VesselMovement_798","Event_Collaborate_276","Event_Collaborate_512","Event_Collaborate_719","Relationship_Friends_0","Relationship_Colleagues_2","Relationship_Colleagues_11","Relationship_Colleagues_80","Relationship_Colleagues_84","Relationship_Colleagues_102","Relationship_Colleagues_158","Relationship_Colleagues_322","Relationship_Colleagues_535","Relationship_Colleagues_536","Relationship_Colleagues_589","Relationship_Colleagues_599","Relationship_Colleagues_601","Relationship_Colleagues_617","Relationship_AccessPermission_101","Relationship_AccessPermission_156","Relationship_AccessPermission_303","Relationship_AccessPermission_304","Relationship_AccessPermission_425","Relationship_Reports_41","Relationship_Reports_355","Relationship_Reports_496","Relationship_Reports_537","Relationship_Reports_622","Relationship_Coordinates_77","Relationship_Coordinates_236","Relationship_Coordinates_274","Relationship_Coordinates_437","Relationship_Coordinates_550","Relationship_Coordinates_618","Relationship_Operates_153","Relationship_Operates_154","Relationship_Operates_210","Relationship_Operates_211","Relationship_Operates_283","Relationship_Operates_439","Relationship_Operates_506","Relationship_Operates_602","Relationship_Suspicious_209","Relationship_Suspicious_219","Relationship_Suspicious_426","Relationship_Suspicious_600",null],"group":["Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Entity","Pseudonym"],"title":["Entity ID: Event_Monitoring_0","Entity ID: Event_Monitoring_444","Entity ID: Event_Monitoring_595","Entity ID: Event_Monitoring_704","Entity ID: Event_Monitoring_797","Entity ID: Event_Communication_1","Entity ID: Event_Communication_2","Entity ID: Event_Communication_5","Entity ID: Event_Communication_6","Entity ID: Event_Communication_7","Entity ID: Event_Communication_8","Entity ID: Event_Communication_9","Entity ID: Event_Communication_10","Entity ID: Event_Communication_11","Entity ID: Event_Communication_12","Entity ID: Event_Communication_21","Entity ID: Event_Communication_22","Entity ID: Event_Communication_39","Entity ID: Event_Communication_40","Entity ID: Event_Communication_87","Entity ID: Event_Communication_89","Entity ID: Event_Communication_90","Entity ID: Event_Communication_91","Entity ID: Event_Communication_92","Entity ID: Event_Communication_94","Entity ID: Event_Communication_120","Entity ID: Event_Communication_143","Entity ID: Event_Communication_150","Entity ID: Event_Communication_156","Entity ID: Event_Communication_159","Entity ID: Event_Communication_160","Entity ID: Event_Communication_161","Entity ID: Event_Communication_162","Entity ID: Event_Communication_163","Entity ID: Event_Communication_171","Entity ID: Event_Communication_189","Entity ID: Event_Communication_199","Entity ID: Event_Communication_244","Entity ID: Event_Communication_246","Entity ID: Event_Communication_248","Entity ID: Event_Communication_249","Entity ID: Event_Communication_250","Entity ID: Event_Communication_275","Entity ID: Event_Communication_277","Entity ID: Event_Communication_278","Entity ID: Event_Communication_279","Entity ID: Event_Communication_280","Entity ID: Event_Communication_297","Entity ID: Event_Communication_312","Entity ID: Event_Communication_313","Entity ID: Event_Communication_316","Entity ID: Event_Communication_317","Entity ID: Event_Communication_318","Entity ID: Event_Communication_328","Entity ID: Event_Communication_365","Entity ID: Event_Communication_366","Entity ID: Event_Communication_367","Entity ID: Event_Communication_368","Entity ID: Event_Communication_369","Entity ID: Event_Communication_371","Entity ID: Event_Communication_372","Entity ID: Event_Communication_373","Entity ID: Event_Communication_382","Entity ID: Event_Communication_389","Entity ID: Event_Communication_441","Entity ID: Event_Communication_442","Entity ID: Event_Communication_446","Entity ID: Event_Communication_458","Entity ID: Event_Communication_464","Entity ID: Event_Communication_513","Entity ID: Event_Communication_519","Entity ID: Event_Communication_523","Entity ID: Event_Communication_525","Entity ID: Event_Communication_541","Entity ID: Event_Communication_562","Entity ID: Event_Communication_590","Entity ID: Event_Communication_593","Entity ID: Event_Communication_594","Entity ID: Event_Communication_596","Entity ID: Event_Communication_597","Entity ID: Event_Communication_599","Entity ID: Event_Communication_619","Entity ID: Event_Communication_649","Entity ID: Event_Communication_651","Entity ID: Event_Communication_652","Entity ID: Event_Communication_683","Entity ID: Event_Communication_702","Entity ID: Event_Communication_705","Entity ID: Event_Communication_712","Entity ID: Event_Communication_714","Entity ID: Event_Communication_715","Entity ID: Event_Communication_717","Entity ID: Event_Communication_720","Entity ID: Event_Communication_721","Entity ID: Event_Communication_726","Entity ID: Event_Communication_730","Entity ID: Event_Communication_739","Entity ID: Event_Communication_764","Entity ID: Event_Communication_792","Entity ID: Event_Communication_794","Entity ID: Event_Communication_796","Entity ID: Event_Communication_799","Entity ID: Event_Communication_811","Entity ID: Event_Communication_842","Entity ID: Event_Communication_859","Entity ID: Event_Communication_860","Entity ID: Event_Communication_862","Entity ID: Event_Communication_864","Entity ID: Event_Communication_866","Entity ID: Event_Communication_867","Entity ID: Event_Communication_912","Entity ID: Event_Communication_921","Entity ID: Event_Communication_923","Entity ID: Event_Communication_925","Entity ID: Event_Communication_926","Entity ID: Event_Communication_935","Entity ID: Event_Communication_936","Entity ID: Event_Communication_937","Entity ID: Event_Communication_950","Entity ID: Event_Communication_951","Entity ID: Event_Communication_955","Entity ID: Event_Communication_963","Entity ID: Event_Communication_984","Entity ID: Event_Communication_991","Entity ID: Event_Assessment_445","Entity ID: Event_Assessment_463","Entity ID: Event_Assessment_650","Entity ID: Event_Assessment_703","Entity ID: Event_Assessment_729","Entity ID: Event_Assessment_791","Entity ID: Event_VesselMovement_154","Entity ID: Event_VesselMovement_798","Entity ID: Event_Collaborate_276","Entity ID: Event_Collaborate_512","Entity ID: Event_Collaborate_719","Entity ID: Relationship_Friends_0","Entity ID: Relationship_Colleagues_2","Entity ID: Relationship_Colleagues_11","Entity ID: Relationship_Colleagues_80","Entity ID: Relationship_Colleagues_84","Entity ID: Relationship_Colleagues_102","Entity ID: Relationship_Colleagues_158","Entity ID: Relationship_Colleagues_322","Entity ID: Relationship_Colleagues_535","Entity ID: Relationship_Colleagues_536","Entity ID: Relationship_Colleagues_589","Entity ID: Relationship_Colleagues_599","Entity ID: Relationship_Colleagues_601","Entity ID: Relationship_Colleagues_617","Entity ID: Relationship_AccessPermission_101","Entity ID: Relationship_AccessPermission_156","Entity ID: Relationship_AccessPermission_303","Entity ID: Relationship_AccessPermission_304","Entity ID: Relationship_AccessPermission_425","Entity ID: Relationship_Reports_41","Entity ID: Relationship_Reports_355","Entity ID: Relationship_Reports_496","Entity ID: Relationship_Reports_537","Entity ID: Relationship_Reports_622","Entity ID: Relationship_Coordinates_77","Entity ID: Relationship_Coordinates_236","Entity ID: Relationship_Coordinates_274","Entity ID: Relationship_Coordinates_437","Entity ID: Relationship_Coordinates_550","Entity ID: Relationship_Coordinates_618","Entity ID: Relationship_Operates_153","Entity ID: Relationship_Operates_154","Entity ID: Relationship_Operates_210","Entity ID: Relationship_Operates_211","Entity ID: Relationship_Operates_283","Entity ID: Relationship_Operates_439","Entity ID: Relationship_Operates_506","Entity ID: Relationship_Operates_602","Entity ID: Relationship_Suspicious_209","Entity ID: Relationship_Suspicious_219","Entity ID: Relationship_Suspicious_426","Entity ID: Relationship_Suspicious_600","Pseudonym: NA"]},"edges":{"from":["Event_Monitoring_0","Event_Monitoring_444","Event_Monitoring_595","Event_Monitoring_704","Event_Monitoring_797","Event_Communication_1","Event_Communication_2","Event_Communication_5","Event_Communication_6","Event_Communication_7","Event_Communication_8","Event_Communication_9","Event_Communication_10","Event_Communication_11","Event_Communication_12","Event_Communication_21","Event_Communication_22","Event_Communication_39","Event_Communication_40","Event_Communication_87","Event_Communication_89","Event_Communication_90","Event_Communication_91","Event_Communication_92","Event_Communication_94","Event_Communication_120","Event_Communication_143","Event_Communication_150","Event_Communication_156","Event_Communication_159","Event_Communication_160","Event_Communication_161","Event_Communication_162","Event_Communication_163","Event_Communication_171","Event_Communication_189","Event_Communication_199","Event_Communication_244","Event_Communication_246","Event_Communication_248","Event_Communication_249","Event_Communication_250","Event_Communication_275","Event_Communication_277","Event_Communication_278","Event_Communication_279","Event_Communication_280","Event_Communication_297","Event_Communication_312","Event_Communication_313","Event_Communication_316","Event_Communication_317","Event_Communication_318","Event_Communication_328","Event_Communication_365","Event_Communication_366","Event_Communication_367","Event_Communication_368","Event_Communication_369","Event_Communication_371","Event_Communication_372","Event_Communication_373","Event_Communication_382","Event_Communication_389","Event_Communication_441","Event_Communication_442","Event_Communication_446","Event_Communication_458","Event_Communication_464","Event_Communication_513","Event_Communication_519","Event_Communication_523","Event_Communication_525","Event_Communication_541","Event_Communication_562","Event_Communication_590","Event_Communication_593","Event_Communication_594","Event_Communication_596","Event_Communication_597","Event_Communication_599","Event_Communication_619","Event_Communication_649","Event_Communication_651","Event_Communication_652","Event_Communication_683","Event_Communication_702","Event_Communication_705","Event_Communication_712","Event_Communication_714","Event_Communication_715","Event_Communication_717","Event_Communication_720","Event_Communication_721","Event_Communication_726","Event_Communication_730","Event_Communication_739","Event_Communication_764","Event_Communication_792","Event_Communication_794","Event_Communication_796","Event_Communication_799","Event_Communication_811","Event_Communication_842","Event_Communication_859","Event_Communication_860","Event_Communication_862","Event_Communication_864","Event_Communication_866","Event_Communication_867","Event_Communication_912","Event_Communication_921","Event_Communication_923","Event_Communication_925","Event_Communication_926","Event_Communication_935","Event_Communication_936","Event_Communication_937","Event_Communication_950","Event_Communication_951","Event_Communication_955","Event_Communication_963","Event_Communication_984","Event_Communication_991","Event_Assessment_445","Event_Assessment_463","Event_Assessment_650","Event_Assessment_703","Event_Assessment_729","Event_Assessment_791","Event_VesselMovement_154","Event_VesselMovement_798","Event_Collaborate_276","Event_Collaborate_512","Event_Collaborate_719","Relationship_Friends_0","Relationship_Colleagues_2","Relationship_Colleagues_11","Relationship_Colleagues_80","Relationship_Colleagues_84","Relationship_Colleagues_102","Relationship_Colleagues_158","Relationship_Colleagues_322","Relationship_Colleagues_535","Relationship_Colleagues_536","Relationship_Colleagues_589","Relationship_Colleagues_599","Relationship_Colleagues_601","Relationship_Colleagues_617","Relationship_AccessPermission_101","Relationship_AccessPermission_156","Relationship_AccessPermission_303","Relationship_AccessPermission_304","Relationship_AccessPermission_425","Relationship_Reports_41","Relationship_Reports_355","Relationship_Reports_496","Relationship_Reports_537","Relationship_Reports_622","Relationship_Coordinates_77","Relationship_Coordinates_236","Relationship_Coordinates_274","Relationship_Coordinates_437","Relationship_Coordinates_550","Relationship_Coordinates_618","Relationship_Operates_153","Relationship_Operates_154","Relationship_Operates_210","Relationship_Operates_211","Relationship_Operates_283","Relationship_Operates_439","Relationship_Operates_506","Relationship_Operates_602","Relationship_Suspicious_209","Relationship_Suspicious_219","Relationship_Suspicious_426","Relationship_Suspicious_600"],"to":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"groups":{"Entity":{"color":"steelblue"},"useDefaultGroups":true,"Pseudonym":{"color":"tomato"}},"layout":{"randomSeed":123}},"groups":["Entity","Pseudonym"],"width":"100%","height":"600px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":[{"label":"Entity","shape":"dot","color":"steelblue"},{"label":"Pseudonym","shape":"dot","color":"tomato"}],"nodesToDataframe":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>The visualisation used for this part of the question is an interactive graph using the <code>visNetwork</code> entity which shows the edges and nodes. The blue nodes indicates the entities (may be people or vessels), red nodes which is the pseudonym names and edges which indicates which entity uses what pseudonym. The aim of this visualisation is to expose the reusing of an alias whereby the same pseudonym is tied and connected to multiple entities</p>
<div class="callout callout-style-default callout-note callout-titled" title="What can we learn from this visualisation?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What can we learn from this visualisation?
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>This visualisation helps Clepper to easily identify which pseudonyms are reused by multiple entities</p></li>
<li><p>This breaks the assumed connection between identity and name revealing many one-to-one mapping</p></li>
<li><p>This therefore can help Clepper to detect deception strategies such as multiple people pretending to have one single alias, hence minimising the risks of impersonation.</p></li>
</ul>
</div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>