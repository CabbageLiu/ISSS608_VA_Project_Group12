<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Chiam, Enrico Sebastian, Liu Chih Yuan">
<meta name="dcterms.date" content="2025-06-20">

<title>VAST Challenge 2025 - Mini-Challenge 3 – ISSS608 Visual Analytics Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608 Visual Analytics Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-menu" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Menu</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-menu">    
        <li>
    <a class="dropdown-item" href="../../project_proposal/project_proposal.html">
 <span class="dropdown-text">Project Proposal</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../main_project_qmd/main_project_qmd/main.html">
 <span class="dropdown-text">Report Draft (Main)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-meeting-minutes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Meeting Minutes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-meeting-minutes">    
        <li>
    <a class="dropdown-item" href="../../Mtg_Minutes/Meeting01.html">
 <span class="dropdown-text">Meeting Minutes 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Mtg_Minutes/Meeting02.html">
 <span class="dropdown-text">Meeting Minutes 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Mtg_Minutes/Meeting03.html">
 <span class="dropdown-text">Meeting Minutes 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">1. Background</a></li>
  <li><a href="#load-package" id="toc-load-package" class="nav-link" data-scroll-target="#load-package">2. Load Package</a></li>
  <li><a href="#clean-and-transform-data" id="toc-clean-and-transform-data" class="nav-link" data-scroll-target="#clean-and-transform-data">3. Clean and Transform Data</a>
  <ul class="collapse">
  <li><a href="#initial-eda" id="toc-initial-eda" class="nav-link" data-scroll-target="#initial-eda">3.1 Initial EDA</a></li>
  </ul></li>
  <li><a href="#data-cleaning-and-wrangling" id="toc-data-cleaning-and-wrangling" class="nav-link" data-scroll-target="#data-cleaning-and-wrangling">4. Data Cleaning and Wrangling</a></li>
  <li><a href="#building-tidygraph-object" id="toc-building-tidygraph-object" class="nav-link" data-scroll-target="#building-tidygraph-object">5. Building <code>tidygraph</code> object</a></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">6. EDA</a>
  <ul class="collapse">
  <li><a href="#relationship-between-entities-and-events" id="toc-relationship-between-entities-and-events" class="nav-link" data-scroll-target="#relationship-between-entities-and-events">6.1 Relationship between entities and events</a></li>
  <li><a href="#entity-distribution" id="toc-entity-distribution" class="nav-link" data-scroll-target="#entity-distribution">6.2 Entity distribution</a></li>
  <li><a href="#event-type-distribution" id="toc-event-type-distribution" class="nav-link" data-scroll-target="#event-type-distribution">6.3 Event type distribution</a></li>
  <li><a href="#list-of-communication-participants" id="toc-list-of-communication-participants" class="nav-link" data-scroll-target="#list-of-communication-participants">6.4 List of communication participants</a></li>
  <li><a href="#visualization-of-communication-participants-network" id="toc-visualization-of-communication-participants-network" class="nav-link" data-scroll-target="#visualization-of-communication-participants-network">6.4.1 Visualization of communication participants network</a>
  <ul class="collapse">
  <li><a href="#filtering-communication-events" id="toc-filtering-communication-events" class="nav-link" data-scroll-target="#filtering-communication-events">Filtering Communication Events</a></li>
  <li><a href="#extracting-essential-communication-fields" id="toc-extracting-essential-communication-fields" class="nav-link" data-scroll-target="#extracting-essential-communication-fields">Extracting Essential Communication Fields</a></li>
  <li><a href="#converting-timestamps-to-datetime-format" id="toc-converting-timestamps-to-datetime-format" class="nav-link" data-scroll-target="#converting-timestamps-to-datetime-format">Converting Timestamps to Datetime Format</a></li>
  <li><a href="#filtering-edges-for-sender-and-receiver-links" id="toc-filtering-edges-for-sender-and-receiver-links" class="nav-link" data-scroll-target="#filtering-edges-for-sender-and-receiver-links">Filtering Edges for Sender and Receiver Links</a></li>
  <li><a href="#separating-senders-and-receivers" id="toc-separating-senders-and-receivers" class="nav-link" data-scroll-target="#separating-senders-and-receivers">Separating Senders and Receivers</a></li>
  <li><a href="#creating-senderreceiver-pairs" id="toc-creating-senderreceiver-pairs" class="nav-link" data-scroll-target="#creating-senderreceiver-pairs">Creating Sender–Receiver Pairs</a></li>
  <li><a href="#adding-message-content-and-timing" id="toc-adding-message-content-and-timing" class="nav-link" data-scroll-target="#adding-message-content-and-timing">Adding Message Content and Timing</a></li>
  <li><a href="#resolving-official-labels-for-senders-and-receivers" id="toc-resolving-official-labels-for-senders-and-receivers" class="nav-link" data-scroll-target="#resolving-official-labels-for-senders-and-receivers">Resolving Official Labels for Senders and Receivers</a></li>
  <li><a href="#enriching-with-entity-labels-and-preparing-for-network-construction" id="toc-enriching-with-entity-labels-and-preparing-for-network-construction" class="nav-link" data-scroll-target="#enriching-with-entity-labels-and-preparing-for-network-construction">Enriching with Entity Labels and Preparing for Network Construction</a></li>
  </ul></li>
  <li><a href="#question-2-communication-network-group-detection" id="toc-question-2-communication-network-group-detection" class="nav-link" data-scroll-target="#question-2-communication-network-group-detection">Question 2 – Communication Network &amp; Group Detection</a>
  <ul class="collapse">
  <li><a href="#key-features-of-the-network-visualization" id="toc-key-features-of-the-network-visualization" class="nav-link" data-scroll-target="#key-features-of-the-network-visualization">Key Features of the Network Visualization</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">VAST Challenge 2025 - Mini-Challenge 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Chiam, Enrico Sebastian, Liu Chih Yuan </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 20, 2025</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 30, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="background" class="level1">
<h1>1. Background</h1>
<p>This take home exercise is based on the <a href="https://vast-challenge.github.io/2025/MC3.html">VAST Challenge Mini Case 3</a></p>
<p>Over the past decade, the community of Oceanus has faced numerous transformations and challenges evolving from its fishing-centric origins. Following major crackdowns on illegal fishing activities, suspects have shifted investments into more regulated sectors such as the ocean tourism industry, resulting in growing tensions. This increased tourism has recently attracted the likes of international pop star Sailor Shift, who announced plans to film a music video on the island.</p>
<p>Clepper Jessen, a former analyst at FishEye and now a seasoned journalist for the Hacklee Herald, has been keenly observing these rising tensions. Recently, he turned his attention towards the temporary closure of Nemo Reef. By listening to radio communications and utilizing his investigative tools, Clepper uncovered a complex web of expedited approvals and secretive logistics. These efforts revealed a story involving high-level Oceanus officials, Sailor Shift’s team, local influential families, and local conservationist group The Green Guardians, pointing towards a story of corruption and manipulation.</p>
<p>Your task is to develop new and novel visualizations and visual analytics approaches to help Clepper get to the bottom of this story</p>
</section>
<section id="load-package" class="level1">
<h1>2. Load Package</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Load Libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite, tidygraph, ggraph, lubridate, SmartEDA, igraph, dplyr, viridis, ggrepel, scales)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Load Graph and Schema</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>MC3 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_release/MC3_graph.json"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>MC3_schema <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC3_release/MC3_schema.json"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MC3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 5
 $ directed  : logi TRUE
 $ multigraph: logi FALSE
 $ graph     :List of 4
  ..$ mode        : chr "static"
  ..$ edge_default: Named list()
  ..$ node_default: Named list()
  ..$ name        : chr "VAST_MC3_Knowledge_Graph"
 $ nodes     :'data.frame': 1159 obs. of  31 variables:
  ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  ..$ findings         : chr [1:1159] NA NA NA NA ...
  ..$ content          : chr [1:1159] NA NA NA NA ...
  ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  ..$ results          : chr [1:1159] NA NA NA NA ...
  ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  ..$ destination      : chr [1:1159] NA NA NA NA ...
  ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  ..$ outcome          : chr [1:1159] NA NA NA NA ...
  ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  ..$ thing_collected  :'data.frame':   1159 obs. of  2 variables:
  .. ..$ type: chr [1:1159] NA NA NA NA ...
  .. ..$ name: chr [1:1159] NA NA NA NA ...
  ..$ reference        : chr [1:1159] NA NA NA NA ...
  ..$ date             : chr [1:1159] NA NA NA NA ...
  ..$ time             : chr [1:1159] NA NA NA NA ...
  ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  ..$ start_date       : chr [1:1159] NA NA NA NA ...
  ..$ end_date         : chr [1:1159] NA NA NA NA ...
  ..$ report_type      : chr [1:1159] NA NA NA NA ...
  ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  ..$ operational_role : chr [1:1159] NA NA NA NA ...
 $ edges     :'data.frame': 3226 obs. of  5 variables:
  ..$ id         : chr [1:3226] "2" "3" "5" "3013" ...
  ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  ..$ source     : chr [1:3226] "Sam" "Sam" "Sam" "Sam" ...
  ..$ target     : chr [1:3226] "Relationship_Suspicious_217" "Event_Communication_370" "Event_Assessment_600" "Relationship_Colleagues_430" ...
  ..$ type       : chr [1:3226] NA "sent" NA NA ...</code></pre>
</div>
</div>
</section>
<section id="clean-and-transform-data" class="level1">
<h1>3. Clean and Transform Data</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>nodes)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>mc3_edges <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(MC3<span class="sc">$</span>edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="initial-eda" class="level2">
<h2 class="anchored" data-anchor-id="initial-eda">3.1 Initial EDA</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ExpCatViz(data=mc3_nodes,</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          col="pink")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="data-cleaning-and-wrangling" class="level1">
<h1>4. Data Cleaning and Wrangling</h1>
<p>Code chunk below performs the following data cleaning tasks:</p>
<ul>
<li><p>convert values in id field into character data type,</p></li>
<li><p>exclude records with&nbsp;<code>id</code>&nbsp;value are na,</p></li>
<li><p>exclude records with similar id values,</p></li>
<li><p>exclude&nbsp;<code>thing_collected</code>&nbsp;field, and</p></li>
<li><p>save the cleaned tibble dataframe into a new tibble datatable called&nbsp;<code>mc3_nodes_cleaned</code>.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_cleaned <span class="ot">&lt;-</span> mc3_nodes <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below will be used to:</p>
<ul>
<li><p>rename source and target fields to from_id and to_id respectively,</p></li>
<li><p>convert values in from_id and to_id fields to character data type,</p></li>
<li><p>exclude values in from_id and to_id which not found in the id field of mc3_nodes_cleaned,</p></li>
<li><p>exclude records whereby from_id and/or to_id values are missing, and</p></li>
<li><p>save the cleaned tibble dataframe and called it mc3_edges_cleaned.</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_cleaned <span class="ot">&lt;-</span> mc3_edges <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id, </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> mc3_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, code chunk below will be used to create mapping of character id in&nbsp;<code>mc3_nodes_cleaned</code>&nbsp;to row index</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>node_index_lookup <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, the code chunk below will be used to join and convert&nbsp;<code>from_id</code>&nbsp;and&nbsp;<code>to_id</code>&nbsp;to integer indices. At the same time we also drop rows with unmatched nodes.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_indexed <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_index_lookup, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(to))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next the code chunk below is used to subset nodes to only those referenced by edges.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>used_node_indices <span class="ot">&lt;-</span> <span class="fu">sort</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>(<span class="fu">c</span>(mc3_edges_indexed<span class="sc">$</span>from, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>           mc3_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(used_node_indices) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We will then use the code chunk below to rebuild lookup from old index to new index.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>old_to_new_index <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> used_node_indices,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    used_node_indices))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below will be used to update edge indices to match new node table.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mc3_edges_final <span class="ot">&lt;-</span> mc3_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(old_to_new_index, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>         is_inferred, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="building-tidygraph-object" class="level1">
<h1>5. Building <code>tidygraph</code> object</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mc3_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> mc3_nodes_final,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> mc3_edges_final,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mc3_graph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'tbl_graph', 'igraph'  hidden list of 10
 $ : num 1159
 $ : logi TRUE
 $ : num [1:3226] 0 0 0 0 0 0 0 1 1 1 ...
 $ : num [1:3226] 1137 356 746 894 875 ...
 $ : NULL
 $ : NULL
 $ : NULL
 $ : NULL
 $ :List of 4
  ..$ : num [1:3] 1 0 1
  ..$ : Named list()
  ..$ :List of 31
  .. ..$ type             : chr [1:1159] "Entity" "Entity" "Entity" "Entity" ...
  .. ..$ label            : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ name             : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ sub_type         : chr [1:1159] "Person" "Person" "Person" "Person" ...
  .. ..$ id               : chr [1:1159] "Sam" "Kelly" "Nadia Conti" "Elise" ...
  .. ..$ timestamp        : chr [1:1159] NA NA NA NA ...
  .. ..$ monitoring_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ findings         : chr [1:1159] NA NA NA NA ...
  .. ..$ content          : chr [1:1159] NA NA NA NA ...
  .. ..$ assessment_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ results          : chr [1:1159] NA NA NA NA ...
  .. ..$ movement_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ destination      : chr [1:1159] NA NA NA NA ...
  .. ..$ enforcement_type : chr [1:1159] NA NA NA NA ...
  .. ..$ outcome          : chr [1:1159] NA NA NA NA ...
  .. ..$ activity_type    : chr [1:1159] NA NA NA NA ...
  .. ..$ participants     : int [1:1159] NA NA NA NA NA NA NA NA NA NA ...
  .. ..$ reference        : chr [1:1159] NA NA NA NA ...
  .. ..$ date             : chr [1:1159] NA NA NA NA ...
  .. ..$ time             : chr [1:1159] NA NA NA NA ...
  .. ..$ friendship_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ permission_type  : chr [1:1159] NA NA NA NA ...
  .. ..$ start_date       : chr [1:1159] NA NA NA NA ...
  .. ..$ end_date         : chr [1:1159] NA NA NA NA ...
  .. ..$ report_type      : chr [1:1159] NA NA NA NA ...
  .. ..$ submission_date  : chr [1:1159] NA NA NA NA ...
  .. ..$ jurisdiction_type: chr [1:1159] NA NA NA NA ...
  .. ..$ authority_level  : chr [1:1159] NA NA NA NA ...
  .. ..$ coordination_type: chr [1:1159] NA NA NA NA ...
  .. ..$ operational_role : chr [1:1159] NA NA NA NA ...
  .. ..$ new_index        : int [1:1159] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ :List of 2
  .. ..$ is_inferred: logi [1:3226] TRUE FALSE TRUE TRUE TRUE TRUE ...
  .. ..$ type       : chr [1:3226] NA "sent" NA NA ...
 $ :&lt;environment: 0x000002a770f409e0&gt; 
 - attr(*, "active")= chr "nodes"</code></pre>
</div>
</div>
</section>
<section id="eda" class="level1">
<h1>6. EDA</h1>
<p>Setting seed for reproducibility</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="relationship-between-entities-and-events" class="level2">
<h2 class="anchored" data-anchor-id="relationship-between-entities-and-events">6.1 Relationship between entities and events</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(mc3_graph, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">colour =</span> <span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="st">`</span><span class="at">type</span><span class="st">`</span>), </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> type), </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repel =</span> <span class="cn">TRUE</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_DC3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="entity-distribution" class="level2">
<h2 class="anchored" data-anchor-id="entity-distribution">6.2 Entity distribution</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define color mapping</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>subtype_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Person"</span> <span class="ot">=</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Organization"</span> <span class="ot">=</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Vessel"</span> <span class="ot">=</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Group"</span> <span class="ot">=</span> <span class="st">"#25e158"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Location"</span> <span class="ot">=</span> <span class="st">"#ec4bff"</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(sub_type, n), <span class="at">y =</span> n, <span class="at">fill =</span> sub_type)) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Entity Sub-type Distribution"</span>, <span class="at">x =</span> <span class="st">"Sub-type"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_DC3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="event-type-distribution" class="level2">
<h2 class="anchored" data-anchor-id="event-type-distribution">6.3 Event type distribution</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mc3_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sub_type, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(sub_type, n), <span class="at">y =</span> n, <span class="at">fill =</span> sub_type)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Event Sub-type Distribution"</span>, <span class="at">x =</span> <span class="st">"Sub-type"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_DC3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="list-of-communication-participants" class="level2">
<h2 class="anchored" data-anchor-id="list-of-communication-participants">6.4 List of communication participants</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get all Communication Event IDs</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>comm_event_ids <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(id)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Extract 'sent' edges for communication events</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>comm_sent_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>, to_id <span class="sc">%in%</span> comm_event_ids) <span class="sc">%&gt;%</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">comm_id =</span> to_id, <span class="at">sender_id =</span> from_id)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Extract 'received' edges for same communication events</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>comm_received_edges <span class="ot">&lt;-</span> mc3_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>, from_id <span class="sc">%in%</span> comm_event_ids) <span class="sc">%&gt;%</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">comm_id =</span> from_id, <span class="at">receiver_id =</span> to_id)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Join sent and received edges by communication ID</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>comm_pairs <span class="ot">&lt;-</span> comm_sent_edges <span class="sc">%&gt;%</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(comm_received_edges, <span class="at">by =</span> <span class="st">"comm_id"</span>)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Add sender and receiver labels</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>participants_named <span class="ot">&lt;-</span> comm_pairs <span class="sc">%&gt;%</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">sender_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mc3_nodes_cleaned <span class="sc">%&gt;%</span> <span class="fu">select</span>(id, <span class="at">receiver_label =</span> label), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver_id"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step7: Interactive summary of top sender–receiver pairs</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>participants_named <span class="sc">%&gt;%</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_label, receiver_label, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Top Communication Pairs (Sender → Receiver)"</span>,</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">"Sender"</span>, <span class="st">"Receiver"</span>, <span class="st">"Message Count"</span>),</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">10</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">rownames =</span> <span class="cn">FALSE</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-54575bd3d30a622838bc" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-54575bd3d30a622838bc">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top Communication Pairs (Sender → Receiver)<\/caption>","data":[["Clepper Jensen","Miranda Jordan","The Intern","Green Guardians","Green Guardians","The Lookout","Neptune","Remora","Neptune","Oceanus City Council","The Intern","The Lookout","Himark Harbor","Neptune","Davis","Green Guardians","Liam Thorne","Mrs. Money","Oceanus City Council","Oceanus City Council","Osprey","Remora","Davis","Davis","EcoVigil","Himark Harbor","Mako","Mrs. Money","Oceanus City Council","Sentinel","Sentinel","The Lookout","Boss","Davis","Green Guardians","Horizon","Mako","Mako","Mako","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Rodriguez","Small Fry","The Lookout","The Middleman","V. Miesel Shipping","Boss","Defender","Elise","Green Guardians","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Horizon","Mako","Mrs. Money","Neptune","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Rodriguez","Rodriguez","Samantha Blake","Samantha Blake","Samantha Blake","The Lookout","The Middleman","The Middleman","Davis","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Green Guardians","Green Guardians","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Kelly","Knowles","Liam Thorne","Mako","Mako","Mako","Mako","Marlin","Marlin","Mrs. Money","Nadia Conti","Nadia Conti","Neptune","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Sentinel","Sentinel","Serenity","Serenity","Serenity","Serenity","Small Fry","The Accountant","The Middleman","V. Miesel Shipping","V. Miesel Shipping","Boss","Boss","Davis","Davis","Davis","Defender","Defender","EcoVigil","Elise","Elise","Glitters Team","Glitters Team","Glitters Team","Glitters Team","Green Guardians","Green Guardians","Green Guardians","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Horizon","Knowles","Knowles","Liam Thorne","Liam Thorne","Liam Thorne","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Marlin","Marlin","Marlin","Mrs. Money","Mrs. Money","Mrs. Money","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Neptune","Neptune","Neptune","Neptune","Northern Light","Northern Light","Northern Light","Northern Light","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Reef Guardian","Reef Guardian","Remora","Remora","Remora","Remora","Remora","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Sailor Shifts Team","Sailor Shifts Team","Sam","Seawatch","Seawatch","Seawatch","Sentinel","Sentinel","Sentinel","Sentinel","Small Fry","The Accountant","The Intern","The Lookout","The Middleman","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping"],["Miranda Jordan","Clepper Jensen","Mrs. Money","Green Guardians","Oceanus City Council","The Intern","Remora","Mako","V. Miesel Shipping","Liam Thorne","The Lookout","Sam","Oceanus City Council","Mako","Davis","Reef Guardian","Oceanus City Council","Boss","Green Guardians","Paackland Harbor","Mako","Neptune","Mako","Nadia Conti","Horizon","Neptune","Remora","The Intern","Himark Harbor","Horizon","Mako","Horizon","Mrs. Money","Remora","Horizon","Sentinel","Himark Harbor","Samantha Blake","Sentinel","Remora","Sentinel","EcoVigil","Oceanus City Council","Rodriguez","Remora","Sentinel","Boss","Neptune","The Middleman","Reef Guardian","Nadia Conti","EcoVigil","Mako","Remora","Seawatch","Serenity","EcoVigil","Neptune","The Middleman","Elise","Mako","Horizon","Marlin","Reef Guardian","Seawatch","Sentinel","Serenity","Paackland Harbor","Boss","Davis","Mako","Oceanus City Council","Sailor Shifts Team","Green Guardians","Mrs. Money","The Accountant","V. Miesel Shipping","EcoVigil","Liam Thorne","Reef Guardian","Sentinel","Mako","Seawatch","Oceanus City Council","Marlin","Green Guardians","Seawatch","Sam","Davis","Nadia Conti","Boss","Osprey","Paackland Harbor","Reef Guardian","Himark Harbor","Remora","Neptune","Liam Thorne","Neptune","Davis","Mako","Reef Guardian","Samantha Blake","Oceanus City Council","Reef Guardian","Defender","Mako","Paackland Harbor","Sailor Shifts Team","Green Guardians","Oceanus City Council","Himark Harbor","Mako","Neptune","Reef Guardian","Davis","Boss","Liam Thorne","Remora","V. Miesel Shipping","Mako","V. Miesel Shipping","Boss","Himark Harbor","Neptune","Mako","Seawatch","Oceanus City Council","Liam Thorne","V. Miesel Shipping","Boss","Northern Light","Remora","Samantha Blake","Northern Light","Paackland Harbor","Sentinel","EcoVigil","Knowles","Mako","Nadia Conti","Osprey","Northern Light","Mako","Oceanus City Council","Reef Guardian","Haacklee Harbor","Mako","Boss","EcoVigil","Elise","Davis","Elise","Marlin","Oceanus City Council","Sailor Shifts Team","Serenity","V. Miesel Shipping","Mako","Oceanus City Council","Reef Guardian","Mako","Remora","V. Miesel Shipping","Haacklee Harbor","Marlin","Oceanus City Council","V. Miesel Shipping","City Officials","Himark Harbor","Nadia Conti","Reef Guardian","Serenity","Green Guardians","Himark Harbor","Oceanus City Council","Sailor Shifts Team","EcoVigil","Marlin","Nadia Conti","Northern Light","Oceanus City Council","Sentinel","Liam Thorne","Neptune","Port Security","Davis","Himark Harbor","Nadia Conti","Rodriguez","V. Miesel Shipping","Mrs. Money","Nadia Conti","Remora","Sailor Shifts Team","Nadia Conti","Remora","Kelly","Green Guardians","Himark Harbor","Reef Guardian","Nadia Conti","Paackland Harbor","Reef Guardian","Seawatch","Mako","The Middleman","The Intern","Reef Guardian","Paackland Harbor","Boss","Davis","Elise","Mako","Mrs. Money","Nadia Conti","Rodriguez"],[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Sender<\/th>\n      <th>Receiver<\/th>\n      <th>Message Count<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":2},{"name":"sender_label","targets":0},{"name":"receiver_label","targets":1},{"name":"n","targets":2}],"order":[],"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="visualization-of-communication-participants-network" class="level2">
<h2 class="anchored" data-anchor-id="visualization-of-communication-participants-network">6.4.1 Visualization of communication participants network</h2>
<p>This code creates an&nbsp;<strong>interactive communication network graph</strong>&nbsp;using&nbsp;<code>visNetwork</code>, where:</p>
<ul>
<li><p>Each&nbsp;<strong>node</strong>&nbsp;represents a person or entity,&nbsp;<strong>node size</strong>&nbsp;is based on total messages&nbsp;<strong>sent</strong>&nbsp;by that participant.</p></li>
<li><p>Each&nbsp;<strong>edge (arrow)</strong>&nbsp;represents a communication sent from one participant to another, the thicker the edge, the more message sent to that particular receiver.</p></li>
</ul>
<p><strong>Ver 1: Layout_in_circle</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Summarize communication edges</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>comm_edges_vis <span class="ot">&lt;-</span> participants_named <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_id, receiver_id, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> sender_id, <span class="at">to =</span> receiver_id, <span class="at">value =</span> n)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute messages sent per node</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>message_counts <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from) <span class="sc">%&gt;%</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sent_count =</span> <span class="fu">sum</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Prepare nodes, merge with message count and add color/shape</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">unique</span>(<span class="fu">c</span>(comm_edges_vis<span class="sc">$</span>from, comm_edges_vis<span class="sc">$</span>to))) <span class="sc">%&gt;%</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(message_counts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"from"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">sent_count =</span> <span class="fu">replace_na</span>(sent_count, <span class="dv">0</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">rescale</span>(sent_count, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>)),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(label, <span class="st">"&lt;br&gt;Sub-type: "</span>, sub_type,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(sent_count), <span class="fu">paste0</span>(<span class="st">"&lt;br&gt;Sent: "</span>, sent_count, <span class="st">" messages"</span>), <span class="st">""</span>)),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"#25e158"</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#ec4bff"</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">case_when</span>(</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"dot"</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"square"</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"triangle"</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"star"</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"diamond"</span>,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"dot"</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(size))</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Format visNetwork edges</span></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fu">rescale</span>(value, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)),</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Messages:"</span>, value)</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Define legend items</span></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>legend_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Organization"</span>, <span class="st">"Vessel"</span>, <span class="st">"Group"</span>, <span class="st">"Location"</span>),</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#2ca5ff"</span>, <span class="st">"#f5ee15"</span>, <span class="st">"#FB7E81"</span>, <span class="st">"#25e158"</span>, <span class="st">"#ec4bff"</span>),</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">c</span>(<span class="st">"dot"</span>, <span class="st">"square"</span>, <span class="st">"triangle"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>),</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Render network with legend</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"1000px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> nodes_vis<span class="sc">$</span>size</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># color and shape are picked up from nodes_vis columns automatically</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(legend_nodes), <span class="cf">function</span>(i) {</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> legend_nodes<span class="sc">$</span>label[i],</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">shape =</span> legend_nodes<span class="sc">$</span>shape[i],</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> legend_nodes<span class="sc">$</span>color[i]</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span>,</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.15</span></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_in_circle"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">enabled =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-a09acc36575f53e3d2b2" style="width:100%;height:1000px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a09acc36575f53e3d2b2">{"x":{"nodes":{"id":["Green Guardians","Oceanus City Council","Mako","Neptune","Reef Guardian","The Lookout","Himark Harbor","Davis","Remora","The Intern","Clepper Jensen","Mrs. Money","Miranda Jordan","Sentinel","Paackland Harbor","V. Miesel Shipping","Rodriguez","Horizon","EcoVigil","The Middleman","Liam Thorne","Samantha Blake","Boss","Nadia Conti","Serenity","Small Fry","Marlin","Haacklee Harbor","Osprey","Elise","Defender","Glitters Team","Northern Light","Knowles","The Accountant","Seawatch","Kelly","Sailor Shifts Team","Sam","City Officials","Port Security"],"label":["Green Guardians","Oceanus City Council","Mako","Neptune","Reef Guardian","The Lookout","Himark Harbor","Davis","Remora","The Intern","Clepper Jensen","Mrs. Money","Miranda Jordan","Sentinel","Paackland Harbor","V. Miesel Shipping","Rodriguez","Horizon","EcoVigil","The Middleman","Liam Thorne","Samantha Blake","Boss","Nadia Conti","Serenity","Small Fry","Marlin","Haacklee Harbor","Osprey","Elise","Defender","Glitters Team","Northern Light","Knowles","The Accountant","Seawatch","Kelly","Sailor Shifts Team","Sam","City Officials","Port Security"],"sub_type":["Organization","Organization","Vessel","Vessel","Vessel","Person","Location","Person","Vessel","Person","Person","Person","Person","Vessel","Location","Organization","Person","Vessel","Vessel","Person","Person","Person","Person","Person","Vessel","Person","Vessel","Location","Vessel","Person","Vessel","Organization","Vessel","Vessel","Person","Vessel","Person","Organization","Person","Group","Location"],"sent_count":[44,37,35,34,34,33,27,25,25,24,20,19,18,18,16,15,14,14,14,13,11,9,9,8,8,7,7,7,6,5,5,4,4,4,3,3,2,2,1,0,0],"size":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],"title":["Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages","Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages","Mako<br>Sub-type: Vessel<br>Sent: 35 messages","Neptune<br>Sub-type: Vessel<br>Sent: 34 messages","Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages","The Lookout<br>Sub-type: Person<br>Sent: 33 messages","Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages","Davis<br>Sub-type: Person<br>Sent: 25 messages","Remora<br>Sub-type: Vessel<br>Sent: 25 messages","The Intern<br>Sub-type: Person<br>Sent: 24 messages","Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages","Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages","Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages","Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages","Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages","V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages","Rodriguez<br>Sub-type: Person<br>Sent: 14 messages","Horizon<br>Sub-type: Vessel<br>Sent: 14 messages","EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages","The Middleman<br>Sub-type: Person<br>Sent: 13 messages","Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages","Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages","Boss<br>Sub-type: Person<br>Sent: 9 messages","Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages","Serenity<br>Sub-type: Vessel<br>Sent: 8 messages","Small Fry<br>Sub-type: Person<br>Sent: 7 messages","Marlin<br>Sub-type: Vessel<br>Sent: 7 messages","Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages","Osprey<br>Sub-type: Vessel<br>Sent: 6 messages","Elise<br>Sub-type: Person<br>Sent: 5 messages","Defender<br>Sub-type: Vessel<br>Sent: 5 messages","Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages","Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages","Knowles<br>Sub-type: Vessel<br>Sent: 4 messages","The Accountant<br>Sub-type: Person<br>Sent: 3 messages","Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages","Kelly<br>Sub-type: Person<br>Sent: 2 messages","Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages","Sam<br>Sub-type: Person<br>Sent: 1 messages","City Officials<br>Sub-type: Group<br>Sent: 0 messages","Port Security<br>Sub-type: Location<br>Sent: 0 messages"],"color":["#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#2ca5ff","#ec4bff","#2ca5ff","#FB7E81","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#FB7E81","#ec4bff","#f5ee15","#2ca5ff","#FB7E81","#FB7E81","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#FB7E81","#2ca5ff","#FB7E81","#ec4bff","#FB7E81","#2ca5ff","#FB7E81","#f5ee15","#FB7E81","#FB7E81","#2ca5ff","#FB7E81","#2ca5ff","#f5ee15","#2ca5ff","#25e158","#ec4bff"],"shape":["square","square","triangle","triangle","triangle","dot","diamond","dot","triangle","dot","dot","dot","dot","triangle","diamond","square","dot","triangle","triangle","dot","dot","dot","dot","dot","triangle","dot","triangle","diamond","triangle","dot","triangle","square","triangle","triangle","dot","triangle","dot","square","dot","star","diamond"],"x":[1,0.988263204734962,0.9533279194732136,0.8960129976915159,0.8176618525785562,0.7201109685684317,0.6056468557020445,0.4769524557696989,0.3370442564294944,0.189201587293274,0.03688975521995497,-0.1163211795401867,-0.2668400825319395,-0.4111389182430832,-0.5458354442665709,-0.6677724881958929,-0.7740919490703919,-0.8623017888393665,-0.9303344436218247,-0.9765952856514705,-1,-1,-0.9765952856514704,-0.9303344436218246,-0.8623017888393664,-0.7740919490703918,-0.6677724881958926,-0.5458354442665705,-0.4111389182430827,-0.2668400825319392,-0.1163211795401862,0.03688975521995497,0.1892015872932742,0.3370442564294949,0.4769524557696991,0.6056468557020447,0.7201109685684317,0.8176618525785562,0.8960129976915159,0.9533279194732136,0.988263204734962],"y":[0,0.1527613834167303,0.3019421694807169,0.4440456870063911,0.5757411499843077,0.6939417283821623,0.7958769008244742,0.8791573932654411,0.9418311815475191,0.9824292451932162,1,0.9941316023674809,0.964961602562342,0.9131737206566701,0.8399818207089611,0.7471014588194116,0.6367096719489684,0.5113939500181348,0.3740915873362889,0.2280208349126063,0.07660546738007068,-0.07660546738007079,-0.2280208349126069,-0.374091587336289,-0.511393950018135,-0.6367096719489687,-0.7471014588194118,-0.8399818207089614,-0.9131737206566706,-0.964961602562342,-0.994131602367481,-1,-0.9824292451932162,-0.941831181547519,-0.879157393265441,-0.7958769008244738,-0.6939417283821623,-0.5757411499843074,-0.4440456870063906,-0.3019421694807168,-0.1527613834167298]},"edges":{"from":["Clepper Jensen","Miranda Jordan","The Intern","Green Guardians","Green Guardians","The Lookout","Neptune","Remora","Neptune","Oceanus City Council","The Intern","The Lookout","Himark Harbor","Neptune","Davis","Green Guardians","Liam Thorne","Mrs. Money","Oceanus City Council","Oceanus City Council","Osprey","Remora","Davis","Davis","EcoVigil","Himark Harbor","Mako","Mrs. Money","Oceanus City Council","Sentinel","Sentinel","The Lookout","Boss","Davis","Green Guardians","Horizon","Mako","Mako","Mako","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Rodriguez","Small Fry","The Lookout","The Middleman","V. Miesel Shipping","Boss","Defender","Elise","Green Guardians","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Horizon","Mako","Mrs. Money","Neptune","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Rodriguez","Rodriguez","Samantha Blake","Samantha Blake","Samantha Blake","The Lookout","The Middleman","The Middleman","Davis","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Green Guardians","Green Guardians","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Kelly","Knowles","Liam Thorne","Mako","Mako","Mako","Mako","Marlin","Marlin","Mrs. Money","Nadia Conti","Nadia Conti","Neptune","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Sentinel","Sentinel","Serenity","Serenity","Serenity","Serenity","Small Fry","The Accountant","The Middleman","V. Miesel Shipping","V. Miesel Shipping","Boss","Boss","Davis","Davis","Davis","Defender","Defender","EcoVigil","Elise","Elise","Glitters Team","Glitters Team","Glitters Team","Glitters Team","Green Guardians","Green Guardians","Green Guardians","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Horizon","Knowles","Knowles","Liam Thorne","Liam Thorne","Liam Thorne","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Marlin","Marlin","Marlin","Mrs. Money","Mrs. Money","Mrs. Money","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Neptune","Neptune","Neptune","Neptune","Northern Light","Northern Light","Northern Light","Northern Light","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Reef Guardian","Reef Guardian","Remora","Remora","Remora","Remora","Remora","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Sailor Shifts Team","Sailor Shifts Team","Sam","Seawatch","Seawatch","Seawatch","Sentinel","Sentinel","Sentinel","Sentinel","Small Fry","The Accountant","The Intern","The Lookout","The Middleman","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping"],"to":["Miranda Jordan","Clepper Jensen","Mrs. Money","Green Guardians","Oceanus City Council","The Intern","Remora","Mako","V. Miesel Shipping","Liam Thorne","The Lookout","Sam","Oceanus City Council","Mako","Davis","Reef Guardian","Oceanus City Council","Boss","Green Guardians","Paackland Harbor","Mako","Neptune","Mako","Nadia Conti","Horizon","Neptune","Remora","The Intern","Himark Harbor","Horizon","Mako","Horizon","Mrs. Money","Remora","Horizon","Sentinel","Himark Harbor","Samantha Blake","Sentinel","Remora","Sentinel","EcoVigil","Oceanus City Council","Rodriguez","Remora","Sentinel","Boss","Neptune","The Middleman","Reef Guardian","Nadia Conti","EcoVigil","Mako","Remora","Seawatch","Serenity","EcoVigil","Neptune","The Middleman","Elise","Mako","Horizon","Marlin","Reef Guardian","Seawatch","Sentinel","Serenity","Paackland Harbor","Boss","Davis","Mako","Oceanus City Council","Sailor Shifts Team","Green Guardians","Mrs. Money","The Accountant","V. Miesel Shipping","EcoVigil","Liam Thorne","Reef Guardian","Sentinel","Mako","Seawatch","Oceanus City Council","Marlin","Green Guardians","Seawatch","Sam","Davis","Nadia Conti","Boss","Osprey","Paackland Harbor","Reef Guardian","Himark Harbor","Remora","Neptune","Liam Thorne","Neptune","Davis","Mako","Reef Guardian","Samantha Blake","Oceanus City Council","Reef Guardian","Defender","Mako","Paackland Harbor","Sailor Shifts Team","Green Guardians","Oceanus City Council","Himark Harbor","Mako","Neptune","Reef Guardian","Davis","Boss","Liam Thorne","Remora","V. Miesel Shipping","Mako","V. Miesel Shipping","Boss","Himark Harbor","Neptune","Mako","Seawatch","Oceanus City Council","Liam Thorne","V. Miesel Shipping","Boss","Northern Light","Remora","Samantha Blake","Northern Light","Paackland Harbor","Sentinel","EcoVigil","Knowles","Mako","Nadia Conti","Osprey","Northern Light","Mako","Oceanus City Council","Reef Guardian","Haacklee Harbor","Mako","Boss","EcoVigil","Elise","Davis","Elise","Marlin","Oceanus City Council","Sailor Shifts Team","Serenity","V. Miesel Shipping","Mako","Oceanus City Council","Reef Guardian","Mako","Remora","V. Miesel Shipping","Haacklee Harbor","Marlin","Oceanus City Council","V. Miesel Shipping","City Officials","Himark Harbor","Nadia Conti","Reef Guardian","Serenity","Green Guardians","Himark Harbor","Oceanus City Council","Sailor Shifts Team","EcoVigil","Marlin","Nadia Conti","Northern Light","Oceanus City Council","Sentinel","Liam Thorne","Neptune","Port Security","Davis","Himark Harbor","Nadia Conti","Rodriguez","V. Miesel Shipping","Mrs. Money","Nadia Conti","Remora","Sailor Shifts Team","Nadia Conti","Remora","Kelly","Green Guardians","Himark Harbor","Reef Guardian","Nadia Conti","Paackland Harbor","Reef Guardian","Seawatch","Mako","The Middleman","The Intern","Reef Guardian","Paackland Harbor","Boss","Davis","Elise","Mako","Mrs. Money","Nadia Conti","Rodriguez"],"value":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"width":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"title":["Messages: 20","Messages: 18","Messages: 15","Messages: 12","Messages: 12","Messages: 12","Messages: 9","Messages: 9","Messages: 8","Messages: 8","Messages: 8","Messages: 8","Messages: 7","Messages: 7","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":[40,35.22727272727273,33.86363636363636,33.18181818181818,33.18181818181818,32.5,28.40909090909091,27.04545454545455,27.04545454545455,26.36363636363636,23.63636363636364,22.95454545454545,22.27272727272727,22.27272727272727,20.90909090909091,20.22727272727273,19.54545454545455,19.54545454545455,19.54545454545455,18.86363636363636,17.5,16.13636363636364,16.13636363636364,15.45454545454546,15.45454545454546,14.77272727272727,14.77272727272727,14.77272727272727,14.09090909090909,13.40909090909091,13.40909090909091,12.72727272727273,12.72727272727273,12.72727272727273,12.04545454545454,12.04545454545454,11.36363636363636,11.36363636363636,10.68181818181818,10,10],"physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"enabled":false},"layout":{"randomSeed":1818}},"groups":null,"width":"100%","height":"1000px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.15,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":[{"label":"Person","shape":"dot","color":"#2ca5ff"},{"label":"Organization","shape":"square","color":"#f5ee15"},{"label":"Vessel","shape":"triangle","color":"#FB7E81"},{"label":"Group","shape":"star","color":"#25e158"},{"label":"Location","shape":"diamond","color":"#ec4bff"}],"nodesToDataframe":false},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><strong>Ver 2: Layout_on_sphere</strong></p>
<p>From this plot, it reveals that some pairs (e.g., Miranda Jordan and Clepper Jensen) mainly communicate with each other, suggesting isolated or private channels outside the broader network.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Summarize communication edges</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>comm_edges_vis <span class="ot">&lt;-</span> participants_named <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_id, receiver_id, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> sender_id, <span class="at">to =</span> receiver_id, <span class="at">value =</span> n)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Compute messages sent per person (by sender)</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>message_counts <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from) <span class="sc">%&gt;%</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sent_count =</span> <span class="fu">sum</span>(value), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Prepare nodes with label, subtype, color, shape, and scaled size</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>nodes_vis <span class="ot">&lt;-</span> mc3_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> <span class="fu">unique</span>(<span class="fu">c</span>(comm_edges_vis<span class="sc">$</span>from, comm_edges_vis<span class="sc">$</span>to))) <span class="sc">%&gt;%</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(message_counts, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"from"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">if_else</span>(</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rescale</span>(sent_count, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">40</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>      <span class="dv">15</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste0</span>(label, <span class="st">"&lt;br&gt;Sub-type: "</span>, sub_type,</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(sent_count), <span class="fu">paste0</span>(<span class="st">"&lt;br&gt;Sent: "</span>, sent_count, <span class="st">" messages"</span>), <span class="st">""</span>)),</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"#2ca5ff"</span>,</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"#f5ee15"</span>,</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"#FB7E81"</span>,</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"#25e158"</span>,</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"#ec4bff"</span>,</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"black"</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="fu">case_when</span>(</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Person"</span> <span class="sc">~</span> <span class="st">"dot"</span>,</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Organization"</span> <span class="sc">~</span> <span class="st">"square"</span>,</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Vessel"</span> <span class="sc">~</span> <span class="st">"triangle"</span>,</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Group"</span> <span class="sc">~</span> <span class="st">"star"</span>,</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>      sub_type <span class="sc">==</span> <span class="st">"Location"</span> <span class="sc">~</span> <span class="st">"diamond"</span>,</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"dot"</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Format edges</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>edges_vis <span class="ot">&lt;-</span> comm_edges_vis <span class="sc">%&gt;%</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrows =</span> <span class="st">"to"</span>,</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fu">rescale</span>(value, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)),</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Messages:"</span>, value)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Legend mapping</span></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>legend_nodes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Organization"</span>, <span class="st">"Vessel"</span>, <span class="st">"Group"</span>, <span class="st">"Location"</span>),</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="fu">c</span>(<span class="st">"#2ca5ff"</span>, <span class="st">"#f5ee15"</span>, <span class="st">"#FB7E81"</span>, <span class="st">"#25e158"</span>, <span class="st">"#ec4bff"</span>),</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">shape =</span> <span class="fu">c</span>(<span class="st">"dot"</span>, <span class="st">"square"</span>, <span class="st">"triangle"</span>, <span class="st">"star"</span>, <span class="st">"diamond"</span>),</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Render the network with layout_on_sphere and legend</span></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_vis, edges_vis, <span class="at">width =</span> <span class="st">"100%"</span>, <span class="at">height =</span> <span class="st">"900px"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> nodes_vis<span class="sc">$</span>size</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># color and shape columns are automatically used</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>(</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">addNodes =</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(legend_nodes), <span class="cf">function</span>(i) {</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> legend_nodes<span class="sc">$</span>label[i],</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">shape =</span> legend_nodes<span class="sc">$</span>shape[i],</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> legend_nodes<span class="sc">$</span>color[i]</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">useGroups =</span> <span class="cn">FALSE</span>,</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">width =</span> <span class="fl">0.15</span></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">smooth =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>, <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_on_sphere"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">enabled =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">1818</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-175c971dccb8e6d83228" style="width:100%;height:900px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-175c971dccb8e6d83228">{"x":{"nodes":{"id":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Glitters Team","Oceanus City Council","Green Guardians","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","City Officials","Paackland Harbor","Haacklee Harbor","Himark Harbor","Port Security"],"label":["Sam","Kelly","Nadia Conti","Elise","Liam Thorne","Samantha Blake","Davis","Rodriguez","Clepper Jensen","Miranda Jordan","The Intern","The Lookout","The Accountant","Mrs. Money","The Middleman","Boss","Small Fry","Glitters Team","Oceanus City Council","Green Guardians","V. Miesel Shipping","Sailor Shifts Team","Neptune","Marlin","Serenity","Mako","Reef Guardian","Horizon","Seawatch","EcoVigil","Sentinel","Osprey","Defender","Northern Light","Remora","Knowles","City Officials","Paackland Harbor","Haacklee Harbor","Himark Harbor","Port Security"],"sub_type":["Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Person","Organization","Organization","Organization","Organization","Organization","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Vessel","Group","Location","Location","Location","Location"],"sent_count":[1,2,8,5,11,9,25,14,20,18,24,33,3,19,13,9,7,4,37,44,15,2,34,7,8,35,34,14,3,14,18,6,5,4,25,4,null,16,7,27,null],"size":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],"title":["Sam<br>Sub-type: Person<br>Sent: 1 messages","Kelly<br>Sub-type: Person<br>Sent: 2 messages","Nadia Conti<br>Sub-type: Person<br>Sent: 8 messages","Elise<br>Sub-type: Person<br>Sent: 5 messages","Liam Thorne<br>Sub-type: Person<br>Sent: 11 messages","Samantha Blake<br>Sub-type: Person<br>Sent: 9 messages","Davis<br>Sub-type: Person<br>Sent: 25 messages","Rodriguez<br>Sub-type: Person<br>Sent: 14 messages","Clepper Jensen<br>Sub-type: Person<br>Sent: 20 messages","Miranda Jordan<br>Sub-type: Person<br>Sent: 18 messages","The Intern<br>Sub-type: Person<br>Sent: 24 messages","The Lookout<br>Sub-type: Person<br>Sent: 33 messages","The Accountant<br>Sub-type: Person<br>Sent: 3 messages","Mrs. Money<br>Sub-type: Person<br>Sent: 19 messages","The Middleman<br>Sub-type: Person<br>Sent: 13 messages","Boss<br>Sub-type: Person<br>Sent: 9 messages","Small Fry<br>Sub-type: Person<br>Sent: 7 messages","Glitters Team<br>Sub-type: Organization<br>Sent: 4 messages","Oceanus City Council<br>Sub-type: Organization<br>Sent: 37 messages","Green Guardians<br>Sub-type: Organization<br>Sent: 44 messages","V. Miesel Shipping<br>Sub-type: Organization<br>Sent: 15 messages","Sailor Shifts Team<br>Sub-type: Organization<br>Sent: 2 messages","Neptune<br>Sub-type: Vessel<br>Sent: 34 messages","Marlin<br>Sub-type: Vessel<br>Sent: 7 messages","Serenity<br>Sub-type: Vessel<br>Sent: 8 messages","Mako<br>Sub-type: Vessel<br>Sent: 35 messages","Reef Guardian<br>Sub-type: Vessel<br>Sent: 34 messages","Horizon<br>Sub-type: Vessel<br>Sent: 14 messages","Seawatch<br>Sub-type: Vessel<br>Sent: 3 messages","EcoVigil<br>Sub-type: Vessel<br>Sent: 14 messages","Sentinel<br>Sub-type: Vessel<br>Sent: 18 messages","Osprey<br>Sub-type: Vessel<br>Sent: 6 messages","Defender<br>Sub-type: Vessel<br>Sent: 5 messages","Northern Light<br>Sub-type: Vessel<br>Sent: 4 messages","Remora<br>Sub-type: Vessel<br>Sent: 25 messages","Knowles<br>Sub-type: Vessel<br>Sent: 4 messages","City Officials<br>Sub-type: Group","Paackland Harbor<br>Sub-type: Location<br>Sent: 16 messages","Haacklee Harbor<br>Sub-type: Location<br>Sent: 7 messages","Himark Harbor<br>Sub-type: Location<br>Sent: 27 messages","Port Security<br>Sub-type: Location"],"color":["#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#2ca5ff","#f5ee15","#f5ee15","#f5ee15","#f5ee15","#f5ee15","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#FB7E81","#25e158","#ec4bff","#ec4bff","#ec4bff","#ec4bff"],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","square","square","square","square","square","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","triangle","star","diamond","diamond","diamond","diamond"],"x":[0.006440927175621391,-0.06664830184967618,-0.4409630997074512,-0.2787167727474305,0.2365064772775034,0.6476746072078645,0.667719144831592,0.2976986554858154,-0.2526935027451958,-0.7129586264042103,-0.8813060495281457,-0.6944798975090127,-0.2316698995019175,0.3317086862019816,0.794708147038439,1,0.8814846985123932,0.4796721568472757,-0.0759052165537506,-0.6094787616592352,-0.9536054047189444,-1,-0.732695736478211,-0.2342851279815245,0.3371692344569699,0.7953258761289943,0.9847209772943193,0.83512595572909,0.393361353839724,-0.1815498231890834,-0.6654615755328198,-0.851148143779292,-0.642764389284291,-0.1259267219792909,0.4310925572677355,0.6825812698064202,0.4211383409771228,-0.1688497446265791,-0.4410178911458582,0.09467015775055376,0.006440927175621391],"y":[-0.01598891125852964,0.2954839704434384,0.006862204298155872,-0.4747234670075287,-0.5862691145784071,-0.2409750687836689,0.3014469779380633,0.7063569373476082,0.7617907495947651,0.4507146812594094,-0.08001565513005549,-0.6066112860066712,-0.924405409326406,-0.9192001757418308,-0.5970787360481746,-0.07163254829246113,0.4807357855851913,0.8803103056319443,1,0.8025079340453891,0.3497092889073024,-0.2171529858949235,-0.7203891044614957,-1,-0.9640461487628595,-0.620602608247057,-0.08055603018195756,0.4725053352879633,0.8400550256881181,0.8794642891354818,0.5658741880942779,0.02003717536535121,-0.5188955272797955,-0.7832295634598994,-0.6126999832464018,-0.08620961161376928,0.4389235777464779,0.4945974391681667,-0.03774803939227411,-0.3235418088732364,-0.01598891125852964]},"edges":{"from":["Clepper Jensen","Miranda Jordan","The Intern","Green Guardians","Green Guardians","The Lookout","Neptune","Remora","Neptune","Oceanus City Council","The Intern","The Lookout","Himark Harbor","Neptune","Davis","Green Guardians","Liam Thorne","Mrs. Money","Oceanus City Council","Oceanus City Council","Osprey","Remora","Davis","Davis","EcoVigil","Himark Harbor","Mako","Mrs. Money","Oceanus City Council","Sentinel","Sentinel","The Lookout","Boss","Davis","Green Guardians","Horizon","Mako","Mako","Mako","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Rodriguez","Small Fry","The Lookout","The Middleman","V. Miesel Shipping","Boss","Defender","Elise","Green Guardians","Himark Harbor","Himark Harbor","Himark Harbor","Himark Harbor","Horizon","Mako","Mrs. Money","Neptune","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Rodriguez","Rodriguez","Samantha Blake","Samantha Blake","Samantha Blake","The Lookout","The Middleman","The Middleman","Davis","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Green Guardians","Green Guardians","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Kelly","Knowles","Liam Thorne","Mako","Mako","Mako","Mako","Marlin","Marlin","Mrs. Money","Nadia Conti","Nadia Conti","Neptune","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Paackland Harbor","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Sentinel","Sentinel","Serenity","Serenity","Serenity","Serenity","Small Fry","The Accountant","The Middleman","V. Miesel Shipping","V. Miesel Shipping","Boss","Boss","Davis","Davis","Davis","Defender","Defender","EcoVigil","Elise","Elise","Glitters Team","Glitters Team","Glitters Team","Glitters Team","Green Guardians","Green Guardians","Green Guardians","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Haacklee Harbor","Himark Harbor","Horizon","Horizon","Horizon","Knowles","Knowles","Liam Thorne","Liam Thorne","Liam Thorne","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Marlin","Marlin","Marlin","Mrs. Money","Mrs. Money","Mrs. Money","Nadia Conti","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Neptune","Neptune","Neptune","Neptune","Northern Light","Northern Light","Northern Light","Northern Light","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Oceanus City Council","Paackland Harbor","Reef Guardian","Reef Guardian","Remora","Remora","Remora","Remora","Remora","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Sailor Shifts Team","Sailor Shifts Team","Sam","Seawatch","Seawatch","Seawatch","Sentinel","Sentinel","Sentinel","Sentinel","Small Fry","The Accountant","The Intern","The Lookout","The Middleman","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping","V. Miesel Shipping"],"to":["Miranda Jordan","Clepper Jensen","Mrs. Money","Green Guardians","Oceanus City Council","The Intern","Remora","Mako","V. Miesel Shipping","Liam Thorne","The Lookout","Sam","Oceanus City Council","Mako","Davis","Reef Guardian","Oceanus City Council","Boss","Green Guardians","Paackland Harbor","Mako","Neptune","Mako","Nadia Conti","Horizon","Neptune","Remora","The Intern","Himark Harbor","Horizon","Mako","Horizon","Mrs. Money","Remora","Horizon","Sentinel","Himark Harbor","Samantha Blake","Sentinel","Remora","Sentinel","EcoVigil","Oceanus City Council","Rodriguez","Remora","Sentinel","Boss","Neptune","The Middleman","Reef Guardian","Nadia Conti","EcoVigil","Mako","Remora","Seawatch","Serenity","EcoVigil","Neptune","The Middleman","Elise","Mako","Horizon","Marlin","Reef Guardian","Seawatch","Sentinel","Serenity","Paackland Harbor","Boss","Davis","Mako","Oceanus City Council","Sailor Shifts Team","Green Guardians","Mrs. Money","The Accountant","V. Miesel Shipping","EcoVigil","Liam Thorne","Reef Guardian","Sentinel","Mako","Seawatch","Oceanus City Council","Marlin","Green Guardians","Seawatch","Sam","Davis","Nadia Conti","Boss","Osprey","Paackland Harbor","Reef Guardian","Himark Harbor","Remora","Neptune","Liam Thorne","Neptune","Davis","Mako","Reef Guardian","Samantha Blake","Oceanus City Council","Reef Guardian","Defender","Mako","Paackland Harbor","Sailor Shifts Team","Green Guardians","Oceanus City Council","Himark Harbor","Mako","Neptune","Reef Guardian","Davis","Boss","Liam Thorne","Remora","V. Miesel Shipping","Mako","V. Miesel Shipping","Boss","Himark Harbor","Neptune","Mako","Seawatch","Oceanus City Council","Liam Thorne","V. Miesel Shipping","Boss","Northern Light","Remora","Samantha Blake","Northern Light","Paackland Harbor","Sentinel","EcoVigil","Knowles","Mako","Nadia Conti","Osprey","Northern Light","Mako","Oceanus City Council","Reef Guardian","Haacklee Harbor","Mako","Boss","EcoVigil","Elise","Davis","Elise","Marlin","Oceanus City Council","Sailor Shifts Team","Serenity","V. Miesel Shipping","Mako","Oceanus City Council","Reef Guardian","Mako","Remora","V. Miesel Shipping","Haacklee Harbor","Marlin","Oceanus City Council","V. Miesel Shipping","City Officials","Himark Harbor","Nadia Conti","Reef Guardian","Serenity","Green Guardians","Himark Harbor","Oceanus City Council","Sailor Shifts Team","EcoVigil","Marlin","Nadia Conti","Northern Light","Oceanus City Council","Sentinel","Liam Thorne","Neptune","Port Security","Davis","Himark Harbor","Nadia Conti","Rodriguez","V. Miesel Shipping","Mrs. Money","Nadia Conti","Remora","Sailor Shifts Team","Nadia Conti","Remora","Kelly","Green Guardians","Himark Harbor","Reef Guardian","Nadia Conti","Paackland Harbor","Reef Guardian","Seawatch","Mako","The Middleman","The Intern","Reef Guardian","Paackland Harbor","Boss","Davis","Elise","Mako","Mrs. Money","Nadia Conti","Rodriguez"],"value":[20,18,15,12,12,12,9,9,8,8,8,8,7,7,6,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"width":[6,5.473684210526316,4.684210526315789,3.894736842105263,3.894736842105263,3.894736842105263,3.105263157894737,3.105263157894737,2.842105263157895,2.842105263157895,2.842105263157895,2.842105263157895,2.578947368421053,2.578947368421053,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.315789473684211,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,2.052631578947368,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.789473684210526,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.526315789473684,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1.263157894736842,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"title":["Messages: 20","Messages: 18","Messages: 15","Messages: 12","Messages: 12","Messages: 12","Messages: 9","Messages: 9","Messages: 8","Messages: 8","Messages: 8","Messages: 8","Messages: 7","Messages: 7","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 6","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 5","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 4","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 3","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 2","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1","Messages: 1"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","size":[10,10.69767441860465,14.88372093023256,12.7906976744186,16.97674418604651,15.58139534883721,26.74418604651163,19.06976744186046,23.25581395348837,21.86046511627907,26.04651162790698,32.32558139534883,11.3953488372093,22.55813953488372,18.37209302325581,15.58139534883721,14.18604651162791,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15],"physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"enabled":false},"layout":{"randomSeed":1818}},"groups":null,"width":"100%","height":"900px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.15,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":[{"label":"Person","shape":"dot","color":"#2ca5ff"},{"label":"Organization","shape":"square","color":"#f5ee15"},{"label":"Vessel","shape":"triangle","color":"#FB7E81"},{"label":"Group","shape":"star","color":"#25e158"},{"label":"Location","shape":"diamond","color":"#ec4bff"}],"nodesToDataframe":false},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === Load libraries ===</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 1: Load from MC3_graph.json ===</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>q2_json <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"MC3_graph.json"</span>, <span class="at">simplifyVector =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the nodes correctly (flat list → data frame)</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>q2_nodes_raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(q2_json<span class="sc">$</span>nodes)  <span class="co"># Already flattened</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean nodes</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>q2_nodes_cleaned <span class="ot">&lt;-</span> q2_nodes_raw <span class="sc">%&gt;%</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id)) <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>thing_collected)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Edges: all types</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>q2_edges_raw <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  q2_json<span class="sc">$</span>edges<span class="sc">$</span><span class="st">`</span><span class="at">Entity-&gt;Event</span><span class="st">`</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  q2_json<span class="sc">$</span>edges<span class="sc">$</span><span class="st">`</span><span class="at">Event-&gt;Entity</span><span class="st">`</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  q2_json<span class="sc">$</span>edges<span class="sc">$</span><span class="st">`</span><span class="at">Entity-&gt;Relationship</span><span class="st">`</span>,</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  q2_json<span class="sc">$</span>edges<span class="sc">$</span><span class="st">`</span><span class="at">Relationship-&gt;Entity</span><span class="st">`</span>,</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  q2_json<span class="sc">$</span>edges<span class="sc">$</span><span class="st">`</span><span class="at">Event-&gt;Event</span><span class="st">`</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  q2_json<span class="sc">$</span>edges<span class="sc">$</span><span class="st">`</span><span class="at">Event-&gt;Relationship</span><span class="st">`</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 2: Clean Nodes ===</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>q2_edges_raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(q2_json<span class="sc">$</span>edges)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>q2_edges_cleaned <span class="ot">&lt;-</span> q2_edges_raw <span class="sc">%&gt;%</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source, <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> q2_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> q2_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 3: Clean Edges ===</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>q2_edges_cleaned <span class="ot">&lt;-</span> q2_edges_raw <span class="sc">%&gt;%</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_id =</span> source, <span class="at">to_id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(from_id, to_id), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from_id <span class="sc">%in%</span> q2_nodes_cleaned<span class="sc">$</span>id,</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>         to_id <span class="sc">%in%</span> q2_nodes_cleaned<span class="sc">$</span>id) <span class="sc">%&gt;%</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from_id), <span class="sc">!</span><span class="fu">is.na</span>(to_id))</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 4: Build index lookup ===</span></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>q2_node_index <span class="ot">&lt;-</span> q2_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.row_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, .row_id)</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 5: Join edge IDs to node index ===</span></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>q2_edges_indexed <span class="ot">&lt;-</span> q2_edges_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(q2_node_index, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(q2_node_index, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to_id"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> .row_id) <span class="sc">%&gt;%</span></span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(from, to, is_inferred, type) <span class="sc">%&gt;%</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(from), <span class="sc">!</span><span class="fu">is.na</span>(to))</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 6: Subset nodes that are used in edges ===</span></span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>q2_used_node_ids <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(q2_edges_indexed<span class="sc">$</span>from, q2_edges_indexed<span class="sc">$</span>to)))</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>q2_nodes_final <span class="ot">&lt;-</span> q2_nodes_cleaned <span class="sc">%&gt;%</span></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(q2_used_node_ids) <span class="sc">%&gt;%</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_index =</span> <span class="fu">row_number</span>())</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 7: Remap old indices in edges to new ones ===</span></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>q2_index_remap <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">old_index =</span> q2_used_node_ids,</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">new_index =</span> <span class="fu">seq_along</span>(q2_used_node_ids)</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>q2_edges_final <span class="ot">&lt;-</span> q2_edges_indexed <span class="sc">%&gt;%</span></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(q2_index_remap, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(q2_index_remap, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"to"</span> <span class="ot">=</span> <span class="st">"old_index"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to_new =</span> new_index) <span class="sc">%&gt;%</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">from =</span> from_new, <span class="at">to =</span> to_new, is_inferred, type)</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a><span class="co"># === Step 8: Build tidygraph ===</span></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>q2_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">nodes =</span> q2_nodes_final,</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">edges =</span> q2_edges_final,</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">TRUE</span></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="filtering-communication-events" class="level3">
<h3 class="anchored" data-anchor-id="filtering-communication-events">Filtering Communication Events</h3>
<p>To begin our analysis of interaction patterns, we first isolate only the <strong>communication-related events</strong> from the full knowledge graph. These are represented in the dataset as nodes where <code>type</code> is <code>"Event"</code> and the <code>sub_type</code> is <code>"Communication"</code>. These nodes correspond to actual <strong>radio or verbal exchanges</strong> logged in the system.</p>
<p>This filtering step ensures that we focus solely on the <strong>core transmission of information</strong> between entities — ignoring unrelated events such as movements, assessments, or reporting.</p>
<p>The resulting subset <code>comm_events_q2</code> serves as the <strong>foundation for identifying who communicated with whom</strong> in the subsequent steps of our analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>comm_events_q2 <span class="ot">&lt;-</span> q2_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Event"</span>, sub_type <span class="sc">==</span> <span class="st">"Communication"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="extracting-essential-communication-fields" class="level3">
<h3 class="anchored" data-anchor-id="extracting-essential-communication-fields">Extracting Essential Communication Fields</h3>
<p>With our subset of communication events (<code>comm_events_q2</code>) identified, we now extract only the essential fields required for downstream analysis:</p>
<ul>
<li><code>id</code>: The unique identifier of each communication event node</li>
<li><code>timestamp</code>: The time the message was logged</li>
<li><code>content</code>: The body of the message, which may contain names, vessel references, or pseudonyms</li>
</ul>
<p>This produces a concise working table focused on the <strong>core attributes</strong> needed to trace interactions and perform text-based analysis. The <code>content</code> column, in particular, will play a critical role in revealing <strong>pseudonymous references</strong> and <strong>frequently co-mentioned entities</strong>, which are key to uncovering influence patterns and answering Question 2b and 3a.</p>
<p>In the next step, we will <strong>standardize the timestamp</strong> for use in time-based charts and aggregations.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>comm_events_q2 <span class="ot">&lt;-</span> comm_events_q2 <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, <span class="at">timestamp =</span> timestamp, <span class="at">content =</span> content)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="converting-timestamps-to-datetime-format" class="level3">
<h3 class="anchored" data-anchor-id="converting-timestamps-to-datetime-format">Converting Timestamps to Datetime Format</h3>
<p>The <code>timestamp</code> field in our <code>comm_events_q2</code> table was originally stored as a character string. To support <strong>time-based analysis</strong> such as daily trends, hourly grouping, or temporal filtering, we convert the timestamp into a proper datetime object using the <code>ymd_hms()</code> function from the <code>lubridate</code> package.</p>
<p>This transformation standardizes all timestamps into <strong>POSIXct format</strong>, making them compatible with datetime-based operations in <code>ggplot2</code>, <code>dplyr</code>, and <code>ggraph</code>.</p>
<p>With properly formatted timestamps, we can now begin linking these communication records to their <strong>sender and receiver</strong> nodes — using the knowledge graph’s edge table.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>comm_events_q2 <span class="ot">&lt;-</span> comm_events_q2 <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">ymd_hms</span>(timestamp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="filtering-edges-for-sender-and-receiver-links" class="level3">
<h3 class="anchored" data-anchor-id="filtering-edges-for-sender-and-receiver-links">Filtering Edges for Sender and Receiver Links</h3>
<p>To map who sent and received each communication, we filter the edge list to retain only those records where <code>type</code> is either <code>"sent"</code> or <code>"received"</code>. These denote <strong>directional communication connections</strong> between entities and events.</p>
<p>In this structure: - <code>source</code> refers to the initiating entity (e.g., a person or vessel) - <code>target</code> refers to the communication event (a node of type <code>Event</code>) - <code>type</code> indicates whether the action was a message being sent or received</p>
<p>This refined subset, <code>comm_edges_q2</code>, will allow us to <strong>join communication event nodes to their participants</strong>. In the next step, we will reshape this edge list into a format where each communication row includes both the <strong>sender and receiver</strong> — an essential structure for downstream interaction visualizations and pseudonym detection.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>comm_edges_q2 <span class="ot">&lt;-</span> q2_edges_raw <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"sent"</span>, <span class="st">"received"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="separating-senders-and-receivers" class="level3">
<h3 class="anchored" data-anchor-id="separating-senders-and-receivers">Separating Senders and Receivers</h3>
<p>We now divide the directional communication edges into two distinct subsets — one representing <strong>message senders</strong>, and the other <strong>message receivers</strong>. This separation is based on the <code>type</code> of the edge (<code>"sent"</code> or <code>"received"</code>):</p>
<ul>
<li>In the <code>senders_q2</code> table, the <code>source</code> node is the <strong>entity who sent</strong> the message, and the <code>target</code> is the message node.</li>
<li>In the <code>receivers_q2</code> table, the <code>target</code> node is the <strong>entity who received</strong> the message, and the <code>source</code> is the message node.</li>
</ul>
<p>By renaming the shared message node to a common field (<code>message_id</code>), we create a consistent schema across both tables. This setup enables us to perform a join in the next step, reconstructing complete sender–receiver paths for each communication.</p>
<p>This representation is crucial for: - Mapping direct communication flows (Q2a) - Identifying alias usage and common message pathways (Q3a)</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate senders</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>senders_q2 <span class="ot">&lt;-</span> comm_edges_q2 <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"sent"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender =</span> source, <span class="at">message_id =</span> target)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate receivers</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>receivers_q2 <span class="ot">&lt;-</span> comm_edges_q2 <span class="sc">%&gt;%</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"received"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver =</span> target, <span class="at">message_id =</span> source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="creating-senderreceiver-pairs" class="level3">
<h3 class="anchored" data-anchor-id="creating-senderreceiver-pairs">Creating Sender–Receiver Pairs</h3>
<p>Now that we have separated sender and receiver records, we join them using the common <code>message_id</code>. This produces a structure where each row represents one complete communication:</p>
<ul>
<li><code>sender</code>: the entity that initiated the message</li>
<li><code>receiver</code>: the entity that received it</li>
<li><code>message_id</code>: the identifier of the communication event</li>
</ul>
<p>This <code>comm_pairs_q2</code> table becomes the core <strong>person-to-person interaction dataset</strong>, enabling us to build networks, identify frequent message paths, and trace potential alias usage.</p>
<p>In the next step, we enrich this with <strong>timestamp and message content</strong> to fully contextualize each interaction.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join on message_id</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>comm_pairs_q2 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(senders_q2, receivers_q2, <span class="at">by =</span> <span class="st">"message_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="adding-message-content-and-timing" class="level3">
<h3 class="anchored" data-anchor-id="adding-message-content-and-timing">Adding Message Content and Timing</h3>
<p>To complete our interaction data, we join the sender–receiver pairs with the original communication event records. This adds two critical fields:</p>
<ul>
<li><code>timestamp</code>: when the message occurred (in POSIXct datetime format)</li>
<li><code>content</code>: the actual text or subject of the message</li>
</ul>
<p>This full dataset, <code>comm_full_q2</code>, allows us to: - Trace <strong>who messaged whom</strong>, <strong>when</strong>, and <strong>what was said</strong> - Detect clusters or frequently interacting groups (Q2b) - Identify <strong>pseudonym usage or name overlaps</strong> (Q3a)</p>
<p>It also prepares us to build structured network visualizations and perform deeper temporal or semantic analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with content and timestamp</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>comm_full_q2 <span class="ot">&lt;-</span> comm_pairs_q2 <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(comm_events_q2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"message_id"</span> <span class="ot">=</span> <span class="st">"id"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="resolving-official-labels-for-senders-and-receivers" class="level3">
<h3 class="anchored" data-anchor-id="resolving-official-labels-for-senders-and-receivers">Resolving Official Labels for Senders and Receivers</h3>
<p>To ensure clarity in our visualizations and pseudonym analysis, we join readable labels and subtypes to both the sender and receiver entities. We create a lookup table, <code>entity_labels_q2</code>, that contains:</p>
<ul>
<li><code>id</code>: unique identifier</li>
<li><code>label</code>: human-readable name (e.g., “Kelly”, “Sailor Shift”)</li>
<li><code>sub_type</code>: whether the entity is a Person, Vessel, Organization, etc.</li>
</ul>
<p>This join is critical to: - Accurately label nodes in network plots - Normalize ambiguous or reused IDs - Track patterns of <strong>alias reuse</strong> across different messages</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>entity_labels_q2 <span class="ot">&lt;-</span> q2_nodes_final <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Entity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, label, sub_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="enriching-with-entity-labels-and-preparing-for-network-construction" class="level3">
<h3 class="anchored" data-anchor-id="enriching-with-entity-labels-and-preparing-for-network-construction">Enriching with Entity Labels and Preparing for Network Construction</h3>
<p>To finalize the communication dataset, we join readable <code>label</code> and <code>sub_type</code> attributes for both <strong>senders</strong> and <strong>receivers</strong>. This eliminates ambiguity around entity IDs and provides a human-readable structure that includes:</p>
<ul>
<li><code>sender_label</code> and <code>receiver_label</code> (e.g., “Nadia Conti”, “The Intern”)</li>
<li><code>sender_type</code> and <code>receiver_type</code> (e.g., Person, Vessel)</li>
<li>Message <code>content</code> and <code>timestamp</code></li>
</ul>
<p>This enriched table, <code>comm_full_q2</code>, now forms the basis for constructing our communication network and detecting social clusters — all <strong>without the need to export to CSV</strong>. The dataset remains in memory and feeds directly into the interactive visualization engine.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join readable labels and subtypes</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>comm_full_q2 <span class="ot">&lt;-</span> comm_full_q2 <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(entity_labels_q2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender_label =</span> label, <span class="at">sender_type =</span> sub_type) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(entity_labels_q2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver"</span> <span class="ot">=</span> <span class="st">"id"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver_label =</span> label, <span class="at">receiver_type =</span> sub_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><br>
</p>
</section>
</section>
<section id="question-2-communication-network-group-detection" class="level2">
<h2 class="anchored" data-anchor-id="question-2-communication-network-group-detection">Question 2 – Communication Network &amp; Group Detection</h2>
<p>To analyze the structure of intercepted messages, we construct an interactive network where nodes represent individuals and vessels, and edges represent direct communication. Each directed edge indicates a message from a <strong>sender</strong> to a <strong>receiver</strong>, derived from parsed radio transmissions.</p>
<section id="key-features-of-the-network-visualization" class="level3">
<h3 class="anchored" data-anchor-id="key-features-of-the-network-visualization">Key Features of the Network Visualization</h3>
<ul>
<li><strong>Node Labels:</strong> Names and aliases are displayed directly, enabling entity recognition at a glance.</li>
<li><strong>Edge Direction:</strong> Arrows show message flow (who talked to whom).</li>
<li><strong>Node Size:</strong> Reflects message volume (total sent + received).</li>
<li><strong>Tooltip:</strong> Shows exact count of messages sent and received per entity.</li>
<li><strong>Coloring &amp; Grouping:</strong> Louvain clustering reveals distinct communication groups — possibly corresponding to factions like <em>Green Guardians</em>, <em>Sailor Shift’s entourage</em>, or suspicious vessels.</li>
<li><strong>Filtering Controls:</strong> Users can interactively isolate individuals or entire communities.</li>
<li><strong>Navigation UI:</strong> Built-in zoom, pan, and full-view support helps explore dense areas.</li>
</ul>
<p>This visualization directly addresses: - <strong>Q2a</strong>: Mapping who communicates with whom - <strong>Q2b</strong>: Detecting distinct communication groups</p>
<p>The structure suggests coordinated behavior among subsets of individuals, likely reflecting underlying roles, affiliations, or orchestrated activity. These clusters warrant deeper investigation in the context of known suspects and potential pseudonym usage.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(visNetwork)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 0: Filter person ↔ vessel/entity messages</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>edge_list_q2 <span class="ot">&lt;-</span> comm_full_q2 <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sender_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>         receiver_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sender_label) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(receiver_label)) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sender_label, receiver_label, <span class="at">name =</span> <span class="st">"weight"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: igraph object</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>graph_comm_q2 <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(edge_list_q2, <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Convert to undirected before Louvain</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>graph_comm_q2_undirected <span class="ot">&lt;-</span> <span class="fu">as.undirected</span>(graph_comm_q2, <span class="at">mode =</span> <span class="st">"collapse"</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>clusters_q2 <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(graph_comm_q2_undirected)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Node degrees</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>deg_out_q2 <span class="ot">&lt;-</span> <span class="fu">degree</span>(graph_comm_q2, <span class="at">mode =</span> <span class="st">"out"</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>deg_in_q2  <span class="ot">&lt;-</span> <span class="fu">degree</span>(graph_comm_q2, <span class="at">mode =</span> <span class="st">"in"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Nodes with cluster and interactivity</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>nodes_q2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">id    =</span> <span class="fu">V</span>(graph_comm_q2)<span class="sc">$</span>name,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">V</span>(graph_comm_q2)<span class="sc">$</span>name,</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"📤 Sent: "</span>, deg_out_q2, <span class="st">"&lt;br&gt;📥 Received: "</span>, deg_in_q2),</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">paste</span>(<span class="st">"Cluster"</span>, clusters_q2<span class="sc">$</span>membership),</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> deg_out_q2 <span class="sc">+</span> deg_in_q2</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Edges with arrows</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>edges_q2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">from   =</span> <span class="fu">as_edgelist</span>(graph_comm_q2)[, <span class="dv">1</span>],</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">to     =</span> <span class="fu">as_edgelist</span>(graph_comm_q2)[, <span class="dv">2</span>],</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">arrows =</span> <span class="st">"to"</span></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Render interactive network</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(nodes_q2, edges_q2, <span class="at">height =</span> <span class="st">"700px"</span>, <span class="at">width =</span> <span class="st">"100%"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">selectedBy =</span> <span class="fu">list</span>(<span class="at">variable =</span> <span class="st">"group"</span>, <span class="at">multiple =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">"Select by cluster"</span>),</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodesIdSelection =</span> <span class="fu">list</span>(<span class="at">enabled =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">"Select by entity"</span>)</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visPhysics</span>(<span class="at">solver =</span> <span class="st">"forceAtlas2Based"</span>, <span class="at">stabilization =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-08444c9e699161510b2c" style="width:100%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-08444c9e699161510b2c">{"x":{"nodes":{"id":["Boss","Clepper Jensen","Davis","Defender","EcoVigil","Elise","Horizon","Kelly","Knowles","Liam Thorne","Mako","Marlin","Miranda Jordan","Mrs. Money","Nadia Conti","Neptune","Osprey","Reef Guardian","Remora","Rodriguez","Sam","Samantha Blake","Seawatch","Sentinel","Serenity","Small Fry","The Accountant","The Intern","The Lookout","The Middleman"],"label":["Boss","Clepper Jensen","Davis","Defender","EcoVigil","Elise","Horizon","Kelly","Knowles","Liam Thorne","Mako","Marlin","Miranda Jordan","Mrs. Money","Nadia Conti","Neptune","Osprey","Reef Guardian","Remora","Rodriguez","Sam","Samantha Blake","Seawatch","Sentinel","Serenity","Small Fry","The Accountant","The Intern","The Lookout","The Middleman"],"title":["📤 Sent: 3<br>📥 Received: 7","📤 Sent: 1<br>📥 Received: 1","📤 Sent: 6<br>📥 Received: 7","📤 Sent: 3<br>📥 Received: 1","📤 Sent: 5<br>📥 Received: 4","📤 Sent: 2<br>📥 Received: 3","📤 Sent: 5<br>📥 Received: 4","📤 Sent: 1<br>📥 Received: 1","📤 Sent: 2<br>📥 Received: 0","📤 Sent: 4<br>📥 Received: 4","📤 Sent: 11<br>📥 Received: 15","📤 Sent: 3<br>📥 Received: 3","📤 Sent: 1<br>📥 Received: 1","📤 Sent: 6<br>📥 Received: 4","📤 Sent: 3<br>📥 Received: 7","📤 Sent: 7<br>📥 Received: 7","📤 Sent: 1<br>📥 Received: 1","📤 Sent: 10<br>📥 Received: 11","📤 Sent: 5<br>📥 Received: 7","📤 Sent: 6<br>📥 Received: 2","📤 Sent: 1<br>📥 Received: 2","📤 Sent: 1<br>📥 Received: 1","📤 Sent: 1<br>📥 Received: 4","📤 Sent: 5<br>📥 Received: 5","📤 Sent: 3<br>📥 Received: 3","📤 Sent: 3<br>📥 Received: 0","📤 Sent: 2<br>📥 Received: 1","📤 Sent: 3<br>📥 Received: 3","📤 Sent: 5<br>📥 Received: 1","📤 Sent: 4<br>📥 Received: 3"],"group":["Cluster 1","Cluster 2","Cluster 3","Cluster 4","Cluster 4","Cluster 3","Cluster 4","Cluster 1","Cluster 3","Cluster 3","Cluster 3","Cluster 4","Cluster 2","Cluster 1","Cluster 3","Cluster 3","Cluster 3","Cluster 4","Cluster 3","Cluster 3","Cluster 1","Cluster 3","Cluster 4","Cluster 4","Cluster 4","Cluster 3","Cluster 1","Cluster 1","Cluster 1","Cluster 1"],"value":[10,2,13,4,9,5,9,2,2,8,26,6,2,10,10,14,2,21,12,8,3,2,5,10,6,3,3,6,6,7]},"edges":{"from":["Boss","Boss","Boss","Clepper Jensen","Davis","Davis","Davis","Davis","Davis","Davis","Defender","Defender","Defender","EcoVigil","EcoVigil","EcoVigil","EcoVigil","EcoVigil","Elise","Elise","Horizon","Horizon","Horizon","Horizon","Horizon","Kelly","Knowles","Knowles","Liam Thorne","Liam Thorne","Liam Thorne","Liam Thorne","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Mako","Marlin","Marlin","Marlin","Miranda Jordan","Mrs. Money","Mrs. Money","Mrs. Money","Mrs. Money","Mrs. Money","Mrs. Money","Nadia Conti","Nadia Conti","Nadia Conti","Neptune","Neptune","Neptune","Neptune","Neptune","Neptune","Neptune","Osprey","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Reef Guardian","Remora","Remora","Remora","Remora","Remora","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Rodriguez","Sam","Samantha Blake","Seawatch","Sentinel","Sentinel","Sentinel","Sentinel","Sentinel","Serenity","Serenity","Serenity","Small Fry","Small Fry","Small Fry","The Accountant","The Accountant","The Intern","The Intern","The Intern","The Lookout","The Lookout","The Lookout","The Lookout","The Lookout","The Middleman","The Middleman","The Middleman","The Middleman"],"to":["Mako","Mrs. Money","The Middleman","Miranda Jordan","Boss","Davis","Mako","Nadia Conti","Neptune","Remora","Mako","Reef Guardian","Seawatch","EcoVigil","Horizon","Liam Thorne","Reef Guardian","Sentinel","Liam Thorne","Nadia Conti","EcoVigil","Mako","Reef Guardian","Seawatch","Sentinel","Sam","Davis","Mako","Boss","EcoVigil","Elise","Nadia Conti","Boss","Davis","Elise","Marlin","Neptune","Osprey","Reef Guardian","Remora","Samantha Blake","Sentinel","Serenity","Mako","Reef Guardian","Remora","Clepper Jensen","Boss","Mako","Neptune","Remora","The Intern","The Middleman","Liam Thorne","Marlin","Neptune","Davis","Elise","Mako","Nadia Conti","Reef Guardian","Remora","Serenity","Mako","Defender","EcoVigil","Horizon","Mako","Marlin","Neptune","Reef Guardian","Seawatch","Sentinel","Serenity","Davis","Mako","Nadia Conti","Neptune","Rodriguez","Boss","Davis","Mrs. Money","Nadia Conti","Remora","Rodriguez","Kelly","Mako","Reef Guardian","Horizon","Mako","Nadia Conti","Reef Guardian","Seawatch","Mako","Neptune","Reef Guardian","Davis","Mako","Remora","Boss","The Middleman","Mrs. Money","The Intern","The Lookout","Horizon","Reef Guardian","Sam","Sentinel","The Intern","Boss","Liam Thorne","Mrs. Money","The Accountant"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"solver":"forceAtlas2Based","stabilization":true},"interaction":{"navigationButtons":true,"zoomSpeed":1},"layout":{"randomSeed":42}},"groups":["Cluster 1","Cluster 2","Cluster 3","Cluster 4"],"width":"100%","height":"700px","idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by entity"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by cluster","values":["Cluster 1","Cluster 2","Cluster 3","Cluster 4"]},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br>
<br>
<br>
</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Get Louvain membership for each node</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>node_cluster_q2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">label   =</span> <span class="fu">V</span>(graph_comm_q2)<span class="sc">$</span>name,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cluster =</span> clusters_q2<span class="sc">$</span>membership</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Add sender/receiver cluster membership</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>comm_with_cluster_q2 <span class="ot">&lt;-</span> comm_full_q2 <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sender_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>),</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>         receiver_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Person"</span>, <span class="st">"Vessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_cluster_q2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sender_label"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sender_cluster =</span> cluster) <span class="sc">%&gt;%</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_cluster_q2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"receiver_label"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">receiver_cluster =</span> cluster)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Pivot to long format</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>comm_long_q2 <span class="ot">&lt;-</span> comm_with_cluster_q2 <span class="sc">%&gt;%</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(content, sender_cluster, receiver_cluster) <span class="sc">%&gt;%</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">message_content =</span> content) <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(sender_cluster, receiver_cluster),</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"role"</span>, <span class="at">values_to =</span> <span class="st">"cluster"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(cluster), <span class="sc">!</span><span class="fu">is.na</span>(message_content))</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Tokenize and remove stopwords</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"stop_words"</span>)</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>tokens_by_cluster_q2 <span class="ot">&lt;-</span> comm_long_q2 <span class="sc">%&gt;%</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, message_content) <span class="sc">%&gt;%</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> stop_words<span class="sc">$</span>word, <span class="fu">str_detect</span>(word, <span class="st">"[a-z]"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cluster, word, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Top 20 keywords per cluster</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>top_keywords_q2 <span class="ot">&lt;-</span> tokens_by_cluster_q2 <span class="sc">%&gt;%</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(cluster, <span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: Structure into list by cluster</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>keyword_lists_q2 <span class="ot">&lt;-</span> top_keywords_q2 <span class="sc">%&gt;%</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>()</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(keyword_lists_q2) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Cluster_"</span>, <span class="fu">sort</span>(<span class="fu">unique</span>(top_keywords_q2<span class="sc">$</span>cluster)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option A: Print tables for Cluster 1 to Cluster 4</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)   <span class="co"># For kable</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show tables side-by-side (if you want in columns)</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  cluster_df <span class="ot">&lt;-</span> keyword_lists_q2[[i]]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  cluster_label <span class="ot">&lt;-</span> <span class="fu">names</span>(keyword_lists_q2)[i]</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"### 🔹 "</span>, cluster_label, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>))  <span class="co"># Section header</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  cluster_df <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">Word =</span> word, <span class="at">Frequency =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="st">"html"</span>, <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Top Keywords for"</span>, cluster_label)) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>### 🔹 Cluster_1

### 🔹 Cluster_2

### 🔹 Cluster_3

### 🔹 Cluster_4</code></pre>
</div>
</div>
<p><br>
</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define color per cluster</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>cluster_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cluster_1"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>,  <span class="co"># blue</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cluster_2"</span> <span class="ot">=</span> <span class="st">"#d62728"</span>,  <span class="co"># red</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cluster_3"</span> <span class="ot">=</span> <span class="st">"#2ca02c"</span>,  <span class="co"># green</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Cluster_4"</span> <span class="ot">=</span> <span class="st">"#9467bd"</span>   <span class="co"># purple</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate one gt table per cluster</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  cluster_df <span class="ot">&lt;-</span> keyword_lists_q2[[i]]</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  cluster_name <span class="ot">&lt;-</span> <span class="fu">names</span>(keyword_lists_q2)[i]</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  cluster_df <span class="sc">%&gt;%</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">Word =</span> word, <span class="at">Frequency =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_header</span>(</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">md</span>(<span class="fu">paste0</span>(<span class="st">"**Top 20 Keywords – "</span>, cluster_name, <span class="st">"**"</span>))</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_options</span>(</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">table.width =</span> <span class="fu">pct</span>(<span class="dv">60</span>),</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.background.color =</span> cluster_colors[cluster_name],</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">heading.align =</span> <span class="st">"left"</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cols_label</span>(</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">Word =</span> <span class="st">"Keyword"</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">Frequency =</span> <span class="st">"Mentions"</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data_color</span>(</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> <span class="fu">vars</span>(Frequency),</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">colors =</span> scales<span class="sc">::</span><span class="fu">col_numeric</span>(</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"white"</span>, cluster_colors[cluster_name]),</span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">domain =</span> <span class="cn">NULL</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()  <span class="co"># In Quarto, this auto-renders under each cluster</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;div id="ajdnxyiwtn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;"&gt;
  &lt;style&gt;#ajdnxyiwtn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ajdnxyiwtn thead, #ajdnxyiwtn tbody, #ajdnxyiwtn tfoot, #ajdnxyiwtn tr, #ajdnxyiwtn td, #ajdnxyiwtn th {
  border-style: none;
}

#ajdnxyiwtn p {
  margin: 0;
  padding: 0;
}

#ajdnxyiwtn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 60%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ajdnxyiwtn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ajdnxyiwtn .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ajdnxyiwtn .gt_subtitle {
  color: #FFFFFF;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ajdnxyiwtn .gt_heading {
  background-color: #1F77B4;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ajdnxyiwtn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ajdnxyiwtn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ajdnxyiwtn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ajdnxyiwtn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ajdnxyiwtn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ajdnxyiwtn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ajdnxyiwtn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ajdnxyiwtn .gt_spanner_row {
  border-bottom-style: hidden;
}

#ajdnxyiwtn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ajdnxyiwtn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ajdnxyiwtn .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#ajdnxyiwtn .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#ajdnxyiwtn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ajdnxyiwtn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ajdnxyiwtn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ajdnxyiwtn .gt_row_group_first td {
  border-top-width: 2px;
}

#ajdnxyiwtn .gt_row_group_first th {
  border-top-width: 2px;
}

#ajdnxyiwtn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajdnxyiwtn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ajdnxyiwtn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ajdnxyiwtn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ajdnxyiwtn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajdnxyiwtn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ajdnxyiwtn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ajdnxyiwtn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ajdnxyiwtn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ajdnxyiwtn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ajdnxyiwtn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajdnxyiwtn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ajdnxyiwtn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ajdnxyiwtn .gt_left {
  text-align: left;
}

#ajdnxyiwtn .gt_center {
  text-align: center;
}

#ajdnxyiwtn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ajdnxyiwtn .gt_font_normal {
  font-weight: normal;
}

#ajdnxyiwtn .gt_font_bold {
  font-weight: bold;
}

#ajdnxyiwtn .gt_font_italic {
  font-style: italic;
}

#ajdnxyiwtn .gt_super {
  font-size: 65%;
}

#ajdnxyiwtn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ajdnxyiwtn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ajdnxyiwtn .gt_indent_1 {
  text-indent: 5px;
}

#ajdnxyiwtn .gt_indent_2 {
  text-indent: 10px;
}

#ajdnxyiwtn .gt_indent_3 {
  text-indent: 15px;
}

#ajdnxyiwtn .gt_indent_4 {
  text-indent: 20px;
}

#ajdnxyiwtn .gt_indent_5 {
  text-indent: 25px;
}

#ajdnxyiwtn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ajdnxyiwtn div.Reactable &gt; div.rt-table &gt; div.rt-thead &gt; div.rt-tr.rt-tr-group-header &gt; div.rt-th-group:after {
  height: 0px !important;
}
&lt;/style&gt;
  &lt;table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"&gt;
  &lt;thead&gt;
    &lt;tr class="gt_heading"&gt;
      &lt;td colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border" style&gt;&lt;span data-qmd-base64="KipUb3AgMjAgS2V5d29yZHMg4oCTIENsdXN0ZXJfMSoq"&gt;&lt;span class='gt_from_md'&gt;&lt;strong&gt;Top 20 Keywords – Cluster_1&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr class="gt_col_headings"&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Word"&gt;Keyword&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Frequency"&gt;Mentions&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class="gt_table_body"&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;reef&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #1F77B4; color: #FFFFFF;"&gt;131&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;nemo&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #4584BC; color: #FFFFFF;"&gt;120&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;money&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #84A7D0; color: #000000;"&gt;91&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;intern&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #86A9D1; color: #000000;"&gt;90&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;meeting&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #88AAD1; color: #000000;"&gt;89&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;lookout&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #8AABD2; color: #000000;"&gt;88&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;conservation&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #9FB9DA; color: #000000;"&gt;77&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;tomorrow&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #B7CAE3; color: #000000;"&gt;64&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;boss&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #C1D2E7; color: #000000;"&gt;58&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;middleman&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #D0DCED; color: #000000;"&gt;50&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;birdwatching&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #DEE7F2; color: #000000;"&gt;42&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;bring&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #DEE7F2; color: #000000;"&gt;42&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;vessels&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #E0E8F3; color: #000000;"&gt;41&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;equipment&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #EBF0F7; color: #000000;"&gt;35&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;council&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F2F5FA; color: #000000;"&gt;31&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;underwater&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F8FAFC; color: #000000;"&gt;28&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;spotted&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FBFCFE; color: #000000;"&gt;26&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;activity&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;24&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;harbor&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;24&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;hey&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;24&lt;/td&gt;&lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;
&lt;/div&gt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;div id="fivmrfaexf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;"&gt;
  &lt;style&gt;#fivmrfaexf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fivmrfaexf thead, #fivmrfaexf tbody, #fivmrfaexf tfoot, #fivmrfaexf tr, #fivmrfaexf td, #fivmrfaexf th {
  border-style: none;
}

#fivmrfaexf p {
  margin: 0;
  padding: 0;
}

#fivmrfaexf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 60%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fivmrfaexf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fivmrfaexf .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fivmrfaexf .gt_subtitle {
  color: #FFFFFF;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fivmrfaexf .gt_heading {
  background-color: #D62728;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fivmrfaexf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fivmrfaexf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fivmrfaexf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fivmrfaexf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fivmrfaexf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fivmrfaexf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fivmrfaexf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fivmrfaexf .gt_spanner_row {
  border-bottom-style: hidden;
}

#fivmrfaexf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fivmrfaexf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fivmrfaexf .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#fivmrfaexf .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#fivmrfaexf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fivmrfaexf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fivmrfaexf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fivmrfaexf .gt_row_group_first td {
  border-top-width: 2px;
}

#fivmrfaexf .gt_row_group_first th {
  border-top-width: 2px;
}

#fivmrfaexf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fivmrfaexf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fivmrfaexf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fivmrfaexf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fivmrfaexf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fivmrfaexf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fivmrfaexf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fivmrfaexf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fivmrfaexf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fivmrfaexf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fivmrfaexf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fivmrfaexf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fivmrfaexf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fivmrfaexf .gt_left {
  text-align: left;
}

#fivmrfaexf .gt_center {
  text-align: center;
}

#fivmrfaexf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fivmrfaexf .gt_font_normal {
  font-weight: normal;
}

#fivmrfaexf .gt_font_bold {
  font-weight: bold;
}

#fivmrfaexf .gt_font_italic {
  font-style: italic;
}

#fivmrfaexf .gt_super {
  font-size: 65%;
}

#fivmrfaexf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fivmrfaexf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fivmrfaexf .gt_indent_1 {
  text-indent: 5px;
}

#fivmrfaexf .gt_indent_2 {
  text-indent: 10px;
}

#fivmrfaexf .gt_indent_3 {
  text-indent: 15px;
}

#fivmrfaexf .gt_indent_4 {
  text-indent: 20px;
}

#fivmrfaexf .gt_indent_5 {
  text-indent: 25px;
}

#fivmrfaexf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fivmrfaexf div.Reactable &gt; div.rt-table &gt; div.rt-thead &gt; div.rt-tr.rt-tr-group-header &gt; div.rt-th-group:after {
  height: 0px !important;
}
&lt;/style&gt;
  &lt;table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"&gt;
  &lt;thead&gt;
    &lt;tr class="gt_heading"&gt;
      &lt;td colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border" style&gt;&lt;span data-qmd-base64="KipUb3AgMjAgS2V5d29yZHMg4oCTIENsdXN0ZXJfMioq"&gt;&lt;span class='gt_from_md'&gt;&lt;strong&gt;Top 20 Keywords – Cluster_2&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr class="gt_col_headings"&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Word"&gt;Keyword&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Frequency"&gt;Mentions&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class="gt_table_body"&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;miranda&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #D62728; color: #FFFFFF;"&gt;76&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;equipment&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F9A394; color: #000000;"&gt;42&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;clepper&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FBA99B; color: #000000;"&gt;40&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;jensen&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FDB5A9; color: #000000;"&gt;36&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;environmental&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFCEC5; color: #000000;"&gt;28&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;vessels&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFCEC5; color: #000000;"&gt;28&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;conservation&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFE0DA; color: #000000;"&gt;22&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;documents&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFE6E2; color: #000000;"&gt;20&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;rodriguez&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFE6E2; color: #000000;"&gt;20&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;document&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFECE9; color: #000000;"&gt;18&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;harbor&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFECE9; color: #000000;"&gt;18&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;security&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFECE9; color: #000000;"&gt;18&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;vessel&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFECE9; color: #000000;"&gt;18&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;council&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFF3F0; color: #000000;"&gt;16&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;reef&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFF3F0; color: #000000;"&gt;16&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;nemo&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFF9F8; color: #000000;"&gt;14&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;knowles&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;12&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;meeting&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;12&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;miesel&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;12&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;officials&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;12&lt;/td&gt;&lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;
&lt;/div&gt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;div id="jblsbooqxr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;"&gt;
  &lt;style&gt;#jblsbooqxr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jblsbooqxr thead, #jblsbooqxr tbody, #jblsbooqxr tfoot, #jblsbooqxr tr, #jblsbooqxr td, #jblsbooqxr th {
  border-style: none;
}

#jblsbooqxr p {
  margin: 0;
  padding: 0;
}

#jblsbooqxr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 60%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jblsbooqxr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jblsbooqxr .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jblsbooqxr .gt_subtitle {
  color: #FFFFFF;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jblsbooqxr .gt_heading {
  background-color: #2CA02C;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jblsbooqxr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jblsbooqxr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jblsbooqxr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jblsbooqxr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jblsbooqxr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jblsbooqxr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jblsbooqxr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jblsbooqxr .gt_spanner_row {
  border-bottom-style: hidden;
}

#jblsbooqxr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jblsbooqxr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jblsbooqxr .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#jblsbooqxr .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#jblsbooqxr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jblsbooqxr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jblsbooqxr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jblsbooqxr .gt_row_group_first td {
  border-top-width: 2px;
}

#jblsbooqxr .gt_row_group_first th {
  border-top-width: 2px;
}

#jblsbooqxr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jblsbooqxr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jblsbooqxr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jblsbooqxr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jblsbooqxr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jblsbooqxr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jblsbooqxr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jblsbooqxr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jblsbooqxr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jblsbooqxr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jblsbooqxr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jblsbooqxr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jblsbooqxr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jblsbooqxr .gt_left {
  text-align: left;
}

#jblsbooqxr .gt_center {
  text-align: center;
}

#jblsbooqxr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jblsbooqxr .gt_font_normal {
  font-weight: normal;
}

#jblsbooqxr .gt_font_bold {
  font-weight: bold;
}

#jblsbooqxr .gt_font_italic {
  font-style: italic;
}

#jblsbooqxr .gt_super {
  font-size: 65%;
}

#jblsbooqxr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jblsbooqxr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jblsbooqxr .gt_indent_1 {
  text-indent: 5px;
}

#jblsbooqxr .gt_indent_2 {
  text-indent: 10px;
}

#jblsbooqxr .gt_indent_3 {
  text-indent: 15px;
}

#jblsbooqxr .gt_indent_4 {
  text-indent: 20px;
}

#jblsbooqxr .gt_indent_5 {
  text-indent: 25px;
}

#jblsbooqxr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jblsbooqxr div.Reactable &gt; div.rt-table &gt; div.rt-thead &gt; div.rt-tr.rt-tr-group-header &gt; div.rt-th-group:after {
  height: 0px !important;
}
&lt;/style&gt;
  &lt;table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"&gt;
  &lt;thead&gt;
    &lt;tr class="gt_heading"&gt;
      &lt;td colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border" style&gt;&lt;span data-qmd-base64="KipUb3AgMjAgS2V5d29yZHMg4oCTIENsdXN0ZXJfMyoq"&gt;&lt;span class='gt_from_md'&gt;&lt;strong&gt;Top 20 Keywords – Cluster_3&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr class="gt_col_headings"&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Word"&gt;Keyword&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Frequency"&gt;Mentions&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class="gt_table_body"&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;mako&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #2CA02C; color: #FFFFFF;"&gt;168&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;reef&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #73BB67; color: #000000;"&gt;132&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;equipment&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #76BC6B; color: #000000;"&gt;130&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;nemo&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #96CC8C; color: #000000;"&gt;109&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;remora&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #9BCE90; color: #000000;"&gt;106&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;neptune&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #BADDB2; color: #000000;"&gt;85&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;davis&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #C2E1BA; color: #000000;"&gt;80&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;team&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #D3EACD; color: #000000;"&gt;68&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;tomorrow&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #D3EACD; color: #000000;"&gt;68&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;protocols&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #E3F1DF; color: #000000;"&gt;57&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;harbor&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #E5F2E1; color: #000000;"&gt;56&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;operation&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #EBF5E8; color: #000000;"&gt;52&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;security&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #EEF6EB; color: #000000;"&gt;50&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;nadia&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #EFF7ED; color: #000000;"&gt;49&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;maintain&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F3F9F2; color: #000000;"&gt;46&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;operations&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F5FAF3; color: #000000;"&gt;45&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;meeting&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FBFDFA; color: #000000;"&gt;41&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;route&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FEFEFD; color: #000000;"&gt;39&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;transfer&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FEFEFD; color: #000000;"&gt;39&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;confirmed&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;38&lt;/td&gt;&lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;
&lt;/div&gt;</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;div id="ayhlakgtox" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;"&gt;
  &lt;style&gt;#ayhlakgtox table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ayhlakgtox thead, #ayhlakgtox tbody, #ayhlakgtox tfoot, #ayhlakgtox tr, #ayhlakgtox td, #ayhlakgtox th {
  border-style: none;
}

#ayhlakgtox p {
  margin: 0;
  padding: 0;
}

#ayhlakgtox .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 60%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ayhlakgtox .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ayhlakgtox .gt_title {
  color: #FFFFFF;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ayhlakgtox .gt_subtitle {
  color: #FFFFFF;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ayhlakgtox .gt_heading {
  background-color: #9467BD;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ayhlakgtox .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ayhlakgtox .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ayhlakgtox .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ayhlakgtox .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ayhlakgtox .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ayhlakgtox .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ayhlakgtox .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ayhlakgtox .gt_spanner_row {
  border-bottom-style: hidden;
}

#ayhlakgtox .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ayhlakgtox .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ayhlakgtox .gt_from_md &gt; :first-child {
  margin-top: 0;
}

#ayhlakgtox .gt_from_md &gt; :last-child {
  margin-bottom: 0;
}

#ayhlakgtox .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ayhlakgtox .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ayhlakgtox .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ayhlakgtox .gt_row_group_first td {
  border-top-width: 2px;
}

#ayhlakgtox .gt_row_group_first th {
  border-top-width: 2px;
}

#ayhlakgtox .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayhlakgtox .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ayhlakgtox .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ayhlakgtox .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ayhlakgtox .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayhlakgtox .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ayhlakgtox .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ayhlakgtox .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ayhlakgtox .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ayhlakgtox .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ayhlakgtox .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayhlakgtox .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ayhlakgtox .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ayhlakgtox .gt_left {
  text-align: left;
}

#ayhlakgtox .gt_center {
  text-align: center;
}

#ayhlakgtox .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ayhlakgtox .gt_font_normal {
  font-weight: normal;
}

#ayhlakgtox .gt_font_bold {
  font-weight: bold;
}

#ayhlakgtox .gt_font_italic {
  font-style: italic;
}

#ayhlakgtox .gt_super {
  font-size: 65%;
}

#ayhlakgtox .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ayhlakgtox .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ayhlakgtox .gt_indent_1 {
  text-indent: 5px;
}

#ayhlakgtox .gt_indent_2 {
  text-indent: 10px;
}

#ayhlakgtox .gt_indent_3 {
  text-indent: 15px;
}

#ayhlakgtox .gt_indent_4 {
  text-indent: 20px;
}

#ayhlakgtox .gt_indent_5 {
  text-indent: 25px;
}

#ayhlakgtox .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ayhlakgtox div.Reactable &gt; div.rt-table &gt; div.rt-thead &gt; div.rt-tr.rt-tr-group-header &gt; div.rt-th-group:after {
  height: 0px !important;
}
&lt;/style&gt;
  &lt;table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false"&gt;
  &lt;thead&gt;
    &lt;tr class="gt_heading"&gt;
      &lt;td colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border" style&gt;&lt;span data-qmd-base64="KipUb3AgMjAgS2V5d29yZHMg4oCTIENsdXN0ZXJfNCoq"&gt;&lt;span class='gt_from_md'&gt;&lt;strong&gt;Top 20 Keywords – Cluster_4&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr class="gt_col_headings"&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Word"&gt;Keyword&lt;/th&gt;
      &lt;th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Frequency"&gt;Mentions&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody class="gt_table_body"&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;reef&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #9467BD; color: #FFFFFF;"&gt;167&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;nemo&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #CEB6E1; color: #000000;"&gt;89&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;guardian&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #D4BFE4; color: #000000;"&gt;81&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;equipment&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #D7C3E6; color: #000000;"&gt;77&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;sentinel&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #E8DCF1; color: #000000;"&gt;53&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;vessels&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #E8DCF1; color: #000000;"&gt;53&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;horizon&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #E9DEF1; color: #000000;"&gt;52&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;ecovigil&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F2EBF7; color: #000000;"&gt;39&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;activity&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F8F4FB; color: #000000;"&gt;31&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;eastern&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F9F5FB; color: #000000;"&gt;30&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;position&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #F9F6FB; color: #000000;"&gt;29&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;quadrant&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FBF8FC; color: #000000;"&gt;27&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;boundary&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FBFAFD; color: #000000;"&gt;26&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;mako&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FBFAFD; color: #000000;"&gt;26&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;tourism&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FBFAFD; color: #000000;"&gt;26&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;appears&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FCFBFD; color: #000000;"&gt;25&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;activities&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FDFCFE; color: #000000;"&gt;24&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;vessel&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FEFDFE; color: #000000;"&gt;23&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;closure&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;21&lt;/td&gt;&lt;/tr&gt;
    &lt;tr&gt;&lt;td headers="Word" class="gt_row gt_left"&gt;documentation&lt;/td&gt;
&lt;td headers="Frequency" class="gt_row gt_right" style="background-color: #FFFFFF; color: #000000;"&gt;21&lt;/td&gt;&lt;/tr&gt;
  &lt;/tbody&gt;
  
  
&lt;/table&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>